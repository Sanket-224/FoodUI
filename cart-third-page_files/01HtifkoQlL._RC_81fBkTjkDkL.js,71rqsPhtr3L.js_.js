(function(b){var d=window.AmazonUIPageJS||window.P,e=d._namespace||d.attributeErrors,a=e?e("WidgetStreamer",""):d;a.guardFatal?a.guardFatal(b)(a,window):a.execute(function(){b(a,window)})})(function(b,d,e){b.register("widget-streamer-jquery-action",function(){return function(a){if(!a||3>a.length)throw Error("Can not create update action, insufficient data in chunk: "+JSON.stringify(a));return{action:a[0],selector:a[1],html:a[2]}}});"use strict";b.when("jQuery","widget-streamer-jquery-action").register("widget-streamer-action-ws-update",
function(a,b){return function(f){var c=b(f);return{execute:function(){a(c.selector).html(c.html)}}}});"use strict";b.when("jQuery","widget-streamer-jquery-action").register("widget-streamer-action-ws-append",function(a,b){return function(f){var c=b(f);return{execute:function(){var b=a(c.selector);b.html(b.html()+c.html)}}}});"use strict";b.when("jQuery","widget-streamer-jquery-action").register("widget-streamer-action-ws-prepend",function(a,b){return function(f){var c=b(f);return{execute:function(){var b=
a(c.selector);b.html(c.html+b.html())}}}});"use strict";b.register("widget-streamer-utils",function(){return{isStreamingAjax:function(a){if(a&&"function"===typeof a.getResponseHeader)a=a.getResponseHeader("Content-Type");else if(a&&a.http&&"function"===typeof a.http.getResponseHeader)a=a.http.getResponseHeader("Content-Type");else throw Error("Unable to retrive headers for the given xhr object: "+a);return"application/json-amazonui-streaming"===a}}});"use strict";b.when("A","jQuery").register("widget-streamer",
function(a,d){return function(a){function c(a){var c,d="widget-streamer-action-"+a[0];b.now(d).execute(function(b){if(b)c=b(a);else throw Error("Operation: "+a[0]+" is not supported. Register component "+d+" to handle this action");});return c}var d=a||{},g=[],e=!d.isPrefetch,h=!0;return{onNewChunk:function(a){h&&d.before&&(h=!1,d.before());a=c(a);e?a.execute():g.push(a)},execute:function(){for(var a=0;a<g.length;a++)g[a].execute();g=[];e=!0}}}})});
/* ******** */
(function(q){var n=window.AmazonUIPageJS||window.P,Ca=n._namespace||n.attributeErrors,ja=Ca?Ca("CheckoutCommonAsset",""):n;ja.guardFatal?ja.guardFatal(q)(ja,window):ja.execute(function(){q(ja,window)})})(function(q,n,Ca){q.register("polyfill-indexof",function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,l){if(null==this)throw new TypeError('"this" is null or not defined');var k=Object(this),b=k.length>>>0;if(0===b)return-1;l=+l||0;Infinity===Math.abs(l)&&(l=0);if(l>=b)return-1;for(l=
Math.max(0<=l?l:b-Math.abs(l),0);l<b;){if(l in k&&k[l]===a)return l;l++}return-1})});"use strict";q.register("polyfill-filter",function(){Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var l=Object(this),k=l.length>>>0;if("function"!==typeof a)throw new TypeError;for(var b=[],f=2<=arguments.length?arguments[1]:void 0,g=0;g<k;g++)if(g in l){var h=l[g];a.call(f,h,g,l)&&b.push(h)}return b})});"use strict";q.register("polyfill-json-stringify",
function(){"object"!==typeof JSON&&(JSON={});(function(){function a(a){return 10>a?"0"+a:a}function l(){return this.valueOf()}function k(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=B[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function b(a,c){var d,e,f=m,g,h=c[a];h&&"object"===typeof h&&"function"===typeof h.toJSON&&(h=h.toJSON(a));"function"===typeof u&&(h=u.call(c,a,h));switch(typeof h){case "string":return k(h);case "number":return isFinite(h)?
String(h):"null";case "boolean":case "null":return String(h);case "object":if(!h)return"null";m+=p;g=[];if("[object Array]"===Object.prototype.toString.apply(h)){e=h.length;for(a=0;a<e;a+=1)g[a]=b(a,h)||"null";c=0===g.length?"[]":m?"[\n"+m+g.join(",\n"+m)+"\n"+f+"]":"["+g.join(",")+"]";m=f;return c}if(u&&"object"===typeof u)for(e=u.length,a=0;a<e;a+=1)"string"===typeof u[a]&&(d=u[a],(c=b(d,h))&&g.push(k(d)+(m?": ":":")+c));else for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&(c=b(d,h))&&g.push(k(d)+
(m?": ":":")+c);c=0===g.length?"{}":m?"{\n"+m+g.join(",\n"+m)+"\n"+f+"}":"{"+g.join(",")+"}";m=f;return c}}var f=/^[\],:{}\s]*$/,g=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,h=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,d=/(?:^|:|,)(?:\s*\[)+/g,e=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=l,Number.prototype.toJSON=l,String.prototype.toJSON=l);var m,p,B,u;"function"!==typeof JSON.stringify&&(B={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=
function(a,c,d){var e;p=m="";if("number"===typeof d)for(e=0;e<d;e+=1)p+=" ";else"string"===typeof d&&(p=d);if((u=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return b("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function e(a,c){var d,m,f=a[c];if(f&&"object"===typeof f)for(d in f)Object.prototype.hasOwnProperty.call(f,d)&&(m=e(f,d),void 0!==m?f[d]=m:delete f[d]);return b.call(a,c,f)}a=String(a);c.lastIndex=0;c.test(a)&&
(a=a.replace(c,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(f.test(a.replace(g,"@").replace(h,"]").replace(d,"")))return a=eval("("+a+")"),"function"===typeof b?e({"":a},""):a;throw new SyntaxError("JSON.parse");})})()});"use strict";q.when("A","jQuery","client-side-metrics","weblab-helper","polyfill-filter","polyfill-json-stringify").register("ajax-wrapper",function(a,l,k,b){function f(a,b){function c(a,b){for(var d=0;d<a._options.length;d++){var e=a._options[d];
if(e=b.call(a,e,"object"===typeof e?e.name:e))return e}}this._options=a instanceof f&&b&&b.length?a._options.concat(b):a instanceof f?a._options:a&&a.length?a:[];this.filter=function(a){var b={};c(this,function(c,d){d in a&&(b[d]=a[d])});return b};this.getOption=function(a){return c(this,function(b,c){if(c===a)return b})};return this}function g(a){this._options=a.allowedOptions;this._messageForViolation=a.messageForViolation;this._messageForViolationWithValue=a.messageForViolationWithValue;this._optionName=
a.optionName;this._valueName=a.valueName;this.validate=function(a){for(var b in a)if(a.hasOwnProperty(b)){var c=this._options.getOption(b);if(!c)throw c=this._messageForViolation.replace(this._optionName,b),Error(c);if("object"===typeof c&&!c.validate(a[b]))throw c=this._messageForViolationWithValue.replace(this._optionName,b),c=c.replace(this._valueName,a[b]),Error(c);}};return this}function h(a){try{D.validate(a)}catch(b){console.error(b)}var c=t.filter(a),c=l.extend(c,d(a));return l.ajax(c)}function d(a){if(a.params){if(a.data&&
a.params)throw Error("The option data can not be present with the emulated params option. Merge both and use just one.");return{data:a.params}}}function e(d){try{J.validate(d)}catch(e){console.error(e)}var f={url:void 0,options:v.filter(d)},t=new l.Deferred;f.url=d.url;if(d.data){if(d.data&&d.params)throw Error("Unsupported options. 'params' and 'data' options are both specified. Remove one of them.");if("object"===typeof d.data)f.options.params=d.data;else if("string"===typeof d.data)b.isSetParamsFormatAsStirngWeblabOn()?
"GET"===d.type?f.url+="?"+d.data:(f.options.params=d.data,f.options.paramsFormat="string"):f.url+="?"+d.data;else throw Error("Unsupported type provided in the 'data' attribute of an AJAX call");}if(d.type){if(d.type&&d.method)throw Error("Unsupported options. 'type' and 'method' options are both specified. Remove one of them.");f.options.method=d.type}if("crossDomain"in d){if("crossDomain"in d&&"withCredentials"in d)throw Error("Unsupported options. 'crossDomain' and 'withCredentials' options are both specified. Remove one of them.");
f.options.withCredentials=d.crossDomain}f=m(f,d,t);f=c(f,d,t);f=B(f,d,t);f=p(f,d,t);f=u(f,d,t);d.beforeSend&&d.beforeSend(f.options);f=x(f,d,t);d=a.ajax(f.url,f.options);return d=t.promise(d)}function c(a,b,c){var d=a.options.success;a.options.success=function(a,b,e){d&&d(a,b,e);c.resolve(a,b,e)};var e=a.options.error;a.options.error=function(a,b,d){e&&e(a,b,d);c.reject(a,b,d)};var f=a.options.abort;a.options.abort=function(a){f&&f(a);c.reject(a,"abort")};return a}function m(a,b){if(!b.complete)return a;
var c=a.options.success;a.options.success=function(a,d,e){c&&c(a,d,e);b.complete(e,"success")};var d=a.options.error;a.options.error=function(a,c,e){d&&d(a,c,e);b.complete(a,"error")};var e=a.options.abort;a.options.abort=function(a){e&&e(a);b.complete(a,"abort")};return a}function p(a,b){var c=a.options.success;a.options.success=function(a,d,e){c&&("text"===b.dataType&&"object"===typeof a&&(a=JSON.stringify(a)),c(a,d,e))};return a}function B(a,b){if(!b.useXMLHttp)return a;var c=a.options.success;
a.options.success=function(a,b,d){d&&(d=d.http);c(a,b,d)};var d=a.options.error;a.options.error=function(a,b,c){a&&(a=a.http);d(a,b,c)};var e=a.options.abort;a.options.abort=function(a){a&&(a=a.http);e(a)};return a}function u(a,b){var c=a.options.success;a.options.success=function(a,b,d){d&&304===d.http.status?c(a,"notmodified",d):c(a,"success",d)};var d=a.options.error;a.options.error=function(a,b,e){a&&a.http.readyState<r.DONE?d(a,"timeout",e):a&&200<=a.http.status&&300>a.http.status&&a.http.readyState===
r.DONE?c(a.http.responseText,"success",a):a&&0==a.http.status?d(a,"abort",e):d(a,"error",e)};return a}function x(a,b){var c=a.options.success;a.options.success=function(a,b,d){K(d,"success");c(a,b,d)};var d=a.options.error;a.options.error=function(a,b,c){K(a,"error");d(a,b,c)};return a}function K(a,b){a?(k.increaseCount("AUI:Ajax:"+b+":xhr:defined"),a.http?k.increaseCount("AUI:Ajax:"+b+":xhr:http:defined"):void 0===a.http?k.increaseCount("AUI:Ajax:"+b+":xhr:http:undefined"):null===a.http&&k.increaseCount("AUI:Ajax:"+
b+":xhr:http:null")):void 0===a?k.increaseCount("AUI:Ajax:"+b+":xhr:undefined"):null===a&&k.increaseCount("AUI:Ajax:"+b+":xhr:null")}var r={UNSET:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},t=new f("accepts async beforeSend cache complete contents contentType context converters crossDomain data dataFilter dataType error global headers ifModified isLocal jsonp jsonpCallback method mimeType password processData scriptCharset statusCode success timeout traditional type url username xhr xhrFields".split(" ")),
v=new f("abort accepts cache chunk contentType error headers indicator method params success timeout withCredentials".split(" ")),z=new f(v,[{name:"async",validate:function(a){return a}},"useXMLHttp","beforeSend","complete","crossDomain","dataType","data","type","url"]),y=new f(t,["params"]),J=new g({allowedOptions:z,messageForViolation:"The option %O is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",
optionName:"%O",valueName:"%V"}),D=new g({allowedOptions:y,messageForViolation:"The option %O is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",optionName:"%O",valueName:"%V"}),F=l("meta[name\x3ddefaultAJAX]").attr("content");"jQuery"!==F&&"AUI"!==F&&(F="jQuery");return{default:function(a){try{J.validate(a),D.validate(a)}catch(b){console.error(b)}if("jQuery"===
F)h(a);else if("AUI"===F)e(a);else throw Error("Unknown AJAX method: "+F);},jQuery:h,aui:e,READY_STATE:r}});"use strict";q.when("jQuery").register("weblab-helper",function(a){return{isAJAXWeblabOn:function(){return"1"===a("meta[name\x3dPAGE_CONDUCTOR_AUI_AJAX]").attr("content")},isNavCFWeblabOn:function(){return"1"===a("meta[name\x3dEMIT_NAV_CF]").attr("content")},isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff:function(){return"1"!==a("#is-remove-os-pabt").val()},isSetParamsFormatAsStirngWeblabOn:function(){return"1"===
a("meta[name\x3dSET_PARAMS_FORMAT_AS_STRING]").attr("content")},disablePrefetchForScheduledDeliveryWeblabOn:function(){return"1"===a("meta[name\x3dDISABLE_PREFETCH_FOR_SCHEDULED_DELIVERY]").attr("content")},isRemoveAddressFormOnDeleteAddressWeblabOn:function(){return"1"===a("meta[name\x3dREMOVE_ADDRESS_FORM_ON_DELETE_ADDRESS]").attr("content")},isSOSPExclusiveJSHandlerWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_EXCLUSIVE_JS]").attr("content")},sospPartialAvailabilityWeblabOn:function(){return"1"===
a("meta[name\x3dSOSP_PARTIAL_UNAVAILABILITY]").attr("content")},refactorExtractURL:function(){return"1"===a("meta[name\x3dREFACTOR_EXTRACT_URL]").attr("content")},showGiftTextAreaOnWarning:function(){return"1"===a("meta[name\x3dSHOW_GIFT_TEXT_AREA_ON_WARNING]").attr("content")},isInterceptionAddressFormWidthFixEnabled:function(){return"1"===a("meta[name\x3dFIX_FIELD_WIDTH_IN_CHECKOUT_INTERCEPTION_FIX_ENABLED]").attr("content")},isBillingAddressAutoCompleteFixEnabled:function(){return"1"===a("meta[name\x3dBILLING_ADDRESS_AUTOCOMPLETE_FIX_ENABLED]").attr("content")},
removesGiftOptionOnRush:function(){return"1"===a("meta[name\x3dREMOVE_GIFT_OPTION_RUSH]").attr("content")},isSPCMobileDisplayMoreShipOptionsEnabled:function(){return"1"===a("meta[name\x3dSPC_MOBILE_DISPLAY_MORE_SHIP_OPTIONS]").attr("content")},isNoShipOptionSelectionChangeIndicatorEnabled:function(){return"1"===a("meta[name\x3dNO_SHIP_OPTION_SELECTION_CHANGE_INDICATOR]").attr("content")},isMCBMultiTenderWeblabEnabled:function(){return"1"===a("meta[name\x3dMCB_MULTI_TENDER_ENABLED]").attr("content")},
isCreateAddressLinkForTaxAddressFormWeblabOn:function(){return"1"===a("meta[name\x3dCREATE_ADDRESS_IN_TAX_COLLECTION_ENABLED]").attr("content")},isClearTemporaryPreferenceBugFixWeblabOn:function(){return"1"===a("meta[name\x3dSWP_CLEAR_TPP_BUG_FIX]").attr("content")},isMfaPSD2DeviceDescriptionCollectionEnabled:function(){return"1"===a("meta[name\x3dMFA_PSD2_DEVICE_DESCRIPTION_COLLECTION_ENABLED]").attr("content")},isSospCalendarFixEnabled:function(){return"1"===a("meta[name\x3dSOSP_CALENDAR_FIX]").attr("content")},
isTaxExemptionMessagingEnabled:function(){return"1"===a("meta[name\x3dTAX_EXEMPTION_MSGING_PHASE_2]").attr("content")},getFixFederatedAssetsInjectionTimingIssueTreatment:function(){var l=a("meta[name\x3dFIX_FEDERATED_ASSETS_INJECTION_TIMING_ISSUE]");return l.length?l.attr("content"):"C"},isUpdateMobileNumberEnabled:function(){return"1"===a("meta[name\x3dUPDATE_MOBILE_NUMBER]").attr("content")},isFixDisabledPyoForMissingBlockerMessageEnabled:function(){return"1"===a("meta[name\x3dFIX_DISABLE_PYO_FOR_MISSING_BLOCKER_MESSAGE]").attr("content")},
isShippingOptionTrialCallsDisabled:function(){return"1"===a("meta[name\x3dDISABLE_SHIPPING_OPTION_TRIAL_CALLS_194487]").attr("content")},isGILCreditCardEnabled:function(){return"1"===a("meta[name\x3dGIL_CREDIT_CARD_PAYMENT_METHOD]").attr("content")},isCFMarkersCleanupOnSPCEnabled:function(){return"1"===a("meta[name\x3dREMOVE_OLD_CF_MARKERS_SPC]").attr("content")},isAddSpcPyoCFMarkerEnabled:function(){return"1"===a("meta[name\x3dSPC_SET_PYO_CF]").attr("content")},isFTCMobileUpsellBannerMetricsEnabled:function(){return"1"===
a("meta[name\x3dFTC_MOBILE_UPSELL_BANNER_METRICS_ENABLED]").attr("content")},isSetSpcAnalysisCFMarkerEnabled:function(){return"1"===a("meta[name\x3dSET_SPC_ANALYSIS_CF_MARKER]").attr("content")}}});"use strict";q.when("A","client-side-metrics").register("weekend-availability-expander-helper",function(a,l){function k(a){return(a=h[a])?g("#weekend-availability-expander-header-text-"+a).text():g("#weekend-availability-default").text()}function b(){return 1==g("input[name\x3d'isBusinessDefaultWeekendDeliveryEnabled']").attr("value")?
!0:!1}function f(a,b){return a&&b?"BOTH":a?"SAT":b?"SUN":"NONE"}var g=a.$,h={BOTH:"both",SAT:"sat",SUN:"sun",NONE:"none"};return{isBusinessDefaultWeekendDeliveryViewActive:b,logExpanderState:function(a,b,c,f){l.increaseCount("checkout:delivery-preferences:"+a+":expander:"+b+":"+(c&&f?"neverExpanded":f?"collapsed":"expanded"),1)},stateToCheckboxes:function(a){var e=!1,c=!1;if(b()){if("BOTH"===a||"SAT"===a)e=!0;if("BOTH"===a||"SUN"===a)c=!0}else{if("BOTH"===a||"OTH"===a||"SAT"===a)e=!0;if("BOTH"===
a||"OTH"===a||"SUN"===a)c=!0}return{isSaturdayChecked:e,isSundayChecked:c}},updateAllOptOutMessages:function(a){a.isSaturdayChecked||a.isSundayChecked?a.isSaturdayChecked?a.isSundayChecked?g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-sun-text").text()),g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-sat-text").text()),
g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-both-text").text()),g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1))},updateAllTitles:function(a){a=f(a.isSaturdayChecked,a.isSundayChecked);g(".sat-sun-expander-heading-text").text(k(a))},updateAllWeekendAvailabilityStates:function(a){a=f(a.isSaturdayChecked,a.isSundayChecked);g("input[name\x3d'BusinessHours']").attr("value",a)}}});
"use strict";q.when("A","loading-spinner-controller","page-transition-controller","page-conductor","checkout-general-utils","address-utilities","page-detector-current-page","client-side-metrics","weblab-helper").register("address-popovers",function(a,l,k,b,f,g,h,d,e){function c(a){a.getResponseHeader("x-amz-checkout-popover-valid")||b.redirect({conductoraction:{url:"/gp/cart/view.html",type:"redirect"}})}function m(d,e,m){f.protectAgainstDoubleAction("show-add-address-popover",200)||(F=d.popover,
!D('input[name\x3d"preloadAddressPopover"]').length||e.is(":empty")?(e.empty(),e.css("min-height",397),F.updatePosition(!0),l.showSpinner(e,!1,F),d=(new Date).getTime(),m=h.getCurrentPage(),D.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+d,data:{isBilling:n,isMultiAddress:"itemselect"===m?1:0},async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},success:function(a,b,d){c(d);e.css("min-height",0);v(e,a)},error:b.ajaxRedirect})):(g.customizeFormFromIdentity(e),
g.countrySpecificPopoverOptimizationCheck(D("html")),m&&a.trigger("identity-assets")))}function p(a,e){if(!f.protectAgainstDoubleAction("add-new-address",200)){d.resetMetrics();var m=!1;D(".identity-protect-from-errant").each(function(){var a=D(this),a=a.is("input")?a:a.find("input:first");-1!==a.val().search(/(\d[ -]?){13}/)&&(m=!0)});if(m){var t=D(".address-form-security-error:first");t.length?alert(t.text()):alert("Please check that the address you have entered is correct.")}else{e.$event.preventDefault();
l.showSpinner(a,!1,F);var p=D("#domestic-address-popover-form, #international-address-popover-form, #address-popover-suggestions-form").filter(":visible"),t=p.serialize(),h=(new Date).getTime();e=e.$currentTarget.find('input[type\x3d"submit"]').attr("name");"useSelectedAddress"===e?t+="\x26fromSuggestionPage\x3d1":"fromAddressEditToContinue"===e&&(t+="\x26fromAddressEditToContinue\x3d1");D("#addAddressOnly").length&&(t+="\x26addOnly\x3d1");n&&(t+="\x26isBilling\x3d1");var g="/gp/buy/addressselect/handlers/popover/new.html";
if(F){if("domestic-address-popover-form"===p.attr("id")&&(p.find(".enterAddressFormField").blur(),p="#"+a.attr("id")+" div[id^\x3donblur-character-validation-error-]",0<D(p).size())){l.hideSpinner(a);return}g+="/ref\x3dchk_addr_editPopoverSubmit";b.isSPP()&&(F.lock(11),setTimeout(function(){F.unlock(12)},2E3))}var k=null!==L&&void 0!==L&&null!==P&&void 0!==P;"useSelectedAddress"===e&&!n&&k&&(t+="\x26fromSTMAPopover\x3d1");D("#international-address-popover-form").filter(":visible").length&&(t+="\x26showSecondaryForm\x3d1");
y()&&Q?B(a,h,t):D.ajax({type:"POST",url:g+"?cachebuster\x3d"+h,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:t,async:!0,cache:!1,error:b.ajaxRedirect,success:function(d,e,f){b.isSPP()&&F.unlock(12);c(f);f.getResponseHeader("x-amz-checkout-open-new-popover")?x(d,e,f):f.getResponseHeader("x-amz-checkout-reload-popover")?v(a,d):k?K(f):r("added")}})}}}function B(a,d,e){var m=Q.getNewTaxAddressPopoverURL();D.ajax({type:"POST",url:m+"?cachebuster\x3d"+d,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",
data:e,async:!0,cache:!1,error:b.ajaxRedirect,success:function(d,e,m){b.isSPP()&&F.unlock(12);c(m);m.getResponseHeader("x-amz-checkout-reload-popover")?v(a,d):m.getResponseHeader("x-amz-checkout-new-address-id")&&(D(".a-button-close").trigger("click"),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),d=m.getResponseHeader("x-amz-checkout-new-address-id"),Q.submitTaxAddressFormWithNewAddressId(d))}})}function u(a){if(!f.protectAgainstDoubleAction("show-edit-address-popover",200)){var d=
D("#address-suggestions-popover");a.$event.preventDefault();l.showSpinner(d,!1,F);a=D("#address-popover-suggestions-form");var e=a.serialize();a.find('input[type\x3d"radio"]').each(function(){var a=D(this);a.attr("checked")&&(e+="\x26edit_"+a.val()+"\x3d1")});n&&(e+="\x26isBilling\x3d1");F&&b.isSPP()&&(F.lock(11),setTimeout(function(){F.unlock(12)},2E3));a=(new Date).getTime();D.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:e,async:!0,cache:!1,error:b.ajaxRedirect,
success:function(a,d,e){b.isSPP()&&F.unlock(12);c(e);x(a,d,e)}})}}function x(b,c,d){D('input[name\x3d"preloadAddressPopover"]').remove();c=d.getResponseHeader("x-amz-checkout-open-new-popover");"suggestions"===c?(D("#address-suggestions-popover").empty().append(b),D("#address-suggestions-popover-link").trigger("click")):"edit"===c&&(G=1,c=D("#edit-address-popover"),c.empty().append(b),D("#edit-address-popover-link").trigger("click"),v(c,b));a.trigger("identity-assets")}function K(a){a=a.getResponseHeader("x-amz-checkout-new-address-id");
var c=(new Date).getTime();D.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+c,data:{action:"update-address",lineitems:L,quantities:P,addresses:a+".home..",returnHTML:0},async:!0,cache:!1,error:b.ajaxRedirect,success:function(a,b,c){r("applied")}})}function r(c){var d=(new Date).getTime();if(D('input[name\x3d"shipToAddress"]').length)c=function(){b.isSPP()?(k.blockAllActions(),k.shrinkPanel(D(".spp-panel.expanded"),!0)):k.show()},b.isNonBlockingAnimationEnabled()?
a.delay(c,0):c(),c=h.getCurrentPage(),b.loadPage(c,"",void 0,{refTag:"chk_addr_editPopoverSubmit"});else{var e=b.setAjaxTransitionHeader();D.ajax({type:"POST",headers:e,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+d,data:{useCase:"multiAddress",showAddressAdded:c,page:"itemselect"},dataType:"text",async:!0,cache:!1,error:b.ajaxRedirect,success:function(a,c,d){b.ajaxUpdatePage(a,c,d);D(".a-button-close").trigger("click");f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}}
function t(a){a=D("#"+a);a.length&&a.empty()}function v(b,c){b.html(c);g.customizeFormFromIdentity(b);F.updatePosition(!0);a.trigger("identity-assets");g.countrySpecificPopoverOptimizationCheck(D("html"))}function z(a){a=a.$currentTarget.closest(".lineitem");L=a.find('input[name^\x3d"lineItemEntityID."]').val();P=a.find('input[name^\x3d"quantity."]').val();a=D("#add-address-popover-link");a.length?a.trigger("click"):D("#add-new-address-popover").trigger("click")}function y(){return e.isCreateAddressLinkForTaxAddressFormWeblabOn()&&
0<D("#isTaxAddress").length}function J(){n=D("#isBilling").length?1:0;if(e.isInterceptionAddressFormWidthFixEnabled()){var a=D(".enter-address-form");g.customizeFormFromIdentity(a)}}var D=a.$,F,L,P,G=0,n=0,Q=null;if(!D("html").hasClass("a-ie6"))return a.on("a:popover:show:add-address",function(a){t("edit-address-popover");t("add-billing-address-popover");n=0;m(a,D("#add-address-popover"),!1)}),a.on("a:popover:show:add-billing-address",function(a){t("edit-address-popover");t("add-address-popover");
m(a,D("#add-billing-address-popover"),!0)}),a.on("a:popover:show:address-suggestions",function(a){F=a.popover}),a.on("a:popover:show:edit-address",function(a){F=a.popover;if(f.protectAgainstDoubleAction("show-edit-address-popover",200)||G)G=0;else{var d=D("#edit-address-popover"),e=F.$trigger.closest(".address-edit-link").find("a").attr("href");d.empty();t("add-address-popover");t("add-billing-address-popover");var m=D("#delete-address-popover-button");m.length&&m.addClass("aok-hidden").addClass("a-disabled");
a.popover.updatePosition(!0);l.showSpinner(d,!1,F);a=(new Date).getTime();D.ajax({type:"POST",url:e+"\x26cachebuster\x3d"+a,async:!0,cache:!1,success:function(a,b,e){c(e);v(d,a);m.length&&D("#delete-address-button").length&&m.removeClass("aok-hidden").removeClass("a-disabled")},error:b.ajaxRedirect})}}),a.on("a:popover:show:select-billing-address",function(d){if(!f.protectAgainstDoubleAction("show-select-billing-address-popover",200)){var m=D("#select-billing-address-popover");m.empty();m.css("min-height",
250);d.popover.updatePosition(!0);l.showSpinner(m,!1,d.popover);var p=(new Date).getTime(),h="/gp/buy/billingaddressselect/handlers/popover.html";b.isSPP()&&(h+="/ref\x3dchk_pay_billing_change_coll");e.isBillingAddressAutoCompleteFixEnabled()&&t("add-billing-address-popover");D.ajax({type:"POST",url:h+"?cachebuster\x3d"+p,async:!0,cache:!1,success:function(b,e,f){c(f);m.html(b);a.trigger("checkout:reload:spp-billing-address");m.css("min-height",0);d.popover.updatePosition(!0)},error:b.ajaxRedirect})}}),
a.on("a:expander:delivery-expander:toggle:expand",function(a){a=D(".a-expander-content");g.fixOverflow(a)}),a.declarative("close-delete-popover",["click","touchend"],function(a){q.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()})}),a.declarative("rm-address-action",["click","touchend"],function(a){q.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()});e.isRemoveAddressFormOnDeleteAddressWeblabOn()&&(t("edit-address-popover"),t("add-address-popover"),
t("add-billing-address-popover"));q.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),a.declarative("select-billing-address-action",["click","touchend"],function(a){q.when("a-popover-base").execute(function(a){a.get("select-billing-address").hide()});q.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),D(document).delegate("a.prevent-default-marker","click",function(a){a.preventDefault()}),a.declarative("select-billing-address-in-popover",
["click","touchend"],function(a){q.when("a-popover-base").execute(function(a){(a=a.get("select-billing-address"))&&a.hide()})}),a.declarative("trigger-popover-from-link",["click","touchend"],function(a){f.protectAgainstDoubleAction("trigger-popover-from-link",200)||(P=L=null,D("#add-address-popover-link").trigger("click"))}),a.declarative("add-address-popover-submit",["click","touchend"],function(a){p(D("#add-address-popover"),a)}),a.declarative("add-billing-address-popover-submit",["click","touchend"],
function(a){p(D("#add-billing-address-popover"),a)}),a.declarative("edit-address-popover-submit",["click","touchend"],function(a){p(D("#edit-address-popover"),a)}),a.declarative("address-suggestions-submit",["click","touchend"],function(a){p(D("#address-suggestions-popover"),a)}),a.declarative("delete-address-popover-submit",["click","touchend"],function(a){a=D("#delete-address-button");0<a.length&&a.click()}),a.declarative("edit-address-suggestions",["click","touchend"],u),a.declarative("add-address-popover-edit",
["click","touchend"],function(a){if(!f.protectAgainstDoubleAction("add-address-popover-edit",200)){a.$event.preventDefault();var d=D("#add-address-popover");l.showSpinner(d,!1,F);a=D("#address-popover-suggestions-form").serialize()+"\x26"+a.$currentTarget.find('input[type\x3d"submit"]').attr("name")+"\x3d1";var e=(new Date).getTime();D.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+e,data:a,async:!0,cache:!1,error:b.ajaxRedirect,success:function(a,b,e){c(e);
v(d,a)}})}}),a.declarative("add-address-popover-toggle",["click","touchend"],function(a){f.protectAgainstDoubleAction("add-address-popover-toggle",200)||(a.$event.preventDefault(),a=a.$currentTarget.closest(".enter-address-form"),g.toggleAddressForm(a,a.siblings(".enter-address-form")))}),a.declarative("select-radio-option",["click","touchend"],function(a){a=a.$currentTarget.find(".radio-option");a.find('input[type\x3d"radio"]').attr("checked","checked");a.closest(".radio-option-list").find(".radio-option").removeClass("radio-option-selected");
a.addClass("radio-option-selected")}),a.declarative("trigger-address-popover",["click","touchend"],function(a){f.protectAgainstDoubleAction("trigger-address-popover",200)||D("#add-address-popover-link").trigger("click")}),a.on("checkout:reload:spp-shipaddress",J),a.on("checkout:reload:spp-billing-address",J),a.on("checkout:reload:itemselect",J),a.on("checkout:reload:spp-itemselect",J),{actionTriggerPopoverFromDropdown:z,actionRegisterTaxAddressController:function(a){y()&&!Q&&a&&(Q=a)}}});"use strict";
q.when("A").register("address-book-controller",function(a){function l(){k("div.address-book").unbind("recalculate-address-height").bind("recalculate-address-height",function(){var a,f=k(),g=0,h=k("div.address-book .js-same-height"),d=h.length;h.css({height:"auto"}).each(function(e){var c=k(this);a=a||c.offset().top;a!==c.offset().top&&(f.height(g),f=k(),g=0,a=c.offset().top);var m=c.height();f=f.add(c);m>g&&(g=m);e===d-1&&0<g&&f.height(g)})}).trigger("recalculate-address-height");k(n).unbind("resize.checkout-as").bind("resize.checkout-as",
function(){k("div.address-book").trigger("recalculate-address-height")})}var k=a.$;a.on("checkout:reload:spp-shipaddress",l);a.on("checkout:reload:shipaddressselect",l);a.on("checkout:reload:billingaddressselect",l);a.on("checkout:reload:spp-billing-address",l)});"use strict";q.when("A","client-side-metrics","weblab-helper").register("address-utilities",function(a,l,k){function b(a){a.find("input").each(function(){var a=d(this),b=a.outerWidth(!0),e=a.parent().outerWidth(!0);b>e&&a.attr("size")&&(document.getElementById(a.attr("id")).removeAttribute("size"),
a.width("100%"))})}function f(a){if(d('input[name\x3d"useLiveAUI"]').length)q.when("p-detect").execute(function(b){b.capabilities.inputPlaceholder&&a.find(".field-description").each(function(){var a=d(this),b=a.text(),c=a.closest(".a-col-right").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");c.attr("maxlength")<b.length&&c.attr("size",b.length);c.attr("placeholder",a.text())})}),a.find("input").each(function(){d(this).outerWidth()}),a.find("input[type\x3d'text'], select").each(function(){var a=
d(this).closest(".full-width-config"),b=d(this);0===a.find(".a-popover-trigger").length&&(k.isInterceptionAddressFormWidthFixEnabled()?b.addClass("addressform-textfield-width"):b.width("96%"))});else{q.when("p-detect").execute(function(b){b.capabilities.inputPlaceholder?a.find(".field-description").each(function(){var a=d(this),b=a.text(),c=a.closest(".a-column").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");c.attr("maxlength")<b.length&&c.attr("size",b.length);
c.attr("placeholder",a.text())}):a.find(".field-description").each(function(){var a=d(this);a.find("br").remove();a.show()})});a.find(".popover-field-label").each(function(){var a=d(this);a.find("b").each(function(){var a=d(this);a.text(d.trim(a.text()))});a.find("font").each(function(){var a=d(this);"-2"===a.attr("size")&&a.remove()})});var c=d(".enter-address-form");b(c);var f=0,c=a.find(".one-new-address-form-field").first();c.length&&c.find(".a-column").each(function(){f+=d(this).outerWidth()});
a.width(0<f?f:"")}}function g(b){function c(){K=f.val();(r=k[K])&&h.find(".learn-more a").text(r.popOverLinkText)}var d=n.P&&n.P.AUI_BUILD_DATE,f=b.find("#enterAddressCountryCode"),h=b.find(".country-specific-form-input"),g,k;d?(g=h.find("input"),k=b.find(".country-specific-config").data("popovercountryconfig")):(l.increaseCount("removeauijs2"),g=h.find("#"+h.data("inputid")),k=h.find(".country-specific-config").data("popovercountryconfig"));if(f.length&&h.length&&g.length&&k){var K=f.val(),r=k[K];
f.unbind("change.countryChangeConfigUpdate").bind("change.countryChangeConfigUpdate",c);c();var t=d?"show":"beforeShow";a.on("a:popover:"+t+":checkout-"+h.data("inputid")+"Name",function(a){"beforeShow"===t&&l.increaseCount("removeauijs3");r&&(a.popover.$popover.find(".a-popover-header h4").html(r.popOverTitle),a.popover.$popover.find(".a-popover-inner").html(r.popOverText),a.popover.updatePosition())})}}function h(a){function b(){var a=h.val();(a=x[a])?(a=(a=a.label)||"",k.attr("placeholder",d("\x3cdiv /\x3e").html(a).text().replace(":",
"")),g.show()):g.hide()}var f=n.P&&n.P.AUI_BUILD_DATE,h=a.find("#enterAddressCountryCode"),g=a.find(".country-specific-form-input-mobile"),k,x;f?(k=g.find("input"),x=a.find(".country-specific-config").data("labelcountryconfig")):(l.increaseCount("removeauijs3"),k=g.find("#"+g.data("inputid")),x=g.find(".country-specific-config").data("labelcountryconfig"));h.length&&g.length&&k.length&&x&&(h.unbind("change.countryChangeLabelUpdate").bind("change.countryChangeLabelUpdate",function(){g.hasClass("initial-edit-value")?
g.removeClass("initial-edit-value"):k.val("");b()}),b())}var d=a.$;q.when("a-checkbox").execute(function(b){a.declarative("delivery-preferences-weekend-availability-checkbox-triggered","click",function(a){if("undefined"!==typeof a.$target){var d=a.$target.val();a.$target.is(":checked")&&("NONE"===d?(b("#delivery-preferences-weekend-availability-sat").uncheck(),b("#delivery-preferences-weekend-availability-sun").uncheck()):"SAT"!==d&&"SUN"!==d||b("#delivery-preferences-weekend-availability-none").uncheck())}})});
a.declarative("wdp-redesign-addresstype-radio-clicked","click",function(a){var b=a.$target.context.id;a=d(".com-businesshours-text");var f=d("#delivery-preferences-weekend-availability-sat").is(":checked"),h=d("#delivery-preferences-weekend-availability-sun").is(":checked");"devyPrefs_AddressType_COM"===b?(l.increaseCount("WDPTotalCOMClick"),d(".wdp-res").removeClass("a-color-base-background").addClass("a-color-alternate-background"),d(".wdp-com").removeClass("a-color-alternate-background").addClass("a-color-base-background"),
d(".wdp-BusinessHours").removeClass("aok-hidden")):"devyPrefs_AddressType_RES"===b?(l.increaseCount("WDPTotalRESClick"),d(".wdp-com").removeClass("a-color-base-background").addClass("a-color-alternate-background"),d(".wdp-res").removeClass("a-color-alternate-background").addClass("a-color-base-background"),d(".wdp-BusinessHours").addClass("aok-hidden")):"delivery-preferences-weekend-availability-sat"===b?(l.increaseCount("WDPTotalSATClick"),b=f?h?"BOTH":"SAT":h?"SUN":"OTH",a.addClass("aok-hidden"),
d(".com-businesshours-"+b).removeClass("aok-hidden")):"delivery-preferences-weekend-availability-sun"===b&&(l.increaseCount("WDPTotalSUNClick"),b=h?f?"BOTH":"SUN":f?"SAT":"OTH",a.addClass("aok-hidden"),d(".com-businesshours-"+b).removeClass("aok-hidden"))});return{toggleAddressForm:function(a,c){a.hide();c.find("div.a-alert-error:not(.js-originally-shown-imb)").hide();a.find("input[type\x3d'text'], select, input[type\x3d'radio']:checked, input[type\x3d'hidden']").each(function(){var a=d(this),b=a.attr("name")||
a.data("copyto")||a.attr("id");if(!a.is(":disabled")&&!a.find(":selected").is(".js-not-a-value")){var e=c.find("input[name\x3d'"+b+"']");"enterAddressLandmark"===b&&(e=c.find("input[name\x3d'Landmark']"));"Landmark"!==b||e.length||(e=c.find("input[name\x3d'enterAddressLandmark']"));1<e.length&&a.is("input[type\x3d'radio']")?e.filter("[value\x3d'"+a.val()+"']").attr("checked",!0):e.is("select")?e.find("option[value\x3d'"+a.val()+"']").attr("selected",!0):a.is("input[type\x3d'hidden']")||e.is("input[type\x3d'hidden']")||
e.val(a.val())}});c.show();b(c);f(c)},customizeFormFromIdentity:f,fixOverflow:b,countrySpecificLabelOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){h(b)},100):h(b)},countrySpecificPopoverOptimizationCheck:function(a){var b=a.find(".enter-address-form");1===b.data("taxidOpt")?setTimeout(function(){g(b)},100):g(b)}}});"use strict";q.when("A","page-conductor","client-side-metrics").register("address-form-helper",function(a,l,k){var b=a.$;
a.on("a:popover:afterUpdatePosition:edit-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:edit-address",b.popover)});a.on("a:popover:afterUpdatePosition:add-address",function(b){b.popover&&b.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",b.popover)});return{setDestination:function(a){a||(k.increaseCount("checkout:addressForm:setDestination:noRequest",1),a={});var g=a.addressId;g||k.increaseCount("checkout:addressForm:setDestination:noAddressId",
1);var h=a.purchaseId||b("input[name\x3d'purchaseId']").val();h||k.increaseCount("checkout:addressForm:setDestination:noPurchaseId",1);a=a.ref||"ox_shipaddress_add_new_addr";b(".a-button-close").trigger("click");a=b("\x3cform/\x3e").attr("action","/gp/buy/addressselect/handlers/continue.html/ref\x3d"+a);b('\x3cinput name\x3d"addressID"/\x3e').val(g).appendTo(a);b('\x3cinput name\x3d"purchaseId"/\x3e').val(h).appendTo(a);b('\x3cinput name\x3d"action" value\x3d"select-shipping"/\x3e').appendTo(a);l.continueClicked(null,
a)}}});"use strict";q.when("A","client-side-metrics","weblab-helper").register("action-logger",function(a,l){var k=a.$;a.declarative("ue-count",["click","touchend"],function(a){l.increaseCount(a.data.countFlag,a.data.countValue)});return{logUsedPrefetch:function(a,f,g,h){h||(l.increaseCount("Checkout:action-log:MissingRefMarker"),h="");k.ajax({type:"GET",url:"/gp/buy/shared/handlers/log-used-prefetch.html"+h,data:"pageType\x3d"+a+"\x26subPageType\x3d"+f+"\x26relatedRequestId\x3d"+g,dataType:"text",
cache:!1})}}});"use strict";q.when("A","weblab-helper").register("ajax-utility",function(a,l){return{jsonify:function(k){var b;if(b=l.isAJAXWeblabOn()){b=k instanceof Function;var f=k instanceof Array,g=k instanceof String;b=k instanceof Object&&!f&&!b&&!g}if(b)return k;try{k=a.$.parseJSON(k)}catch(h){k=null}return k}}});"use strict";q.when("A","page-conductor","client-side-metrics","weblab-helper").register("button-blocker",function(a,l,k,b){function f(a,b,c,d){l.isSPP()?b.closest("span.a-declarative").data("blockerText",
c):b.find("input.a-button-text").data("blockerText",c);g(d);p?(a.addClass("aok-hidden"),b.removeClass("aok-hidden"),h("#hasTVNavigation").length&&q.when("a-tv").execute(function(b){b.remove(a)})):(k.increaseCount("removeauijs10"),a.hide(),b.show(),b.hasClass("aok-hidden")&&b.removeClass("aok-hidden"))}function g(a){var b=h(".continue-button-blocker-text");b.length&&(a?(b.html(a),b.removeClass("aok-hidden")):(b.addClass("aok-hidden"),b.empty()))}var h=a.$,d={},e=[],c,m,p=n.P&&n.P.AUI_BUILD_DATE,B=
!1;a.on("checkout:beforeReload",function(){e=[];d={};c=""});return{show:function(a,m,g){if(!B){var p=h(".continue-button");if(p.length){if(!m)if(n.console&&n.console.error&&console.error("showBlockerOnContinue should not be called with an empty tooltip."),k.increaseCount("Checkout:ButtonBlocker:EmptyTooltip"),b.isFixDisabledPyoForMissingBlockerMessageEnabled())m="";else return;var t=h(".continue-button-blocker");if(t.length){g=g||"";var l=void 0!==d[a]&&d[a].tooltipText!==m,z=void 0!==d[a]&&d[a].buttonInlineText!==
g;if(0===e.length||!d[a]||l||z)f(p,t,m,g),c=a;void 0===d[a]&&e.push(a);d[a]={tooltipText:m,buttonInlineText:g}}}}},hide:function(a){if(!B){if(void 0!==d[a]){delete d[a];var b=h.inArray(a,e);e.splice(b,1)}var m=h(".continue-button");m.length&&(b=h(".continue-button-blocker"),b.length&&(0===e.length?(g(),p?(b.addClass("aok-hidden"),m.removeClass("aok-hidden"),h("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.add(m)})):(k.increaseCount("removeauijs11"),b.hide(),m.show(),m.hasClass("aok-hidden")&&
m.removeClass("aok-hidden"))):c===a&&(c=e[0],f(m,b,d[c].tooltipText,d[c].buttonInlineText))))}},lock:function(){B=!0},unlock:function(){B=!1},getButtonBlocker:function(){m||(m=h(".continue-button-blocker"));return m}}});"use strict";q.when("A","page-detector","button-blocker","client-side-metrics").register("button-blocker-controller",function(a,l,k,b){function f(a){return void 0!==e[a]?1:0}function g(a,b){f(a)&&e[a].state!==b&&(e[a].state=b,h())}function h(){var a=!0,f;d.each(e,function(e,h){f=h.owner;
if(h.state===m.DISABLE_CONTINUE)return a=!1,k.show(f,h.toolTipMessage,h.buttonInlineMessage),c||(b.increaseCount("removeauijs12"),d(".continue-button-blocker").css("display","inline-block")),!1});a&&k.hide(f)}var d=a.$,e={},c=n.P&&n.P.AUI_BUILD_DATE,m={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};a.on("checkout:beforeReload",function(){e={}});return{disableContinue:function(a,b,c,d){d=d||"";f(b)||(c?(f(b)||(e[b]={state:m.ENABLE_CONTINUE,owner:a,toolTipMessage:c,buttonInlineMessage:d}),
h()):n.console&&n.console.error&&console.error("_registerElement should not be called with an empty tooltip."));g(b,m.DISABLE_CONTINUE)},enableContinue:function(a){f(a)&&g(a,m.ENABLE_CONTINUE)}}});"use strict";q.when("jQuery").register("cache-page-data-controller",function(a){var l={};return{clearCache:function(){l={}},setCachedPageData:function(k,b,f,g,h){var d=[],e=!0;a(".cacheable-spp-panel").each(function(){var b=a(this),c;c=!b||b.find(".is-scheduled-delivery").length?!1:!0;if(!c)return e=!1;
b.find(".expand-panel-button").removeClass("a-button-focus");d.push({id:b.attr("id"),content:b[0].outerHTML})});if(e){var c={panels:d};a(".cacheable-spp-section").each(function(){var b=a(this);c[b.attr("id")]=b[0].outerHTML});l[k+"-"+b]={curPageData:c,state:n.history?history.state:f,page:k,title:document.title||g,url:n.location.href||h}}},getCachedPageData:function(a,b){return l[a+"-"+b]}}});"use strict";q.when("A").register("checkout-general-utils",function(a){var l=a.$,k={moveToNextInput:function(a){a=
a.nextAll(":visible").find("input").get(0);a!==[]&&a.focus()},hide:function(a){a.hide()},show:function(a){n.P&&n.P.AUI_BUILD_DATE&&a.hasClass("aok-hidden")&&a.removeClass("aok-hidden");a.show()},getAssocParamValuesFromUrl:function(a){var f={};if("string"!==typeof a||-1===a.indexOf("?"))return f;a=a.slice(a.indexOf("?")+1);if(!a)return f;-1!=a.indexOf("#")&&(a=a.substring(a,a.indexOf("#")));a=a.split("\x26");for(var g=0;g<a.length;g++){var h=a[g].split("\x3d");f[h[0]]=h[1]}return f},addQueryStringParameter:function(a,
f,g){var h=k.getAssocParamValuesFromUrl(a);h[f]=g;f=0<=a.indexOf("?")?a.substring(0,a.indexOf("?")):a;f=f+"?"+l.param(h,1);(a=k.getFragmentFromUrl(a))&&(f+="#"+a);return f},getFragmentFromUrl:function(a){var f=a.indexOf("#");return-1==f?void 0:a.substring(f+1)},extractURLParts:function(a){if(!a||"string"!==typeof a)return{};a=/(.*html)(\/ref[^?\n]*)?[?]?(.*)/g.exec(a);var f={};a&&(a[1]&&(f.normalizedUrl=a[1]),a[2]&&(f.refMarker=a[2]),a[3]&&(f.query=a[3]));return f},redirectWithJavascript:function(a){n.location=
k.addQueryStringParameter(a,"hasWorkingJavascript","1")},bindActionEnterKeyOnButton:function(a){a.keyup(function(a){13===a.which&&l(a.target).trigger("click")})},toggleExpanderContent:function(a){a=a.$target.closest(".a-box");a.hasClass("a-single")?a.removeClass("a-single").addClass("a-first"):a.addClass("a-single").removeClass("a-first")},validateNumber:function(a,f,g){l.trim(a);return/^\d+$/.test(a)&&a>=f&&a<=g}};k.protectAgainstDoubleAction=function(){var a={};return function(f,g){if(!f)return n.console&&
n.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),!1;if(a.hasOwnProperty(f))return!0;a[f]=1;setTimeout(function(){delete a[f]},g||100);return!1}}();k.logErrorOnLevel=function(a,f){(n.ueLogError||l.noop)({message:a,logLevel:f});if(n.console){var g={FATAL:n.console.error,"default":n.console.warn};f=g[f]||g["default"]}else f=l.noop;f.call(n,a)};k.logError=function(a){k.logErrorOnLevel(a,"FATAL")};k.updateCartByMash=function(a){q.when("safe-mash").execute(function(f){null!==
a&&void 0!==a&&"1"===l("#updateCartByMash").attr("content")&&f&&f.cart&&f.cart.didUpdate&&f.cart.didUpdate({newCartQuantity:a})})};k.getPosition=function(a,f,g){for(var h=0,d=a.length,e=0;e<d;e++)if(a.charAt(e)===f&&(h++,h===g))return e;return-1};k.limitInputToNumbers=function(a){var f=a.$event.keyCode;-1!==l.inArray(f,[46,8,9,37,39])||-1!==l.inArray(f,[65,67,86])&&!0===a.ctrlKey||(a.$event.shiftKey||(48>f||57<f)&&(96>f||105<f))&&a.$event.preventDefault()};k.nukeDropdowns=function(a){q.when("a-popover-base").execute(function(f){l.each(l(a),
function(){f.remove(this.name)})})};a.on("checkout:reload",function(){l('input[name\x3d"useLiveAUI"]').length||a.defer(function(){l(".a-declarative, .a-button").filter("[data-action]").unbind("keypress.checkout-page").bind("keypress.checkout-page",function(a){13===a.which&&l(this).trigger("click")})})});a.on("checkout:beforeLoadPage",function(){l("div.a-popover").find(".a-declarative:first:[data-action\x3dcustom-popover-close|a-popover-close]").click()});return k});"use strict";q.when("A","weblab-helper").register("client-side-metrics",
function(a,l){var k=a.$,b=null,f=null,g=0,h;a=function(){};var d=n.uet||a,e=n.uex||a,c=n.ues||a,m=function(a){n.ue&&n.ue.t&&n.uet(a,b)},p=function(a,b){d(a,b,{wb:1})},B=function(a){n.ue&&n.uex&&n.uex(a,b)},u=function(a){n.ue&&n.ues&&n.ues("id",b,a)},x=function(){n.ue&&n.ues&&n.ues("ctb",b,"1")},K=function(){n.ue&&n.ues&&(n.ues("t0",b,(new Date).getTime()),m("ue"),m("bb"))},r=function(a){a?f="ctbajax"+g++:b="ajax"+g++},t=function(a){if(a&&a.length){var c=b;b=f;u(a);b=c}},v=function(a){e("ld",a,{wb:1})},
z=function(){void 0===h&&(h=0<k("#transitionLogging").length);return h};return{getscope:function(){return b},getasyncscope:function(){return f},setmarker:m,sendue:B,setrid:u,setctb:x,resetue:K,createscope:r,setscope:function(a){b=a},increaseCount:function(a,b,c){"undefined"!==typeof n.ue&&"undefined"!==typeof n.ue.count&&(b=b?b:1,c?n.ue.count(a,(n.ue.count(a)||0)+1):n.ue.count(a,b))},resetMetrics:function(){b=f;x();K()},setAsyncRequestId:t,sendUEPageLoadStats:function(){B("ld");r(1);l.isSetSpcAnalysisCFMarkerEnabled()&&
v("201904-spc-latency-analysis")},isTransitionLoggingEnabled:z,logPageTransition:function(a,b,c,d){if(z()){var e=(new Date).getTime();k.ajax({type:"POST",url:"/gp/buy/shared/handlers/log-page-transition.html?cachebuster\x3d"+e,data:{fromPage:a,toPage:b},async:!0,cache:!1,timeout:1E3,success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-requestid");t(e);c&&c.call(this,a,b,d)},complete:function(a,b){d&&d.call(this,a,b)}})}},logError:function(a,b,c,d){n.ueLogError&&n.ueLogError(a,{message:b,
attribution:c,logLevel:d})},startWidgetTiming:function(a){d("bb",a,{wb:1})},finishWidgetTiming:v,setWidgetMarker:p,markWithinAnalysisScope:function(a){l.isSetSpcAnalysisCFMarkerEnabled()&&p(a,"201904-spc-latency-analysis")},setAnalysisScopeT0:function(){l.isSetSpcAnalysisCFMarkerEnabled()&&c("t0","201904-spc-latency-analysis",Date.now&&Date.now()||(new Date).getTime())}}});"use strict";q.register("currency-formatter",function(){function a(l,k){isNaN(k)||(l=Number(l).toFixed(k));l=l.toString();k=0<=
l.lastIndexOf(".")?l.lastIndexOf("."):l.length;return 3>=k?l:a(l.substring(0,k-3),0)+","+l.substring(k-3)}return{getNumberWithSeparators:a}});"use strict";q.when("A","client-side-metrics","page-conductor","page-detector").register("delivery-preferences-csm-helper",function(a,l,k,b){function f(a){var e=k.isSPP()?"spp":"mpp",c="desktop";b.isMobile()?c="mobile":b.isTablet()&&(c="tablet");l.increaseCount("checkout:delivery-preferences:"+c+":"+e+":"+a,1)}function g(a){return 0===a.length?"NoValueSet":
a}var h=a.$;return{recordCSM:f,recordCSMWithCurrentFieldValues:function(a,b,c){b=h("input[name\x3d"+b+"]:checked");b.length&&(b=b.val(),f(a+":preference:"+g(b)));c=h("input[name\x3d"+c+"]");c.length&&f(a+":set-as-default:"+(c.is(":checked")?"yes":"no"))},recordCSMForEligiblePages:function(a){a=a||"";f(a+"eligible-page-displayed");var b=h("input[name\x3ddelivery-preferences-preference-set]");b.length&&f(a+"summary-displayed:preference:"+g(b.val()))}}});"use strict";q.when("page-detector-current-page",
"A").register("error-feature-detection",function(a,l){function k(a){n.errorFeatureDetection&&n.errorFeatureDetection.safelyLogError?n.errorFeatureDetection.safelyLogError(a):(n.ueLogError&&n.ueLogError(a),n.console&&n.console.error&&console.error(a))}try{l.on("page-detector:page-changed",function(){var b=a.getCurrentPage();if(b&&"spc"===b)try{n.errorFeatureDetection&&n.errorFeatureDetection.enableErrorHandling&&n.errorFeatureDetection.enableErrorHandling()}catch(f){k(f)}else try{n.errorFeatureDetection&&
n.errorFeatureDetection.disableErrorHandling&&n.errorFeatureDetection.disableErrorHandling()}catch(f){k(f)}})}catch(b){k(b)}return{registerFeature:function(a,f){try{n.errorFeatureDetection&&n.errorFeatureDetection.registerFeature&&n.errorFeatureDetection.registerFeature(a,f)}catch(g){k(g)}},markFeatureAvailable:function(a){try{n.errorFeatureDetection&&n.errorFeatureDetection.markFeatureAvailable&&n.errorFeatureDetection.markFeatureAvailable(a)}catch(f){k(f)}},markFeatureUnavailable:function(a){try{n.errorFeatureDetection&&
n.errorFeatureDetection.markFeatureUnavailable&&n.errorFeatureDetection.markFeatureUnavailable(a)}catch(f){k(f)}}}});q.when("error-feature-detection").execute(function(a){a.registerFeature("continue-action",0);a.markFeatureAvailable("javascript-detection");a.markFeatureAvailable("continue-action")});"use strict";q.when("A","loading-spinner-controller","ajax-utility","currency-formatter","page-conductor","page-transition-controller").register("inline-points-register-controller",function(a,l,k,b,f,
g){function h(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))}function d(a){var b=u.$popover.find(".rewards-registration");l.hideSpinner(b);b.children("div").hide();b=b.find(".rewards-registration-error");a&&a.error?(a=b.find("[data-error\x3d'"+a.error+"']"),a.length?a.show():
b.find("[data-error\x3d'rewards_SystemUnavailable']").show()):b.find("[data-error\x3d'rewards_SystemUnavailable']").show();b.fadeIn(300)}function e(a){u=a.popover;var b=u.$popover.find(".rewards-registration");l.showSpinner(b,!1,u);a=b.data("issuer-id");var c=b.data("program-id"),e=b.data("cc-issuer"),f=b.data("cc-brand"),b=b.data("parent-payment-method-id"),m="/gp/buy/payselect/handlers/get-rewards-configuration.html?cachebuster\x3d"+(new Date).getTime();B.ajax({type:"POST",url:m,data:"programid\x3d"+
c+"\x26partner\x3d"+a+"\x26ccpaymentinstrumentid\x3d"+b+"\x26issuer\x3d"+e+"\x26brand\x3d"+f+"\x26hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:function(a){return k.jsonify(a)},success:function(a,b,c){b=u.$popover.find(".rewards-registration");l.hideSpinner(b);c=a.fields||{};for(var d in c)if(c.hasOwnProperty(d)){var e=c[d],f=b.find("[data-field\x3d'"+e.type+"']");e.value&&f.filter("input").attr("value",e.value);f.parents(".rewardsfield").show()}a.termshtml&&b.find(".rewardstermstext").html(h(a.termshtml));
a.billingzip&&b.find("[data-field\x3dBILLING_POSTAL_CODE]").attr("value",a.billingzip);if(a.displaydata){d=b.find("[data-field]");for(var m in a.displaydata)a.displaydata.hasOwnProperty(m)&&d.filter("[data-field\x3d"+m+"]").html(a.displaydata[m])}a.marketinglink&&b.find("[data-field\x3d'rewards_marketing_link']").html(a.marketinglink);b.find("#rewards-registration-image").show();b.find(".rewards-registration-main").fadeIn(300);u.updatePosition(!0)},error:function(a){d(a)}})}function c(){if(u){var a=
u.$popover.find(".rewards-registration");l.hideSpinner(a);a.find(".rewards-registration-success").hide();a=a.find(".rewards-registration-error");a.hide();a.find("h4").hide();x&&(g.show(),f.isSPP()?f.reloadPage():B("div.pay").length?f.loadPage("payselect","payselect"):B("div.spc").length&&f.loadPage("spc","spc"))}}function m(a){return a.is("input")?a:a.find("input")}function p(){if(u){var a=u.$popover.find(".rewards-registration");a.find(".rewards-registration-main").hide();a.find("#rewards-registration-image").hide();
l.showSpinner(a,!1,u);var c=(new Date).getTime(),e="programid\x3d"+encodeURIComponent(a.data("programId")),e=e+("\x26paymentinstrumentid\x3d"+encodeURIComponent(a.data("parent-payment-method-id"))+"\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26cachebuster\x3d"+c),f=a.find("[data-field]");f.each(function(){var a=B(this).attr("data-field");if("CVV2"===a)e+="\x26registerRewardsCreditCardVerificationNumber\x3d"+encodeURIComponent(B(this).val());else if(B(this).data("entryindex")){if(1===B(this).data("entryindex")){var b=
f.filter("[data-field\x3d"+a+"]").sort(function(a,b){return Number(B(a).data("entryindex"))-Number(B(b).data("entryindex"))});e+="\x26"+a+"\x3d";b.each(function(){e+=encodeURIComponent(B(this).val())})}}else"TERMS_AND_CONDITIONS"===a?m(B(this)).is(":checked")&&(e+="\x26"+a+"\x3dtrue"):e+="\x26"+a+"\x3d"+encodeURIComponent(B(this).val())});c="ox_pay_page_swp_reg_popover_submit";a.data("programId")&&(c+="_"+a.data("programId"));a="/gp/buy/payselect/handlers/register-rewards-account.html/ref\x3d"+c+
"?cachebuster\x3d"+(new Date).getTime();B.ajax({type:"POST",url:a,data:e,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return k.jsonify(a)},success:function(a,c,e){a?a&&0===a.success?d(a):u&&(c=u.$popover.find(".rewards-registration-success"),c.find(".customername").text(a.customername),a.dollarbalancedisplay&&a.pointsbalance&&(c.find("[data-field\x3d'rewardsamount']").html(a.dollarbalancedisplay),c.find("[data-field\x3d'pointsamount']").html(b.getNumberWithSeparators(a.pointsbalance,a.rewardsdecimalplaces)),
c.find(".rewardsuccessbalance").show()),a.showwarnmessage&&c.find(".warnmessage").show(),x=!0,c.fadeIn(300),l.hideSpinner(u.$popover.find(".rewards-registration"))):d()},error:function(a){d(a)}})}}var B=a.$,u,x=!1;a.on("a:popover:show:rewards-registration",e);a.on("a:popover:hide:rewards-registration",c);a.declarative("close-rewards",["click"],function(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")});a.declarative("rewards-signup",["click"],function(a){a.$event.preventDefault();
p(a)});a.declarative("toggle-reward-signup-button","change",function(a){a=a.$target;var b=u.$popover.find(".rewards-registration");a&&a.is(":checked")?(b.find("#reward-signup-button").removeClass("aok-hidden"),b.find("#disabled-reward-signup-button").addClass("aok-hidden")):(b.find("#reward-signup-button").addClass("aok-hidden"),b.find("#disabled-reward-signup-button").removeClass("aok-hidden"))});a.on("a:popover:beforeShow:cvv2helpcontent",function(a){a.popover.$popover.find(".a-popover-inner").html(B(".cvv2helpcontent").text());
a.popover.updatePosition()});return{displayRewardsRegister:e,hideRewardsRegister:c}});"use strict";q.when("A","error-feature-detection","safe-mash","ready").register("shared-kitchensink",function(a,l,k){var b=a.$;a.on("checkout:reload",function(){(b("body.a-touch").length||b("div.a-touch:first").length)&&b("html").addClass("a-touch");b("form").each(function(){var a=b(this).find('input[name\x3d"hasWorkingJavascript"]');a&&0<a.length?a.val("1"):b(this).append('\x3cinput type\x3d"hidden" name\x3d"hasWorkingJavascript" value\x3d"1" /\x3e')});
k&&(b("div.checkout-tablet a[target\x3d'AmazonHelp']").each(function(){var a=b(this).attr("href"),a=a+(0<=a.indexOf("?")?"\x26app-nav-type\x3dmodal":"?app-nav-type\x3dmodal"),a=a.replace("#","");b(this).attr("href",a);b(this).removeAttr("data-action");b(this).removeAttr("data-help-popup");b(this).removeAttr("onclick")}),b("div.checkout.mobile a[target\x3d'AmazonHelp']").each(function(){var a=b(this).attr("href"),a=a.replace("#","");b(this).attr("href",a);b(this).removeAttr("data-help-popup");b(this).removeAttr("onclick");
b(this).addClass("a-declarative help-popup");b(this).attr("data-action","help-popup")}));if(0<b("div.checkout-tablet").length)for(var a=document.getElementsByTagName("a"),g=0;g<a.length;g++)a[g].href||(a[g].href="#")});b(document).bind("jsdetection",function(){l.markFeatureAvailable("javascript-detection")})});q.when("A","safe-mash","ready").execute(function(a,l){var k=a.$;a.declarative("mash-navigate",["click"],function(a){a=a.$currentTarget.attr("href");l&&l.navigate?l.navigate({url:a}):n.location.href=
a});a.declarative("expander-scroll-there",["click"],function(a){if("false"!==a.$currentTarget.closest(".a-expander-container").find(".a-expander-content").attr("aria-expanded")){var f=k(n),g=k(document),h=a.$currentTarget.offset().top,d=0,e=0,c=function(){n.setTimeout(function(){f.scrollTop(h);d===g.height()?e++:(e=0,d=g.height());10>e&&c()},10)};c()}})});n.amz_js_PopWin=function(a,l,k){(a=n.open(a,l,k))&&a.focus&&a.focus();return!1};var ja=!1;n.confirmPurchase_onSubmit||(n.confirmPurchase_onSubmit=
function(){return ja?!1:ja=!0});"use strict";q.when("A","error-feature-detection","loading-spinner-spp-controller").register("loading-spinner-controller",function(a,l,k){function b(a){if(g&&h){var b,e,t;c&&B?(a=c.getContent(),b=a.innerHeight(),e=a.innerWidth()):(b=a.height(),e=a.width());t=a.offset();a=h.width();var p=h.height();if(d)t="1"===f("input[name\x3dfromAnywhere]").val()?f(document).height():f(n).height(),g.width(f(document).width()).height(t).css("left","0px").css("z-index",2E3),h.css("left",
e/2-a/2+"px").css("top",b/2-p/2+"px").css("z-index",4E3).show();else{var k=f(n),l=B?k.scrollLeft():0;g.css("position","fixed").width(e).height(b).css("z-index",3E3).css("left",t.left-l).css("top",t.top-k.scrollTop());m?h.css("position","fixed").css("left",t.left-l+(e/2-a/2)+"px").css("top",t.top-k.scrollTop()+(b/2-p/2)+"px").css("z-index",4E3).show():h.css("left",e/2-a/4+"px").css("top",b/2-p/4+"px").css("z-index",4E3).show()}}}var f=a.$,g,h,d,e,c,m=!1,p=!1,B=!1,u=!1;a.on("a:popover:positionUpdated",
function(a){if(B&&c&&c.name===a.popover.name&&g&&h){var b=c.getContent();a=b.innerHeight();var d=b.innerWidth(),b=b.offset(),e=f(n);g.width(d).height(a).css("left",b.left-e.scrollLeft()).css("top",b.top-e.scrollTop());h.css("left",b.left-e.scrollLeft()+(d/2-h.width()/2)+"px").css("top",b.top-e.scrollTop()+(a/2-h.height()/2)+"px")}});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",b=f("#first-pipeline-load-page-spinner-img");
b.length&&(a=f.trim(b.attr("src")));1>f("#loading-spinner-blocker-doc").length&&(a=f(['\x3cdiv class\x3d"template loading-spinner" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-inner"\x3e','\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"'+a+'"/\x3e','\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"loading-spinner-blocker-doc" class\x3d"loading-spinner-blocker" style\x3d"display:none;"\x3e\x3c/div\x3e\x3cdiv id\x3d"spinner-anchor" class\x3d"spinner-anchor" style\x3d"display:none"\x3e\x3c/div\x3e'].join("")),
h=g=e=null,"1"===f("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),f("body").prepend(a));f("input[name\x3duseModifiedSpinnerResizeFn]").length&&(m=!0);f("#useRelativeSpinner").length&&(p=!0);f("#modifiedBlockerDivSize").length&&(B=!0)});return{showSpinner:function(a,K,r){if(p&&!K&&B&&m&&r)return u=!0,k.showSpinner(a,r);u=!1;0!==a.length&&(c=(d=K)?void 0:r,e||(e=f(".loading-spinner.template").clone().removeClass("template"),e.show()),
a.append(e),d?(g=f("#loading-spinner-blocker-doc"),a.find(".loading-spinner-blocker").hide()):g=a.find(".loading-spinner-blocker"),g.show(),d&&l.markFeatureUnavailable("continue-action"),h=a.find(".loading-spinner-inner"),b(a))},hideSpinner:function(a,b){if(u)return u=!1,k.hideSpinner(a,b);u=!1;g&&(d&&(g.hide(),l.markFeatureAvailable("continue-action")),e.detach());b&&a.hide()},adjustSize:function(a){return u?k.adjustSize():b(a)}}});"use strict";q.when("A","error-feature-detection").register("loading-spinner-spp-controller",
function(a,l){function k(){if(f&&g){var a=d.innerHeight(),b=d.innerWidth();f.width(b).height(a);g.css("left",b/2-g.width()/2+"px").css("top",a/2-g.height()/2+"px")}}var b=a.$,f,g,h,d,e;a.on("a:popover:positionUpdated",function(a){e&&e.name===a.popover.name&&k()});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",d=b("#first-pipeline-load-page-spinner-img");d.length&&(a=b.trim(d.attr("src")));1>b(".loading-spinner-spp").length&&
(a=b(['\x3cdiv class\x3d"template loading-spinner-spp" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-spp-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-spp-inner"\x3e','\x3cimg class\x3d"loading-spinner-spp-img" src\x3d"'+a+'"/\x3e',"\x3c/div\x3e\x3c/div\x3e"].join("")),g=f=h=null,"1"===b("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),b("body").prepend(a))});return{showSpinner:function(a,m){0!==a.length&&
(e=m,d=a,h||(h=b(".loading-spinner-spp.template").clone().removeClass("template"),h.show()),m.getContent().before(h),d.prepend(h),f=d.find(".loading-spinner-spp-blocker"),f.show(),g=d.find(".loading-spinner-spp-inner"),k())},hideSpinner:function(a,b){f&&h.detach();b&&a.hide()},adjustSize:k}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","client-side-metrics","safe-mash","cache-page-data-controller","ajax-wrapper","widget-streamer",
"widget-streamer-utils","weblab-helper","temporary-preference-indicator").register("page-conductor",function(a,l,k,b,f,g,h,d,e,c,m,p,B){function u(a){n.ueLogError&&n.ueLogError({message:a},{logLevel:"WARN",attribution:"CheckoutCommonAsset-PageConductor"})}function x(a){ia&&(a?(a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"),a["x-amz-checkout-type"]||(a["x-amz-checkout-type"]="spp")):a={"x-amz-checkout-transition":"ajax","x-amz-checkout-type":"spp"});return a}function K(){la=
!1;ea=null;ra=0;pa=!1;sa=null}function r(a){var b=parseInt(U("#checkoutDisplayPage").data("delaySetTitle"),10)||0;b?n.setTimeout(function(){document.title=a},b):document.title=a}function t(b){a.trigger("checkout:beforeReload");a.trigger("checkout:reload");b&&("spp-revieworder"===b?a.trigger("checkout:reload:spc"):a.trigger("checkout:reload:"+b));a.trigger("checkout:afterReload")}function v(a){l.show();var b="/gp/buy/addtocart/handlers/display.html";a&&(b+="?errorType\x3d"+a);n.location=b}function z(b){(b=
U("#pageTypeRedirectedTo").text())&&a.trigger("checkout:reload:"+b)}function y(b,c){var d;if(c.getResponseHeader("x-amz-force-full-page-update"))J(b);else{if(c.getResponseHeader("x-amz-checkout-redirect-addtocart")){(c=k.jsonify(b))?v(c.errorCode):v();return}d=I(b)}b=U("#pipelinedPageTitle").text();r(b);var e=c.getResponseHeader("x-amz-checkout-page");ia?a.delay(function(){p.isCFMarkersCleanupOnSPCEnabled()||g.setmarker&&g.setmarker("cf");t(e)},d):t(e)}function J(a){var b=document.open("text/html",
"replace");b.write(a);b.close()}function D(a,b){try{if(b.getResponseHeader("x-amz-force-full-page-update"))J(a);else{if(!oa)throw Error("Member _updateDisplayPageContent not set in page-conductor. Make sure 'initFunc' is called.");oa(a)}}catch(c){a="Error while replacing page content.",c.message&&(a+="  Error message: "+c.message),q.error(a,"page-conductor","replaceDisplayPage",c)}p.isCFMarkersCleanupOnSPCEnabled()||g.setmarker&&g.setmarker("cf");a=U("#pipelinedPageTitle").text();r(a);b=b.getResponseHeader("x-amz-checkout-page");
t(b)}function F(a){var b=parseInt(U("#showPageTransition").attr("content"),10);(b=isNaN(b)?1:b)||l.hide();b="/gp/buy/shared/handlers/dispatch.html";a&&(a.conductoraction&&a.conductoraction.url?b=a.conductoraction.url:a.pipedata&&a.pipedata.conductoraction&&a.pipedata.conductoraction.url&&(b=a.pipedata.conductoraction.url));b=0<b.indexOf("?")?b+"\x26":b+"?";U("input[name\x3dfromAnywhere][value\x3d1]").length&&(b+="fromAnywhere\x3d1");b=O(b);h&&U("html").hasClass("a-tablet")&&-1<b.indexOf("/gp/cart/view.html")&&
(b="/gp/aw/c?app-action\x3dcart");n.location=b}function L(a,b,c,e,f){e=e||{};e.pushNewFrame=e.pushNewFrame||"true";e.anchor=e.anchor||void 0;K();"true"===e.pushNewFrame&&h&&h.navigate&&U("#checkoutDisplayPage").data("useMashNavigateForTransitions")?h.navigate({url:null,transitionEffect:"slide",successCallback:function(){G(a,b,c,e,f)},failCallback:function(a){}}):G(a,b,c,e,f);e.keepCachedPagesData||d.clearCache()}function P(){var a=U("input#isPipelinedPage");return 0<a.length&&"1"===a.val()}function G(a,
c,d,e,t){e=e||{};e.pushNewFrame=e.pushNewFrame||"true";e.anchor=e.anchor||void 0;var h=d.getResponseHeader("x-amz-checkout-page");b.setCurrentPage(h);if(e.freshLoad)e.freshLoad=!1,q.when("first-load-dependencies").execute(function(b){G(a,c,d,e)});else if(g.setAnalysisScopeT0(),h){U("head .aui-page-asset").removeAttr("disabled");U("head .old-pipeline-asset").removeAttr("disabled");var fa=d.getResponseHeader("x-amz-checkout-requestid");g.setAsyncRequestId(fa);if(fa=d.getResponseHeader("x-amz-checkout-redirect"))F({conductoraction:{url:fa,
type:"redirect"}});else{var fa=d.getResponseHeader("x-amz-checkout-url"),l=d.getResponseHeader("x-amz-checkout-additional-page-args");p.isAJAXWeblabOn()&&m.isStreamingAjax(d)?(z(d),M(a,h)):0<U("#checkoutDisplayPage").length?D(a,d):y(a,d);var r=U("#pipelinedPageTitle").text();if(P()&&r&&fa&&n.history&&n.history.pushState){fa=O(fa);e.anchor&&(fa+=e.anchor);var v=U("input#executionId").val();v&&(fa=f.addQueryStringParameter(fa,"executionId",v));"true"===e.pushNewFrame&&history.state&&history.state.page!==
h&&history.pushState({page:h,additionalURLArgs:l},r,fa)}e.anchor&&(h=U(e.anchor),0===h.length&&(h=e.anchor.replace("#",""),h=U(document.getElementsByName(h))),h.length&&U(document).scrollTop(h.offset().top));e.logUsedPrefetch&&q.when("action-logger").execute(function(a){a.logUsedPrefetch(d.getResponseHeader("x-amz-checkout-page-type"),d.getResponseHeader("x-amz-checkout-sub-page-type"),d.getResponseHeader("x-amz-checkout-requestid"),t)})}}else{if(n.getOldAjaxSuccessCallback)return n.getOldAjaxSuccessCallback("ajaxConductor",
"generalErrorHandling","generalErrorHandling")(a,c,d);a=k.jsonify(a);F(a)}}function M(a,b){a.execute();a=U("#pipelinedPageTitle").text();r(a);t(b)}function Q(){n.location=ya?"/gp/buy/addtocart/handlers/display.html":"/gp/buy/payselect/handlers/error.html"}function V(b,c,d,f,h){f=f||{};f.refTag=f.refTag||"";f.pushNewFrame=f.pushNewFrame||"true";f.anchor=f.anchor||void 0;f.refTag&&0!==f.refTag.indexOf("/ref\x3d")&&(f.refTag="/ref\x3d"+f.refTag);b="fromPage\x3d"+b+"\x26page\x3d"+c;(c=U("input#executionId").val())&&
(b+="\x26executionId\x3d"+c);d&&(b+="\x26"+d);d=function(){};c=function(){};var t,g;"function"===typeof f.resultscallback?(t=function(a,b,c){f.resultscallback(a,b,c)},g=function(a,b,c){f.resultscallback(void 0,b,a)}):(d=function(b){a.trigger("checkout:beforeLoadPage");S&&S.abort();S=b},t=function(a,b,c){p.isAJAXWeblabOn()&&m.isStreamingAjax(c)||f.callbackBeforePageUpdate&&f.callbackBeforePageUpdate();L(a,b,c,f);f.callbackAfterPageUpdate&&f.callbackAfterPageUpdate()},g=function(a,b,c){"abort"!==b&&
("error"===b&&a.readyState===e.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,b){n.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):(W(a,b),Q()))},c=function(a){S=null});h={type:"GET",url:(h?h:"/gp/buy/shared/handlers/pipeline-dispatch.html")+f.refTag,data:b,dataType:"text",async:!0,beforeSend:d,success:t,error:g,complete:c,cache:!1};ia&&(h.headers=x({"x-amz-checkout-transition":"ajax"}));return p.isAJAXWeblabOn()?(h.useXMLHttp=!0,h=E(h,f.callbackBeforePageUpdate),e.aui(h)):
U.ajax(h)}function E(a,b){a.timeout=5E4;a.data=C(a.data,"acceptsStreaming\x3d1");var d;d=a.data.match(/.*isAsync=1.*/)?!0:!1;var e=c({isPrefetch:d,before:b});a.chunk=e.onNewChunk;var f=a.success;a.success=function(a,b,c){f&&m.isStreamingAjax(c)?f(e,b,c):f&&f(a,b,c)};return a}function C(a,b){return a?a+"\x26"+b:b}function W(a,b){g.increaseCount("Checkout:PageConductor:Ajax:Error");p.isAJAXWeblabOn()?(a?(g.increaseCount("Checkout:AUI:Ajax:jqXHR:defined"),u("jqXHR defined throw CheckoutErrorAW under AJAX Weblab, textStatus:"+
b+" stateCode:"+a.state+" readyState:"+a.readyState)):void 0===a?(g.increaseCount("Checkout:AUI:Ajax:jqXHR:undefined"),u("jqXHR undefined throw CheckoutErrorAW under AJAX Weblab")):null===a&&(g.increaseCount("Checkout:AUI:Ajax:jqXHR:null"),u("jqXHR null throw CheckoutErrorAW under AJAX Weblab")),g.increaseCount("Checkout:AUI:Ajax:Error:textStatus:"+b),g.increaseCount("Checkout:AUI:Ajax:Error:statusCode:"+a.status),g.increaseCount("Checkout:AUI:Ajax:Error:readyState:"+a.readyState)):(a?(g.increaseCount("Checkout:jQuery:Ajax:jqXHR:defined"),
u("jqXHR defined throw CheckoutErrorAW using jQuery, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):void 0===a?(g.increaseCount("Checkout:jQuery:Ajax:jqXHR:undefined"),u("jqXHR undefined throw CheckoutErrorAW using jQuery")):null===a&&(g.increaseCount("Checkout:jQuery:Ajax:jqXHR:null"),u("jqXHR null throw CheckoutErrorAW using jQuery")),g.increaseCount("Checkout:jQuery:Ajax:Error:textStatus:"+b),g.increaseCount("Checkout:jQuery:Ajax:Error:statusCode:"+a.status),g.increaseCount("Checkout:jQuery:Ajax:Error:readyState:"+
a.readyState))}function aa(a,b,c,d){var m=a;b=C(b,"isClientTimeBased\x3d1");if(p.refactorExtractURL()){var h=f.extractURLParts(a);a=h.normalizedUrl;if(!a)return g.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:T1"),u("Unable to normalize url ["+m+"]. Ajax request aborted."),!1;var t=a.indexOf("/gp/buy/");0<t?(a=a.substring(t),g.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:T1")):g.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:T1");h.query?
(b+="\x26"+h.query,g.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:T1")):g.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:T1");m=h.refMarker;m||(g.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:T1"),m="");m&&-1===m.indexOf("ref\x3d")&&(g.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:T1"),m="")}else{h=a.indexOf("?");0<h?(b+="\x26"+a.substring(h+1),a=a.substring(0,h),g.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:C")):
g.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:C");t=a.indexOf("/gp/buy/");0<t?(a=a.substring(t),g.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:C")):g.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:C");if(-1===a.indexOf(".html"))return g.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:C"),u("url ["+m+"] is missing html extension. Ajax request aborted."),!1;h=a.indexOf(".html");m=a.substring(h+5);a=a.substring(0,h+5);
m||g.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:C");m&&-1===m.indexOf("ref\x3d")&&(g.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:C"),m="")}b+="\x26handler\x3d"+a;a={type:"POST",url:"/gp/buy/shared/handlers/async-continue.html"+m,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:x({"x-amz-checkout-transition":"ajax"}),data:b,dataType:"text",async:!0,success:c,error:function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===
e.READY_STATE.UNSET?q.when("a-tv","mash").execute(function(a,b){n.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):"function"===typeof d&&(W(a,b),d()))},cache:!1};return p.isAJAXWeblabOn()?(a.useXMLHttp=!0,E(a),e.aui(a)):U.ajax(a)}function Y(a,b,c,d,e){e=e&&e.action?e.action:a.attr("action");a=a.serialize();d&&(a+="\x26isAsync\x3d1");return aa(e,a,b,c)}function X(a,b,c,d){a=O(a.attr("href"));d&&(a+="\x26isAsync\x3d1");return aa(a,"",b,c)}function da(a){a=a||{};a.logUsedPrefetch=1;L(ea.data,
ea.status,ea.response,a,ea.refMarker)}function O(a){-1===a.toLowerCase().indexOf("hasworkingjavascript")&&(a+=(0<=a.indexOf("?")?"\x26":"?")+"hasWorkingJavascript\x3d1");return a}function Z(a){pa=!1;qa&&clearTimeout(qa);if(a.is("form"))w(a)?da():Y(a,L,Q);else if(a.is("a"))if(ca(a)){var b;1===parseInt(a.data("keepCachedPagesData"),10)&&(b={keepCachedPagesData:1});da(b)}else X(a,L,Q);else q.error("function called without a trigger","page-conductor","handleContinueAction")}function w(a){return a.is("form")&&
null!==ea&&ea.serializedValue===a.serialize()}function ca(a){return a.is("a")&&null!==ea&&O(ea.serializedValue)===O(a.attr("href"))}function ba(a,b,c,d,e){function h(f,l,v){var N=!0;if("success"===l){if(!p.isAJAXWeblabOn()||!m.isStreamingAjax(v)){var B=k.jsonify(f);null!==B&&B&&B.result&&"noPrefetch"===B.result&&(ea=null,N=!1)}N&&(ea={},ea.serializedValue=r,ea.data=f,ea.status=l,ea.response=v,ea.refMarker=fa)}else ea=null;la=!1;ia&&q.when("spp-button-blocker").execute(function(a){a.hideDefaultContinueBtnBlocker()});
if(pa)return Z(sa),!0;if(N){var u=function(){d?ba(a,b,c,!0,e):ga(a)};if(null===ea||"form"===t&&ea.serializedValue!==a.serialize())return u(),!0;b&&(0===b?g.increaseCount("checkoutPrefetchTimeoutSetToZero",1):qa=setTimeout(function(){ea=null;u()},1E3*b))}return!0}if(!P()||0===a.length)return!1;var t=a.get(0).tagName.toLowerCase();if("form"!==t&&"a"!==t||"function"===typeof e&&!e(t))return!1;b=b||0;c=c||0;d=d||!1;if(la||ra>=c)return!1;la=!0;ia&&q.when("spp-button-blocker").execute(function(a){a.showDefaultContinueBtnBlocker()});
ra++;qa&&clearTimeout(qa);var fa=f.extractURLParts("form"===t?a.attr("action"):a.attr("href")).refMarker,l,r=null;"form"===t?(r=a.serialize(),l=p.isAJAXWeblabOn()?Y(a,h,h,!0):Y(a,null,null,!0)):"a"===t&&(r=O(a.attr("href")),l=p.isAJAXWeblabOn()?X(a,h,h,!0):X(a,null,null,!0));"object"!==typeof l||"function"!==typeof l.always||p.isAJAXWeblabOn()||l.always(h)}function ga(a){var b=parseInt(a.data("prefetchTimeout"),10),c=parseInt(a.data("maxPrefetches"),10);return ba(a,b,c,!1,function(b){if(a.find("input:checked").hasClass("no-prefetch"))return!1;
if(p.disablePrefetchForScheduledDeliveryWeblabOn()){var c=a.find("div.one-shipment:not(:hidden)").find("input:checked");if(c.parents('[data-a-input-name\x3d"'+c.attr("name")+'"]').hasClass("no-prefetch"))return!1}return"1"===U("input#block-prefetch").val()||"1"===U("input#block-all-prefetch").val()||"form"===b&&!a.data("checkoutFormReady")?!1:!0})}function fa(){var a=b.getCurrentPage();return"payselect"===a||"spp-payment"===a||"pay"===a}function N(b,c){b&&b.preventDefault();p.isClearTemporaryPreferenceBugFixWeblabOn()&&
fa()&&B.hasActiveTemporaryPreference&&B.hasActiveTemporaryPreference()&&K();var d=b?U(b.currentTarget):c;b=function(){if(ia){l.blockAllActions();var a=d.data("shrink-panel"),b=d.data("loading-text");(a=U("#"+a))&&a.length?a.hasClass("expanded")||l.shrinkPanel(U(".spp-panel.expanded"),!1):a=U(".spp-panel.expanded");l.shrinkPanel(a,!0,b)}else l.show()};g.resetMetrics();g.markWithinAnalysisScope("tc");!ta||w(d)||ca(d)?b():a.delay(b,0);try{pa=!0,sa=d,la||Z(d)}catch(e){b="An error occured while click on the continue button.",
e.message&&(b+="  Error message: "+e.message),q.error(b,"page-conductor","continueClicked",e)}}var U=a.$,la,S,ea,ra,pa,sa,qa,ua,oa,I=function(a){if(!ua)throw Error("Member _updatePageContent not set in page-conductor. Make sure 'initFunc' is called.");return ua(a)},ia=!1,ya=!1,T=!1,ta=!1,wa=!1;K();a.declarative("page-transit-no-update-action","click",function(c){if(!T){c.$event.preventDefault();g.resetMetrics();var e=c.data.targetDeclarativeActionId;if(e&&(e=U("#"+e),e.length)){e.trigger("click");
return}var f=c.data.toPage,e=c.data.fromPage||b.getCurrentPage(),m=c.data.refTag||"chk_"+e+"_cancel_pri",h=c.data.args,fa=c.$currentTarget.find("a.checkout-pipeline-pref-link");ia&&d.setCachedPageData(e,f);if(d.getCachedPageData(f,e)){g.increaseCount("checkout:"+e+":cancelpri",1);m=d.getCachedPageData(f,e);K();b.setCurrentPage(m.page);var k;k=p.isAJAXWeblabOn()?I(m.curPageData):I(JSON.stringify(m.curPageData));if(ia)if(g.isTransitionLoggingEnabled()){var r=(new Date).getTime();g.logPageTransition(e+
"-cached",f,void 0,function(b){b=(new Date).getTime()-r;b<k?a.delay(function(){t(f)},k-b):t(f)})}else a.delay(function(){t(f)},k);else t(f);m.title&&m.url&&n.history&&n.history.pushState&&history.state&&history.state.page!==m.page&&history.pushState(m.state,m.title,m.url)}else fa.length?N(null,fa):(g.increaseCount("checkoutSPPCancelNoCachedData",1),fa=function(){if(ia)if(l.blockAllActions(),c.data.noShrink)l.show();else{var a=c.data.loadingText,b=U("#"+c.data.shrinkPanel);b.length||(b=c.$currentTarget.closest("div.spp-panel"));
l.shrinkPanel(b,!0,a)}else l.show()},ta?a.delay(fa,0):fa(),V(e,f,h,{refTag:m,keepCachedPagesData:1}))}});a.on("ready",function(){ta=0<U("#executeNonBlockingAnimations").length;wa=0<U("#prefetchFromAddressEnabled").length});a.on("checkout:afterReload",function(){l.hide();g.sendUEPageLoadStats();if(P()){var a=U("form.checkout-page-form:not(:disabled):first"),b=U("a.checkout-continue-link:not(:disabled):first");U("#useFirstActivePrefetch").length&&(b=U("a.checkout-continue-link:not(:disabled)").filter(function(){return 0<
(parseInt(U(this).data("maxPrefetches"),10)||0)}).first());var c=!1;a.length&&(c=ga(a));!c&&b.length&&(c=ga(b));!c&&ia&&(a=U("a.checkout-pipeline-pref-link:not(:disabled):first"),a.length&&(b=a.data("fromPage"),c=a.data("toPage"),d.getCachedPageData(c,b)||(c=ga(a))))}});return{ajaxUpdatePage:L,ajaxRedirect:F,ajaxSorryPage:Q,isPageLoadRequestInProgress:function(){return S?1:0},submitFormAjax:Y,reloadPage:function(){var a=b.getCurrentPage();V(a,a)},loadPage:V,usePrefetch:da,makePrefetch:ga,makePrefetchWithParams:ba,
isPrefetchValidFor:function(a){if(null!==ea){var b=ea.response.getResponseHeader("x-amz-checkout-page");return a===b}return!1},redirect:F,continueClicked:N,initFunc:function(a,b){ua=a;oa=b},overrideIsSPP:function(a){ia=a},isSPP:function(){return ia},overrideAddToCart:function(a){ya=a},isAnimating:function(){return T},overrideIsAnimating:function(a){T=a},setAjaxTransitionHeader:x,isPipeliningOn:P,disablePageNoUpdateTransition:function(){wa&&q.when("a-button").execute(function(a){var b=U(".spp-panel.expanded").data("stepIndex");
U(".expand-collapsed-panel-trigger").each(function(){var c=U(this),d=c.parents(".spp-panel").data("stepIndex");if(!b||!d||d>b)c.filter(".clickable-heading").removeClass("clickable-heading").addClass("off-clickable-heading"),a(c.filter(".expand-panel-button")).disable(),c.filter("a.expand-panel-button").addClass("disabled-link"),c.parents(".a-declarative").addClass("off-declarative").removeClass("a-declarative")});U(".panel-cancel-row").hide()})},enablePageNoUpdateTransition:function(){wa&&q.when("a-button").execute(function(a){U(".off-clickable-heading").addClass("clickable-heading").removeClass("off-clickable-heading");
a(".expand-collapsed-panel-trigger.expand-panel-button").enable();U(".off-declarative").addClass("a-declarative").removeClass("off-declarative")})},isNonBlockingAnimationEnabled:function(){return ta},isPrefetchFromAddressEnabled:function(){return wa}}});q.when("jQuery","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","page-conductor","cache-page-data-controller","client-side-metrics","weblab-helper","ready").execute(function(a,l,k,b,f,g,h,d,e){if(g.isPipeliningOn()){n.history&&
a(n).bind("popstate",function(){var c=this.history.state,e=b.getCurrentPage();c&&c.page&&e&&(c.page!==e||g.isPageLoadRequestInProgress())&&(l.show(),e=a("#checkoutDisplayPage"),e.data("wipeOnPipelineBackTransition")&&e.empty(),d.resetMetrics(),a("#useFastBackButton").length&&g.isPrefetchValidFor(c.page)?g.usePrefetch({pushNewFrame:!1}):(e="spc"===c.page?"":c.page,g.loadPage(b.getCurrentPage(),e,c.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"})))});a(document).delegate("form.checkout-page-form",
"change",function(b){a(b.target).parent().hasClass("no-prefetch-on-change")||(b=a(b.currentTarget),g.makePrefetch(b))});a(document).delegate("form.checkout-page-form","submit",function(a){g.continueClicked(a)});a(document).delegate("a.checkout-continue-link","click",function(a){g.continueClicked(a)});a(document).delegate("form.checkout-page-form .submit-button-with-name","click",function(b){b=a(b.currentTarget);a("\x3cinput\x3e").attr({type:"hidden",name:b.attr("name"),value:b.val()}).appendTo(b.closest("form.checkout-page-form"))});
var c=!1;a(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","touchmove",function(a){c=!0});a(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","click keypress touchend",function(b){if(c)c=!1,b.preventDefault();else if(f.protectAgainstDoubleAction("pipeline-link"))b.preventDefault();else if("keypress"!==b.type||13===b.which){var e=a(b.currentTarget),k=e.data("pipelineLinkFromPage"),u=e.data("pipelineLinkToPage"),x=e.data("pipelineLinkAnchor"),
K=e.data("pipelineLinkRef");K||((K=f.extractURLParts(e.attr("href")).refMarker)?d.increaseCount("Checkout:PageConductor:LoadPage:AddedRefMarker"):d.increaseCount("Checkout:PageConductor:LoadPage:NoRefMarkerInUrl"));e=e.data("pipelineLinkArgs");u&&(d.resetMetrics(),b.preventDefault(),g.isSPP()&&h.setCachedPageData(k,u),l.show(),b={refTag:K,anchor:x},g.isSPP()&&(b.keepCachedPagesData=1),g.loadPage(k,u,e,b))}});a(document).delegate("a.spclite-dispatch-link","click keypress touchend",function(b){if("keypress"!==
b.type||13===b.which){var c=a(b.currentTarget),d=c.data("spcliteLinkFromPage"),e=c.data("spcliteLinkToPage");c.data("spcliteLinkAnchor");var f=c.data("spcliteLinkRef"),c=c.data("spcliteLinkArgs"),h=a("input#executionId").val(),c=c?c+("\x26executionId\x3d"+h):"executionId\x3d"+h;e&&(b.preventDefault(),l.show(),g.loadPage(d,e,c,{refTag:f},"/gp/buy/shared/handlers/spclite-dispatch.html"))}})}a(document).delegate("input.submit","click touchend",function(){d.resetMetrics()});a(document).delegate("form",
"submit",function(){d.resetMetrics()});a(document).delegate(".panel-cancel-row a, .clickable-heading","click",function(){d.isTransitionLoggingEnabled()&&d.resetMetrics()})});"use strict";q.when("A","a-popover-base","a-popover-util").register("checkout-modal-popover",function(a,l,k){function b(b){return b.disableHide?function(){}:function(){var c=this;c.animating=!0;a.fadeOut(this.$popover,250);b.secondaryPopover||e("#a-popover-modal").hide();a.delay(function(){c.animating=!1},250)}}function f(a,d){var e=
b(d);a=a.$event.triggerPositioningElement?a.$event.triggerPositioningElement:a.$declarativeParent;(c=l.show({$trigger:a,name:d.name,skin:p(d.header,d.closeButton,d.closeTextOverride),content:d.content,url:d.url,data:d.data,update:u,alone:d.alone?"true"===d.alone:!0,position:d.position||"triggerVertical",hide:e}))&&c.$trigger!==a&&(c.$trigger=a,c.updatePosition())}function g(a,c){c.disableHide=!0;var d=b(c);m=!1;(c=l.show({$trigger:a.$declarativeParent,skin:B(c.header,c.footer,c.closeButton,c.contentClass),
name:c.name,requestURL:c.url,position:"windowCenter",update:u,data:c.data,updatePosition:c.allowScrollOnPage?x:K,modal:!0,alone:c.alone?"true"===c.alone:!0,show:function(){this.animating=!0;this.$popover.show();e("#a-popover-modal").show();this.animating=!1},hide:d}))&&c.$trigger!==a.$declarativeParent&&(c.$trigger=a.$declarativeParent,c.updatePosition())}function h(b){var c=b.$declarativeParent;a.delay(function(){d(b,c)},250)}function d(b,e){c&&(k.eventOccursWithin(b,e)||k.eventOccursWithin(b,c.$popover))?
a.delay(function(){d(b,e)},250):l.hide(e)}var e=a.$,c,m=!1,p=function(a,b,c){return function(d){var f=c;void 0===c&&(f=e("input#closeButtonText").val()||"");var m="";f&&(m='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+f+"\x3c/a\x3e\x26nbsp;");f="false"===b?"":['\x3cdiv class\x3d"popover-close-section"\x3e',m,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");
return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',a||f?['\x3cdiv class\x3d"a-popover-header"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",f,"\x3c/div\x3e"].join(""):"",'\x3cdiv class\x3d"a-popover-inner"\x3e',d,'\x3c/div\x3e\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}},B=function(a,b,c,d){return function(f){var m=e("input#closeButtonText").val()||"",h="";m&&(h='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+
m+"\x3c/a\x3e\x26nbsp;");m="false"===c?"":['\x3cdiv class\x3d"popover-close-section"\x3e',h,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");m=a||m?['\x3cdiv class\x3d"a-popover-header huawei-device-header-fix"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",m,"\x3c/div\x3e"].join(""):"";h="";if(b){var g=e("#a-popover-footer-"+b);0<g.length&&(h=['\x3cdiv class\x3d"a-popover-footer"\x3e',
g.html(),"\x3c/div\x3e"].join(""))}return['\x3cdiv class\x3d"a-popover a-popover-modal"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',m,'\x3cdiv class\x3d"a-popover-inner ',d,'"\x3e',f,"\x3c/div\x3e",h,'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}};a.declarative("custom-popover-close",["click","touchend"],function(b){b.$event.preventDefault();var c=b.$target;e("html").hasClass("a-ie6")||e("html").hasClass("a-ie7")||
e("html").hasClass("a-ie8")?c.closest(".a-popover").hide():a.fadeOut(c.closest(".a-popover"),250);e("#a-popover-modal").hide();a.trigger("a:declarative:a-popover-close:click",{$target:c,$event:b.$event,$currentTarget:b.$currentTarget})});a.on("a:popover:positionUpdated",function(a){a=a.popover.$popover;0>a.offset().left&&a.offset({left:0});0>a.offset().top&&a.offset({top:0})});a.on("a:popover:show",function(a){if(a.popover&&a.popover.$trigger){var b=a.popover.$trigger.data("aCheckoutModalPopover");
b&&b.allowScrollOnPage&&a.popover.$popover.css("position","absolute")}});var u=function(a){e(".a-popover-inner",this.$popover).html(a)},x=function(a){if(!m||a)K.call(this,!0),m=!0},K=function(a){var b=e(n),c=b.height()/2,d=b.width()/2,f=this.$popover.height()/2,m=this.$popover.width()/2,c=c-f;if(a||"fixed"!==this.$popover.css("position"))c+=b.scrollTop();a=Math.max(0,d-m);c=Math.max(0,c);this.$popover.css({top:c,left:a})};a.declarative("a-checkout-popover",["click","mouseenter","mouseleave","keyup",
"touchend"],function(a){a.data.showOnHover&&"touchend"!==a.type?"mouseenter"===a.type||"click"===a.type?f(a,a.data):"mouseleave"===a.type&&h(a):("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&f(a,a.data)});a.declarative("a-checkout-modal-popover",["click","keyup","touchend"],function(a){("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&g(a,a.data)});a.on("checkout:reload",function(){a.defer(function(){0===e("#a-popover-modal").length&&
e("body").append('\x3cdiv id\x3d"a-popover-modal" /\x3e')})});return{hideById:function(a){l.hide(a)},createModal:g}});"use strict";(function(){var a=!1;q.when("A").register("page-detector",function(l){function k(){return b("checkout-as")}function b(a){d||(d={});d.hasOwnProperty(a)||(d[a]=0<h("div."+a).length);return d[a]}function f(){return b("checkout.pay")}function g(){return b("checkout.spc")}var h=l.$,d;l.on("checkout:reload",function(){d={};a||q.when("page-detector-current-initializer").execute(function(a){a.initializeDetectorWithCurrentPage(null)})});
return{isAddressSelect:k,isAddressTranslation:function(){return b("translate-address-form")},isDesktopPayment:function(){return f()&&b("pay-desktop")},isDesktopSpc:function(){return g()&&b("spc-desktop")},isMobileAddressSelect:function(){return k()&&b("checkout-as-mobile")},isMobilePayment:function(){return f()&&b("pay-mobile")},isMobileSpc:function(){return g()&&b("spc-mobile")},isTabletAddressSelect:function(){return k()&&b("checkout-as-tablet")},isTabletPayment:function(){return f()&&b("pay-tablet")},
isTabletSpc:function(){return g()&&b("spc-tablet")},isSpcLite:function(){return g()&&b("spclite")},isPayment:f,isSosp:function(){return b("checkout.sosp")},isSpc:g,isMobile:function(){return b("checkout.mobile")},isTablet:function(){return b("checkout.tablet")}}});q.register("page-detector-current-initializer",function(){return{initializeDetectorWithCurrentPage:function(l){if(!a){var k=l;q.register("page-detector-current-page",function(){return{getCurrentPage:function(){return k},setCurrentPage:function(a){var f=
k;k=a;q.when("A").execute(function(g){g.trigger("page-detector:page-changed",f,a)})}}});a=!0}}}})})();"use strict";q.when("jQuery","loading-spinner-controller").register("page-spinner-controller",function(a,l){function k(){"function"===typeof x.blockAllActions&&x.blockAllActions()}function b(){"function"===typeof x.unblockAllActions&&x.unblockAllActions()}function f(a){"function"===typeof x.showTransitionInContainer&&x.showTransitionInContainer(a)}function g(){var b=a(n).width(),c=a(n).height(),d=
a(n),e=0;null!==u&&(e=u.outerHeight()-a(n).scrollTop(),0>e&&(e=0));p.css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c);"1"!==a("input[name\x3dfromAnywhere]").val()&&a("#loading-spinner-blocker-doc").css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c)}function h(){var b;b=document.activeElement?a(document.activeElement):a(":focus:first");b.is("button, a, input:enabled")&&b.blur()}function d(){if(K){k();q.when("spp-button-blocker").execute(function(a){a.hideContinueBtnBlocker()});
var b=a(".spp-panel.expanded");if(0<b.length&&b.is(":visible")){f(b,1);return}}if(B)return p.length&&p.find(".loading-spinner-inner").show(),!1;B=!0;h();p=a("#spinner-anchor");p.find(".loading-spinner-inner").show();a("#unblockHeader").length&&(u=a("#header"));c=p.css("z-index");a(n).unbind("scroll.checkout-page-spinner").bind("scroll.checkout-page-spinner",function(a){m&&n.clearTimeout(m);m=setTimeout(function(){g();m=null},50)});a(n).unbind("resize.checkout-page-spinner").bind("resize.checkout-page-spinner",
function(){g();l.adjustSize(p)});a(n).unbind("orientationchange.checkout-page-spinner").bind("orientationchange.checkout-page-spinner",function(){g();l.adjustSize(p)});g();p.show();p.css("z-index",2E3);l.showSpinner(p,!0);return!0}function e(){if(K)b(),"function"===typeof x.hideSpinner&&x.hideSpinner();else{a("#first-pipeline-load-page-spinner").remove();if(!B)return!1;B=!1;p.length&&p.find(".loading-spinner-inner").show();p&&(a(n).unbind(".checkout-page-spinner"),p.hide(),p.css("z-index",c),l.hideSpinner(p));
return!0}}var c,m=null,p,B=!1,u=null,x={},K=!1;return{show:d,showPageTransition:function(){return"0"===a("#showPageTransition").attr("content")?!1:d()},hide:e,hidePageTransition:function(){"0"===a("#showPageTransition").attr("content")&&e();return!0},hideAnimatedSpinnerImage:function(){p.length&&p.find(".loading-spinner-inner").hide()},initFunc:function(a){null!==a&&(x=a,K=!0)},blockAllActions:k,unblockAllActions:b,showTransitionInContainer:f,shrinkPanel:function(a,b,c){"function"===typeof x.shrinkPanel&&
x.shrinkPanel(a,b,c)},clearFocus:h}});"use strict";q.when("A").execute(function(a){a=a.$;var l="",l="mash-transitions"===a("input[name\x3dpageTransitionType]").val()?"page-mash-transition-controller":"page-spinner-controller";q.when(l).register("page-transition-controller",function(a){q.when("A").execute(function(b){b.declarative("page-spinner-show",["click"],{allowLinkDefault:!0},function(b){b=b.$target;b.hasClass("a-button-disabled")||b.closest(".a-button-disabled").length||a.showPageTransition()})});
q.when("A").execute(function(b){b.declarative("page-spinner-show-on-submit",["submit"],{allowLinkDefault:!0},function(b){a.showPageTransition()})});return{show:a.show,hide:a.hide,showPageTransition:a.showPageTransition,hidePageTransition:a.hidePageTransition,blockAllActions:a.blockAllActions,unblockAllActions:a.unblockAllActions,showTransitionInContainer:a.showTransitionInContainer,shrinkPanel:a.shrinkPanel}})});"use strict";q.when("A","page-conductor","client-side-metrics","page-detector-current-page",
"a-popover","ready").execute(function(a,l,k,b){function f(a,b,c){l.isSPP()&&k.setmarker&&k.setmarker("af");k.sendUEPageLoadStats()}var g=a.$,h=!1;a.on("a:popover:afterHide",function(a){a.popover&&(h=!1)});a.on("a:popover:beforeShow",function(a){var b=a.popover;b&&(h=!0,b.$trigger.find(".modal-parameters").each(function(){g.each(g(this).data(),function(a,d){b.attrs(a,d)})}))});a.on("a:popover:dismiss",function(a){a=a.popover;if(k.isTransitionLoggingEnabled()&&a&&h){h=!1;var e,c;"prime-acquisition-spc-popover"===
a.name&&(e="prime-acquisition",c=b.getCurrentPage());e||c||!a.attrs||(e=a.attrs("returnfrom"),c=a.attrs("returnto"));e&&c&&(k.resetMetrics(),k.logPageTransition(e,c,f))}})});"use strict";q.when("weblab-helper").execute(function(a){function l(a,b,f,g){function h(){"function"===typeof n.uet&&"function"===typeof n.uex&&(n.uet("cf","first-load-dependencies-ready",{wb:1}),n.uex("ld","first-load-dependencies-ready",{wb:1}));a.trigger("checkout:beforeReload");a.trigger("checkout:reload");e&&("spp-revieworder"===
e?a.trigger("checkout:reload:spc"):a.trigger("checkout:reload:"+e));a.trigger("checkout:afterReload");setTimeout(function(){var a=d("#first-pipeline-load-page-spinner");a.is(":visible")&&(a.remove(),f.logError("The page has taken more than 90 seconds to load, or there was a JS error preventing it from loading, hiding page spinner."))},9E4)}var d=a.$,e=b.getCurrentPage();"function"===typeof n.uet&&n.uet("bb","first-load-dependencies-ready",{wb:1});return{allDependenciesCheck:function(a){if(a&&a.length){var b=
!1,k={};d.each(a,function(a,b){k[b]=1;q.when(b).execute(function(){delete k[b]})});var l=function(a){a="Page ("+e+") is missing dependencies ["+a.join(", ")+"] after 5 secs.";g.increaseCount("checkout:dependency:missed:regular-page:error");f.logErrorOnLevel(a,"ERROR")},u=setTimeout(function(){if(!b){var a=[];d.each(k,function(b){a.push(b)});g.increaseCount("checkout:dependency:missed");0<d("#assets-prefetch").length?g.increaseCount("checkout:dependency:missed:assets-prefetch"):(g.increaseCount("checkout:dependency:missed:regular-page"),
l(a));h()}},5E3);q.when.apply(q,a).execute(function(){b=!0;n.clearTimeout&&u&&n.clearTimeout(u);h()})}else h()}}}/T1|T2/.test(a.getFixFederatedAssetsInjectionTimingIssueTreatment())?q.when("A","page-detector-current-page","checkout-general-utils","client-side-metrics").register("first-load-dependencies-base",l):q.when("A","page-detector-current-page","checkout-general-utils","client-side-metrics","afterReady").register("first-load-dependencies-base",l)});"use strict";q.when("A","page-detector","client-side-metrics").register("gift-utility",
function(a,l,k){var b=a.$,f=/[^\s\u0020-\u007E\u00A0-\u00FF]/g,g=n.P&&n.P.AUI_BUILD_DATE;return{getInput:function(a){return a.is("input")?a:a.find("input")},getCharCount:function(a,b){return b?n.unescape(encodeURIComponent(a)).length:a.length},getLineCount:function(a,b){var e=a.split("\n").length;b=Math.floor(b);a=a.split("\n");for(var c=0;c<a.length;c++)a[c].length>b&&(e+=Math.floor(a[c].length/b),0===a[c].length%b&&e--);return e},getNameWithNoTitle:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&
(b=!0);b&&a.shift();return a.join(" ")},getFirstName:function(a){var b=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(b=!0);b&&a.shift();return a.shift()},toggleGiftMessageWarning:function(a,d){var e=d.find(".gift-message-warning");if(f.test(a.val())){var c=d.find(".gift-message-preview-trigger"),m=a.val().replace(f,"?");g?q.when("a-popover").execute(function(a){var b=a.get(c);b?b.update({content:m}):a.create(c,{inlineContent:m,position:"triggerVertical",closeButton:"false"})}):
(k.increaseCount("removeauijs13"),c.unbind("click.preview").bind("click.preview",function(a){q.when("a-popover-base").execute(function(c){var d=b(a.target);d.data("popoverid")&&(c=c.get(d.data("popoverid")))&&(c.update(m),c.updatePosition())})}));a.addClass("a-form-error");e.show()}else a.removeClass("a-form-error"),e.hide()}}});"use strict";q.when("A","page-detector","page-detector-current-page","safe-mash","client-side-metrics").register("help-popup",function(a,l,k,b,f){function g(){if(h("div#help-popover").length){h(n).unbind("resize.checkout-help-popover");
var a=h("#help-popover-frame")[0];h(a.contentWindow?a.contentWindow:a.contentDocument.defaultView).undelegate("a","click");h("div#help-popover").remove()}}var h=a.$;l=l.isMobile();k=h("input#isPipelinedPage");k=0<k.length&&"1"===k.val();var d=l&&k&&b&&b.navigate;a.declarative("help-popup",["click"],function(a){if(!h(".a-touch").length||d){a.$event.preventDefault();a.data&&"1"===a.data.stopPropagation&&a.$event.stopPropagation();var c=a.$target.attr("href");a=a.data;d?b.navigate({url:c,transitionEffect:"slide"}):
(a.width||(a.width="340"),a.height||(a.height="340"),n.open(c,"AmazonHelp","width\x3d"+a.width+",height\x3d"+a.height+",left\x3d10,top\x3d10,resizable\x3dyes,scrollbars\x3dyes,menubar\x3dno,toolbar\x3dyes,location\x3dno,directories\x3dno,status\x3dyes"))}else n.open(a.$target.attr("href"),"AmazonHelp")});if(d)a.on("checkout:reload",g)});"use strict";q.when("jQuery","page-conductor").register("quantity-service",function(a,l){function k(b,f){f=f||{};var g;f.additionalData&&(g=f.additionalData);var h=
"/gp/buy/pipeline/handlers/update-quantity.html",d={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};g&&g.deletePrimeMembership&&g.primeMembershipASIN&&(d.deletePrimeMembershipItemIn=g.deletePrimeMembership,d.deletedPrimeMembershipASINIn=g.primeMembershipASIN);f.ref&&(h+="/ref\x3d"+f.ref,delete f.ref);g=f.success;delete f.success;var e=l.ajaxRedirect;f.error&&(e=f.error,delete f.error);a.extend(d,f);f=[];for(var c in b)void 0!==b[c]&&(f.push(c),d[c]=b[c]);
d.entityids=f;b=l.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});a.ajax({type:"POST",url:h,data:a.param(d,!0),dataType:"text",async:!0,cache:!1,headers:b,success:g,error:e})}return{callBatch:function(a,f){k(a,f)},call:function(a,f,g){var h={};h[a]=f;k(h,g)}}});"use strict";q.when("jQuery").register("scroll-controller",function(a){return{scrollToTop:function(){a(n).scrollTop(0)},toggleScrollOn:function(){a(document).unbind("touchmove")},toggleScrollOff:function(){a(document).bind("touchmove",
function(a){a.preventDefault()})}}});"use strict";q.when("A","checkout-general-utils","ready").execute(function(a,l){a.$("#checkout-mash-will-load").length?q.when("mash").execute(function(a){var b;"object"===typeof a?b=a:n.amazon&&n.amazon.mash&&(b=n.amazon.mash);"object"!==typeof b?l.logError("MASH is expected but can't be found"):q.register("safe-mash",function(){return b})}):q.register("safe-mash",function(){})});"use strict";q.when("A","scheduled-delivery-external-interface","shipping-speed-selection-controller",
"page-detector","ready").register("scheduled-delivery-controller",function(a,l,k,b){var f=a.$,g={};k=function(){g={};f("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=f(this),b=a.closest("div.fake-label");(b=l.getSdWidgetRootId(b))&&(g[a.attr("name")]=b)})};a.on("checkout:reload:shipoptionselect",k);a.on("checkout:reload:spp-revieworder",k);b.isSosp()&&k();f(document).delegate("div.fake-label","click",function(){if(b.isSosp()){var h=f(this),d=h.find("input[type\x3d'radio']");
d.attr("disabled")||(d=d.attr("name"),h=l.getSdWidgetRootId(h),a.trigger("scheduled-delivery:ship-option-changed",{current:h,previous:g[d]}),g[d]=h)}});f(document).delegate(".ship-option.is-scheduled-delivery","click",function(){if(b.isSpc()){var h=f(this);h.find("input[type\x3d'radio']").attr("disabled")||(h=l.getSdWidgetRootId(h))&&a.trigger("scheduled-delivery:ship-option-changed",{current:h,previous:null})}});a.on("scheduled-delivery:unblock-continue",function(){q.when("button-blocker").execute(function(a){a.hide("scheduled-delivery")})});
a.on("scheduled-delivery:block-continue",function(a){q.when("button-blocker").execute(function(b){b.show("scheduled-delivery",a)})});a.on("scheduled-delivery:disable-ship-option",function(a,d){var e;a=f("#"+a);if(0!==a.length){if(b.isSpc())a=a.closest(".shipping-speed");else if(b.isSosp())a=a.closest("div.fake-label.a-box");else return;e=a.find("input[type\x3d'radio']");e.attr("disabled",!0);e.is(":checked")&&d&&(d=f("input[name\x3d"+e.attr("name")+"]:radio:not(:disabled):first"),d.prop("checked",
!0),d.trigger("change"));a.addClass("sd-disabled")}});a.on("scheduled-delivery:enable-ship-option",function(a){var d;a=f("#"+a);if(0!==a.length){if(b.isSpc())a=a.closest(".shipping-speed");else if(b.isSosp())a=a.closest("div.fake-label.a-box");else return;d=a.find("input[type\x3d'radio']");d.removeAttr("disabled");a.removeClass("sd-disabled")}})});"use strict";q.when("A","ready").register("mobile-nav-bar-back-controller",function(a){a.capabilities.history&&(a=a.$,a=a("#mobile-top-bar-navigation-back"),
1<=a.length&&a.click(function(a){a.preventDefault();n.history.back()}))});"use strict";q.when("A","page-spinner-controller","page-detector","page-conductor","weblab-helper","ready").execute(function(a,l,k,b,f){function g(a,b){var c=[];a.addressId||c.push("addressId");a.slotKey||c.push("slotKey");a.shippingOfferingId||c.push("shippingOfferingId");a.conflictItems&&!p.isArray(a.conflictItems)&&c.push("conflictItems");if(0<c.length){a="Error calling fresh widget callback on "+b+": Bad or Missing Input: "+
c[0];for(b=1;b<c.length;b++)a+=", "+c[b];console.error(a);return 0}return 1}function h(){p("#freshSlotKey").val("");p("#freshAddressId").val("");p("#freshReservationToCancel").val("");p("#freshConflictingItems").val("");p("#freshShipOfferingId").val("")}function d(a){var b="",c=f.sospPartialAvailabilityWeblabOn();if(a&&p.isArray(a)&&0<a.length)for(var b=a[0].asin+":"+a[0].merchantId+(c?"|"+a[0].maxQtyAvailable:""),d=1;d<a.length;d++)b+="-"+a[d].asin+":"+a[d].merchantId+(c?"|"+a[d].maxQtyAvailable:
"");return b}function e(a){var c;c="page\x3dspc\x26returnFullHTML\x3d1\x26callSetters\x3d1\x26freshSlotKey\x3d"+a.addressId;c+="\x26freshAddressId\x3d"+a.slotKey;a.reservationToCancel&&(c+="\x26freshReservationToCancel\x3d"+a.reservationToCancel);(a=d(a.conflictItems))&&(c+="\x26freshConflictingItems\x3d"+a);a=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});l.show();p.ajax({type:"POST",url:"/gp/buy/shared/handlers/handle-fresh-widget-results.html/ref\x3dset-fresh-information",data:c,dataType:"text",
async:!0,cache:!1,headers:a,success:function(a,c,d){return d.getResponseHeader("x-amz-checkout-page")?b.ajaxUpdatePage(a,c,d):b.redirect(a)},error:function(a,c,d){b.ajaxRedirect(a,c,d)}})}function c(){p(".sosp-continue-button").removeClass("js-hide").removeClass("aok-hidden");p(".continue-button-blocker").addClass("aok-hidden")}function m(){p(".sosp-continue-button").addClass("aok-hidden");p(".continue-button-blocker").removeClass("aok-hidden")}var p=a.$;a.on("handle-fresh-results",function(a){if(p("#isfresh").val())if(a)if(k.isSosp())if(g(a,
"sosp")){p("#freshSlotKey").val(a.slotKey);p("#freshAddressId").val(a.addressId);p("#freshReservationToCancel").val(a.reservationToCancel);var f=d(a.conflictItems);p("#freshConflictingItems").val(f);p("#freshShipOfferingId").val(a.shippingOfferingId);f&&0<f.length?p("input#block-prefetch").val(1):p("input#block-prefetch").val(0);f=p("#shippingOptionFormId");a.conflictItems&&0<a.conflictItems.length||b.makePrefetch(f);c()}else h(),m();else k.isSpc()?g(a,"spc")&&e(a):console.error("remote fresh widget JS callback called on unsupported page.");
else console.error("remote fresh widget JS callback called with empty data.");else console.error("remote fresh widget JS callback called without isfresh flag on page")});a.on("block-continue",function(a){p("#isfresh").val()?a?"undefined"===typeof a.blockContinue?console.error("block continue callback - missing blockContinue"):k.isSosp()?1===a.blockContinue?(m(),h()):0===a.blockContinue?c():console.error("block continue callback - invalid value"):console.error("block continue callback called on unsupported page."):
console.error("block continue callback called with no argument"):console.error("block continue callback called without isfresh flag on page")});a.on("confirm-and-continue",function(){p("div.sosp-fresh #shippingOptionFormId").submit()});a.on("redirect-to-spc",function(){b.redirect({conductoraction:{url:'/gp/buy/spc/handlers/display.html/ref\x3d"cancel-fresh-address-select"',type:"redirect"}})})});"use strict";q.when("A","ready").execute(function(a){function l(){(0<k(".change-preference-block").length||
0<k(".mobile-change-preference-block").length)&&!1===b&&(q.register("loadVasRcxCheckoutAsset",function(){}),b=!0)}var k=a.$,b=!1;l();a.on("checkout:reload:spc",l);a.on("checkout:reload:shipoptionselect",l);a.on("checkout:reload:spp-revieworder",l)});"use strict";q.register("time-left-formatter",function(){function a(a,b,f,g,h){return 0>=b?a:a+b+" "+(1===b?h.HOUR:h.HOURS)+(!g&&0<f?" "+h.AND+" ":"")}function l(a,b,f,g,h){return 0>=b?a:a+b+" "+(1===b?h.MINUTE:h.MINUTES)+(!g&&1>f?" "+h.AND+" ":"")+(1===
g&&1>f?" ":"")}return{getTimeLeftFormatted:function(k,b,f){var g="",h=86400<k?(k-k%86400)/86400:0,d=3600<k?(k-k%3600)/3600:0;k-=3600*d;var e=60<k?(k-k%60)/60:0;k-=60*e;if(b&&0<h)return g+h+" "+(1===h?f.DAY:f.DAYS);if(b&&0<d)return a(g,d,e,b,f);if(b&&5<=e)return l(g,e,d,b,f);g=a(g,d,e,b,f);g=l(g,e,d,b,f);1<=d||(g=g+k+" "+(1===k?f.SECOND:f.SECONDS));return g}}});"use strict";q.when("A","page-transition-controller","checkout-general-utils","page-detector","page-detector-current-page","safe-mash","loading-spinner-controller",
"weblab-helper").register("shipoptionselect-controller",function(a,l,k,b,f,g,h,d){function e(a){var b=r(".delivery-window-groups .more-window");h.showSpinner(b,!1);a=a.$currentTarget.closest(".delivery-window-groups").data("orderid");b=r("input[name\x3dlineItemEntityIds_"+a+"]").attr("value");r.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+b+"\x26orderid\x3d"+a+"\x26isMobile\x3d1\x26fromPage\x3dsosp",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},
success:function(a){h.hideSpinner();if(a&&a.deliveryWindowGroups){var b=r(".delivery-window-groups .a-box-group");b.empty();r.each(a.deliveryWindowGroups,function(a,c){b.append(c)});a=r(".delivery-window-groups .selected-group");a.length&&a.trigger("click")}}})}function c(a,b){var c=r("div.one-shipment:visible");a=J?r("div.one-shipment").slice(parseInt(a,10),parseInt(b,10)+1):r("div.one-shipment#"+a);v&&0!==a.size()&&c.last().attr("id")!==a.last().attr("id")&&(c.hide(),a.show(),r(n).scrollTop(0))}
function m(){if(v){var a=(location.hash?location.hash.replace("#",""):"0-"+y).split("-");2===a.length&&c(a[0],a[1])}}function p(){function e(a,b){r.ajax({type:"POST",url:"/gp/buy/gift/handlers/remove-gift-option.html",data:b,dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:a,error:function(a,b,c){l.hide()}})}function h(a){var b=a.closest("div."+p);a.is(":checked")?(b.siblings("div."+p+".selected").removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),
b.addClass("selected").find(".a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active")):b.removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");x("triggerChangeEvent",[a])}0<r(".prime-calendar-container").length&&r(".prime-calendar-container").contents().each(function(a,b){8===b.nodeType&&r(b).replaceWith(b.nodeValue)});var k=r(".delivery-window-groups .selected-group");
k.length&&k.trigger("click");t=r(".sosp-continue-button");v="1"===r("#isClientSidePagingEnabled").val()?1:0;y=(r("div.one-shipment:visible").length-1).toString();z="1"===r("#useMashNavigateForClientSidePaging").val()?1:0;J="1"===r("#collapseDigitalShipmentsEnabled").val()?1:0;var p=(k=n.P&&n.P.AUI_BUILD_DATE)?"selectable-box":"fake-label";v&&(r(".one-shipment:gt("+y+")").hide(),m());t.bind("click",function(e){function m(a,b){var c=f.getCurrentPage();if(n.history&&n.history.pushState){var d=location.href;
0<d.indexOf("#")&&(d=d.substring(0,d.indexOf("#")));d+="#"+a.attr("id")+"-"+b.attr("id");history.pushState({page:c,id:a.attr("id")},r("title"),d)}}var h=!1;r("div.one-shipment:visible input[type\x3d'radio'][checked]").each(function(){if(r(this).data("blockingOn"))return alert(r(this).data("blockingOn")),e.preventDefault(),h=!0,!1});if(h)return!1;if(d.removesGiftOptionOnRush()&&b.isMobile()&&null!=D){var t=r("div.one-shipment:visible"),k=t.find("input[type\x3d'radio']:checked").closest(".shipping-option");
if(0<t.find("input[type\x3dhidden][name\x3disGift]").length&&1==t.find("input[type\x3dhidden][name\x3disGift]").attr("value")&&1==k.data("nosupportforgiftoption"))return D.show(),!1}B();t=r("div.one-shipment:visible");k=t.nextAll("div.one-shipment:hidden");if(0<k.length){e.preventDefault();var p=k.first(),l=p;J&&(l=k.filter(".shipment-with-ship-options"),l=1<l.length?l.eq(1).prev():k.last());z&&g&&g.navigate?g.navigate({url:null,transitionEffect:"slide",successCallback:function(){m(p,l)},failCallback:function(a){}}):
m(p,l);c(p.attr("id"),l.attr("id"));a.trigger("active-shipment-changed")}K("logInlineCalMetrics",[t])});r(".gift-option-removal-cancel-button").bind("click",function(a){D.hide()});r(".gift-option-removal-confirm-button").bind("click",function(a){l.show();D.hide();a="lineItemsToRemoveGiftOptionFrom\x3d"+r("div.one-shipment:visible").find("input[name^\x3dlineItemEntityIds_]").attr("value");var b=r("div.one-shipment:visible"),c=b.nextAll("div.one-shipment:hidden");e(function(a,d,e){b.find("input[type\x3dhidden][name\x3disGift]").each(function(){r(this).remove()});
0<c.length?(t.click(),l.hide()):r(".checkout-page-form").submit()},a)});r(n).bind("popstate",function(a){b.isSosp()&&m()});r(document).delegate("div."+p,"click",function(a){a=r(this);a.find("input[type\x3d'radio']").trigger("change",["setActive"]);a.parent().hasClass("timeslot-picker")&&(a=a.find(".a-button-selected").length,t&&t.length&&(a?t.removeClass("a-button-disabled").addClass("a-button-primary").find("input").prop("disabled",!1):t.removeClass("a-button-primary").addClass("a-button-disabled").find("input").prop("disabled",
!0)))});var q;a.declarative("faster-than-same-day-sosp-save",["click","submit"],function(){var b="lineItemsToRemoveGiftOptionFrom\x3d"+q.closest(".one-shipment").find("input[name^\x3dlineItemEntityIds_]").attr("value");a.$("div.a-popover button.a-button-close").trigger("click");l.show();e(function(a,b,c){q.closest(".one-shipment").find(".isGift").each(function(){r(this).remove()});q.attr("checked",!0);h(q);l.hide()},b)});r(document).delegate("div."+p+" input[type\x3d'radio']","change",function(a,
b){a=r(this);if("setActive"===b&&!a.attr("disabled")&&d.removesGiftOptionOnRush()&&0<a.closest(".one-shipment").find(".isGift").length&&1==a.data("nosupportforgiftoption"))q=a,a.is(":checked")&&(b=a.closest("div."+p).siblings("div."+p+".selected").find('input[type\x3d"radio"]'),q.attr("checked",!1),b.attr("checked",!0)),setTimeout(function(){r("#faster-than-same-day-sosp-popover").trigger("click")},10);else{if("setActive"===b){if(a.attr("disabled"))return;a.attr("checked",!0)}if("disabling"===b)if(a.attr("disabled",
!0),a.is(":checked"))a.removeAttr("checked");else return;h(a)}});r("div."+p+" input[type\x3d'radio']:checked").change();r("h3").children().removeAttr("style");0===r("div."+p+".scheduled-delivery").length&&r("form.checkout-page-form").data("checkoutFormReady",!0).change();k&&r(document).delegate(".a-touch-radio a","click",function(a){if(!d.isSOSPExclusiveJSHandlerWeblabOn()||b.isSosp())g&&g.navigate?g.navigate({url:r(a.target).attr("href"),transition:"slide"}):a.preventDefault=!1});u("triggerInlineCalendar")}
function B(){if(1===r("div.store-upsell-ship-options").length){var a="/gp/buy/shared/handlers/store-upsell-async.html",b="ox_store_upsell_continue_",c=r("div.ship-speed, div.store-upsell-ship-options").find("input.shipping-option, input.store-upsell-ship-option"),d=[],e;r.each(c,function(a,c){a=r(c);c=a.attr("value");d.push(c.toLowerCase());a.is(":checked")&&(e=a.attr("value"),b=a.hasClass("store-upsell-ship-option")?b+"success":b+"failure")});a=k.addQueryStringParameter(a,"ref",b);r.ajax({url:a,
type:"POST",async:!0,data:{shown:d.toString(),clicked:e}})}}function u(b){q.when("shipoption-hnb-in-controller").execute("safe-hnb-in-wrapper",function(c){if(c&&!a.objectIsEmpty(c)&&"function"===typeof c[b])c[b]()})}function x(a,b){q.when("checkout-federation-wrapper","shipspeed-provider").execute(function(c,d){c.wrap(function(){d&&!r.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"VasCheckoutShipSpeedProvider")})}function K(a,b){q.when("checkout-federation-wrapper","sd-methods").execute(function(c,
d){c.wrap(function(){d&&!r.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"CricketInlineCalendarHeavyBulkyIN")})}var r=a.$,t,v,z,y,J=0,D;a.declarative("sosp-change-quantity-link",["click"],function(a){var b=a.$currentTarget,c=r("\x3cinput type\x3d'hidden' /\x3e").attr("name","change-quantities-or-delete").val("1");b.hasClass("pipeline-link")?(a.$event.preventDefault(),b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click")):
b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click").end().trigger("submit")});q.when("A","a-sheet").register("shipoptionselect-gift-removal-controller-mobile",function(a,b){D=b.create({name:"gift-removal-popover",height:200,preloadDomId:"gift-option-removal-message",closeType:"icon",sheetType:"web"})});a.declarative("sosp-extender-toggle",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("sosp-extender-toggle")){var b=
a.$target.closest("a"),c=r(".delivery-window-groups .a-box-group").find(".lazy-loaded");if(b.hasClass("aui-extender"))c.length?c.remove():e(a);else{var d=b.find("i"),b=b.closest("div.extender-section");d.hasClass("a-icon-extender-expand")?(b.find(".collapsed").hide(),b.find(".expanded").slideDown("fast"),d.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse"),e(a)):(b.find(".collapsed").show(),b.find(".expanded").slideUp("fast"),d.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"),
c.length&&c.remove())}}});a.declarative("sosp-select-prime-slot",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("sosp-select-prime-slot")){a=a.$currentTarget;var b=a.closest(".valid-slot");if(b.closest(".prime-calendar").hasClass("long-calendar")){var c=b.closest(".prime-calendar").data("orderid"),d=r("#calendar-"+c),c=r("#calendar-delivery-message-"+c),e=a.closest(".long-calendar");e.find(".selected-slot").removeClass("selected-slot");0<b.length&&b.addClass("selected-slot");r(".a-button-close").trigger("click");
b=a.data("slotid");b=d.find(".slot-"+b);if(0<b.length)d.show(),c.parent().hide(),b.closest(".prime-calendar").find(".selected-slot").removeClass("selected-slot"),b.closest(".valid-slot").addClass("selected-slot");else{var f=a.parent()[0],m=a.parent().parent().find(".rhead")[0],b=m.innerText;b||(b=m.textContent);f=f.cellIndex;e=e.find("th")[f];f=e.innerText;f||(f=e.textContent);c.text(f+" "+b);d.hide();c.parent().show()}}else c=b.closest(".prime-calendar-container").data("orderid"),d=r("#calendar-"+
c).find(".selected-slot"),0<d.length&&(d.removeClass("selected-slot"),0<b.length&&b.addClass("selected-slot"));d=a.closest(".prime-calendar-container").data("orderid");a.data("key")&&r("#order_"+d+"_ShippingSpeed").val(a.data("key"));a.data("isscheduleddeliveryslot")&&r("#sdData"+d).val(a.data("sddatastring"))}});a.declarative("sosp-select-delivery-window",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("sosp-select-delivery-window")){a=a.$currentTarget;a.length&&!a.hasClass("dwg-button")&&
(a=a.find(".dwg-button"));r(".dwg-button").removeClass("selected-dwg-button");a.addClass("selected-dwg-button");var b=a.closest(".delivery-window-groups").data("orderid"),c=a.data("key");!c&&a.find("button").length&&(c=a.find("button").data("key"));c&&r("#order_"+b+"_ShippingSpeed").val(c);c=a.data("isscheduleddeliveryslot");!c&&a.find("button").length&&(c=a.find("button").data("isscheduleddeliveryslot"));c&&(c=a.data("sddatastring"),!c&&a.find("button").length&&(c=a.find("button").data("sddatastring")),
r("#sdData"+b).val(c))}});a.on("checkout:reload:shipoptionselect",p);a.on("checkout:reload:spp-shipoption",p)});q.when("jQuery","page-detector").register("deliv-prefs-sosp",function(a,l){function k(){a(".sosp .order-delivery-time-preference").each(function(){var b=a(this);b.bind("selectionChanged",function(){0===b.find(".delivery-time-preference-group").length?b.hide():(b.show(),0===b.find("input:checked").length&&b.find("input:first").trigger("change",["setActive"]))}).bind("empty",function(){b.find(".delivery-time-preference-group").detach()});
var f=b.closest(".one-shipment").find("input.shipping-option");b.find(".delivery-time-preference-group").each(function(){var f=a(this),h=f.data("shippingoptionid"),h=a("#"+h);f.is(".template")&&f.detach().removeClass("template");h.change(function(){b.trigger("empty");f.appendTo(b);b.trigger("selectionChanged")}).addClass("hasDeliveryTimePreference")});f.not(".hasDeliveryTimePreference").change(function(f,h){"disabling"===h||a(this).is(":disabled")||(b.trigger("empty"),b.trigger("selectionChanged"))});
b.trigger("selectionChanged")})}q.when("A").execute(function(a){a.on("checkout:reload:shipoptionselect",k)})});q.when("A","shipoptionselect-controller").execute(function(a){var l=a.$,k={},b={};a.on("checkout:reload:shipoptionselect",function(){var a=l("#shippingOptionFormId"),g=a.find("input[name\x3dtrialKey]");if(1===g.length){for(var h in k)k.hasOwnProperty(h)&&(k[h].abort(),delete k[h]);k={};b={};var d=function(a){return a.join("::").replace(/\s+/g,"_")},e=function(){return l.map(a.find("input[type\x3dradio]:checked"),
function(a){return a.name})},c=function(){return l.map(a.find("input[type\x3dradio]:checked"),function(a){return a.value})},m=function(a,c){if(k.hasOwnProperty(a)||b.hasOwnProperty(a))return!1;console.debug('initiating ajax call for trial key "'+a+'"');c=l.ajax({type:"POST",url:"/gp/buy/shipoptionselect/handlers/launch-delivery-trial.html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},data:c,dataType:"json",async:!0,success:function(c){c?
console.debug('trial "'+a+'" success'):console.debug('trial "'+a+'" failed');b[a]=c;delete k[a]},error:function(b,c,d){delete k[a];"abort"!==d&&(console.debug("trial "+a+" error"),q.error("issue with set-delivery-options trial: "+c,d))},cache:!1});k[a]=c;return!0},p=function(){for(var a=c(),a=d(a),b=Object.keys(k),e=0;e<b.length;++e){var f=b[e];f!==a&&(console.debug('removing ajax call for trial key "'+f+'"'),k[f].abort(),delete k[f])}};l(document).delegate("#shippingOptionFormId","change",function(b){b=
c();if(d(b)!==g.val())a:{p(),b=e();var h=c(),k=d(h);g.val(k);var n=m(k,a.serialize()),k=0;n&&++k;for(var r=0;r<b.length;++r)for(var t=a.find('input[type\x3dradio][name\x3d"'+b[r]+'"][value!\x3d"'+h[r]+'"]'),v=0;v<t.length;++v){var z=t[v],n=h.slice(0);n[r]=z.value;for(var n=d(n),y=z.name,z=z.value,J=a.serializeArray(),D=0;D<J.length;++D)J[D].name===y&&(J[D].value=z),"trialKey"===J[D].name&&(J[D].value=n);y=l.param(J);if((n=m(n,y))&&5===++k)break a}}});l(document).delegate("#shippingOptionFormId","submit",
function(a){p()})}})});q.when("A","button-blocker","page-detector").register("scheduled-delivery-readiness-checker",function(a,l,k){function b(){k.isMobile()&&k.isSosp()&&h("div.scheduled-delivery").length&&(h(document).delegate("div."+e+":visible input[type\x3d'radio'].shipping-option","change",function(){g(h(this).closest("div."+e))}),a.on("active-shipment-changed",g))}function f(a){d||(a.hasClass("scheduled-delivery-loading")?d=a.find(".loading-tooltip").text():a.hasClass("scheduled-delivery-picking")&&
(d=a.find(".picking-tooltip").text()))}function g(a){d=null;a?f(a):h("div.one-shipment:visible div."+e+".scheduled-delivery").each(function(){var a=h(this);a.find("input").is(":checked")&&f(a)});d?l.show("scheduled-delivery",d):l.hide("scheduled-delivery")}var h=a.$,d,e=n.P&&n.P.AUI_BUILD_DATE?"selectable-box":"fake-label";if(k.isMobile())a.on("checkout:reload:shipoptionselect",b);return{check:g}});"use strict";q.when("A","quantity-service","page-conductor","page-detector","ajax-utility","page-transition-controller",
"gift-utility","client-side-metrics").register("gift-form-base-controller",function(a,l,k,b,f,g,h,d){function e(a){a.is(":checked")||(ca?a.is(":checked")||a.closest("label").click():(d.increaseCount("removeauijs4"),a.attr("checked",!0).trigger("change")))}function c(a){a.attr("disabled","disabled");ca&&a.closest("div").bind("click.disable",function(a){a.stopPropagation()})}function m(a){a.removeAttr("disabled");ca&&a.closest("div").unbind("click.disable")}function p(){q.when("a-dropdown").execute(function(a){var b=
w(".select-recipient");b.empty();for(var c=0;c<da.length;c++){var d=w("\x3coption/\x3e").attr({value:da[c].value}).text(da[c].text);b.append(d)}b.each(function(){var b=w(this).closest(".gift-connection-section"),c=b.find(".include-gift-connection-checkbox").is(":checked"),d=b.find(".item-id").val(),e=b.find(".item-giftlist-type-id").val(),f;!e||"0"!==e&&"1"!==e&&"2"!==e?e&&"3"===e&&(f=b.find(".item-giftlist-id").val()):f=e;!f&&c&&(c=b.find(".item-registry-id").val())&&Z&&Z[c]&&(f=Z[c]);f&&(a.setValue(w(this).attr("id"),
f),(e&&"1"===e||"2"===e)&&b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show(),z(d))})})}function B(){w(".gift-connection-recipient-section").unbind("click").bind("click",function(){if(!O)return w(this).find(".select-recipient-spinner").removeClass("aok-hidden").show(),!1});w(".select-recipient").each(function(){w(this).unbind("change").bind("change",function(){var a=w(this),b=a.next().find(".a-dropdown-prompt"),c=w("\x3cdiv/\x3e").html(a.find(":selected").text()).clone().html();
setTimeout(function(){b.html(c)},0)})});q.when("a-dropdown").execute(function(a){w(".gift-connection-section").each(function(){var b=w(this),c=b.find(".item-id").val(),d=b.find(".item-giftlist-type-id").val();b.find(".item-giftlist-id").val();var e=b.find(".item-occasion-id").val(),f=b.find(".item-occasion-month").val(),m=b.find(".item-occasion-day").val(),g=b.find(".item-age").val();b.find("#input-recipient-first-name-"+c).unbind("keyup").keyup(function(){z(c)});b.find("#input-recipient-last-name-"+
c).unbind("keyup").keyup(function(){z(c)});if("1"===d||"2"===d)a.setValue(b.find(".select-recipient").attr("id"),d),b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show();a.setValue(b.find(".select-occasion").attr("id"),e);a.setValue(b.find(".select-occasion-month").attr("id"),f);a.setValue(b.find(".select-occasion-day").attr("id"),m);a.setValue(b.find(".select-occasion-age").attr("id"),g);if("1"===e||"2"===e)b.find(".gift-connection-occasion-extra").removeClass("aok-hidden").show(),
"2"===d&&b.find(".select-occasion-age-row").removeClass("aok-hidden").show();"1"!==e&&"2"!==e&&"3"!==e&&z(c)})});var a="/gp/buy/pipeline/handlers/list-of-giftlists.html",b=w(".item-registry-id").map(function(){if(w(this).val())return w(this).val()}).get().join();b&&(a+="?fromRegistryIds\x3d"+b);da?(p(),w(".select-recipient-spinner").hide(),O=!0):(O=!1,w.ajax({type:"POST",url:a,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(a){!da&&a.options&&0<a.options.length&&(da=a.options);a.registryIdMapping&&
(Z=a.registryIdMapping);da&&p();w(".select-recipient-spinner").hide();O=!0},error:function(a,b,c){w(".select-recipient-spinner").hide();O=!0}}))}function u(){X=[];a.state("giftNotificationEmailConstraints",[]);a.state("giftDeliveryDateConstraints",[]);w('[data-action\x3d"gift-form-element"]').each(function(){var a=w(this);a.is("span")?a.find("input, textarea, select:first").trigger({type:"change",isInit:!0}):a.trigger({type:"change",isInit:!0})});w("textarea").unbind("keyup.gift-textarea click.gift-textarea").bind("keyup.gift-textarea click.gift-textarea",
function(){w(this).trigger("change")});0<w(".enable-gift-connections").length&&B()}function x(a,b){var c=31;if("1"===b)c=0===a%4&&0!==a%100||0===a%400?29:28;else if("3"===b||"5"===b||"8"===b||"10"===b)c=30;return c}function K(a,b,c){a=f.jsonify(a);k.redirect(a)}function r(a){q.when("a-dropdown").execute(function(b){w(".gift-connection-recipient-extra-"+a).hide();b.setValue("select-recipient-"+a,"0");w("#input-recipient-first-name-"+a).val("");w("#input-recipient-last-name-"+a).val("")})}function t(a){q.when("a-dropdown").execute(function(b){w(".gift-connection-occasion-extra-"+
a).hide();b.setValue("select-occasion-"+a,"0");b.setValue("select-occasion-month-"+a,"0");b.setValue("select-occasion-day-"+a,"0");b.setValue("select-occasion-age-"+a,"-1");w("#occasion-has-reminder-checkbox-"+a).attr("checked",!0)})}function v(a,b){q.when("a-dropdown").execute(function(c){for(var d=0;d<da.length;d++)b&&b===da[d].value&&da[d].bMonth&&da[d].bDay&&(c.setValue("select-occasion-month-"+a,da[d].bMonth),c.setValue("select-occasion-day-"+a,da[d].bDay))})}function z(a){q.when("a-dropdown").execute(function(b){var c=
w("#select-recipient-"+a).find(":selected").val();"0"!==c&&("1"!==c&&"2"!==c||w("#input-recipient-first-name-"+a).val()||w("#input-recipient-last-name-"+a).val())?b.updateSelect("select-occasion-"+a,{status:"enabled"}):(t(a),b.updateSelect("select-occasion-"+a,{status:"disabled"}))})}function y(a,b,c){"1"===b&&"2"===c?w("#select-occasion-age-row-"+a).removeClass("aok-hidden").show():w("#select-occasion-age-row-"+a).hide()}function J(){var a=w("#hidePricesCheckbox"),b=w("#kindle-reg-radio-your-account");
ca?b.is(":checked")?w("#kindle-reg-radio-another-account").closest("label").click():a.is(":checked")||a.closest("label").click():(d.increaseCount("removeauijs6"),a.is(":checked")||a.attr("checked","checked").trigger("change"),b.is(":checked")&&(b.removeAttr("checked").trigger("change"),w("#kindle-reg-radio-another-account").attr("checked","checked").trigger("change")))}function D(){var a=w("#hidePricesCheckbox"),b=w("#kindle-reg-radio-another-account");ca?b.is(":checked")?w("#kindle-reg-radio-your-account").closest("label").click():
a.is(":checked")&&a.closest("label").click():(d.increaseCount("removeauijs7"),a.is(":checked")&&a.removeAttr("checked").trigger("change"),b.is(":checked")&&(b.removeAttr("checked").trigger("change"),w("#kindle-reg-radio-your-account").attr("checked","checked").trigger("change")))}function F(){w("#hidePricesCheckboxLabel").hide();var a=w("#hidePricesCheckbox");ca&&(a.is(":checked")||a.closest("label").click());a.attr("disabled",!0).hide().trigger("change");w("#kindle-reg-radio-another-account").attr("disabled",
!0).trigger("change");w("#kindle-reg-radio-your-account").attr("disabled",!0).trigger("change");w("#hidePricesDisabledMessage").show();w("#hidePricesDisabledMessage").removeClass("aok-hidden");ca&&(w("label.a-touch-checkbox.hide-prices-checkbox").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}),w("label.a-touch-radio.kindle-reg-option").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}))}function L(a){var b=!1;w(".afn-wrap-checkbox").each(function(){var a=
w(this),a=a.is("input")?a:a.find("input");if(a.is(":checked"))return b=!0,!1});w(".mfn-no-wrap-radio").each(function(){var a=w(this),a=a.is("input")?a:a.find("input");if(!a.is(":checked"))return b=!0,!1});if(b)J(),F();else if(w("#hidePricesCheckbox").is(":disabled"))w("#hidePricesCheckboxLabel").show(),w("#hidePricesCheckbox").removeAttr("disabled").show().trigger("change"),w("#kindle-reg-radio-another-account").removeAttr("disabled").trigger("change"),w("#kindle-reg-radio-your-account").removeAttr("disabled").trigger("change"),
w("#hidePricesDisabledMessage").hide(),ca&&(w("label.a-touch-checkbox.hide-prices-checkbox").removeClass("a-touch-selector-disabled").unbind("click.disable"),w("label.a-touch-radio.kindle-reg-option").removeClass("a-touch-selector-disabled").unbind("click.disable"));else if(a.is("input")||(a=a.find("input")),"hidePricesCheckbox"===a.attr("id"))a.is(":checked")?J():D();else if("kindle-reg-radio-another-account"===a.attr("id")||"kindle-reg-radio-your-account"===a.attr("id"))w("#kindle-reg-radio-your-account").is(":checked")?
D():J()}function P(a){var b=w("#giftwrap-carousel-wrap-pane-"+a+" ul li").size();b&&(w("#giftwrap-carousel-wrap-holder-"+a).css("width",90*b),w("#giftwrap-carousel-wrap-pane-"+a).css("width",360));G(a)}function G(a){w("#giftwrap-carousel-wrap-holder-"+a).find("ul li, ol li").each(function(b,c){b=w(c);b.find("input").is(":checked")&&M(b,{itemId:a})})}function M(a,b){a.parent().find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".giftwrap-carousel-item-image").addClass("selected-giftwrap-image");
a.parent().find(".wrap.a-button-selected").removeClass("a-button-selected");a.addClass("a-button-selected");var c=b.itemId;b=b.wrapNo;var d=k.isSPP();if(a.hasClass("noshi-wrap")&&!a.hasClass("none-wrap")){k.isSPP();var e="#item-"+c;w("#gift-message-noshi-warning-"+c).removeClass("aok-hidden");w("#includeMessageCheckbox-"+c).attr("disabled","disabled");aa()?(w("#afn-message-span-"+c,w(e)).addClass("aok-hidden"),w("#gift-message-"+c).addClass("aok-hidden")):(w("#afn-message-span",w(e)).removeClass("enable-message-area").addClass("disable-message-area"),
w("#message-area-"+c).attr("disabled","disabled"))}else e="#item-"+c,aa()&&(w("#afn-message-span-"+c,w(e)).removeClass("aok-hidden"),w("#gift-message-"+c).removeClass("aok-hidden")),w("#gift-message-noshi-warning-"+c).addClass("aok-hidden"),w("#afn-message-span",w(e)).removeClass("disable-message-area").addClass("enable-message-area"),w("#includeMessageCheckbox-"+c).removeAttr("disabled"),w("#message-area-"+c).removeAttr("disabled");e=a.find("input[type\x3dradio]");e.attr("checked",!0);d||(d=a.data("giftwrap-id"),
e.val(d).change());var d=a.data("wrap-no"),e=w("#giftwrap-option-preview-imagearea-default-"+c),f=w("#giftwrap-option-preview-imagearea-image-"+c),m=w(".selectedWrapLargeLink","#item-"+c),c=w(".wrapNo-"+c+"-"+b);a.hasClass("none-wrap")?(e.removeClass("aok-hidden"),f.addClass("aok-hidden"),m.length&&(m.addClass("aok-hidden"),m.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),f.find("img").attr("src",a),e.addClass("aok-hidden"),f.removeClass("aok-hidden"),m.length&&(m.addClass("aok-hidden"),
m.removeClass("selectedWrapLargeLink")),c.length&&(c.addClass("selectedWrapLargeLink"),c.removeClass("aok-hidden")));a=w(".selectedWrapLargeLink");c=w(".larger-image-link-carousel-"+d);a.removeClass("selectedWrapLargeLink").addClass("aok-hidden");c.removeClass("aok-hidden").addClass("selectedWrapLargeLink")}function Q(a,b){var c;c=b.itemId;b=w("#giftwrap-option-preview-imagearea-default-"+c);c=w("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):
(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function V(a,b){var c=b.itemId;b=w("#giftwrap-option-preview-imagearea-default-"+c);c=w("#giftwrap-option-preview-imagearea-image-"+c);if(a.parent().find(".selected-giftwrap-image").parents("li").hasClass("none-wrap"))b.removeClass("aok-hidden"),c.addClass("aok-hidden");else{var d=".selected-giftwrap-image img";k.isSPP()&&(d="img.selected-giftwrap-image");a=a.parent().find(d).attr("src");
c.find("img").attr("src",a);b.addClass("aok-hidden");c.removeClass("aok-hidden")}}function E(a,b){var c=a.find(".empty-message-warning"),d=a.find(".no-receipt-warning"),e=a.find("textarea");a=a.find(".message-counter");b&&!d.is(":visible")?(a.hide(),c.show(),e.addClass("gift-warning")):(c.hide(),e.removeClass("gift-warning"),a.show())}function C(a){var b=w("#"+a.id),c=h.getCharCount(b.val(),a.useByteSize),b=h.getLineCount(b.val(),a.maxChars/a.maxLines);return{length:c,charDelta:a.maxChars-c,lineDelta:a.maxLines-
b}}function W(a,b){b=w("#item-"+b.itemId);var c=a.is(":checked")&&!a.hasClass("mfn-no-wrap-radio");aa()&&(c=!a.hasClass("mfn-no-wrap-radio"));c?(b.find(".gift-message-pslip").hide(),b.find(".gift-message-card").show()):(b.find(".gift-message-card").hide(),b.find(".gift-message-pslip").show())}function aa(){return k.isSPP()&&w("#carouselGiftWrap").length}function Y(b,c){var d=c.itemId;c=k.isSPP()?c.currentTab:b.data("current-tab");var e=w("#afn-gift-options-wrapper-"+d).data("active-tab");c!==e&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),
b.addClass("selected-giftwrap-tab"),w("#afn-gift-options-wrapper-"+d).data("active-tab",c),b="#item-"+d,e=k.isSPP()?w("#giftwrap-carousel-wrap-holder-"+d,b):b,e.length&&a.trigger("checkout:gift:changeCarouselWrapOptions",e,c,d),c=w(".none-wrap",w(b)).find("input"),c.prop("checked",!0),c.val("").change(),k.isSPP()?(c=w("#afn-gift-options-wrapper-"+d),c.length&&(c=c.data("active-tab"),a.trigger("checkout:gift:adaptCarouselGiftPanel",d,c))):a.trigger("checkout:gift:adaptCarousel",d),w("#giftwrap-carousel-wrap-holder-"+
d).removeClass("a-button-selected").find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),w("#giftwrap-carousel-item-image-"+d).addClass("selected-giftwrap-image").parents(".wrap").addClass("a-button-selected"),w("#giftwrap-option-preview-imagearea-default-"+d).removeClass("aok-hidden"),w("#giftwrap-option-preview-imagearea-image-"+d).addClass("aok-hidden"),c=w(".selectedWrapLargeLink"),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")),c=k.isSPP(),b="#item-"+
d,w("#gift-message-noshi-warning-"+d).addClass("aok-hidden"),w("#includeMessageCheckbox-"+d).removeAttr("disabled"),c?w("#afn-message-span-"+d,w(b)).removeClass("aok-hidden"):(w("#afn-message-span",w(b)).removeClass("disable-message-area").addClass("enable-message-area"),w("#gift-message-heading-"+d).removeClass("disable-message-area").addClass("enable-message-area"),w("#message-area-"+d).removeAttr("disabled")))}var X,da,O=!1,Z,w=a.$,ca=n.P&&n.P.AUI_BUILD_DATE&&b.isMobile(),ba=h.getInput;a.declarative("save-gift-for-later",
["click"],function(a){g.show();a=a.$currentTarget.data("entityId")||a.data.entityId;l.call(a,0,{success:K})});var ga={toggleGiftDataAndDeliveryOptions:function(a){a=a.closest(".gift-options-wrapper");var b=ba(a.find(".includeMessageCheckbox"));b&&b.is(":checked")?(a.find(".gift-delivery-option").show(),a.find(".item-wrap-span").show(),a.find(".item-wrap-row").show(),a.find(".item-gift-message-span").show()):(a.find(".gift-delivery-option").hide(),a.find(".item-wrap-span").hide(),a.find(".item-wrap-row").hide(),
a.find(".item-gift-message-span").hide())},toggleGiftDeliveryOptions:function(a){var b=a.closest(".gift-options-wrapper");a.is("input[type\x3dcheckbox]")?a.is(":checked")?b.find(".gift-notification-email").removeClass("a-form-disabled"):b.find(".gift-notification-email").addClass("a-form-disabled"):(b.find(".gift-notification-email").removeClass("a-form-disabled"),a=b.find(".includeMessageCheckbox"),e(a.find("input[type\x3dcheckbox]")),ca&&(a=a.find("i.a-icon"),a.length&&(a.removeClass("a-icon-checkbox-inactive"),
a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-checkbox-active"),a.addClass("a-icon-touch-checkbox-active"))))},initGiftNotificationEmail:function(b){var c=a.state("giftNotificationEmailConstraints");c.push({id:b.attr("id")});a.state("giftNotificationEmailConstraints",c)},initGiftDeliveryDate:function(b){var c=a.state("giftDeliveryDateConstraints");b.hasClass("year-select")||(b=b.parents("div.del-opt-date-section").find("select.year-select:first"));c.push({id:b.attr("id")});a.state("giftDeliveryDateConstraints",
c)},updateDateDropdown:function(a){var b=a.closest(".gift-options-wrapper");a=b.find(".month-select").val();var c=b.find(".day-select");c.val();var b=b.find(".year-select").val(),d=x(b,a);if(c.hasClass("a-native-dropdown"))q.when("a-dropdown").execute(function(a){a=a.getSelect(c);if(a.getOptions().size()>d)for(var b=a.getOptions().size()-1;b>=d;b--)a.removeOption(b);else for(b=a.getOptions().size();b<d;b++)a.addOption({text:b+1,value:b+1},b)});else{if(c.find("option").length>d)c.find("option:gt("+
(d-1)+")").remove();else for(a=c.find("option").length+1;a<=d;a++)c.append(w("\x3coption\x3e",{value:a}).text(a));c.trigger("change")}},initSelectedTabAndWrapHolderWidth:P,initGiftMessage:function(a,b){ca&&!a.is("textarea")&&(a=a.find("textarea"));X.push({id:a.attr("id"),maxChars:parseInt(b.maxChars,10),maxLines:parseInt(b.maxLines,10),useByteSize:b.useByteSize});ba(a.closest(".gift-options-wrapper").find(".includeMessageCheckbox")).is(":checked")||a.addClass("a-form-disabled");"1"===w("#multipleAFNGiftWrapOption").val()&&
(a=a.attr("id").substring(a.attr("id").lastIndexOf("-")+1,a.attr("id").size),P(a))},enforceSelectorParity:L,enforceGiftReceiptParity:function(a,b){a=w("#item-"+b.itemId);if(0!==a.length){b=a.find(".item-receipt-row label");var d=ba(a.find(".includeReceiptCheckbox")),f=a.find(".mfn-hide-price-row label"),g=ba(a.find(".mfnHidePriceCheckbox")),h=a.find(".item-message-row label"),t=ba(a.find(".includeMessageCheckbox")).is(":checked"),k=!1;0<a.find(".afn-wrap-checkbox").length?ba(a.find(".afn-wrap-checkbox")).is(":checked")&&
(k=!0):0<a.find(".mfn-no-wrap-radio").length&&(ba(a.find(".mfn-no-wrap-radio")).is(":checked")||(k=!0));if(k||t)e(d),e(g);k||t&&h.is(":visible")?(c(d),b.addClass("checkout-gift-option-disabled"),c(g),f.addClass("checkout-gift-option-disabled")):(m(d),m(g),b.removeClass("checkout-gift-option-disabled"),f.removeClass("checkout-gift-option-disabled"))}},enforceHidePriceParity:function(a){var b=!1;w(".includeReceiptCheckbox").each(function(){if(ba(w(this)).is(":checked"))return b=!0,!1});var c=!1;w(".mfnHidePriceCheckbox").each(function(){if(ba(w(this)).is(":checked"))return c=
!0,!1});b||c?(J(),w(".kindle-reg-msg-your-account").hide(),w(".kindle-reg-msg-another-account").show()):(D(),w(".kindle-reg-msg-another-account").hide(),w(".kindle-reg-msg-your-account").show())},toggleNoReceiptWarning:function(a){var b=ba(a).is(":checked"),c=a.closest(".gift-options-wrapper");a=c.find(".no-receipt-warning");var f=c.find(".empty-message-warning"),c=c.find(".item-message-row").find(".includeMessageCheckbox"),m=ba(c);b?(a.hide(),c.is(":visible")||e(m)):(f.hide(),a.show(),m.is(":checked")&&
(ca?m.is(":checked")&&m.closest("label").click():(d.increaseCount("removeauijs5"),m.removeAttr("checked").trigger("change"))))},toggleMessageArea:function(a){var b=a.closest(".gift-options-wrapper");if(a.is("textarea"))b=ba(b.find(".includeMessageCheckbox")),e(b);else{a=ba(b.find(".includeMessageCheckbox")).is(":checked");var c=b.find(".item-message-row label").is(":visible"),d=0<b.find(".empty-message-warning").length,f=b.find("textarea"),m=f.data("default-text"),g=0<f.val().length;a?(b.find(".gift-message-edit").show(),
b.find(".gift-message-label").removeClass("a-color-secondary"),f.removeClass("a-form-disabled"),m&&f.val(m)):(c&&b.find(".gift-message-edit").hide(),b.find(".gift-message-label").addClass("a-color-secondary"),f.addClass("a-form-disabled"),m&&f.val(""));d&&(a&&g?E(b,!1):E(b,!0))}},toggleMessageLocationText:W,toggleMessageBoxDisplay:function(b,d){var f=w("#item-"+d.itemId);if(0!==f.length){var g=f.find(".item-message-row");d=f.find(".item-receipt-row");var h=f.find(".gift-message-on-card"),t=f.find(".gift-message-on-receipt"),
k=g.find("label"),g=ba(g.find(".includeMessageCheckbox")),p=a.trim(f.find(".gift-message-default-placeholder").text()),l=a.trim(f.find(".gift-message-with-wrap-placeholder").text()),f=f.find("textarea"),v=b.hasClass("mfn-no-wrap-radio")||b.closest("div").hasClass("mfn-no-wrap-radio");ba(b).is(":checked")&&!v?(t.hide(),h.show(),f.attr("placeholder",l),d.is(":visible")&&(e(g),k.is(":visible")&&(c(g),k.addClass("checkout-gift-option-disabled")))):(h.hide(),t.show(),f.attr("placeholder",p),m(g),k.removeClass("checkout-gift-option-disabled"))}},
updateContinueButtons:function(){for(var b=!0,c,d=0;d<X.length;d++)if(c=w("#"+X[d].id),c.closest(".gift-options-wrapper").find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]').is(":checked")&&(c=C(X[d]),0>c.charDelta||0>c.lineDelta))b=!1;b?(w(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").show(),w(".save-gift-button-box span.a-button-disabled").hide()):(w(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").hide(),b=w(".save-gift-button-box span.a-button-disabled"),
b.removeClass("aok-hidden"),b.show());a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},updateMessageCounter:function(a){ca&&!a.is("textarea")&&(a=a.find("textarea"));for(var b,c=0;c<X.length;c++)a.attr("id")===X[c].id&&(b=C(X[c]));if(b){a=a.closest(".gift-options-wrapper");c=a.find(".message-counter");c.find(".remaining-count").hide();if(0<a.find(".empty-message-warning").length){if(0===b.length){E(a,!0);return}E(a,!1)}(-1>b.charDelta?c.find(".remaining-char-over-multiple").show():
0>b.charDelta?c.find(".remaining-char-over-single").show():1===b.charDelta?c.find(".remaining-char-single").show():c.find(".remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(b.charDelta));(-1>b.lineDelta?c.find(".remaining-line-over-multiple").show():0>b.lineDelta?c.find(".remaining-line-over-single").show():1===b.lineDelta?c.find(".remaining-line-single").show():c.find(".remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(b.lineDelta));c.show()}},updateSelectedGiftWrap:M,
clearGiftConnection:function(a,b){w("#include-gift-connection-checkbox-"+b.itemId).is(":checked")||(r(b.itemId),z(b.itemId))},toggleGiftConnectionAgeDropdown:y,toggleGiftConnectionRecipientArea:function(a,b){a=w("#select-recipient-"+b.itemId).find(":selected").val();var c=w("#select-occasion-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?(w(".gift-connection-recipient-extra-"+b.itemId).hide(),"1"===c&&a&&v(b.itemId,a)):w(".gift-connection-recipient-extra-"+b.itemId).removeClass("aok-hidden").show();
y(b.itemId,c,a);z(b.itemId)},toggleGiftConnectionOccasionArea:function(a,b){a=w("#select-occasion-"+b.itemId).find(":selected").val();var c=w("#select-recipient-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?w(".gift-connection-occasion-extra-"+b.itemId).hide():("1"===a&&c&&"1"!==c&&"2"!==c&&v(b.itemId,c),w(".gift-connection-occasion-extra-"+b.itemId).removeClass("aok-hidden").show());y(b.itemId,a,c)},includeGiftConnection:function(a,b){(a=w("#select-recipient-"+b.itemId).find(":selected").val())&&
"0"===a||w("#include-gift-connection-checkbox-"+b.itemId).attr("checked",!0)},updateGiftOptionsTabSelection:Y,updatePreviewImageOnMouseEnter:Q,updatePreviewImageOnMouseLeave:V,toggleGiftMessageWarning:function(a){var b=w("#"+a.attr("id"));h.toggleGiftMessageWarning(b,a.closest(".item-gift-message-span"))}};a.declarative("gift-form-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(ga[b[c]])ga[b[c]](a.$target,a.data)});a.declarative("gift-form-element",
"click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(ga[b[c]])ga[b[c]](a.$currentTarget,a.data,a)});a.declarative("select-gift-wrap","click",function(a){M(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapNo});L(a.$target);var b=a.$target.parents("li").find(".gift-hidden-radio");W(b,{itemId:a.data.itemId})});a.declarative("select-gift-wrap","mouseenter",function(a){Q(a.$target.parents("li"),
a.data)});a.declarative("select-gift-wrap","mouseleave",function(a){V(a.$target.parents("li"),a.data)});a.declarative("update-gift-options-tab-selection",["click"],function(a){var b=a.$target.parents("li");b.attr("data",a.data);Y(b,a.data)});a.on("checkout:reload:giftselect",u);a.on("checkout:reload:spp-giftoptions",u);return{extendFunctions:function(a){w.extend(ga,a)}}});"use strict";q.when("A","page-transition-controller","page-conductor").register("gift-form-del-opt-controller",function(a,l,k){function b(a){var b=
a.closest(".expando-box");b&&(b=b.find(".a-expander-header"),a.closest(".expando-content").is(":hidden")&&b.click())}function f(a){var b=a.closest(".gift-options-wrapper"),d=b.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(d&&!d.is(":checked"))return!0;d=b.find(".email-error-selector");b.find(".gift-notification-email-error").hide();d.removeClass("a-form-error");if(64<n.unescape(encodeURIComponent(a.val())).length)return d.addClass("a-form-error"),b.find(".gift-notification-email-length-exceeded-error").removeClass("aok-hidden").show(),
!1;if(/^\S+[@]\S+[.]\S+$/.test(a.val()))return!0;d.addClass("a-form-error");b.find(".gift-notification-invalid-email-error").removeClass("aok-hidden").show();return!1}function g(){d("#giftForm").find(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").unbind("click").bind("click",function(a){a.preventDefault();h(a)});d(".checkout-gift-image-preview-trigger \x3e a").show();d("#gift-kindle-imb").show()}function h(e){e=d("#giftForm");var c=e.find('input[name\x3d"hidePrices"]'),m=c.is(":disabled");
m&&c.removeAttr("disabled");for(var g=!0,h=a.state("giftNotificationEmailConstraints"),u=a.state("giftDeliveryDateConstraints"),x=0;x<h.length;x++){var n=d("#"+h[x].id);f(n)||(g=!1,b(n))}for(h=0;h<u.length;h++){x=d("#"+u[h].id);var n=x.closest(".gift-options-wrapper"),r=n.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(r&&!r.is(":checked"))n=!0;else{var t=n.find(".month-select").val(),v=n.find(".day-select").val(),r=n.find(".year-select"),z=r.val(),y=n.find("#current-date").val().split("-"),
t=new Date(z,t,v),y=new Date(y[0],y[1]-1,y[2]),v=new Date(y.getTime());v.setMonth(v.getMonth()+12);n.find(".gift-delivery-date-error").hide();z=n.find(".date-error-selector");r=r.hasClass("a-native-dropdown")?"error-border a-form-error":"a-form-error";z.removeClass(r);t>=v||t<y?(n.find(".gift-delivery-date-error").removeClass("aok-hidden").show(),z.addClass(r),n=!1):n=!0}n||(g=!1,b(x))}a.state("continueAction",{enable:g});if(a.state("continueAction").enable)k.isSPP()||l.showPageTransition(),e.submit();
else return d("html, body").animate({scrollTop:d(".a-form-error").closest("div").offset().top},500),!1;m&&c.attr("disabled",!0)}var d=a.$;a.declarative("submit-gift-options","click",function(a){h(a)});a.declarative("discard-gift-options","click",function(a){d('#giftForm input[type\x3d"checkbox"]').prop("checked",!1);d("#giftForm textarea").addClass("a-form-disabled");h(a)});a.on("checkout:reload:giftselect",g);a.on("checkout:reload:spp-giftoptions",g)});"use strict";q.when("A").register("teen-message-controller",
function(a){var l=a.$;a.declarative("teen-message-form-element","click keyup",function(a){a=a.data.maxChars;var b=l("#teen-message-box").val(),f=b.match(/(\r\n|\n|\r)/g),g=0;f&&(g=f.length);b=b.length+g;l(".remaining-char").text(Math.max(a-b,0))});l("#aui-teen-message-box").length&&l(".remaining-char").length&&q.when("A").execute(function(a){function b(a){a=a.val();var b=(a.match(/(\r\n|\n|\r|\n\r)/g)||{}).length||0;return a.length+b}a=a.$;var f,g,h;f=a("#aui-teen-message-box");f.bind("change keypress",
function(a){return b(f)>=h?(a.preventDefault(),!1):!0});f.bind("paste",function(a){if(a&&a.originalEvent&&a.originalEvent.clipboardData&&a.originalEvent.clipboardData.getData("Text")){var e=a.originalEvent.clipboardData.getData("Text"),c=b(f);if(c+e.length>=h)return e=e.substring(0,h-c),e=f.val()+e,f.attr("value",e),a.preventDefault(),!1}return!0});f.bind("click keyup",function(){var a=Math.max(h-b(f),0);g.text(a)});g=a(".remaining-char");h=f.parent().data("maxchars")})});"use strict";q.when("A",
"page-transition-controller","page-conductor","loading-spinner-controller","client-side-metrics").register("concealment-form-del-opt-controller",function(a,l,k,b,f){function g(a){var b=d("#concealmentForm");b.find("input:checked").length?(a=a.data.saveConcealmentRefTag,f.increaseCount("CPEX.Checkout.Select.Concealment",1)):(a=a.data.cancelConcealmentRefTag,f.increaseCount("CPEX.Checkout.Cancel.Concealment",1));b.find("input[name\x3dref]").val(a);b.attr("action",b.attr("action")+"/ref\x3d"+a)}function h(a){a=
d("#concealmentForm");k.isSPP()||l.showPageTransition();a.submit()}var d=a.$;a.declarative("submit-concealment-options","click",function(a){g(a);h(a)});a.declarative("discard-concealment-options","click",function(a){d('#concealmentForm input[type\x3d"checkbox"]').prop("checked",!1);g(a);h(a)});a.declarative("submit-concealment-form","click",function(a){g(a);a.$target.closest(".a-button").addClass("a-button-disabled");b.showSpinner(a.$target.closest("form"))})});"use strict";q.when("A","page-transition-controller",
"page-conductor","address-popovers","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("itemselect-address-controller",function(a,l,k,b,f,g,h,d){function e(){B(".lineitem").each(function(a,b){a=B(b);a.find(".no-js-address-dropdown").remove();a.find(".no-js-address-select").remove();a.find(".js-address-dropdown").prop("disabled",!1);a.find(".address-dropdown").removeClass("a-button-disabled")});B("#suppressAddAddressPopover").val()&&B('select[name^\x3d"addressID."]').find("option").each(function(){var a=
B(this);"New"===a.val()&&a.closest("optgroup").remove()})}function c(a){var b=(new Date).getTime(),c=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});B.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+b,data:a,dataType:"text",headers:c,error:k.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");if(null!==d&&void 0!==d)n.location=d;else if(m(c)){p(a,c);var e;a=r.find('input[name^\x3d"previousAddress."]');
if(null!==a||void 0!==a)e=x||a.val();var g=r.find('select[name^\x3d"addressID."]');null===g&&void 0===g||q.when("a-dropdown").execute(function(a){a.setValue(g.attr("id").replace(/\./g,"\\."),e);g.find("option").removeAttr("selected");g.find('option[value\x3d"'+e+'"]').attr("selected","selected")});l.hide()}else k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function m(a){a=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==a&&void 0!==
a}function p(a,b){b=b.getResponseHeader("x-amz-checkout-show-addon-warning");B(".item-list").hide();a.trim().split(",").forEach(function(a){B('[data-asin\x3d"'+a+'"]').show()});a=B("#addon-warning-"+b+"-launcher");a.length&&(B(".delete-title").hide(),B(".reduce-title").hide(),B(".select-address-title").show(),B("input[name\x3duseLiveAUI]").length?g.get(a).attrs({$trigger:K,position:"triggerHorizontal"}).show():(b=B.Event("keyup",{triggerPositioningElement:K,manualTrigger:!0}),a.trigger(b)))}var B=
a.$,u,x,K,r;a.declarative("itemselect-get-address",["click","touchend"],function(a){f.protectAgainstDoubleAction("itemselect-get-address",200)||(x=a.$currentTarget.find(".js-address-dropdown").val())});a.declarative("itemselect-update-address",["change"],function(a){if(!f.protectAgainstDoubleAction("itemselect-update-address",200)){h.resetMetrics();var d=a.$currentTarget.is("select")?a.$currentTarget:a.$currentTarget.find("select");u=d.val();if("New"===u)b.actionTriggerPopoverFromDropdown(a),q.when("a-dropdown").execute(function(a){a.setValue(d.attr("id").replace(/\./g,
"\\."),x)});else{l.show();r=d.closest(".lineitem");var e,m;if(r){var g=r.find('input[name^\x3d"lineItemEntityID."]');g&&(e=g.val());(g=r.find('input[name^\x3d"quantity."]'))&&(m=g.val());(g=r.find(".js-address-dropdown"))&&(u=g.val())}K=a.$currentTarget.is("select")?a.$currentTarget.closest(".address-dropdown"):a.$currentTarget;a=0;g=B("#addon-indicator");g.length&&"true"===g.attr("data-has-addon-items")&&(a=1);c({lineitems:e,addresses:u,quantities:m,isTrial:a})}}});a.declarative("itemselect-update-pantry-address",
["change"],function(a){if(!f.protectAgainstDoubleAction("itemselect-update-pantry-address",200)){u=a.$currentTarget.val();l.show();var b="";a=a.$currentTarget.closest(".pantry-row");B(a).find(".pantry-item").each(function(a,c){a=B(c);b+="lineitems\x3d"+a.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26";b+="addresses\x3d"+u+"\x26";b+="quantities\x3d"+a.find('input[name^\x3d"quantity."]').val()+"\x26"});c(b)}});a.declarative("addon-delete-items",["click","touchend"],function(a){if(void 0!==
K&&null!==K&&!f.protectAgainstDoubleAction("itemselect-delete-addons",200)){B(".a-button-close").trigger("click");l.show();a=(new Date).getTime();var b=B("#useCase").val(),c=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"}),d=r.find('input[name^\x3d"lineItemEntityID."]').val(),e=r.find('input[name^\x3d"quantity."]').val();B.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+a,data:{lineitems:d,addresses:u,quantities:e,isTrial:0,
deleteAddons:1,returnHTML:1,useCase:b},headers:c,error:k.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==d&&void 0!==d?n.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&void 0!==d?n.location=d:(k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.on("checkout:reload:itemselect",e);a.on("checkout:reload:spp-itemselect",e)});"use strict";q.when("A","page-transition-controller",
"page-conductor","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("itemselect-delete-controller",function(a,l,k,b,f,g,h){function d(a,b){e(a,null===b||void 0===b?a.$currentTarget.closest(".lineitem"):b)}function e(a,c){a.$event.preventDefault();if(!b.protectAgainstDoubleAction("itemselect-delete-single-item",200)){g.resetMetrics();l.show();x=c;r=a.$currentTarget.is("select")?a.$currentTarget.closest(".quantity-dropdown"):a.$currentTarget;a=x.find('input[name^\x3d"lineItemEntityID."]').val();
c=0;(new Date).getTime();var d=u("#addon-indicator");d.length&&"true"===d.attr("data-has-addon-items")&&(c=1);m({lineitems:a,isTrial:c})}}function c(a,c){a.$event.preventDefault();if(!b.protectAgainstDoubleAction("itemselect-delete-multiple-items",200)){l.show();q=c;r=a.$currentTarget;var d="";a=0;c=u("#addon-indicator");c.length&&"true"===c.attr("data-has-addon-items")&&(a=1);c=q.hasClass("pantry-row")?!0:!1;q.find(c?".pantry-item":".lineitem").each(function(a,b){d+="lineitems\x3d"+u(b).find('input[name^\x3d"lineItemEntityID."]').val()+
"\x26"});m(d+"isTrial\x3d"+a)}}function m(a){var b=(new Date).getTime(),c=u('input[name\x3d"useCase"]').val(),d=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});u.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3ddelete\x26useCase\x3d"+c+"\x26cachebuster\x3d"+b,data:a,dataType:"text",headers:d,error:k.ajaxRedirect,success:p})}function p(a,c,d){var e;e=d.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==e&&void 0!==e?(n.location=e,e=!0):e=!1;e||(e=
d.getResponseHeader("x-amz-checkout-fatal-error"),null!==e&&void 0!==e?n.location=e:(e=d.getResponseHeader("x-amz-checkout-show-addon-warning"),null!==e&&void 0!==e?(B(a,d),l.hide()):(k.ajaxUpdatePage(a,c,d),b.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))))}function B(a,b){b=b.getResponseHeader("x-amz-checkout-show-addon-warning");u(".item-list").hide();a.trim().split(",").forEach(function(a){u('[data-asin\x3d"'+a+'"]').show()});a=u("#addon-warning-"+b+"-launcher");a.length&&(u(".delete-title").show(),
u(".reduce-title").hide(),u(".select-address-title").hide(),u("input[name\x3duseLiveAUI]").length?f.get(a).attrs({$trigger:r,position:"triggerHorizontal"}).show():(b=u.Event("keyup",{triggerPositioningElement:r,manualTrigger:!0}),a.trigger(b)))}var u=a.$,x,q,r;a.declarative("itemselect-delete-item",["click","touchend"],d);a.declarative("itemselect-delete-item-row",["click","touchend"],function(a){c(a,a.$currentTarget.closest(".item-row"))});a.declarative("addon-delete-items",["click","touchend"],
function(a){if(void 0!==r&&!b.protectAgainstDoubleAction("itemselect-delete-addons",200)){u(".a-button-close").trigger("click");l.show();var c="";null!==q&&void 0!==q?(a=q.hasClass("pantry-row")?q.find(".pantry-item"):q.find(".lineitem"),u(a).each(function(a,b){c+="lineitems\x3d"+u(b).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"})):null!==x&&void 0!==x&&(c+="lineitems\x3d"+x.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26");m(c+"isTrial\x3d0\x26deleteAddons\x3d1")}});a.declarative("itemselect-delete-pantry-item",
["click","touchend"],function(a){e(a,a.$currentTarget.closest(".pantry-item"))});a.declarative("itemselect-delete-pantry",["click","touchend"],function(a){c(a,a.$currentTarget.closest(".pantry-row"))});a.declarative("itemselect-delete-popover-item",["click","touchend"],function(a){var b=a.$currentTarget.data("entityidtodelete");c(a,u('a[data-entityid\x3d"'+b+'"]').closest(".item-row"))});return{actionDeleteItem:d}});"use strict";q.when("A","page-transition-controller","page-conductor","itemselect-delete-controller",
"checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("itemselect-quantity-controller",function(a,l,k,b,f,g,h,d){function e(){x(".lineitem, .pantry-item").each(function(a,b){a=x(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))})}function c(a){a.find(".quantity-input").val(a.find('input[name^\x3d"previousQuantity."]').val())}
function m(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),d=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),e;e="itemselect-show-update-pantry-button"===a.action?".pantry-item":".lineitem";0===parseInt(d,10)||""===d?("change"===a.type&&c(a.$currentTarget.closest(e)),b.hide()):(a=a.$currentTarget.closest(e).find('input[name^\x3d"previousQuantity."]').val(),d!==a?b.show():b.hide())}function p(a){a.$event.preventDefault();
if(!f.protectAgainstDoubleAction("itemselect-update-quantity",200)){h.resetMetrics();t=a.$currentTarget.closest("itemselect-update-pantry-quantity"===a.action||"itemselect-update-pantry-quantity-text-field"===a.action?".pantry-item":".lineitem");var d=t.find(".js-address-dropdown").val(),e=a.$currentTarget.find("select"),m=e.length?e:a.$currentTarget;K=m.is("select")?m.val():t.find(".quantity-input").val();if(0===parseInt(K,10)||""===K)c(t);else if("Delete"===K)q.when("a-dropdown").execute(function(a){a.setValue(m.attr("id").replace(/\./g,
"\\."),r)}),b.actionDeleteItem(a,t);else{l.show();a=t.find('input[name^\x3d"lineItemEntityID."]').val();var e=0,g=(new Date).getTime(),p=x("#useCase").val(),P=x("#addon-indicator");v=m.is("select")?m.parent():t.find(".quantity-input");P.length&&"true"===P.attr("data-has-addon-items")&&(e=1);P=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});x.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+g,data:{lineitems:a,quantities:K,
address:d,isTrial:e,returnHTML:1,useCase:p},dataType:"text",headers:P,error:k.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");null!==d&&void 0!==d?n.location=d:(d=c.getResponseHeader("x-amz-checkout-show-addon-warning"),null!==d&&void 0!==d?(u(a,c),B(void 0===r?t.find('input[name^\x3d"previousQuantity."]').val():r,c),l.hide()):(k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}}}function B(a,b){10>a?(q.when("a-dropdown").execute(function(b){var c=
t.find('select[name^\x3d"quantity."]');b.setValue(c.attr("id").replace(/\./g,"\\."),a);c.find("option").removeAttr("selected");c.find('option[value\x3d"'+a+'"]').attr("selected","selected")}),t.find(".quantity-dropdown").show(),t.find(".quantity-text-field").hide(),t.find(".js-select").prop("disabled",!1),t.find(".quantity-input").prop("disabled",!0)):(t.find(".quantity-dropdown").hide(),t.find(".quantity-text-field").show(),t.find(".update-quantity-link").hide(),t.find(".js-select").prop("disabled",
!0),t.find(".quantity-input").prop("disabled",!1));t.find(".quantity-input").val(a);t.find('input[name^\x3d"previousQuantity."]').val(a)}function u(a,b){b=b.getResponseHeader("x-amz-checkout-show-addon-warning");x(".item-list").hide();a.trim().split(",").forEach(function(a){x('[data-asin\x3d"'+a+'"]').show()});a=x("#addon-warning-"+b+"-launcher");a.length&&0<a.length&&(x(".reduce-title").show(),x(".delete-title").hide(),x(".select-address-title").hide(),x("input[name\x3duseLiveAUI]").length?g.get(a).attrs({$trigger:v}).show():
(b=x.Event("keyup",{triggerPositioningElement:v,manualTrigger:!0}),a.trigger(b)))}var x=a.$,K,r,t,v;a.declarative("itemselect-get-quantity",["click","touchend"],function(a){f.protectAgainstDoubleAction("itemselect-get-quantity",200)||a.$currentTarget.find("select").length&&(r=a.$currentTarget.find("select").val())});a.declarative("itemselect-update-quantity",["change"],p);a.declarative("itemselect-update-pantry-quantity",["change"],p);a.declarative("addon-delete-items",["click","touchend"],function(a){if(void 0!==
v&&!f.protectAgainstDoubleAction("itemselect-delete-addons",200)){x(".a-button-close").trigger("click");l.show();a=t.find('input[name^\x3d"lineItemEntityID."]').val();var b=(new Date).getTime(),c=x("#useCase").val(),d=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});x.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+b,data:{lineitems:a,quantities:K,isTrial:0,deleteAddons:1,returnHTML:1,useCase:c},headers:d,error:k.ajaxRedirect,
success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==d&&void 0!==d?n.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&void 0!==d?n.location=d:(k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.declarative("itemselect-sanitize-input",["keydown"],function(a){f.limitInputToNumbers(a)});a.declarative("itemselect-update-quantity-text-field",["click","touchend"],p);a.declarative("itemselect-update-pantry-quantity-text-field",
["click","touchend"],p);a.declarative("itemselect-show-update-button",["change","keyup"],m);a.declarative("itemselect-show-update-pantry-button",["change","keyup"],m);a.on("checkout:reload:itemselect",e);a.on("checkout:reload:spp-itemselect",e)});"use strict";q.when("A","page-transition-controller","page-conductor","checkout-general-utils","client-side-metrics").register("itemselect-ship-to-multiple-controller",function(a,l,k,b,f){var g=a.$;a.declarative("itemselect-ship-to-multiple",["click","touchend"],
function(a){a.$event.preventDefault();f.resetMetrics();if(!b.protectAgainstDoubleAction("itemselect-ship-to-multiple",200)){l.show();var d=null,e=null,c=null;a.$currentTarget.closest(".item-row").find(".lineitem").each(function(a,b){a=g(b);b=a.find('select[name^\x3d"quantity."]');var f=a.find('input[type\x3d"number"]');if(a.find(".quantity-dropdown").is(":visible")&&1<b.val())return d=a.find('input[name^\x3d"lineItemEntityID."]').val(),e=b.val(),c=a.find(".js-address-dropdown").val(),!1;if(a.find(".quantity-text-field").is(":visible")&&
1<f.val())return d=a.find('input[name^\x3d"lineItemEntityID."]').val(),e=f.val(),c=a.find(".js-address-dropdown").val(),!1});if(null!==d){a=(new Date).getTime();var m=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});g.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dship-to-multiple\x26cachebuster\x3d"+a,data:{lineitem:d,quantity:e,address:c},headers:m,dataType:"text",error:k.ajaxRedirect,success:function(a,c,d){var e=d.getResponseHeader("x-amz-checkout-fatal-error");
null!==e&&void 0!==e?n.location=e:(k.ajaxUpdatePage(a,c,d),b.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}})});"use strict";q.when("A").register("safe-apx-helper",function(a){var l={},k=a.$;return{get:function(a){return l[a]},set:function(){1===arguments.length?l=k.extend(l,arguments[0]):2===arguments.length?l[arguments[0]]=arguments[1]:n.console&&n.console.error&&n.console.error("Unexpected number of arguments: %d. Expected 1 or 2.",arguments.length)}}});"use strict";q.when("A",
"weblab-helper").register("mobile-carrier-billing-util",function(a,l){var k=!1;return{determineIsMCBEnabled:function(a){k=0<a.paymentRows.find('input[type\x3d"radio"][name\x3dpaymentMethod]').filter("[value^\x3dMCB]").size()},toggleGCForMCB:function(a,f){if(!l.isMCBMultiTenderWeblabEnabled()&&k&&(a=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]'),a.length)){var g=f.paymentRows.find('input[type\x3d"checkbox"][name\x3duseAvailableBalance]'),g=f.existingBalance||g,h=0<f.paymentRows.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,
d="paymentsForm"in f&&0<f.paymentsForm.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,h=h||d;0<a.filter("[value^\x3dMCB]").size()&&h?(g.length&&(g.prop("checked",!1),g.prop("disabled",!0)),f.mcbBalanceWarning&&f.mcbBalanceWarning.show()):(g.length&&g.prop("disabled",!1),f.mcbBalanceWarning&&f.mcbBalanceWarning.hide())}},showMCBWarningMessageForPoints:function(a){k&&a.mcbPointsWarning&&a.mcbPointsWarning.show()},hideMCBWarningMessageForPoints:function(a){k&&a.mcbPointsWarning&&a.mcbPointsWarning.hide()}}});
"use strict";q.when("A","pay-common-util").register("emi-utils",function(a,l){var k=a.$;return{addEMIMenuSelectionAttributes:function(){var a=k("#emiPaymentMethodsSelectList").val();k("#pmEmiPaymentOptions").val(a);var f=a.split(".");1<f.length&&(a=f[1]);var a=k("."+a),g;a&&(g=a.find("#emiMenuIdentifier"));g&&(g.attr("name","isFromEMIMenu"),g.attr("value","1"))},removeEMIMenuSelectionAttributes:function(){var a=k("#selectedSectionEmiPaymentMethod").find("#emiMenuIdentifier");a.removeAttr("name");
a.removeAttr("value")},isEMIPaymentInstrument:function(a){return 1==a.length&&1==k(a[0]).find("#pmEmiPaymentOptions").length?!0:!1},getEMIMenuSelectedCardSection:function(){var a=k("#emiPaymentMethodsSelectList").val(),f=a.split(".");1<f.length&&(a=f[1]);return k("."+a)},setAndHideCVVInEMIMenu:function(a){if(a.length){var f=l.prop("cvv-newcard");f&&(a=a.find("#existingCvvNum"),a.length&&(a=a.val(f),a.parent().hide()))}}}});"use strict";q.when("A","emi-utils").register("emi-helper",function(a,l){function k(){l.addEMIMenuSelectionAttributes()}
function b(){l.removeEMIMenuSelectionAttributes()}function f(a){var b;if("CreditCard"===a)b=g(h.newEMI).find(".new-emi-card-fields").hide();else if(a=a.split("."),1<a.length){var c=a[0];if("emiCreditCard"===c||"netbankingEMI"===c)b=g(h.newEMI).find("."+a[1]).hide()}return b}var g=a.$,h={selectedEMIMenuSection:"#selectedSectionEmiPaymentMethod",emiDisabledText:"#emiDisabledText",emiDisabledWhy:"#emiDisabledWhy",newEMI:"#newEmiCard"};return{addEMIMenuSelectionAttributes:k,removeEMIMenuSelectionAttributes:b,
disableEMIPaymentMethods:function(a){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",!1),g(h.newEMI).find(".payment-selected").removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");g(h.selectedEMIMenuSection).hide();g(h.emiDisabledText).show();g(h.emiDisabledWhy).show()},enableEMIPaymentMethods:function(a){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");a.is(":checked")&&g(h.selectedEMIMenuSection).show();g(h.emiDisabledText).hide();
g(h.emiDisabledWhy).hide()},isEMIPaymentInstrument:function(a){return l.isEMIPaymentInstrument(a)},getEMIMenuSelectedCardSection:function(){return l.getEMIMenuSelectedCardSection()},showPaymentOptionBlock:f,toggleEMIMenu:function(a){var e=g(h.newEMI).find("#emiPaymentMethodsSelectList").find("option:selected").val(),c;a.find("#emiPaymentMethodsSelectList").length?(a.find("#emiMenuErrors_VCC").length&&a.find("#emiMenuErrors_VCC").hide(),g(h.newEMI).find(".section-emi-payment-method").show(),"SelectOption"===
e?g(h.newEMI).find("#selectedSectionEmiPaymentMethod").show():c=f(e),c&&(k(),g(h.newEMI).find("#selectedSectionEmiPaymentMethod").show(),c.show())):(b(),g(h.newEMI).find("#selectedSectionEmiPaymentMethod").hide())},setAndHideCVVInEMIMenu:function(a){l.setAndHideCVVInEMIMenu(a)}}});"use strict";q.when("A","pay-common-util").register("instant-bank-discount-helper",function(a,l){var k={instantBankDiscountAmazonPaySelectedText:".instant-bank-discount-apay-selected",instantBankDiscountAmazonPayDeselectedText:".instant-bank-discount-apay-deselected"};
return{showInstantBankDiscountAmazonPayDeselected:function(){var a=l.getElements(k);a.instantBankDiscountAmazonPaySelectedText.addClass("aok-hidden");a.instantBankDiscountAmazonPayDeselectedText.removeClass("aok-hidden")},showInstantBankDiscountAmazonPaySelected:function(){var a=l.getElements(k);a.instantBankDiscountAmazonPayDeselectedText.addClass("aok-hidden");a.instantBankDiscountAmazonPaySelectedText.removeClass("aok-hidden")}}});"use strict";q.when("A","page-detector","checkout-general-utils").register("pay-common-lib",
function(a,l,k){function b(a,b){b.attr("name")&&(a[b.attr("name")]=b.val());b.attr("id")&&(a[b.attr("id")]=b.val())}function f(a,b){if(!b)return a;for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);return a}function g(a,b,d){h.each(b,function(b,e){a[b]=d?d.find(e):h(e)})}var h=a.$,d="checkbox hidden password radio text number tel month".split(" "),e={};a.declarative("move-to-next-field",["keypress"],function(a){13===a.$event.charCode&&(k.moveToNextInput(a.$declarativeParent),a.$event.preventDefault())});
a.declarative("scroll-to-input",["keypress"],function(a){13===a.$event.charCode&&(h(n).scrollTop(a.$declarativeParent.offset().top),a.$event.preventDefault())});return{getAttributeData:function(a,b){if(a)return a.attr(b)||a.attr("data-"+b)||a.data(b)},getElements:function(a,b){var d={};g(d,a,b);return d},getInputValues:function(a){var e=a.find(".data-row").data()||{};a.find("input").each(function(){var a=h(this),c=a.attr("type");("radio"!==c&&"checkbox"!==c||a.is(":checked"))&&-1<h.inArray(c,d)&&
b(e,a)});a.find("select").each(function(){b(e,h(this))});return e},isDesktopCX:l.isDesktopPayment,isMobileCX:l.isMobilePayment,isPayPage:l.isPayment,isTouchCX:l.isTabletPayment,mergeFrom:function(a,b){b=f({},b);return f(b,a)},prop:function(a,b,d){if(a){if(1<arguments.length)return void 0===b?delete e[a]:e[a]={isOneTime:d?1:0,value:b},b;var f=e[a];if(f)return f.isOneTime&&delete e[a],f.value}},refreshElements:g,scrollTopTo:function(a){a&&a.length&&h("html,body").animate({scrollTop:a.offset().top-20},
"fast")},selectDefaultPaymentMethodIfNotSelected:function(){var a=h("#existing-payment-methods .payment-row").find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b=a.closest("div.payment-selected");b&&0<b.length||(a=a.closest("div.default-payment-marker"))&&a.length&&(a.addClass("payment-selected"),a.find("[name\x3dpaymentMethod]").attr("checked",!0))},processSubmissionParameters:function(a){for(var b={},d=0;d<a.length;d++)b[a[d].name]=a[d].value;return b}}});"use strict";q.when("A","pay-common-lib",
"a-popover-base","ajax-utility","loading-spinner-controller","page-conductor","page-transition-controller").register("pay-desktop-util",function(a,l,k,b,f,g,h){function d(a){a.$event.preventDefault();a.$target.closest(".a-popover").hide();a.$target.siblings("span.error-message").hide()}function e(a){a.preventDefault();var b=v(a.currentTarget),c=b.closest("div.expando-section");a=c.find("div.expando-content");var c=c.find("div.expando-reverse-content"),d=a.is(":visible"),e=function(){var a=b.find("i");
a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand")?d?(a.removeClass("a-icon-collapse").addClass("a-icon-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-expand").addClass("a-icon-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show()):d?(a.removeClass("a-icon-section-collapse").addClass("a-icon-section-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):
(a.removeClass("a-icon-section-expand").addClass("a-icon-section-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show())};d?(c.slideDown("fast"),a.slideUp("fast",e)):(c.slideUp("fast"),a.slideDown("fast",e))}function c(a){var b=a.$target.closest("a");a=b.closest("div.extender-section");b=b.find("i");b.hasClass("a-icon-extender-expand")?(a.find(".collapsed").hide(),a.find(".expanded").slideDown("fast"),b.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):
(a.find(".collapsed").show(),a.find(".expanded").slideUp("fast"),b.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"))}function m(a){F.msgPopovers.filter(":visible").hide();a.$event.preventDefault();a.$event.stopPropagation();a=a.$target.parent().find(".a-popover");a.is(":visible")||a.show()}function p(a,b,c){var d=a||{},e="string"===typeof a;c=c&&c.useSif?v('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0;e?(d+="\x26ajaxResponse\x3d1\x26returnjson\x3d1",c&&(d+="\x26isAmazonApp\x3d1")):
(d.ajaxResponse=1,d.returnjson=1,c&&(d.isAmazonApp=1));for(c=0;c<D.length;c++){var f=D[c],m=v("input[name\x3d"+f+"]").val();e?-1===b.search(f)&&-1===a.search(f)&&(d=d+"\x26"+f+"\x3d"+m):d[f]=m}return d}function B(a,b){if(0>a)return 0;isNaN(b)||(a=Number(a).toFixed(b));a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:B(a.substring(0,b-3),0)+","+a.substring(b-3)}function u(a,b,c,d){a="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===
b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a.status?"pay-ajax-500":"pay-ajax-error";if(c){a=c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+a):c+("\x26ref\x3d"+a);F.pageContainer.find("#tempForm").remove();c=v('\x3cform id\x3d"#tempForm" method\x3d"post"\x3e\x3c/form\x3e');c.attr("action",a);if("string"===typeof d){a={};b=d.split("\x26");for(var e=0;e<b.length;e++){var f=b[e].split("\x3d");2===f.length&&(a[f[0]]=f[1])}}else a=d;for(var m in a)"ajaxResponse"!==m&&"returnjson"!==
m&&(a=v('\x3cinput type\x3d"hidden"/\x3e').attr("name",m).val(d[m]),c.append(a));F.pageContainer.append(c);c.submit()}}function x(a,c,d,e){var f=g.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),f={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:p(c,a,e),dataType:"text",headers:f,timeout:y,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b)},error:function(b,e){d&&
d.errorHandler?d.errorHandler(b,e):u(b,e,a,c)},success:function(a,c,e){var f=e.getResponseHeader("x-amz-checkout-page");if("payselect"!==f&&"spp-payment"!==f)return a=b.jsonify(a),g.redirect(a);d&&d.successHandler?d.successHandler(a,c,e):g.ajaxUpdatePage(a,c,e)}};v.extend(f,e);q.push(v.ajax(f))}function n(a,b,c,d){var e=g.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),e={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:p(b,a,d),dataType:"text",headers:e,timeout:y,
type:"POST",url:a,error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):u(d,e,a,b)},success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-page");"payselect"!==e&&"spp-payment"!==e&&c&&c.pageUpdater?c.pageUpdater(a):g.ajaxUpdatePage(a,b,d)}};v.extend(e,d);q.push(v.ajax(e))}function r(){y=parseInt(v("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10);y=isNaN(y)?1E4:y;l.isMobileCX()?z&&(z=!1):(F=l.getElements(L),z&&(a.declarative("close-popover",["click"],d),a.declarative("toggle-msg-popover",
["click"],m),a.declarative("a-extender-toggle",["click"],c),z=!1),F.pageContainer.undelegate(".expando-link","click").delegate(".expando-link","click",e),F.pageContainer.find("form select.a-touch-select-input").unbind("change",t).bind("change",t),v(".a-dropdown-container").each(function(){k.remove(v(this).find("select").attr("name"))}),v(document).bind("click",function(a){a.isPropagationStopped()||0===v(a.target).closest(".pay-popover-msg").length&&F.msgPopovers.filter(":visible").hide()}))}function t(a){var b=
v(a.currentTarget);a=b.siblings("a.a-placeholder");b=b.find(":selected").text();a.html(b);return!1}var v=a.$,z=!0,y,q=[],D=["forceResponsive","fromAnywhere","hasWorkingJavascript"],F={},L={msgPopovers:"div.pay-popover-msg",pageContainer:"div.a-container"};a.on("checkout:reload:payselect",r);a.on("checkout:reload:spp-payment",r);return l.mergeFrom({decodeJSONResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),
"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:F,getNumberWithSeparators:B,handleForm:function(a,b,c){a.$event.preventDefault();var d=a.$declarativeParent;d.is("span")&&(d=d.find("form"));d=d.serializeArray();d=l.processSubmissionParameters(d);x(a.data.action,d,b,c)},makeAjaxCall:x,handleAjaxError:u,handlePaymentsPortalForm:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);
x(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;n(b,a,c,d)}},l)});"use strict";q.when("A","pay-common-lib","page-transition-controller").register("pay-mobile-util",function(a,l,k){function b(a,b,c){a=a||{};var d=x.fromAnywhereField.val(),e=c&&c.useSif?p('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0,f=h();"string"===typeof a?(a=a+"\x26ajaxResponse\x3d1\x26currentPage\x3d"+f,-1===b.search("fromAnywhere")&&
-1===a.search("fromAnywhere")&&(a=a+"\x26fromAnywhere\x3d"+d),e&&(a+="\x26isAmazonApp\x3d1")):(a.ajaxResponse=1,a.currentPage=f,-1===b.search("fromAnywhere")&&(a.fromAnywhere=d),e&&(a.isAmazonApp=1),c&&c.isAddCardAndContinueEnabled&&(a.isHideSpinnerDisabled=!0));return a}function f(){B&&B.abort("abort-for-cleanup");B=null}function g(a,b,d,e){a=a&&a.status;b="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":
500===a?"pay-ajax-500":"unknown"===a?"pay-unknown-page":"pay-ajax-error";d&&(d=-1===d.lastIndexOf(".html?")?d+("?ref\x3d"+b):d+("\x26ref\x3d"+b),c(d,e))}function h(){var a;p.each(u,function(b,c){if(c.pageId&&p(c.pageId).is(":visible"))return a=b,!1});return a}function d(a){(a=u[a]&&u[a].componentId)&&q.when(a).execute(function(a){a.init&&a.init()})}function e(a,c,e,f,m){m&&m.suppressSpinner||k.show();m={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:b(c,a,f),dataType:"text",
timeout:t,type:"POST",url:a,beforeSend:function(a,b){e&&e.beforeHandler&&e.beforeHandler(a,b)},complete:function(a,b){e&&e.completeHandler&&e.completeHandler(a,b);c&&c.isHideSpinnerDisabled||k.hide()},error:function(b,d){e&&e.errorHandler?e.errorHandler(b,d):g(b,d,a,c)},success:function(b,f,m){var h=m.getResponseHeader("x-amz-checkout-pay-page-name");if(h){var k=m.getResponseHeader("x-amz-checkout-pay-page-title");k&&x.pageTitle.text(decodeURIComponent(k));e&&e.successHandler?e.successHandler(b,f,
m):x.pageContainer.html(b);d(h)}else g(null,"unknown",a,c)}};p.extend(m,f);B=p.ajax(m)}function c(a,b,c){var d=p("#tempForm",x.pageContainer);0<d.length&&d.remove();d=p('\x3cform method\x3d"post"\x3e\x3c/form\x3e');d.attr("action",a);c&&c.target&&d.attr("target",c.target);if("string"===typeof b)for(a=b.split("\x26"),b=0;b<a.length;b++)c=a[b].split("\x3d"),2===c.length&&"ajaxResponse"!==c[0]&&(c=p('\x3cinput type\x3d"hidden"/\x3e').attr("name",c[0]).val(c[1]),d.append(c));else for(var e in b)"ajaxResponse"!==
e&&d.append(p('\x3cinput type\x3d"hidden"/\x3e').attr("name",e).val(b[e]));x.pageContainer.append(d);d.submit()}function m(a,c,e,f,m){m&&m.suppressSpinner||k.show();m={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:b(c,a,f),dataType:"text",timeout:t,type:"POST",url:a,complete:function(a,b){e&&e.completeHandler&&e.completeHandler(a,b);k.hide()},error:function(b,d){e&&e.errorHandler?e.errorHandler(b,d):g(b,d,a,c)},success:function(a,b,c){var f=c.getResponseHeader("x-amz-checkout-pay-page-name");
if(!f&&e&&e.pageUpdater)e.pageUpdater(a);else{var m=c.getResponseHeader("x-amz-checkout-pay-page-title");m&&x.pageTitle.text(decodeURIComponent(m));e&&e.successHandler?e.successHandler(a,b,c):x.pageContainer.html(a);d(f)}}};p.extend(m,f);B=p.ajax(m)}var p=a.$,B=null,u={main:{componentId:"page-main",pageId:"#select-payments-view"},"credit-card-rewards":{componentId:"page-rewards",pageId:"#select-payment-rewards-view"},"financial-offer":{componentId:"page-financial-offer",pageId:"#select-payment-financial-offer-view"},
"new-payment-methods":{pageId:"#new-payments-view"},"gil-estimates":{pageId:"#gil-estimates-subpage"}},x={},K={cvvHelper:"div#cvv-help-popover",fromAnywhereField:"input[name\x3dfromAnywhere]",jppoints:"div#jppoints",pageContainer:"div#page-container",pageTitle:"head title"},r=!0,t;return l.mergeFrom({decodeJSonResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));
a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:x,getCurrentPage:function(){return x.pageContainer.children("div.page").filter(":visible")},getCurrentPageName:h,getPageId:function(a){a=a.getResponseHeader("x-amz-checkout-pay-page-name");return u[a]&&u[a].pageId},handleForm:function(a,b,c){a.$event.preventDefault();e(a.data.action,a.$target.serialize(),{successHandler:function(a,c,d){b(a,c,d)}},c)},submitFormRequest:c,init:function(){l.isMobileCX()&&
(n.onbeforeunload=f,l.refreshElements(x,K),t=parseInt(p("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10),t=isNaN(t)?1E4:t,r&&(r=!1,p("div.pay-mobile").bind("keypress",function(a){l.prop("activeGoElement",13===a.keyCode?document.activeElement:null,!0)})))},makeAjaxCall:e,handleAjaxError:g,pages:u,handlePaymentsPortalForm:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);e(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,d){a=l.processSubmissionParameters(a.submissionParameters);
a.embedOnlyData=1;m(b,a,c,d)}},l)});"use strict";q.when("page-detector","pay-desktop-util","pay-mobile-util").register("pay-common-util",function(a,l,k){return a.isMobile()?k:l});"use strict";q.when("A","pay-common-util","pay-rewards-currency","checkout-federation-wrapper","safe-apx-helper","weblab-helper").register("pay-validator",function(a,l,k,b,f,g){function h(){function a(b,c,d,e){O.push({identifier:b,priority:d||100,target:c,isPincodeError:e})}function h(a){if(!a)return null;var b=new RegExp(String.fromCharCode(32),
"g"),c=new RegExp(String.fromCharCode(45),"g");return a.replace(b,"").replace(c,"")}function B(){return 0<O.length}function u(a){if(!a||0===a.length)return!1;for(var b=0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10}function x(a,b){return a&&a.match(/^[0-9]+$/)&&a.length===b}function n(a,b,c){return a&&a.match(/^[0-9A-Za-z]+$/)&&a.length>=b&&a.length<=c}function r(a,b){if(!a||!b)return!1;a=parseInt(a,10);b=parseInt(b,10);return t(a,b)}function t(a,
b){var c=new Date,d=c.getFullYear();return b>d||b===d&&a>=c.getMonth()+1}function v(a){a=a.val();return!a||0===a.length}function z(){var b=d("#pm_pay_by_check").is(":checked"),c=d("#existing-balance [paymentmethodid\x3d'availablebalance'] input").is(":checked");b&&c&&a("continue_BadCombinationCheckExistingBalance")}function y(b){if(d("#jppoints").length){var c,e=!1;1===b.length&&"jppoints"===b.attr("id")?(c=b,e=!0):c=b.filter("#jppoints");if(c&&c.find("#redeemPoints").is(":checked")){b=c.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val();
b=parseInt(b,10);d('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]').is(":checked")&&(b-=parseInt(c.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10));var f=parseInt(c.find("#redeemableAmount").text(),10),g=c.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');c.find("#jpPointsMax").is(":checked")?c=f:(c=parseInt(g.val(),10))||(c=0);c>f?a("continue_jpPointsExceedsRedeemableAmount",g):e&&c<b?a("continue_notEnoughJPPoints"):c>b&&a("continue_jpPointsExceedsTotalPurchase")}}}
function J(b){b&&(b=b.find(".pci-blocking-cvv"),b.length&&b.is(":visible")&&a("PCI_Block_CVV"))}function D(b){var c=b.find(".currency-list");c.length&&c.is(":visible")&&(b=c.find("[type\x3dradio]:checked").val(),c=c.find("#cardCurrencyDropDown option:selected").val(),b&&("Other"!==b||"-1"!==c&&"-2"!==c)||a("continue_SelectCardCurrency"))}function F(b){var c=b.find("#existingCvvNum");if(0!==c.length){var d=c.val();b=e?b.data("validcvvlength"):b.attr("validcvvlength");x(d,parseInt(b,10))||a("continue_BadSecurityCode",
c)}}function L(b){var c=b.find('input[name\x3d"paymentMethod"]').val();/^creditCard/.test(c)&&b.find("#savedCardSuppressed").length&&a("continue_BankTemporarilyNotAvailable")}function P(b){b=b.find("#existingPincodeNum");if(0!==b.length){var c=b.val();c?n(c,4,8)||a("existingCreditCard_PincodeInvalid",b,null,!l.isMobileCX()):a("continue_EmptyPincode",b)}}function G(b){if(b&&b.length)for(var c=0;c<b.length;c++){var e=d(b[c]);J(e.parent());F(e);P(e);"netBanking"===e.find('input[name\x3d"paymentMethod"]').val()&&
(d("#netBanking_select").val(),d("#net-banking-list").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable"));L(e);var f=e;f.find('input[name\x3d"paymentMethod"]').val();f.find("#vdcBanksSelect").val();d("#vdcBanksSelect").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable");da(e);e=e.siblings("#upi-acceptance-input").find("#vpaCollect");if(!e||e.length)(f=e.val())&&f.match(/.+@.+/)||a("continue_BadVpaForUpi",e)}}function M(b){var c=
b.find("#newMonth"),d=b.find("#newYear");b=b.find("#newExpDate");!(c=c.length&&!r(c.val(),d.val()))&&(c=b.length)&&((b=b.val())?(c=b.split("-"),b=parseInt(c[0],10),c=parseInt(c[1],10),b=t(c,b)):b=!1,c=!b);c&&a("continue_BadExpiration")}function Q(b){"domesticCards"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&b.match(/^[0-9]*$/)||a("continue_BlankSlate"))}function V(b){var c=d("#existing-balance input[name\x3duseFlexiblePayments]").is(":checked");b=l.getAttributeData(b,
"paymentmethodtype");c&&"creditCard"!==b&&a("continue_FlexiblePaymentsNeedsCreditCard")}function E(b){"thirdPartyAccounts"===b.find('input[name\x3d"paymentMethod"]').val()&&((b=b.find("select").val())&&0!==b.length||a("continue_BlankSlate"))}function C(b){var c=b.find(".rewards-list");if(c.length&&c.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")){b=c.find("input.custom-rewards-input");var d=b.val();if(c.hasClass("show-currency-input-widget-new")){var c=b.data("country-code"),
e=k.getCurrencyFormatByCountryCode(c),c=b.data("min"),d=k.getAmount(d,e.decimalPlace);d<c&&a("continue_BadRewardsMin")}else/^\s*$/.test(d)||isNaN(d)?a("continue_BadRewardsValue"):(d=parseFloat(b.val()),c=b.data("min"),0>=d||d<c?a("continue_BadRewardsMin"):d>b.data().max&&a("continue_BadRewardsMax"))}}function W(b){var c=b.find('input[name\x3d"paymentMethod"]').val();"verifiedCreditCard"===c?a("continue_BlankSlate"):"verifiedDebitCard"===c&&(c=b.find("#vdcBanksSelect").val(),(""===c||"OtherBanks"===
c||"1"===d("#save_citi_card").val()&&"CIT"===c)&&a("continue_BlankSlate"),b.find("option:selected").prop("disabled")&&a("continue_BankTemporarilyNotAvailable"))}function aa(b){"cashOnDeliveryCash"===b.find('input[name\x3d"paymentMethod"]').val()&&b.find(".phonenumberNotVerified").length&&a("continue_OTPforCOD")}function Y(b){if("netBanking"===b.find('input[name\x3d"paymentMethod"]').val()){var c=b.find("#net-banking-select-list").val();b=b.find("option:selected").prop("disabled");""===c&&a("continue_BlankSlate");
b&&a("continue_BankTemporarilyNotAvailable")}}function X(b){"morePaymentMethod"===b.find('input[name\x3d"paymentMethod"]').val()&&""===b.find("#more-payment-methods-select-list").val()&&a("continue_BlankSlate")}function da(b){var c=b.find('input[name\x3d"paymentMethod"]').val();if("StandaloneInstallment"===c||"StandaloneCreditCardInstallment"===c||"StandaloneReusableCreditLineInstallment"===c)b.find('input[name\x3d"gilShowContinueBlocker"]').val()&&("StandaloneCreditCardInstallment"===c?a("continue_GilCCContinueError"):
"StandaloneReusableCreditLineInstallment"===c?a("continue_GilRCLContinueError"):a("continue_GilContinueError")),b.find('input[name\x3d"showIneligibleItemSubpage"]').val()&&("StandaloneCreditCardInstallment"===c?a("continue_GilCCContinueErrorIneligibleItems"):"StandaloneReusableCreditLineInstallment"===c?a("continue_GilRCLContinueErrorIneligibleItems"):a("continue_GilContinueErrorIneligibleItems")),b.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val()&&0<d("#existing-balance input[name\x3duseAvailableBalance]:checked").length&&
("StandaloneCreditCardInstallment"===c?a("continue_GilCCContinueErrorPromotions"):"StandaloneReusableCreditLineInstallment"===c?a("continue_GilRCLContinueErrorPromotions"):a("continue_GilContinueErrorPromotions"))}var O=[],Z=null,w=null,ca=function(a){c=a};c||(l.isMobileCX()?q.when("rewards-section-mobile").execute(ca):q.when("rewards-section-desktop").execute(ca));return{displayErrors:function(a,b){(Z=a)&&Z.hide().find(".error-message").hide().addClass("hidden");(w=b)&&w.find(".a-form-error").removeClass("a-form-error");
if(B()){for(a=0;a<O.length;a++){b=O[a];if(b.target){var c=b.target.parent();c.hasClass("a-input-text-wrapper")&&!c.hasClass("a-form-error")?c.addClass("a-form-error"):b.target.hasClass("a-form-error")||b.target.addClass("a-form-error")}b=b.identifier;(Z&&Z.length?Z.find("#"+b):d("#"+b)).show().removeClass("hidden")}Z&&Z.length&&Z.show()}},getHighestErrorId:function(){for(var a={priority:100},b=0;b<O.length;b++){var c=O[b],e;(e=c.identifier)?(e=Z&&Z.length?Z.find("#"+e):d("#"+e),e=parseInt(l.getAttributeData(e,
"priority"),10),e=isNaN(e)?100:e):e=100;e<=a.priority&&(a={identifier:c.identifier,priority:e,isPincodeError:c.isPincodeError,target:c.target})}return a},hasErrors:B,isValidCardCVV:x,isValidCardPincode:n,validateBankAccountNum:function(b,c){v(b)&&a("addBankAccount_NoAccountNumber",c)},validateBankAccountNumConfirm:function(b,c,d){b.val()!==c.val()&&a("addBankAccount_AccountNumberMismatch",d)},validateBankDriverLicense:function(b,c){v(b)&&a("addBankAccount_NoDLNumber",c)},validateBankDriverLicenseState:function(b,
c){void 0!==b.val()&&""!==b.val()&&"0"!==b.val()||a("addBankAccount_NoDLState",c)},validateBankHolderName:function(b,c){v(b)&&a("addBankAccount_NoName",c)},validateBankRoutingNum:function(b,c){9!==b.val().length&&a("addBankAccount_ShortRoutingNumber",c)},validateCreditCardCVV2:function(b,c,d){d="true"===b.attr("isaddresschallenge")?b.attr("issuer"):d&&d.charAt(0);"R"!==d&&(b=b.val(),x(b,"A"===d?4:3)||a("addCreditCard_BadSecurityCode",c))},validateCreditCardDate:function(b,c,d,e){r(b.val(),d.val())||
(a("addCreditCard_BadExpiration",c),a("addCreditCard_BadExpiration",e))},validateCreditCardMobile:function(b,c){b=b.val();g.isUpdateMobileNumberEnabled()?b&&b.replace(/[^0-9]/g,"").match(/^1[0-9]{10}$/)||a("addCreditCard_BadMobileNumber",c):b&&b.replace(/[^0-9]/g,"").match(/^1[34578]{1}[0-9]{9}$/)||a("addCreditCard_BadMobileNumber",c)},validateCreditCardPincode:function(b,c){(b=b.val())&&b.match(/^[a-zA-Z0-9]{4,8}$/)||a("addCreditCard_BadPincode",c)},validateCreditCardName:function(b,c){v(b)&&a("addCreditCard_NoName",
c)},validateCreditCardNumber:function(b,c){var e=h(b.val());e&&10<e.length&&u(e)||a("addCreditCard_BadNumber",c);e=d("#creditCardIssuersBlocked").val();b=b.data("issuer");e&&""!==e&&b&&""!==b&&-1<d.inArray(b,e.split(","))&&a("addCreditCard_IssuerUnsupported",c)},validateSBIMaestroCardNumberLength:function(b,c){19!==h(b.val()).length&&a("addCreditCard_SBIMaestro_BadNumberLength",c)},isAMEXCreditCard:function(a){a=h(a.val());return null!==a?0===a.indexOf("37")||0===a.indexOf("34"):!1},validateCreditCardTail:function(b,
c){var d=h(b.val());d&&10<d.length&&u(d)?(b=(l.isMobileCX()&&e?b.parent().data():b.data()).tail+"",d.substr(d.length-b.length)!==b&&a("addCreditCard_NotMatch",c)):a("addCreditCard_NotMatch",c)},validateCreditCardType:function(b,c){b.is(":visible")&&((b=b.val())&&b.match(/^[A-Z][0-9]*$/)||a("addCreditCard_NoType",c))},validateRegistrationResult:function(b){b.cardStatus?1===b.checkStatusCount&&a("addCreditCard_RegisterFailed"):0<b.errors.length&&a("addCreditCard_RegisterFailed")},validateDirectDebitAccountName:function(b,
c){v(b)&&a("addDirectDebit_NoAccountOwnerName",c)},validateDirectDebitAccountNum:function(b,c){v(b)&&a("addDirectDebit_NoAccountNumber",c)},validateDirectDebitRoutingNum:function(b,c){v(b)&&a("addDirectDebit_NoRoutingNumber",c)},validateInvoiceFirstName:function(b,c){v(b)&&a("addInvoiceAccount_NoFirstName",c)},validateInvoiceLastName:function(b,c){v(b)&&a("addInvoiceAccount_NoLastName",c)},validateLocName:function(b,c){v(b)&&a("addLoc_NoName",c)},validateLocNumber:function(b,c){v(b)&&a("addLoc_BadNumber",
c)},validateNewGiftPromotion:function(b,c){v(b)&&a("addGiftCardOrPromo_NoCode",c)},validatePayment:function(e){if(l.isMobileCX())G(e),c&&b.wrap(function(){c.validatePaymentRewardsInRewardsSection(a)},"shopwithpointsmobile");else if(z(),e&&e.length){for(var f=0;f<e.length;f++){var g=d(e[f]);"true"===l.getAttributeData(g,"isaddresschallenge")&&a("continue_AddressChallenge");"true"===l.getAttributeData(g,"isverifiedfail")&&a("continue_VerifiedFail");"true"===l.getAttributeData(g,"iscupcardexpired")&&
a("continue_CUPExpired");J(g);D(g);F(g);P(g);M(g);Q(g);V(g);E(g);C(g);W(g);Y(g);X(g);da(g);aa(g);L(g)}c&&b.wrap(function(){c.validatePaymentRewardsInRewardsSection(a)},"shopwithpoints");y(e)}else a("continue_BlankSlate")},validateGetCreditCardTypeResult:function(b){if(b.errors&&0<b.errors.length)for(var c=0;c<b.errors.length;c++)a(b.errors[c])},validateEMIMenuForContinueButton:function(b){var c=b.find("#emiPaymentMethodsSelectList").find("option:selected").val();if("CreditCard"===c||"SelectOption"===
c)a("continue_BlankSlate");else if(c=c.split("."),1<c.length){var d=c[0];if("emiCreditCard"===d||"netbankingEMI"===d)b=b.find("."+c[1]),b=b.find(".emiMenuTenuresDropDown"),b.length&&!b.find("option:selected").val()&&a("continue_BlankSlate")}},apxValidatePayment:function(a,b){var c=f.get("payselect");c&&c.validatePayments(this,b,a)},addError:a,errors:O,validatePCICVVBlock:J}}var d=a.$,e=n.P&&n.P.AUI_BUILD_DATE,c=void 0;return{create:function(){return new h}}});"use strict";q.when("A","ajax-utility",
"pay-common-util","pay-validator").register("pay-credit-card",function(a,l,k,b){function f(a,b,d,f){a&&a.length&&(b=d+"-"+b,(d=k.prop(b))&&(a=a.find(f).val(d))&&a.length&&(k.isMobileCX()?a.closest(".card-cvv-field").hide().data("isHidden",1):a.closest(".a-column").hide(),k.prop(b,void 0)))}var g=a.$,h={cc:!1,vcc:!1,vdc:!1},d=n.P&&n.P.AUI_BUILD_DATE;return{confirmCreditCard:function(a,b,d){a.currentPaymentInstrumentID=a.paymentmethodid;a.recommendedPaymentMethodId=a.paymentmethodid;if(a.newMonth&&
a.newYear)a.month=a.newMonth,a.year=a.newYear;else if(a.newExpDate){var f=a.newExpDate.split("-");a.year=parseInt(f[0],10);a.month=parseInt(f[1],10)}else a.expmonth&&a.expyear&&(a.month=a.expmonth,a.year=a.expyear);(f="existingCvvNum"in a?a.addCreditCardVerificationNumber=a.existingCvvNum:a.addCreditCardVerificationNumber)&&k.prop("cvv-"+a.paymentmethodid,f);(f="existingPincodeNum"in a?a.addCreditCardPincode=a.existingPincodeNum:a.addCreditCardPincode)&&k.prop("pincode-"+a.paymentmethodid,f);k.makeAjaxCall(d,
a,{successHandler:b,errorHandler:function(b,c){a.handler="confirm-credit-card";k.handleAjaxError(b,c,"/gp/buy/payselect/handlers/submit.html",a)}},{useSif:!0})},handleCreditCardType:function(a,c){var d=a.$target,f=a.data.type,g=b.create();a.$currentTarget.data("issuer","");g.validateCreditCardNumber(d,d);g.hasErrors()||(h[f]=!0,k.makeAjaxCall(a.data.url,{addCreditCardNumber:d.val(),returnjson:1},{completeHandler:function(){h[f]=!1},successHandler:function(b){b=l.jsonify(b);c(b,f);a.$currentTarget.data("issuer",
b.issuer)}},{useSif:!0},{suppressSpinner:!0}))},isWaitingForType:function(a){return h[a]},runConfirmCardValidator:function(a,c){var d=a.find("#existingCvvNum"),d=d.length?d:a.find("#addCreditCardVerificationNumber"),f=a.find("#addCreditCardNumber"),g=a.find("#newMonth"),h=a.find("#newYear"),k=b.create();k.validateCreditCardTail(f,f);g.length&&h.length&&k.validateCreditCardDate(g,g.closest(".card-date").find(".a-button"),h,h.closest(".card-date").find(".a-button"));d.length&&(f=(f=a.find("#issuer"))&&
f.val(),k.validateCreditCardCVV2(d,d,f));k.displayErrors(c,a);return k.hasErrors()},setDateSelectorStatus:function(a,b){var d=b.find(".card-date").find("select");d&&d.length&&q.when("a-dropdown").execute(function(b){d.each(function(){var c=g(this).attr("id");b.updateSelect(c,{status:"21"===a.brand&&"G"===a.issuer?"disabled":"enabled"})})})},setNewCardCVVInputStatus:function(a){(k.prop("cvv-newcard")||k.prop("pincode-newcard"))&&a.each(function(){var a=g(this);if("1"===(d?a.data("isnewcard")+"":a.attr("isnewcard")))return f(a,
"newcard","cvv","#existingCvvNum"),f(a,"newcard","pincode","#existingPincodeNum"),!1})},setCardPasswordInputStatus:f}});"use strict";q.when("A","ajax-utility","pay-common-util","pay-validator","page-transition-controller","page-conductor","pay-credit-card").register("pay-credit-card-reregistration",function(a,l,k,b,f,g,h){function d(a,d){var e=b.create(),f=c("#cupMobileNumber-"+a),g=c("#cupSecurityCode-"+a),h=c("#reRegisterCCErrors-"+a);a=c("#reRegisterCCInputs-"+a);e.validateCreditCardCVV2(g,g,d);
e.validateCreditCardMobile(f,f);e.displayErrors(h,a);return e.hasErrors()}function e(a,b,c){g.ajaxUpdatePage(a,b,c)}var c=a.$;return{actionReregisterCardInBox:function(a){a.$event.preventDefault();f.show();var b=a.data.type,g=c("#cupMobileNumber-"+a.data.paymentMethodID).val(),u=c("#cupSecurityCode-"+a.data.paymentMethodID).val();d(a.data.paymentMethodID,b)?f.hide():(b={isReregistering:a.data.isReregistering,currentPaymentInstrumentID:a.data.paymentMethodID,name:a.data.holderName,year:a.data.expiredYear,
month:a.data.expiredMonth,addCreditCardMobileNumber:g,addCreditCardVerificationNumber:u},g={useSif:k.isMobileCX()?!0:!1,success:function(a,b,d){a=l.jsonify(a);b=c("#reRegisterCCErrors-"+a.paymentInstrumentId);h.waitForCreditCardStatus(a,e,b)}},a.$event.preventDefault(),k.makeAjaxCall(a.data.url,b,null,g))}}});"use strict";q.when("A","client-side-metrics","ajax-utility","pay-common-util","pay-validator","existing-payments","page-conductor","checkout-modal-popover","page-transition-controller","pay-credit-card",
"pay-gil","new-verified-debit-card","emi-helper").register("new-payments",function(a,l,k,b,f,g,h,d,e,c,m,p,B){function u(a){a.$event.preventDefault();var d=a.data.type;if(c.isWaitingForType(d))e.show(),setTimeout(function(){u(a)},50);else{var f;f="vdc"===d?S.newVDC:"emi"===d?S.newEMI:S.newVCC;if(ga(f,d))e.hide();else{e.show();var g=b.getInputValues(f),h="vdc"===d?"_VDC":"_VCC";f=g["addCreditCardVerificationNumber"+h];var k=g["addCreditCardPincode"+h],m=g["isCardSavedFromEMIMenu"+h],d={addCreditCardNumber:g["addCreditCardNumber"+
h],addCreditCardVerificationNumber:f,addCreditCardPincode:k,handler:g["handler"+h],month:g["month"+h],name:g["name"+h],newPaymentType:d,year:g["year"+h],cctype:g["cctype"+h],isSBIInternationalMaestroSelected:g["isSBIInternationalMaestroSelected"+h],isCardSavedFromEMIMenu:m};b.prop("cvv-newcard",f);k&&b.prop("pincode-newcard",k);b.makeAjaxCall(a.data.url,d,{successHandler:function(a,b,d){F(a,b,d);"1"===N("#hideCVVInEMIMenuStatus").val()&&"1"===m&&(a=y(B.getEMIMenuSelectedCardSection),y(B.setAndHideCVVInEMIMenu,
a));c.setNewCardCVVInputStatus(S.paymentRows)}},{useSif:!0})}}}function x(a){a.$event.preventDefault();var d=a.data.type;if(c.isWaitingForType(d))e.show(),setTimeout(function(){x(a)},50);else{var f=S.newCCFormContent;if(ga(f,d))e.hide();else{e.show();d=b.getInputValues(f);d.handler=d.handler_addCCInBox;var f=a.data.url,g={};N("#cupSecurityCode").is(":visible")&&N("#cupMobileNumber").is(":visible")?(f="/gp/buy/payselect/handlers/add-credit-card.html",g={successHandler:function(a){a=k.jsonify(a);P(a)}}):
g={successHandler:F};b.makeAjaxCall(f,d,g,{useSif:!0})}}}function n(a){a.$event.preventDefault();var c=N("#new-giftcard-promotion"),c=b.getInputValues(c);N("input[name\x3disUnifiedActionsDesignEnabled]").length&&r(a)||(c.handler=c.handler_addGCInBox,a=a.data.url,e.show(),b.makeAjaxCall(a,c,{successHandler:function(a,c,d){h.ajaxUpdatePage(a,c,d);la||b.scrollTopTo(N("#existing-balance"))}},{useSif:!0}))}function r(a){a=a.$declarativeParent;var b=N("#gcpromoinput"),c=f.create();c.validateNewGiftPromotion(b,
b);c.displayErrors(S.newGCErrors,a);return c.hasErrors()}function t(a){var b=N(a.currentTarget).parents("div.new-payment-line").find(".card-date select");if(b&&b.length){var c=N(a.currentTarget).val();q.when("a-dropdown").execute(function(a){b.each(function(){var b=N(this).attr("id");a.updateSelect(b,{status:"G21"===c?"disabled":"enabled"})})})}}function v(a){var b=S.newVDC.find(".vdc-form-fields"),c=S.newVDC.find("#vdc-logo-prompt"),d=S.newVDC.find(".top-cell");a?b.show():b.hide();a?c.show():c.hide();
a?d.addClass():d.removeClass()}function z(a){var b=N(a.currentTarget).val(),c=S.newVDC.find("#suppressedVerifiedDebitCard").hide(),d=S.newVDC.find(".vdc-selected-bank-prompt").hide();v(!1);var e="1"===S.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;"OtherBanks"===b||"1"===N("#save_citi_card").val()&&"CIT"===b||e?(v(!0),N.isEmptyObject(p)||p.showExpiryDateAndCvv()):"SMP"!==b||N.isEmptyObject(p)?""!==b&&(b=N(a.currentTarget).find("option:selected").prop("disabled"),a=N(a.currentTarget).find("option:selected").text(),
b?c.show().find(".suppressed-card-text").html(a):d.show().find(".bank-name-text").html(a)):(v(!0),p.hideExpiryDateAndCvv())}function y(a,b){if(!N.isEmptyObject(B)&&a)return a(b)}function J(a){y(B.removeEMIMenuSelectionAttributes);S.newEMI.find(".emi-group").hide();a=N(a.currentTarget).find("option:selected").val();S.newEMI.find("#emiMenuErrors_VCC").length&&S.newEMI.find("#emiMenuErrors_VCC").hide();if(a=y(B.showPaymentOptionBlock,a))y(B.addEMIMenuSelectionAttributes),a.show()}function D(a){c.handleCreditCardType(a,
fa)}function F(a,c,d){h.ajaxUpdatePage(a,c,d);la||b.scrollTopTo(g.getSelectedPayment())}function L(a){a.$event.preventDefault();var d=a.data.type;c.isWaitingForType(d)?(e.show(),setTimeout(function(){L(a)},50)):ga(a.$declarativeParent,d)?e.hide():(oa&&oa.hide(),ra&&ra.hide(),e.show(),N("#cupSecurityCode").is(":visible")&&N("#cupMobileNumber").is(":visible")?(d=a.$declarativeParent.serializeArray(),d=b.processSubmissionParameters(d),b.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",
d,{successHandler:function(a){a=k.jsonify(a);P(a)}},{useSif:!0})):b.handleForm(a,{successHandler:F},{useSif:!0}))}function P(a){var c={};c.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(c.checkStatusCount=a.checkStatusCount);var d={successHandler:function(a){a=k.jsonify(a);var c=f.create();"VERIFIED"===a.cardStatus?b.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId},{successHandler:F}):"PENDING"===a.cardStatus?(a.checkStatusCount?(a.checkStatusCount=
parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3,c.validateRegistrationResult(a),1===a.checkStatusCount?(e.hide(),c.displayErrors(S.newCCErrors)):(--a.checkStatusCount,P(a))):(c.validateRegistrationResult(a),e.hide(),c.displayErrors(S.newCCErrors))}};setTimeout(function(){b.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",c,d)},2500)}function G(a){a.$event.preventDefault();var c=a.$declarativeParent,d=c.find("#loc-name"),
g=c.find("#loc-number"),h=f.create();h.validateLocName(d,d);h.validateLocNumber(g,g);h.displayErrors(c.find("#error-box-new-loc"),c);h.hasErrors()||(sa&&sa.hide(),e.show(),b.handleForm(a,{successHandler:F}))}function M(a){a.$event.preventDefault();var c=a.$declarativeParent,d=c.find("#gcpromoinput");c.find("#gcpromosuccessblock").hide();var g=f.create();g.validateNewGiftPromotion(d,d);g.displayErrors(S.newGCErrors,c);g.hasErrors()||(e.show(),b.handleForm(a,{successHandler:function(a,c,d){h.ajaxUpdatePage(a,
c,d);la?S.newGCErrors.is(":visible")&&N("#gc-link-expander").trigger("click"):b.scrollTopTo(N("#existing-balance"))}}))}function Q(a){a.$event.preventDefault();N("#ccAddCard").trigger("submit")}function V(a){a.$event.preventDefault();N("#bank-address-popover-submit").trigger("submit")}function E(a){a.$event.preventDefault();N("#direct-debit-popover-submit").trigger("submit")}function C(a){a.$event.preventDefault();N("#new-loc-popover-submit").trigger("submit")}function W(a){a.$event.preventDefault();
N("#new-invoice-popover-submit").trigger("submit")}function aa(a){a.$event.preventDefault();N("#brdcAddCard").trigger("submit")}function Y(a){a.$event.preventDefault();var c=a.$declarativeParent,d=f.create(),g=c.find("#bank-name"),h=c.find("#bank-routing-number"),k=c.find("#bank-account-number"),m=c.find("#bank-account-number-confirm"),l=c.find("#bank-dl"),t=c.find("#bank-dl-state");d.validateBankHolderName(g,g);d.validateBankRoutingNum(h,h);d.validateBankAccountNum(k,k);d.validateBankAccountNumConfirm(k,
m,m);d.validateBankDriverLicense(l,l);d.validateBankDriverLicenseState(t,t.parents("div.a-button-dropdown"));d.displayErrors(c.find("#new-bank-error-box"),c);d.hasErrors()||(pa&&pa.hide(),e.show(),b.handleForm(a,{successHandler:F}))}function X(a){a.$event.preventDefault();var c=a.$declarativeParent,d=f.create(),g=c.find("#debit-bank-routing-number"),h=c.find("#debit-account-number"),k=c.find("#debit-account-name");d.validateDirectDebitRoutingNum(g,g);d.validateDirectDebitAccountNum(h,h);d.validateDirectDebitAccountName(k,
k);d.displayErrors(c.find("#new-direct-debit-error"),c);d.hasErrors()||(qa&&qa.hide(),e.show(),b.handleForm(a,{successHandler:F}))}function da(a){a.$event.preventDefault();var c=a.$declarativeParent,d=f.create(),g=c.find("#invoice-first-name"),h=c.find("#invoice-last-name");d.validateInvoiceFirstName(g,g);d.validateInvoiceLastName(h,h);d.displayErrors(c.find("#new-invoice-error-box"),c);d.hasErrors()||(ua&&ua.hide(),e.show(),b.handleForm(a,{successHandler:F}))}function O(a){a=N("#order-summary-total");
var c=N("#order-summary-container");a.prev().addClass("a-first");c.addClass("a-box-group");a.show();b.isTouchCX()&&c.parent().find(".bottom-order-summary").show();S.newCCFormContent.is(":visible")||N("#wrapper-new-cc").find("a.a-link-expander").trigger("click");N("#ecard-help-link").show()}function Z(a){var c="Unknown";b.isDesktopCX()?c="Desktop":b.isMobileCX()?c="Mobile":b.isTouchCX()&&(c="Tablet");l.increaseCount("PayPage-ClientSide-AddCupClick-"+c,1);c=N("#cupForm");if(0<c.length)c.submit();else{var d=
N("\x3cform\x3e\x3c/form\x3e");d.attr({target:"_blank",method:"POST",action:a.data.url});N("#cup-dc").find("input").each(function(){var a=N(this);"hidden"===a.attr("type")&&a.clone().appendTo(d)});N("body").append(d);d.submit();d.remove()}}function w(c){var f=c.$target.closest(".a-popover"),g=f.data("a-popover-id");d.hideById(g);f.hide();N("#a-popover-modal").hide();e.show();b.makeAjaxCall(c.data.url,void 0,{successHandler:function(b){N("#existing-payment-methods").replaceWith(N(b).find("#existing-payment-methods"));
a.trigger("checkout:reload:payselect");e.hide()}})}function ca(a){a.$event.preventDefault();a=a.data;e.show();m.submitNewGilPayment(a.subtype)}function ba(){if(!b.isMobileCX()){0===N("#form-add-credit-card").length&&(N("#ccAddCard").parents("div.cc-submit").hide(),N("#ccAddCardWithButton").parents("div.cc-submit").show());N("html").hasClass("a-ie6")&&(N("#cup-mbdc").show(),N(".mbdc-link").attr("data-action","redirect-cup"));S=b.getElements(ea);S.bankNumberConfirm.show();S.newVDC.find(".payment-row").data("hasstatus")||
S.newVDC.find(".vdc-form-fields").hide();S.newVDC.find("#suppressedVerifiedDebitCard").hide();S.newCCFormContent.find(".cup-card-field").hide();S.newPayments.find("#cupInfoMessage").hide();S.newPayments.find("#use-ecard-link").show();S.newPayments.find(".mbdc-link").show();S.newPayments.find(".mbdc-button").hide();la=!1;S.newPayments.each(function(){var a=N(this),c=a.data();c&&0===c.hasstatus?(a.find("a.a-link-expander i.js-hide").remove(),a.find("a.a-link-section-expander i.js-hide").remove()):c&&
1===c.hasstatus&&!la&&(b.scrollTopTo(a),la=!0)});var c=S.newVCC.find("#requireCVVOrPincode");c&&c.length&&c.val("1");U&&(a.declarative("new-cc",["submit"],L),a.declarative("new-brdc",["submit"],L),a.declarative("new-loc",["submit"],G),a.declarative("show-card-image",["change"],D),a.declarative("new-giftcard-promotion",["submit"],M),a.declarative("new-verified-card",["click"],u),a.declarative("new-cc-in-dashboard",["click"],x),a.declarative("new-gc-in-dashboard",["click"],n),a.declarative("add-bank-account",
["submit"],Y),a.declarative("add-direct-debit",["submit"],X),a.declarative("add-invoice",["submit"],da),a.declarative("show-order-summary",["click"],O),a.declarative("redirect-cup",["click"],Z),a.declarative("cup-popover-close",["click"],w),a.declarative("add-new-debit-and-cc-popover-submit",["click"],Q),a.declarative("add-bank-account-popover-submit",["click"],V),a.declarative("add-loc-account-popover-submit",["click"],C),a.declarative("new-gil-payment",["click"],ca),a.declarative("add-direct-debit-popover-submit",
["click"],E),a.declarative("add-invoice-account-popover-submit",["click"],W),a.declarative("add-new-br-debit-card-popover-submit",["click"],aa),U=!1);S.cardTypeDropdown.unbind("change",t).bind("change",t);S.vdcBankDropdown.unbind("change",z).bind("change",z);S.emiCardsDropdown.unbind("change",J).bind("change",J);N("div.pay-desktop a.a-link-expander").unbind("keypress");N("div.pay-desktop .a-declarative, div.pay-desktop .a-button").filter("[data-action\x3da-checkout-modal-popover]").unbind("keypress");
a.on("a:popover:show:add-new-debit-cc-modal",function(a){ra=a.popover});a.on("a:popover:show:add-new-bank-account-modal",function(a){pa=a.popover});a.on("a:popover:show:add-new-direct-debit-modal",function(a){qa=a.popover});a.on("a:popover:show:add-new-loc-account-modal",function(a){sa=a.popover});a.on("a:popover:show:add-invoice-account-modal",function(a){ua=a.popover});a.on("a:popover:show:add-br-debit-card-modal",function(a){oa=a.popover})}}function ga(a,b){var c,d,e,g,h,k,m,l,t,p,r;"vcc"===b?
(c="#vccCVVNum",b="#newVCCErrors",d="#vccMonth",e="#vccName",g="#newVerifiedCreditCardNumber",h="#vccType",k="#vccYear",m="#vccPincode",r=p=t=l=void 0):"vdc"===b?(c="#vdcCVVNum",b="#newVDCErrors",d="#vdcMonth",e="#vdcName",g="#newVerifiedDebitCardNumber",h="#vdcType",k="#vdcYear",l="#isSBIMaestroAsSavedCardEnabled",t="#isSBIInternationalMaestroSelected",r=p=m=void 0):"emi"===b?(c="#vccCVVNum",b="#newEMIErrors",d="#vccMonth",e="#vccName",g="#newVerifiedCreditCardNumber",h="#vccType",k="#vccYear",m=
"#vccPincode",r=p=t=l=void 0):"brdc"===b?(b="#newBRDCErrors",d="#brdcMonth",e="#brdcName",g="#addCreditCardNumber_BRDC",k="#brdcYear",r=p=t=l=m=h=c=void 0):(p="#cupSecurityCode",r="#cupMobileNumber",c="#ccCVVNum",b="#newCCErrors",d="#ccMonth",e="#ccName",g="#addCreditCardNumber",h="#ccType",k="#ccYear",t=l=m=void 0);c=a.find(c);p&&0===c.length&&a.find(p).is(":visible")&&(c=a.find(p));l="1"===a.find(l).val()&&"1"===a.find(t).val();e=a.find(e);g=a.find(g);r=r?a.find(r):null;d=a.find(d);h=a.find(h);
k=a.find(k);var u;m&&a.find(m).is(":visible")&&(u=a.find(m));m=h.val();t=f.create();t.validateCreditCardName(e,e);t.validateCreditCardNumber(g,g);l&&t.validateSBIMaestroCardNumberLength(g,g);l=d.parent();l=l.hasClass("a-button")?l:l.find(".a-button");e=k.parent();e=e.hasClass("a-button")?e:e.find(".a-button");"G21"!==m&&t.validateCreditCardDate(d,l,k,e);t.validateCreditCardType(h,h.closest(".card-type-field").find(".a-button"));k=m?m.substr(0,1):"";c.length&&"R"!==k&&c.is(":visible")&&t.validateCreditCardCVV2(c,
c,m);r&&r.length&&r.is(":visible")&&t.validateCreditCardMobile(r,r);u&&u.length&&t.validateCreditCardPincode(u,u);t.displayErrors(N(b),a);return t.hasErrors()}function fa(a,d){if(a){"1"===a.isDebitCard?S.newCCWarnings.show().removeClass("hidden"):S.newCCWarnings.hide().addClass("hidden");if("1"===a.hasErrors){var e=f.create();e.validateGetCreditCardTypeResult(a);if(e.hasErrors()){e.displayErrors(S.newCCErrors);return}}d="vcc"===d?S.newVCC:"vdc"===d?S.newVDC:"emi"===d?S.newEMI:"brdc"===d?S.newBRDCFormContent:
S.newCCFormContent;var e=a.specificFields,g=d.find(".cup-card-field");0!==g.length&&(e&&1===e.securityCode&&1===e.mobileNumber?(b.isTouchCX()&&d.find("#addCreditCardNumber").closest(".a-input-text-wrapper").removeClass("last-child"),g.show()):g.hide());e=a.specificFields;g=d.find(".amex-field");if(0!==g.length){var h=d.find(".cvv-field");0!==h.length&&(e&&1===e.pincode?(h.hide(),g.show()):e&&0===e.pincode&&0===e.securityCode?(g.hide(),h.hide()):(g.hide(),h.show()))}e=d.find(".card-images");e.find("img").hide();
h=a.installmentProgram;g=!1;h&&(h=e.find('img[data-installmentprogram\x3d"'+h+'"]'),0!==h.length&&(h.show(),g=!0));g||(a.issuerdisplayimage?e.find("img[data-issuer\x3dATM]").attr("src",a.issuerdisplayimage).show():(g=a.issuer+a.brand,e.find("img[data-issuer\x3d"+g+"]").show(),d.find(ea.cardTypeDropdown).val(g).trigger("change")));c.setDateSelectorStatus(a,d)}}var N=a.$,U=!0,la=!1,S={},ea={bankNumberConfirm:"#wrapper-bank-account-number-confirm",btnAddCard:"#ccAddCard",btnAddLoc:"#button-new-loc",
btnAddGC:"#button-add-gcpromo",btnAddBank:"#button-add-bank-account",btnAddDirectDebit:"#button-add-direct-debit",btnAddInvoice:"#button-add-invoice",cardImages:"#newCreditCardImages",cardTypeDropdown:".card-type-dropdown select",newCCFormContent:"#new-cc",newBRDCFormContent:"#new-brdc",newGCErrors:"#gcpromoerrorblock",newGCFormContent:"#gc_entry",newPayments:"div.new-payment-line",newVCC:"#new-verified-credit-cards-table",newVDC:"#new-verified-debit-cards-table",newEMI:"#newEmiCard",paymentRows:"#existing-payment-methods .payment-row",
vdcBankDropdown:"#vdcBanksSelect",emiCardsDropdown:"#emiPaymentMethodsSelectList",cardList:"#existing-credit-cards-box",newCCErrors:"#newCCErrors",newCCWarnings:"#newCCWarnings"},ra,pa,sa,qa,ua,oa;a.on("checkout:reload:payselect",ba);a.on("checkout:reload:spp-payment",ba);return{actionShowOrderSummary:O,handleFormHandlerScrollToSelected:F}});q.when("A","page-detector","client-side-metrics","ready").execute(function(a,l,k){function b(a,b,d,e){a=f(b).is(":checked");n.P&&n.P.AUI_BUILD_DATE?a?f(d).val(f(d).parent().data("account-name")):
f(d).val(""):(k.increaseCount("removeauijs8"),a?(f(e).removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"),f(d).val(f(d).data("account-name"))):(f(e).removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),f(d).val("")));d="undefined"!==typeof n.ue&&"undefined"!==typeof n.ue.count;e=l.isMobilePayment()?"mobile":"tablet";a=f("#showNameOnCardCheckbox").is(":checked");d&&n.ue.count(e+"NameOnCardCheckBox"+(a?"Checked":"Unchecked"),1)}var f=
a.$;a.declarative("show-card-name",["click"],function(a){b(a,"#showNameOnCardCheckbox","#ccName","#showNameOnCardIcon")});a.declarative("show-br-debit-card-name",["click"],function(a){b(a,"#showNameOnCardCheckbox_BRDC","#brdcName","#showNameOnCardIcon_BRDC")})});"use strict";q.when("A").register("pay-rewards-currency",function(a){var l=function(a,b){b=Math.pow(10,b);a=a.replace(/[^0-9]/g,"");return parseFloat(a)/b},k={CA:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},DE:{groupingSeparator:".",
decimalSeparator:",",decimalPlace:2},GB:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},JP:{groupingSeparator:",",decimalSeparator:".",decimalPlace:0},US:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2}},b=function(a,b,d,e,c){this.groupingSeparator=a;this.decimalSeparator=b;this.currencyDecimalPlace=d;this.pointsDecimalPlace=e;this.ratio=c;this.getCurrencyAmount=function(a){return l(a,this.currencyDecimalPlace)};this.getPointsAmount=function(a){return this.getCurrencyAmount(a)/
this.ratio};this.format=function(a,b){var c=parseInt(a,10);a=parseFloat(a-c).toFixed(b);a=this.decimalSeparator+a.slice(2);c=c.toString();b=3<c.length?c.length%3:0;c=(0<b?c.substr(0,b)+this.groupingSeparator:"")+c.substr(b).replace(/(\d{3})(?=\d)/g,"$1"+this.groupingSeparator);return void 0===a||a===this.decimalSeparator?c:c+a};this.formatCurrency=function(a){return this.format(a,d)};this.formatPoints=function(a){return this.format(a,e)}},f=function(b,f,d,e){this.maxAmount=e;this.rewardsFormatter=
d;this.currencyElement=b;this.pointElement=f;var c=this;this.isControlKey=function(a){switch(a.which){case 8:case 46:return!0;case 86:case 88:return a.ctrlKey;default:return!1}};this.isNavigationKey=function(a){switch(a.which){case 9:case 16:case 17:case 35:case 36:case 37:case 39:return!0;case 65:case 67:return a.ctrlKey;default:return!1}};this.isValidKey=function(a){var b=a.which;return 48<=b&&57>=b||96<=b&&105>=b||8===a.which||46===a.which};this.getCaret=function(){var a=c.currencyElement,b=a.get(0),
d=0,e=0;if("number"===typeof b.selectionStart&&"number"===typeof b.selectionEnd)d=b.selectionStart,e=b.selectionEnd;else{var f=document.selection.createRange();if(void 0!==f&&f.parentElement()===b){var a=a.val(),e=a.length,g=b.createTextRange();g.moveToBookmark(f.getBookmark());b=b.createTextRange();b.collapse(!1);-1<g.compareEndPoints("StartToEnd",b)?d=e:(d=-g.moveStart("character",-e),d+=a.slice(0,d).length-1,-1<g.compareEndPoints("EndToEnd",b)||(e=-g.moveEnd("character",-e),e+=a.slice(0,e).length-
1))}}return{start:d,end:e}};this.setCaret=function(a){var b=c.currencyElement.get(0);b.setSelectionRange?b.setSelectionRange(a,a):b.createTextRange&&(b=b.createTextRange(),b.collapse(!0),b.moveStart("character",a),b.moveEnd("character",a),b.select())};this.bind=function(){c.currencyElement.unbind();c.currencyElement.bind("keydown",function(a){c.isNavigationKey(a)||c.isControlKey(a)||c.isValidKey(a)||a.preventDefault()});c.currencyElement.bind("keyup",function(b){if(!c.isNavigationKey(b)){b=c.getCaret();
var d=c.currencyElement.val().length;c.format();var e=c.currencyElement.val().length;b.start===b.end&&c.setCaret(Math.min(b.start+(e-d),e));a.trigger("inlineFormatter:formattingCompleted",c)}})};this.unbind=function(){c.currencyElement.unbind("keydown keyup")};this.format=function(a){a=c.currencyElement.val();a=c.rewardsFormatter.getCurrencyAmount(a);isNaN(a)&&(a=0);a>c.maxAmount&&(a=c.maxAmount);a=c.rewardsFormatter.formatCurrency(a);c.currencyElement.val(a)}};a.on("inlineFormatter:formattingCompleted",
function(a){var b=a.pointElement,d=a.currencyElement.val(),d=a.rewardsFormatter.getPointsAmount(d);a=a.rewardsFormatter.formatPoints(Math.round(d));b.html(a)});return{getCurrencyFormatByCountryCode:function(a){(a=k[a])||(a=k["default"]);return a},getAmount:l,initializeInlineFormatting:function(g,h,d){var e=g.maxAmount;d=new b(d.groupingSeparator,d.decimalSeparator,d.decimalPlace,h.decimalPlace,h.ratio);g=new f(g.$element,h.$element,d,e);g.bind();g.format(0);a.trigger("inlineFormatter:formattingCompleted",
g)}}});"use strict";q.when("A","pay-common-util","pay-validator","page-conductor","mobile-carrier-billing-util","weblab-helper").register("jppoints",function(a,l,k,b,f,g){function h(){!l.isMobileCX()&&z("#jppoints").length&&(y=l.getElements(J),p())}function d(){var a=y.paymentRows.find('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.closest("div.payment-selected").removeClass("payment-selected");a.attr("checked",!1);l.isTouchCX()&&e(a,"radio")}function e(a,b){a.siblings("i").removeClass("a-icon-touch-"+
b+"-active").addClass("a-icon-touch-"+b+"-inactive")}function c(a,b){a.is(":disabled")||a.siblings("i").removeClass("a-icon-touch-"+b+"-inactive").addClass("a-icon-touch-"+b+"-active")}function m(){return z('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]').is(":checked")}function p(){if(y.jppoints&&y.jppoints.length){m()&&n();y.jppoints.show();var a=y.jppoints.find("#redeemPoints");l.isTouchCX()?a.parents("label").bind("click",K):a.bind("click",K);y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("click",
function(){var a=y.jppoints.find("#jpPointsCustom");a.attr("checked",!0);var b=y.jppoints.find("#redeemPoints");b.attr("checked",!0);l.isTouchCX()&&(c(a,"radio"),e(y.jppoints.find("#jpPointsMax"),"radio"),c(b,"checkbox"))});y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]').bind("click",u);y.jppoints.find("#jpPointsCustom").bind("click",function(){y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').focus()});y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("keyup",
v)}}function n(){var a=y.jppoints.find("#redeemPoints"),c=y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),f=y.jppoints.find("#redeemableAmount"),g=y.jppoints.find("#redeemableValue");a.attr("checked",!1);a.attr("disabled",!0);c.attr("checked",!1);c.attr("disabled",!0);y.jppoints.find("#jpPointsError").hide();d.val("");d.removeClass("a-form-error");d.attr("disabled",!0);g.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val());
f.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val());b.isSPP()&&(y.jppoints.find("label").addClass("disabled-color"),y.jppoints.removeClass("payment-selected"));l.isTouchCX()&&(e(a,"checkbox"),e(c,"radio"),a.siblings("i").addClass("a-button-disabled"),c.siblings("i").addClass("a-button-disabled"))}function u(b){var f=b.currentTarget,g=y.jppoints.find("#redeemPoints");g.attr("checked",!0);if(l.isTouchCX()){c(z("#"+f.id),"radio");var h;h="jpPointsMax"===f.id?y.jppoints.find("#jpPointsCustom"):
y.jppoints.find("#jpPointsMax");e(h,"radio");c(g,"checkbox")}"true"===f.value&&(y.jppoints.find("#jpPointsError").hide(),f=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),f.removeClass("a-form-error"),f.val(""),g=y.jppoints.find("#redeemableAmount"),h=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10),f=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),g=parseInt(g.text(),10)*h,z('input[name\x3d"useAvailableBalance"]').is(":checked")&&
(h=y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),f-=parseInt(h.val(),10)),g>=f&&d());q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",z(b.currentTarget))})}function x(a){var b=y.jppoints.find("#redeemableAmount"),c=y.jppoints.find("#redeemableValue"),f=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),g;a.is(":checked")?(a=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val(),
g=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val(),f-=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10)):(a=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),g=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val());var h=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10)*a;b.text(a);c.text(g);0>=parseInt(a,10)?
(b=y.jppoints.find("#redeemPoints"),b.attr("checked",!1),c=y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),c.attr("checked",!1),l.isTouchCX()&&(e(b,"checkbox"),e(c,"radio"))):y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"][value\x3d"true"]').is(":checked")?h>=f&&d():v()}function K(){var d=y.jppoints.find("#redeemPoints");if(!d.is(":disabled")){d=d.is(":checked");if(l.isTouchCX())d?(e(y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),
t()):(c(y.jppoints.find("#jpPointsMax"),"radio"),e(y.jppoints.find("#jpPointsCustom"),"radio"),r());else if(d)r(),b.isSPP()&&y.jppoints.addClass("payment-selected");else if(t(),b.isSPP()){y.jppoints.removeClass("payment-selected");if(m())return;l.selectDefaultPaymentMethodIfNotSelected()}q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",y.jppoints)})}}function r(){var a=y.jppoints.find("#jpPointsMax");a.attr("checked",!0);
var f=parseInt(y.jppoints.find("#redeemableAmount").text(),10),g=y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),h=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);l.isTouchCX()&&(e(y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),c(a,"radio"));y.jppoints.find("#jpPointsMax").is(":checked")&&(f>=h?d():b.isSPP()&&y.paymentRows.find("#gcPromo, input[name\x3d'useAvailableBalance']").is(":checked")&&(a=y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),
h-=parseInt(a.val(),10),g>=h&&d()))}function t(){var a=y.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]');a.attr("checked",!1);var b=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');b.val("");b.removeClass("a-form-error");y.jppoints.find("#jpPointsError").hide();l.isTouchCX()&&e(a,"radio")}function v(){var b=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),c=parseInt(b.val(),10);!c||0>c?(b.val(""),y.jppoints.find("#jpPointsError").hide(),y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error")):
(b.val(c),parseInt(y.jppoints.find("#redeemableAmount").text(),10)<c?(y.jppoints.find("#jpPointsError").show(),y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').addClass("a-form-error")):(y.jppoints.find("#jpPointsError").hide(),y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error"),b=parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),parseInt(y.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),
10),c>=b&&d(),q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleJPPointsSection",c)})))}var z=a.$,y={},J={paymentRows:"#existing-payment-methods .payment-row",jppoints:"#jppoints",mcbPointsWarning:"#mcbPointsWarning"};a.on("checkout:reload:payselect",h);a.on("checkout:reload:spp-payment",h);return{handleJPPointsOnPaymentRows:function(a){a=z(a.currentTarget);if("jppoints"!==a.attr("id"))if("useAvailableBalance"===a.attr("name"))x(a);else{g.isMCBMultiTenderWeblabEnabled()||
f.hideMCBWarningMessageForPoints(y);var c=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]');if(!g.isMCBMultiTenderWeblabEnabled()&&c.length&&0<c.filter("[value^\x3dMCB]").size())f.showMCBWarningMessageForPoints(y),n();else if("availablebalance"===a.attr("value")||a.find("#pm_300")&&"availablebalance"===a.find("#pm_300").attr("value"))n();else{a=y.jppoints.find("#redeemPoints");var c=y.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d=y.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),
e=y.jppoints.find("#redeemableAmount"),h=y.jppoints.find("#redeemableValue");b.isSPP()&&y.jppoints.find("label").removeClass("disabled-color");a.attr("disabled",!1);c.attr("disabled",!1);d.attr("disabled",!1);z('#existing-balance input[type\x3d"radio"][value\x3d"availablebalance"]').length&&(e.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val()),h.text(y.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val()));l.isTouchCX()&&(a.siblings("i").removeClass("a-button-disabled"),
c.siblings("i").removeClass("a-button-disabled"))}}},handleJPPointsWithGC:x}});"use strict";q.when("A","ajax-utility","client-side-metrics","pay-common-util","pay-validator","page-transition-controller","page-conductor","a-popover-position","inline-points-register-controller","jppoints","pay-credit-card","checkout-general-utils","a-popover-base","a-dropdown","pay-rewards-currency","cache-page-data-controller","pay-credit-card-reregistration","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper",
"recommendation-helper","safe-apx-helper","apb-limit-messaging-helper").register("existing-payments",function(a,l,k,b,f,g,h,d,e,c,m,p,B,u,x,K,r,t,v,z,y,J,D){function F(){return A.paymentRows.filter(function(){return H(this).hasClass("payment-selected")||H(this).find("#redeemPoints").is(":checked")})}function L(a){g.show();a.$event.preventDefault();var c=F().find(".card-unreg-rewards").data();c.recommendedPaymentMethodId=c.paymentinstrumentid;b.makeAjaxCall(a.$target.attr("href"),c)}function P(c){c=
H(c.currentTarget);var d=c.data();if(!(0>=d.ratio)){var e=c.val()/d.ratio;if(!isNaN(e)){var f=c.val();f<d.min&&(e=0);c=b.getNumberWithSeparators(e,d.decimalplaces);F().find(".custom-reward-points").html(c);q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleRewardsSection",f)})}}}function G(a){1===a.data.refresh&&(g.show(),b.makeAjaxCall(a.data.url))}function M(a){Da(a)?(a=A.continueBtns,a.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),
a.find(".a-button-disabled").removeClass("aok-hidden")):H("#payPageContinueBtnStateFixEnabled").length&&aa(a)}function Q(a){b.isTouchCX()&&(Da()?a.$event.preventDefault():(A.continueErrPopover.hide().find(".error-message").hide(),g.show()))}function V(a){b.isTouchCX()&&(Da()||A.continueErrPopover.hide().find(".error-message").hide())}function E(a){a=H(a.currentTarget);a.click();a=a.closest(".payment-container");a.find("#cc-errors").is(":visible")?a.find(".tv-update .a-button-primary").focus():a.click()}
function C(a){a.$event.preventDefault();var c=F();if(!m.runConfirmCardValidator(c,c.find("#cc-errors"))){g.show();var d=(c=b.getInputValues(c))||{},e=b.getInputValues(A.hiddenFormFields),f;for(f in e)e.hasOwnProperty(f)&&(d[f]=e[f]);m.confirmCreditCard(c,ua,a.data.url)}}function W(){A.continueErrPopover.filter(":visible").length&&A.continueErrPopover.hide()}function aa(){A.continueErrPopover.filter(":visible").length&&A.continueErrPopover.hide().find(".error-message").hide();var a=F();A.disableSubmitButtons.length?
a.find(".no-address").length||(a.find(".continue-center").removeClass("aok-hidden"),a.find(".a-button-disabled").addClass("aok-hidden")):(A.continueBtns.find(".a-button-primary:not(.a-button-disabled)").removeClass("aok-hidden"),A.continueBtns.find(".a-button-disabled").addClass("aok-hidden"));if(a){var b=a.find(".a-form-error");b&&b.length&&(b.removeClass("a-form-error"),(a=a.find(".pincode-err-block").filter(":visible"))&&a.length&&(A.continueErrPopover.hide().find(".error-message").hide(),A.continueBtns.find(".a-button-primary").removeClass("aok-hidden"),
A.continueBtns.find(".a-button-disabled").addClass("aok-hidden"),a.hide()))}}function Y(){A.continueErrPopover.filter(":visible").length||A.continueBtnTop.trigger("click")}function X(a){if(13===a.which){var c=H(document.activeElement),d=c.closest("div.payment-row"),e=c.closest(".a-button"),c=c.get(0).tagName;if(d.length&&!e.length&&"A"!==c&&"a"!==c)return d=d.find('input[type\x3d"submit"]'),d.length?d.trigger("click"):(A.continueErrPopover.filter(":visible").length&&A.continueErrPopover.hide(),Da(a)?
(b.isTouchCX()||(A.continueBtns.find(".a-button-primary").addClass("aok-hidden"),A.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")),a.preventDefault()):A.continueBtnTop.trigger("click")),!1}}function da(a){g.show();var c=F(),d=c.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),e=c.find(".card-unreg-rewards").data(),c=b.isTouchCX()?c.find(".flag-register-rewards"):A.rewardsRegister,c=b.getInputValues(c);c.programid=e.programid;c.paymentinstrumentid=e.paymentinstrumentid;
c.CARD_EXPIRATION_DATE=e.expiredate;c.CARD_HOLDER_NAME=e.holdername;c.returnRefreshedPage=a.data.returnRefreshedPage;c.rewardsdateofbirthmonth&&c.rewardsdateofbirthday&&(c.DATE_OF_BIRTH=c.rewardsdateofbirthmonth+c.rewardsdateofbirthday);-1===a.data.url.toLowerCase().indexOf("cachebuster")&&(a.data.url=p.addQueryStringParameter(a.data.url,"cacheBuster",(new Date).getTime()));b.makeAjaxCall(a.data.url,c,{successHandler:function(a,c,e){g.hide();if(a){a=l.jsonify(a);A.rewardsRegister.find(".register-content").hide();
var f=b.isTouchCX()?F().find(".register-error"):A.rewardsRegister.find(".register-error");f.hide();a.error?f.show().find(".error-message").hide().filter("#"+a.error).show():(h.ajaxUpdatePage(a.refreshedPage,c,e),c=A.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+d+'"]').closest(".payment-row"),c.trigger("click"),b.scrollTopTo(c))}}})}function O(a){a=H(a.currentTarget).parents("div.currency-list");var b=a.find("label.a-touch-radio");b.length?b.trigger("click"):a.find("input[type\x3dradio][value\x3dOther]").trigger("click")}
function Z(a){a=a.$target.closest("div.payment-row");var c=a.find(".currency-list");if(h.isSPP()){var d=u.getSelect(c.find("select"));null!==d&&d.setValue("")}a.find(".change-currency").hide();c.show();b.isTouchCX()&&(a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"),a.find(".bottom-cell").show());oa();xa()}function w(a){a=a.$target.closest("div.payment-row");a.find(".expire-info, .expire-date").hide();a.find(".enter-date, .expire-date-fields").show();oa();I()}function ca(a){var c=
a.$target.closest("div.payment-row"),d="true"===b.getAttributeData(c,"isaddresschallenge")?1:0;c.find(".expire-date-fields").length?(w(a),c.find("#newExpDate").focus()):d&&c.find("#addCreditCardNumber").focus()}function ba(a){setTimeout(function(a){var b=H(a.target);a=document.createEvent("UIEvents");a.initUIEvent("DOMActivate",!0,!0,n,1);b.get(0).dispatchEvent(a)},0,a)}function ga(a){var c=H(a.target).closest("div.payment-row");""!==H(a.target).val()&&("true"===b.getAttributeData(c,"isaddresschallenge")?
c.find("#addCreditCardNumber").focus():Y())}function fa(){var a=F();a.find("div.flag-register-rewards").is(":visible")?(a.find(".bottom-cell").hide(),a.find(".top-cell").removeClass("bottom-line"),a.find(".card-unreg-rewards").show()):(a.find(".card-unreg-rewards").hide(),a.find(".bottom-cell").show(),a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"))}function N(){fa()}function U(a){a.$event.preventDefault();if("1"===F().find("div.flag-register-rewards").attr("cached"))fa();else{var c=
a.$target.attr("href");-1===c.toLowerCase().indexOf("cachebuster")&&(c=p.addQueryStringParameter(c,"cacheBuster",(new Date).getTime()));g.show();b.makeAjaxCall(c,a.data,{successHandler:function(a){g.hide();var c=l.jsonify(a);a=b.decodeJSONResponse(c.widgetHTML);var d=F();d.find("div.flag-register-rewards").html(a);d.find("div.flag-register-rewards").attr("cached",1);d.find("div.flag-register-rewards .error-message").each(function(){var a=H(this),b=a.data("errorid");a.html(c.displaydata[b])});fa()}})}}
function la(d){var e=H(d.target);if(!e.is(":visible"))return d.preventDefault(),d.stopPropagation(),!1;h.isSPP()&&(h.isPrefetchFromAddressEnabled()?h.disablePageNoUpdateTransition():H("#payment").find(".panel-cancel-row").hide(),K.clearCache());var f=H(d.currentTarget);A.jppoints.length&&c.handleJPPointsOnPaymentRows(d);var g=f.find("[name\x3duseAvailableBalance]");if("useAvailableBalance"!==d.target.name&&!g.length)if(ea(f),t.toggleGCForMCB(f,A),S(f),f.hasClass("payment-selected")||f.hasClass("payment-label"))A.disableSubmitButtons.length&&
(pa(f,f,!1),!e.hasClass("continue-center")&&f.find(".continue-center").length||Y());else if(d=f.find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),d.length&&"disabled"!==d.attr("disabled")){$a();d=F();h.isSPP()?d.filter(function(){var a=H(this).attr("id");return"gcPromo"===a?(a=H(this).find('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]'))&&a.length:"jppoints"!==a}).removeClass("payment-selected"):d.removeClass("payment-selected");d.find("[name\x3dpaymentMethod]").attr("checked",
!1);d.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");d.find(".top-cell").removeClass("bottom-line");ia(d);b.isTouchCX()&&(d.find(".bottom-cell").hide(),d.find(".card-unreg-rewards").show());f.addClass("payment-selected");f.find("[name\x3dpaymentMethod]").attr("checked",!0);f.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active");var e="true"===b.getAttributeData(f,
"isaddresschallenge")?1:0,g=f.find('.rewards-list input[type\x3d"radio"]').length,k="1"===b.getAttributeData(f,"hasDerivedCurrency")?1:0,l=f.find(".vcc-form-fields").length,m=f.find(".card-ref-num").length;b.isTouchCX()&&(e||g||l||m||k)&&(f.find(".top-cell").removeClass("align-top bottom-line").addClass("bottom-line"),f.find(".bottom-cell").show());q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:select-payment-row",f,xa)});Ja(f);Ka(f);La(f);Ma(f);ab(f);"1"===
H("#suppressionMessageFixEnabledStatus").val()&&bb(f);cb(f);Na(f);Ca(f);Oa(f);db(f);eb(f);Pa(f);Ea(v,v.toggleEMIMenu,f);Qa(f);fb();sa(f);Xa();oa();I();V();va();qa(f,d);Ra();H.isEmptyObject(y)||y.toggleCustomerNudgingMessage(f);A.hideInputBoxes.length&&(Sa(f,d),Ta(f));A.disableSubmitButtons.length&&pa(f,d,!0);Ga();xa();A.disableSubmitButtons.length&&!f.find(".continue-center").length&&Y()}}function S(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=H("input[type\x3d'hidden'][name\x3d'paySelectLocale']");
b.length&&"IN"===b.val()&&a.length&&q.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-NonMobile",1)})}function ea(a){var b=H("#isGlobalCODEligible").val();if(b&&"0"!==b){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=H("#button-add-gcpromo"),c=H("#button-add-gcpromo").parent().parent();a.length?(c.addClass("a-button-disabled"),b.attr("disabled","disabled")):(c.removeClass("a-button-disabled"),b.removeAttr("disabled"))}}function ra(a){q.when("A",
"a-tv").execute(function(b,c){b=b.$;var d=b(a);d.length&&(b(".tv-lastSelected").removeClass("tv-lastSelected"),d.addClass("tv-lastSelected"),c.select(d))})}function pa(a,b,c){c&&b.find(".billing-address, .cc-continue-button").hide();if(a.find(".tv-update").length)Sa(a,b),Ta(a);else{var d=a.find(".billing-address, .cc-continue-button");if(d.length&&!d.is(":visible")){var e=!1;a.find(".no-address").length&&(e=!0,a.find(".a-button-primary").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden"));
q.when("a-tv").execute(function(f){c&&(b.find(".payment-container").hasClass(".a-tv-navigate")||f.add(b.find(".payment-container")));f.remove(a.find(".payment-container"));f=e?a.find(".billing-address-link"):d.find(".continue-center");ra(f)});d.show()}}}function sa(a){var b=H("#one-click-final-review-message");b.length&&(a.find("#canTryTFX").length?b.removeClass("aok-hidden"):b.addClass("aok-hidden"))}function qa(a,c){if(b.isTouchCX()&&(c&&c.find(".top-cell .data-row").children(".a-column").height("auto"),
a)){a=a.find(".top-cell .data-row");var d=a.find(".addr-challenge-card-scan .a-box");if(d.length){c=a.height();var d=d.height(),e=a.children(".a-column:first");a.children(".a-column").height(d);e.height(c);e.children(".vertical-center-grid:first").height(d)}else a.children(".a-column").height(a.height())}}function ua(c){g.hide();var d=l.jsonify(c);d.imbWidgetHTML&&H("#imb-wrapper").html(b.decodeJSONResponse(d.imbWidgetHTML));if(d.cardWidgetHTML&&(c=F(),c.replaceWith(b.decodeJSONResponse(d.cardWidgetHTML)),
null!=d.rewardsAccountsWidgetHTML&&q.when("rewards-section-desktop").execute(function(c){a.trigger("rewards-section-desktop:refresh-rewards-section",b.decodeJSONResponse(d.rewardsAccountsWidgetHTML))}),a.trigger("checkout:reload"),a.trigger("checkout:reload:payselect"),c=F(),"true"!==b.getAttributeData(c,"isaddresschallenge"))){m.setCardPasswordInputStatus(c,d.newpaymentmethodid,"cvv","#existingCvvNum");m.setCardPasswordInputStatus(c,d.newpaymentmethodid,"pincode","#existingPincodeNum");if(A.cvvColumnLabel.length){var e=
!1;A.paymentRows.each(function(){if("true"===b.getAttributeData(H(this),"isaddresschallenge"))return e=!0,!1});e||A.cvvColumnLabel.hide()}A.disableSubmitButtons.length&&Y()}}function oa(){A.paymentRows.each(function(){var a=H(this),c=a.find('.currency-list input[type\x3d"radio"]').length,d=a.find('.rewards-list input[type\x3d"radio"]').length,e=a.find(".card-reg-info").is(":visible"),f=a.find(".expire-date-fields").is(":visible"),g=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),
h=a.find(".bottom-cell .inner-grid-left"),k=a.find(".bottom-cell .inner-grid-right");f?c||d||e?(h.removeClass("hidden a-span10 a-span12").addClass("a-span8"),k.removeClass("a-span12 a-span2 hidden").addClass("a-span4")):(h.removeClass("a-span8 a-span10 a-span12").addClass("hidden"),k.removeClass("a-span4 a-span2 hidden").addClass("a-span12")):g?(h.removeClass("a-span12 a-span8 hidden").addClass("a-span10"),k.removeClass("hidden a-span4 a-span12").addClass("a-span2")):(h.removeClass("a-span10 a-span8 hidden").addClass("a-span12"),
k.removeClass("a-span2 a-span4 a-span12").addClass("hidden"));!b.isTouchCX()&&g&&(c||d||e)&&a.find(".bottom-cell").removeClass("align-top").addClass("align-top")});var a=F(),c=a.find("a[data-action\x3dshow-expire-date-fields]").filter(":visible").length,d=a.find(".top-cell.bottom-line").length;c&&!d||a.find(".bottom-cell").removeClass("align-top")}function I(){b.isTouchCX()&&A.paymentRows.each(function(){var a=H(this),c="true"===b.getAttributeData(a,"isaddresschallenge")?1:0,d=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),
e=a.find(".expire-date-fields").is(":visible"),f=a.find(".card-reg-info").is(":visible"),g=a.find(".rewards-info").is(":visible"),h=a.find(".change-currency").is(":visible");d?a.find(".top-cell .second-row").addClass("align-top"):a.find(".top-cell .second-row").removeClass("align-top");c=c||h||f||g;f=e||d;g=a.find(".top-cell .inner-grid-left");a=a.find(".top-cell .inner-grid-right");c||(g.removeClass("a-span6 a-span8 a-span12").addClass("hidden"),a.removeClass("a-span4 a-span6 hidden").addClass("a-span12"));
f||(g.removeClass("a-span6 a-span8 hidden").addClass("a-span12"),a.removeClass("a-span4 a-span6 a-span12").addClass("hidden"));c&&d&&(g.removeClass("a-span6 a-span12 hidden").addClass("a-span8"),a.removeClass("a-span6 a-span12 hidden").addClass("a-span4"));c&&e&&(g.removeClass("a-span6 a-span8 hidden").addClass("a-span6"),a.removeClass("a-span4 a-span12 hidden").addClass("a-span6"))})}function ia(a){var b=a.find(".currency-list");if(b.length){var c=b.find("[type\x3dradio]:checked").val(),b=b.find("#cardCurrencyDropDown option:selected").val();
"Other"!==c||"-1"!==b&&"-2"!==b||a.find(".currency-list input[type\x3dradio][value!\x3dOther]").attr("checked",!0)}}function ya(a){var b=H(a.currentTarget);a=b.find("option:selected");if(""===a.val())b.parents("div.selected-section").find(".selected-note-content").hide();else{var c=a.prop("disabled"),b=b.parents("div.selected-section"),d=b.find("#active-bank-content"),e=b.find("#disable-bank-content");c?(e.show(),d.hide()):(d.show(),e.hide());b.find("span.selected-note-bank").text(a.text()).show()}}
function T(a){var b=H(a.currentTarget);a=b.find("option:selected");""===a.val()?b.parents("div.selected-section-more-payment-method").find(".selected-more-payment-content").hide():(b=b.parents("div.selected-section-more-payment-method"),b.find("span.selected-payment-option").text(a.text()).show(),b.find("span.selected-more-payment-content").show())}function ta(a){(A.continueErrPopover.filter(":visible").length||Da())&&a.$event.preventDefault()}function wa(b){b=H(b.currentTarget);var c=b.find("input[type\x3dcheckbox]");
c.attr("checked")?(c.attr("checked",!1),b.find(".checked-checkbox").addClass("aok-hidden"),b.find(".empty-checkbox").removeClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").addClass("aok-hidden")):(c.attr("checked",!0),b.find(".checked-checkbox").removeClass("aok-hidden"),b.find(".empty-checkbox").addClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").removeClass("aok-hidden"));q.when("a-tv").execute(function(b){setTimeout(function(){b.select(".tv-lastSelected")},500);a.trigger("a:tv:resize")})}
function ka(a){a=H(a.currentTarget);"1"===a.attr("isclicked")?a.attr("isclicked",0):a.attr("isclicked",1);va()}function va(a){var c=H("#pm_promo");a=H("#pm_gc_radio");var d=H("#pm_gc_checkbox"),e;H("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").length&&(e=H("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val());if(a&&a.length||d&&d.length){var f=H("input[name\x3dgcBalanceRaw]").val();H("input[name\x3damBalanceRaw]").length&&(f=H("input[name\x3damBalanceRaw]").val());
var g=H("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),h=H("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),k=H("input[name\x3damAvailableBalanceRaw]").val(),l=H("input[name\x3dremainingBalanceRaw]").val(),m=H("input[name\x3dpurchaseTotalRaw]").val(),t,p,na=H(".purchase-total").length;na?(p=H(".purchase-total").html(),t=H(".remaining-balance").html()):(p=H("input[name\x3dpurchaseTotal]").val(),t=H("input[name\x3dremainingBalance]").val());var r=H(".balance-applied");na?r.html(p):
r.text(p);(b.isTouchCX()&&"checkbox"===c.attr("type")?"1"===c.closest(".a-control-row").attr("isclicked"):c.is(":checked"))?(c=l,0<c&&(na?r.html(t):r.text(t))):c=m;g&&D.renderAPBMessagingRemainingBalance({purchaseTotal:p,remainingBalance:t,balanceApplied:r,isPurchaseTotalInSpan:na},f,m,k);t=a.closest(".radio-col");p=d.closest(".radio-col");l=H(".amazon-money-limit-breached");na=H(".long");r=H(".short");"1"===g&&"1"===h?D.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:t,gcCheckboxContainer:p,
gcCheckbox:d,gcRadio:a,shortMsg:r,longMsg:na,amazonMoneyLimitBreachedMsg:l}):0<=f-m?("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),t.removeClass("hidden"),a.is(":checked")&&t.trigger("click"),p.addClass("hidden"),d.attr("disabled","disabled"),0==f-m?(na.hide(),r.show()):(na.show(),r.hide())):0<f-c?0>=c?(p.removeClass("hidden"),d.attr("disabled","disabled"),b.isTouchCX()&&p.find("i").addClass("a-button-disabled checkbox-disabled"),t.addClass("hidden"),a.attr("disabled","disabled"),r.show(),
na.hide()):("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),t.removeClass("hidden"),a.is(":checked")?t.trigger("click"):b.isTouchCX()&&t.find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),p.addClass("hidden"),d.attr("disabled","disabled"),na.show(),r.hide()):("disabled"===d.attr("disabled")&&(d.removeAttr("disabled"),b.isTouchCX()&&p.find("i").removeClass("a-button-disabled checkbox-disabled")),p.removeClass("hidden"),(h=p.closest(".payment-row"))&&
h.hasClass("payment-selected")&&h.removeClass("payment-selected"),t.addClass("hidden"),a.attr("disabled","disabled"),"1"===g?D.renderAPBInsufficientMessaging({shortMsg:r,longMsg:na},f,k):(r.show(),na.hide()));"1"===e&&(a.attr("disabled","disabled"),d.attr("disabled","disabled"),(h=p.closest(".payment-row"))&&h.hasClass("payment-selected")&&h.removeClass("payment-selected"))}}function ha(b){var c=F().find(".enter-custom-rewards");if("rewardscustom"===H(b.currentTarget).children('input[type\x3d"radio"]').val()){c.show();
var d=c.find("input.custom-rewards-input");d.focus();A.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")&&(c=d.val().length,d=d.get(0),d.setSelectionRange?d.setSelectionRange(c,c):d.createTextRange&&(d=d.createTextRange(),d.collapse(!0),d.moveStart("character",c),d.moveEnd("character",c),d.select()))}else c.hide();q.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",H(b.currentTarget))});xa()}function ma(a){a=
a.$target||H(a.currentTarget);ja(a)}function ja(b){if(b.length){var c=A.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),d=A.paymentRows.find(".installments-select.a-row"),e=d.siblings(".installments-message"),f=d.siblings(".card-offers"),g=A.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),h=A.installmentsOnlyCards,k=A.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),l=A.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]');
if(c.length){var t=c.closest(".payment-row"),m=g.closest(".payment-row"),p=k.closest(".payment-row"),na=l.closest(".payment-row");b.is(":checked")?(c.prop("disabled",!0),c.is(":checked")&&(c.prop("checked",!1),t.removeClass("payment-selected")),c.parent().siblings().addClass("a-color-secondary"),Ea(v,v.disableEMIPaymentMethods,k),q.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",l)}),z.showInstantBankDiscountAmazonPaySelected(),Aa(g,m),(b=d.find("select"))&&b.each(function(){var a=
this.id.replace(/\./g,"\\.");u.setValue(a,"")}),d.find(".installments-enabled-text").hide(),e.find(".installments-enabled-text").hide(),f.find(".installments-enabled-text").hide(),d.find(".installments-disabled-text").show(),e.find(".installments-disabled-text").show(),f.find(".installments-disabled-text").show(),h.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),h.removeClass("payment-selected")):(t.find(".payment-invalid").length||(c.prop("disabled",!1),c.parent().siblings().removeClass("a-color-secondary")),
m.find(".payment-invalid").length||za(g,m),p.find(".payment-invalid").length||Ea(v,v.enableEMIPaymentMethods,k),na.find(".payment-invalid").length||q.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",l)}),z.showInstantBankDiscountAmazonPayDeselected(),d.find(".installments-disabled-text").hide(),e.find(".installments-disabled-text").hide(),f.find(".installments-disabled-text").hide(),d.find(".installments-enabled-text").show(),e.find(".installments-enabled-text").show(),
f.find(".installments-enabled-text").show(),h.find("input[name\x3dpaymentMethod]").removeAttr("disabled"))}}}function za(a,b){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");b.find(".selected-section-more-payment-method").show();b.find(".more-payment-gc-disabled-text").hide()}function Aa(a,b){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",!1),b.removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");b.find(".selected-section-more-payment-method").hide();
b.find(".more-payment-gc-disabled-text").show()}function Ba(a){var c=a.$target||H(a.currentTarget);a=c.closest(".currency-list");c=c.val();!0===(b.isTouchCX()?"Other"===c:"Other"!==c)?(a.find("select").attr("disabled",!0),a.find(".a-button.a-button-dropdown").addClass("a-button-disabled"),a.find(".a-button.a-touch-select").addClass("a-button-disabled")):(a.find("select").attr("disabled",!1),a.find(".a-button.a-button-dropdown").removeClass("a-button-disabled"),a.find(".a-button.a-touch-select").removeClass("a-button-disabled"));
xa()}function R(a){r.actionReregisterCardInBox(a);b.scrollTopTo(F())}function na(a){xa()}function Wa(){A.paymentRows.each(function(){var a=H(this),c=".card-ref-num, .addr-challenge, .addr-challenge-msg, .cup-expired-msg, .enter-date, .expire-date-fields, .rewards-static-help-link, .verified-fail-msg, .tv-update, .billing-address, .cc-continue-button",d=".card-info, .card-name, .card-reg-info, .expire-info, .rewards-err-msg, .rewards-list label, .rewards-list div.a-radio, .rewards-dynamic-help-link, .financial-offer-err-detail";
a.hasClass("payment-selected")&&("1"===b.getAttributeData(a,"hasDerivedCurrency")||"1"===b.getAttributeData(a,"hasPreferredCurrency")&&"1"===b.getAttributeData(a,"isNewCard"))||(c+=", .currency-list");"1"===b.getAttributeData(a,"hasPreferredCurrency")&&"1"!==b.getAttributeData(a,"isNewCard")&&(d+=", .change-currency");a.find(c).hide();a.find(d).show()})}function Xa(){A.paymentRows.each(function(){var a=H(this),c="#cc-errors, .enter-date, .expire-date-fields",d=".expire-info";if(a.hasClass("payment-selected")&&
"1"===b.getAttributeData(a,"hasDerivedCurrency"))c+=", .change-currency",d+=", .currency-list";else{var e=a.find(".currency-list"),f=e.find("[type\x3dradio]:checked").val();if(f){var g;if("Other"!==f)g=e.find(".currencyNameLabel").html();else{var f=e.find("#cardCurrencyDropDown option:selected"),h=f.val();"-1"!==h&&"-2"!==h&&(g=f.text())}g&&(d+=", .change-currency",e.closest("div.payment-row").find(".change-currency .currencyNameLabel").html(g))}c+=", .currency-list"}a.find(c).hide();a.find(d).show()})}
function Ya(){var a=H("#aan-ads-box");if(a.length){var b=a.data("adsendpoint"),c=a.data("adsclient"),d="https://"+b+"/2009-09-09/ad/",b="/jsc?pt\x3dstatic\x26slot\x3dlib\x26pt2\x3daanjs";a.data("useaannojq")&&(b+="-nojq");H.getScript(d+c+b,function(){n.d16g&&n.d16g.requestAanAd({elemId:"aan-ads-box",baseUrl:d,afterOnload:!0,client:c,pt:"checkout",slot:"display-ad-right",pt2:"payselect"})})}}function Za(){Ua&&(a.declarative("auto-rewards-reg",["click"],L),a.declarative("complete-rewards-register",
["click"],G),a.declarative("confirm-card",["click"],C),a.declarative("register-card-rewards",["click"],da),a.declarative("cancel-register-card-rewards",["click"],N),a.declarative("show-currencies",["click"],Z),a.declarative("show-expire-date-fields",["click"],w),a.declarative("focus-cc-update-fields",["click"],ca),a.declarative("show-rewards-reg",["click"],U),a.declarative("submit-payment-form",["submit"],ta),a.declarative("toggle-tfx-option",["click"],Ba),a.declarative("reregister-cc-in-dashboard",
["click"],R),a.declarative("modify-expire-date-fields",["change"],na),b.isTouchCX()&&a.declarative("continue-button",["click"],Q),Ua=!1);A.paymentRows.unbind("click").has("input[name\x3dpaymentMethod]:enabled").bind("click",la);q.when("apx-payselect-helper").execute(function(){var a=J.get("payselect");a&&a.initEvents(A.paymentRows,xa)});A.paymentRows.find("input[name\x3dusePromoBalance]").unbind("change",va).bind("change",va);A.disableSubmitButtons.length&&A.paymentRows.has("input[type\x3dcheckbox]:enabled").unbind("click",
wa).bind("click",wa);A.existingPincodeNum.unbind("click",Ia).bind("click",Ia);A.paymentRows.find("select#cardCurrencyDropDown").unbind("change",O).bind("change",O);A.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")?A.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ha).each(function(b,c){c=a.$(c);b=c.find("input.custom-rewards-input");c=c.find(".custom-reward-points");var d=a.$(b);b={$element:d,maxAmount:d.data("max")};c={$element:a.$(c),
decimalPlaces:d.data("decimalplaces"),ratio:d.data("ratio")};d=d.data("country-code");d=x.getCurrencyFormatByCountryCode(d);x.initializeInlineFormatting(b,c,d)}):A.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ha).undelegate("input.custom-rewards-input","keyup").delegate("input.custom-rewards-input","keyup",P);if(b.isTouchCX())A.pageContainer.find("#existing-payment-methods").find("select, input[type\x3dtext], input[type\x3dpassword]").unbind("change",V).bind("change",
V),A.pageContainer.find("#existing-payment-methods").find("div.currency-list label.a-touch-radio").unbind("click").bind("click",Ba),A.pageContainer.find("#existing-payment-methods").find("label.promoLabel").unbind("click").bind("click",ka);else if(!h.isSPP()){var d=A.continueBtns.find(".a-button-text");H("#payPageContinueBtnStateFixEnabled").length?d.filter('input[type\x3d"button"]').unbind("mouseenter",Fa).bind("mouseenter",Fa).unbind("focus",Fa).bind("focus",Fa).unbind("mouseleave",W).bind("mouseleave",
W).unbind("blur",W).bind("blur",W):(d.filter('input[type\x3d"submit"]').unbind("mouseenter").bind("mouseenter",M).unbind("focus").bind("focus",M),d.filter('input[type\x3d"button"]').unbind("mouseleave").bind("mouseleave",aa).unbind("blur").bind("blur",aa))}A.netBankingSelect.unbind("change",ya).bind("change",ya);A.morePaymentMethodsSelect.unbind("change",T).bind("change",T);A.continueBtnBottom.unbind("click").bind("click",Y);0<H("input[name\x3d'needDisableCODandEMIforGC']").length&&(d=H("input#pm_300[type\x3d'checkbox'], #pm_gc_checkbox"),
d.length&&(d.bind("change",ma),d.is(":checked")&&ja(d)));A.jppoints.length&&A.paymentRows.find('input[name\x3d"useAvailableBalance"]').bind("click",c.handleJPPointsOnPaymentRows);q.when("installments-payselect").execute(function(){a.trigger("installments-payselect:initEvents")});A.hideInputBoxes.length&&(A.paymentRows.find("#confirm-card").unbind("focus").bind("focus",E),A.paymentRows.find("#newExpDate").unbind("focus").bind("focus",ba),A.paymentRows.find("#newExpDate").unbind("change").bind("change",
ga))}function Ga(){var a=f.create();a.validatePayment(F());a.hasErrors()||h.makePrefetch(A.existingPaymentForm)}function Ia(a){a=A.showAmexWarning;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function Ha(){if(!b.isMobileCX()){A=b.getElements(gb);A.paymentRows.filter(".payment-selected-marker").removeClass("payment-selected-marker").addClass("payment-selected");var c=F();q.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:page-load",xa)});q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:page-load")});
Ma(c);Ca(c);sa(c);Wa();Ja(c);Ka(c);La(c);Oa(c);Pa(c);Qa(c);Na(c);va();Ra();H.isEmptyObject(y)||y.toggleCustomerNudgingMessage(c);H(document).undelegate("div.pay-desktop .checkout-page-form","keypress").delegate("div.pay-desktop .checkout-page-form","keypress",X);H(document).undelegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup").delegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup",xa);A.addressChallengeCardList.length&&A.addressChallengeCardList.show();
A.paymentRows.find('input[type\x3d"radio"][value\x3d"rewardsmax"]').each(function(){H(this).siblings('[type\x3d"checkbox"]').remove()}).removeClass("hidden");I();oa();Za();A.existingPaymentForm.data("checkoutFormReady",!0);Ga();Ya();A.orderSummaryBottom.show();qa(c);V();xa();ea(c);t.determineIsMCBEnabled(A);t.toggleGCForMCB(c,A);H(".a-popover-preload").each(function(){var b=H(this).find(".rewards-registration").data("parentPaymentMethodId");b&&(a.off("a:popover:show:rewards-registration-"+b,e.displayRewardsRegister),
a.off("a:popover:hide:rewards-registration-"+b,e.hideRewardsRegister),a.on("a:popover:show:rewards-registration-"+b,e.displayRewardsRegister),a.on("a:popover:hide:rewards-registration-"+b,e.hideRewardsRegister))});q.when("a-tv").execute(function(b){a.trigger("a:tv:resize");c.find(".a-tv-navigate").length&&pa(c,c,!1)})}}function xa(b){h.isSPP()?(Da()?A.disableSubmitButtons.length?(b=F(),b.find(".continue-center").addClass("aok-hidden"),b.find(".a-button-disabled").removeClass("aok-hidden")):(A.continueBtns.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),
A.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")):aa(),a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")):H("#payPageContinueBtnStateFixEnabled").length&&M(b)}function Va(a,b){a=H(a.target).closest(".order-summary-box").find(".continue-button-errors");a.length&&b.length&&(b=d.triggerLeft(a,b),a.show(),a.offset(b))}function Fa(a){if((!A.continueErrPopover.filter(":visible").length||b.isTouchCX())&&A.continueErrPopover.find(".error-message:not(.hidden)").length&&a&&
("mouseenter"===a.type||"focus"===a.type)){var c=H(a.target).closest(".continue-buttons").find(".a-button-disabled");Va(a,c)}}function Da(a){if(A.continueErrPopover.filter(":visible").length&&!b.isTouchCX())return!0;var c=F(),e=f.create();Ea(v,v.isEMIPaymentInstrument,c)&&(e.validateEMIMenuForContinueButton(c),c=Ea(v,v.getEMIMenuSelectedCardSection));e.validatePayment(c);e.apxValidatePayment(c,A.paymentRows);e=e.getHighestErrorId();if(!e||!e.identifier)return!1;A.continueErrPopover.find(".error-message").hide();
c=c.find(".pincode-err-block");c.hide();c&&c.length&&e.target&&e.target.length&&e.target.addClass("a-form-error");e.isPincodeError?(c.show(),c.addClass("a-form-error")):(A.continueErrPopover.find("#"+e.identifier).show(),A.continueErrPopover.find("#"+e.identifier).removeClass("hidden"),!a||"mouseenter"!==a.type&&"focus"!==a.type?h.isSPP||A.continueBtns.find(".a-button input").filter(":visible").each(function(){var a=H(this).closest(".order-summary-box").find(".continue-button-errors"),b=d.triggerLeft(a,
H(this));a.show();a.offset(b)}):(c=H(a.target).closest(".continue-buttons").find(".a-button-primary"),Va(a,c)));return!0}function Ja(c){A.paymentRows.find(".addr-challenge, .addr-challenge-msg").hide();A.hideInputBoxes.length?A.paymentRows.find(".card-name").show():A.paymentRows.find(".card-info").show();if("true"===b.getAttributeData(c,"isaddresschallenge")){var d=c.find(".addr-challenge, .addr-challenge-msg");0===d.length&&k.increaseCount("Checkout:Payment:AddressChallengeMissingInputAndMsg");d.show();
A.hideInputBoxes.length?c.find(".card-name").hide():c.find(".card-info").hide();c=c.attr("paymentmethodid")?c.attr("paymentmethodid"):c.attr("data-paymentmethodid");a.trigger("checkout:payment:challenge:log",c)}}function Ta(a){A.paymentRows.find(".expire-date-fields").hide();a=a.find(".expire-date-fields");a.length&&a.show()}function Ra(){A.paymentRows.find(".pci-blocking-cvv").length&&A.paymentRows.each(function(){var a=H(this),b=a.find(".pci-blocking-cvv");a.find("[type\x3dradio]:checked").val()&&
b.length?b.show():b.length&&b.hide()})}function Sa(a,b){q.when("a-tv").execute(function(c){c.add(b.find(".payment-container"));b.find(".tv-update").hide();var d=a.find(".tv-update");d.length&&(c.remove(a.find(".payment-container")),d.show(),ra(d.find(".a-button-primary")))})}function Ka(a){A.paymentRows.find(".verified-fail-msg").hide();"true"===b.getAttributeData(a,"isverifiedfail")&&a.find(".verified-fail-msg").show()}function La(a){A.paymentRows.find(".cup-expired-msg").hide();"true"!==b.getAttributeData(a,
"iscupcardexpired")&&"true"!==b.getAttributeData(a,"iscupcardexpiringsoon")||a.find(".cup-expired-msg").show()}function Ma(c){A.paymentRows.find(".rewards-list").hide();A.paymentRows.find(".top-cell .inner-grid-left").show().find(".rewards-info").show();var d=c.find('.rewards-list input[type\x3d"radio"]'),e=d.filter(":checked");A.paymentRows.find('.rewards-list input[type\x3d"radio"]').prop("checked",!1);0<e.length?e.prop("checked",!0):c.find(".rewards-list").hasClass("apply-by-default")?d.filter('[value\x3d"rewardsmax"]').prop("checked",
!0):d.filter('[value\x3d"rewardsnone"]').prop("checked",!0);d=c.find(".rewards-list").show();d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")&&d.children(".enter-custom-rewards").show();b.isTouchCX()&&d.length&&(c.find(".rewards-info").hide(),c.find(".top-cell").addClass("bottom-line"),c.find(".bottom-cell").show());q.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",c)})}function Ca(a){A.paymentRows.find(".financial-offer-list").hide();
A.paymentRows.find(".financial-offer-err-detail").hide();var c=a.find('.financial-offer-list input[type\x3d"radio"]'),d=c.filter(":checked");c.prop("checked",!1);0<d.length?d.prop("checked",!0):c.first().prop("checked",!0);c=a.find(".financial-offer-list").show();a.find(".financial-offer-err-detail").show();b.isTouchCX()&&c.length&&(a.find(".top-cell").addClass("bottom-line"),a.find(".bottom-cell").show())}function $a(){H(document.body).find(".a-dropdown").each(function(){B.hide(H(this))})}function ab(a){A.paymentRows.find(".installments-select").hide();
A.paymentRows.find(".installments-message").show();a.find(".installments-select").show();a.find(".installments-message").hide()}function bb(a){A.paymentRows.find("#savedCardSuppressed").hide();a.find("#savedCardSuppressed").show()}function cb(a){A.paymentRows.find(".installments-list").hide();a.find(".installments-list").show()}function Na(a){A.paymentRows.find(".card-ref-num, .selected-note, .selected-more-payment-option").hide();A.paymentRows.find(".card-benefit").show();a.find(".card-ref-num, .selected-note, .selected-more-payment-option").show();
a.find(".card-benefit").hide()}function db(a){A.paymentRows.find(".otpBlock").hide();a.find(".otpBlock").show()}function eb(a){A.paymentRows.find(A.ovdWidgetSection).hide();a.find(A.ovdWidgetSection).show()}function Oa(a){A.paymentRows.find(".vcc-info-prompt,.vcc-form-fields").hide();a.find(".vcc-info-prompt,.vcc-form-fields").show()}function Pa(a){var b=A.newVDC.find("#vdcBanksSelect"),c=A.newVDC.find(".vdc-selected-bank-prompt").hide(),d=A.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=b.val(),
f="1"===H("#save_citi_card").val()?"CIT"!==e:!0,g="1"===H("#save_citi_card").val()&&"CIT"===e;a.find("#vdcBanksSelect").length?""!==e&&"OtherBanks"!==e&&f&&(A.newVDC.find("option:selected").prop("disabled")?(d.show(),c.hide()):(d.hide(),c.show())):(("OtherBanks"===e||g)&&b.val(b.children("option").first().val()).trigger("change"),c.hide())}function Ea(a,b,c){if(!H.isEmptyObject(a)&&b)return b(c)}function Qa(a){var b=H("#cash-back-ineligible-for-cod-message");b&&b.length&&((a=a.find("#cashOnDeliveryCash"))&&
a.length?b.removeClass("hidden"):b.addClass("hidden"))}function fb(){var a=H("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}var H=a.$,Ua=!0,A={},gb={cardImages:"#newCreditCardImages",continueBtns:".continue-buttons:not(.place-order-button)",continueBtnTop:"#continue-top",continueBtnBottom:"#continue-bottom",continueErrPopover:".continue-button-errors",cvvColumnLabel:"#cvvColumnLabel",
existingPaymentForm:"form.checkout-page-form",netBankingSelect:"#net-banking-select-list",morePaymentMethodsSelect:"#more-payment-methods-select-list",newVDC:"#new-vdc",newEMI:"#newEmiCard",orderSummaryBottom:"#order-summary-bottom",pageContainer:"div.a-container",paymentRows:"#existing-payment-methods .payment-row",rewardsRegister:"#rewards-register",addressChallengeCardList:".address-challenge-card",hiddenFormFields:"#hiddenFormFields",jppoints:"#jppoints",gcpromo:"#gcPromo",disableSubmitButtons:"#disableSubmitButtons",
hideInputBoxes:"#hideInputBoxes",showAmexWarning:"#showAmexWarning",existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning",installmentsOnlyCards:".installments-only-card",ovdWidgetSection:"#ovdWidgetSection"};a.on("checkout:reload:payselect",Ha);a.on("checkout:reload:spp-payment",Ha);return{getSelectedPayment:F}});"use strict";q.when("A","page-detector").register("wechat-detector",function(a,l){var k=a.$,b=function(a){a&&!1!==a.isWeChatInstalled&&(a=k("#wechat_payment"),a.length&&
a.show())},f=function(a){},g="MShopWeChatPayment";a.on("checkout:reload:payselect",function(){k("#wechat_payment").length&&(k("#mShopWeChatApiName").length&&(g=k("#mShopWeChatApiName").val()),q.when("safe-mash").execute(function(a){n.cordova.require("cordova/exec")(b,f,g,"isWeChatInstalled",[])}))})});"use strict";q.when("A","page-main","client-side-metrics","ready").register("otp-for-cod",function(a,l,k){function b(){x=u("#cashOnDeliveryCash");if(x.length&&(q=x.find(E.verifyOTP),r=x.find(E.sendOTP),
F=q.length&&r.length,L=u(E.payMobile).length?1:0,F&&(t=x.find(E.submitSendOTP),v=x.find(E.submitVerifyOTP),z=x.find(E.submitResendOTP),y=x.find(E.changeOTPNumber),J=x.find(E.OTPPhoneNumber),D=x.find(E.otpCode),t.length&&v.length&&z.length&&y.length))){P=x.find(E.addURLHash).length;k.increaseCount(W.metricPrefix+W.block,1,1);t.click(function(){n();k.increaseCount(W.metricPrefix+W.send,1,1)});v.click(function(){G=J.val();V=D.val();p();var a=g(G),b;b=/^\d{6}$/;b=V&&b.test(V);a&&b&&""!==M?m("VerifyOTP",
M):b?a||x.find(E.otpServiceFailed).removeClass(E.aokHidden):x.find(E.invalidOTPError).removeClass(E.aokHidden);k.increaseCount(W.metricPrefix+W.verify,1,1)});if(P&&location.hash&&location.hash.length){for(var a=location.hash,a=a.replace("#",""),a=a.split(";"),b=0;b<a.length;b++)0<=a[b].indexOf(C.codehandle)&&(M=a[b].replace(C.codehandle,"")),0<=a[b].indexOf(C.contactid)&&(Q=a[b].replace(C.contactid,"")),0<=a[b].indexOf(C.phonenumber)&&(G=a[b].replace(C.phonenumber,""),J.val(G));""!==M&&""!==Q&&""!==
G&&d()}z.click(function(){k.increaseCount(W.metricPrefix+W.resend,1,1);n()});y.click(function(){q.addClass(E.aokHidden);r.removeClass(E.aokHidden);f(z,!1);f(v,!1);p();k.increaseCount(W.metricPrefix+W.changeNumber,1,1)})}}function f(a,b){b?a.addClass(E.aButtonDisabled):a.removeClass(E.aButtonDisabled);L?a.find("button").prop("disabled",b):a.find("input").prop("disabled",b)}function g(a){var b=/^\d{10}$/;return a&&b.test(a)}function h(){x.find(E.otpServiceFailed).removeClass(E.aokHidden)}function d(){var a=
x.find(E.verifyOTPPhoneNumber);x.find(E.invalidPhoneNumber).addClass(E.aokHidden);r.hasClass(E.aokHidden)?x.find(E.otpResentSuccess).removeClass(E.aokHidden):L&&x.find(E.otpSentSuccess).removeClass(E.aokHidden);r.addClass(E.aokHidden);q.removeClass(E.aokHidden);var b=G.substr(0,2)+"*****"+G.substr(7,9);a.text(b);f(z,!1)}function e(a){if(void 0!==a&&"object"!==typeof a)try{a=u.parseJSON(a)}catch(b){a={}}a=a||{};var d,e=P&&location.hash?location.hash:"#";P&&location.hash&&";"!==e.slice(-1)&&(e+=";");
d=a.status;a.codeHandle&&null!==a.codeHandle&&(M=a.codeHandle,P&&"SEND-SUCCESS"===d&&(e=c(e,C.codehandle,M)));a.contactId&&null!==a.contactId&&(Q=a.contactId,P&&"SEND-SUCCESS"===d&&(e=c(e,C.contactid,Q),e=c(e,C.phonenumber,G)));P&&(location.hash=e);x.find(E.otpAlertClass).addClass(E.aokHidden);if(aa[d])aa[d]();else aa.DEFAULT()}function c(a,b,c){var d=a.indexOf(b);if(0<=d){var e=a.indexOf(";",d),e=0<=e?e:a.length;a=a.substring(0,d)+a.substring(e+1,a.length+1)}return a+b+c+";"}function m(b,c){a.ajax("/gp/buy/payselect/handlers/otpAjaxHandler.html",
{method:"get",params:{phoneNumber:G,method:b,codeHandle:c,contactId:Q,otp:V},success:e,error:function(){e({status:"SERVICE-FAILED"})}})}function p(){D.val("");x.find(E.otpAlertClass).addClass(E.aokHidden)}function n(){p();G=J.val();g(G)?m("SendOTP",M):x.find(E.invalidPhoneNumber).removeClass(E.aokHidden)}var u=a.$,x,q,r,t,v,z,y,J,D,F,L,P,G="",M="",Q="",V="",E={aokHidden:"aok-hidden",aRadio:".a-radio",aButtonHidden:"a-button-hidden",aButtonDisabled:"a-button-disabled",payMobile:".pay-mobile",invalidOTPError:".invalidOTPError",
verifyOTP:"#verifyOTP",sendOTP:"#sendOTP",submitSendOTP:"#submitSendOTP",submitVerifyOTP:"#submitVerifyOTP",submitResendOTP:"#submitResendOTP",changeOTPNumber:"#changeOTPNumber",OTPPhoneNumber:"#OTPPhoneNumber",otpCode:"#otpCode",cashOnDeliveryCash:"#cashOnDeliveryCash",invalidPhoneNumber:".invalidPhoneNumber",otpServiceFailed:".otpServiceFailed",enterOTPLabel:"#enterOTPLabel",reEnterOTPLabel:"#reEnterOTPLabel",maxOTPError:".maxOTPError",numberAlreadyUsed:".numberAlreadyUsed",verifiedOTPSuccess:".verifiedOTPSuccess",
verifyOTPPhoneNumber:"#verifyOTPPhoneNumber",otpResentSuccess:".otpResentSuccess",otpSentSuccess:".otpSentSuccess",otpAlertClass:".otpAlertClass",phonenumberNotVerified:"phonenumberNotVerified",addURLHash:".addURLHash"},C={codehandle:"codehandle:",contactid:"contactid:",phonenumber:"phonenumber:"},W={metricPrefix:"PayPage-COD-OTP-",block:"Block",send:"Send",verify:"Verify",resend:"ReSend",changeNumber:"ChangeNumber"},aa={"SERVICE-FAILED":h,"SEND-SUCCESS":d,"VERIFY-SUCCESS":function(){r.addClass(E.aokHidden);
q.addClass(E.aokHidden);x.find(E.verifiedOTPSuccess).removeClass(E.aokHidden);x.find("."+E.phonenumberNotVerified).removeClass(E.phonenumberNotVerified);L&&l.setContinueButtonStatus(!0)},"INVALID-NUMBER":function(){x.find(E.invalidPhoneNumber).removeClass(E.aokHidden)},"NUMBER-ALREADY-USED":function(){f(z,!0);f(v,!0);x.find(E.numberAlreadyUsed).removeClass(E.aokHidden)},"MAX-OTP-REACHED":function(){x.find(E.maxOTPError).removeClass(E.aokHidden);f(z,!0)},"INVALID-OTP":function(){x.find(E.invalidOTPError).removeClass(E.aokHidden);
D.val("");L?D.attr("placeholder","Re-enter OTP"):(x.find(E.enterOTPLabel).addClass(E.aokHidden),x.find(E.reEnterOTPLabel).removeClass(E.aokHidden))},DEFAULT:h};a.on("checkout:reload:payselect",b);a.on("checkout:reload:spp-payment",b)});"use strict";q.when("A","pay-common-util","ready").execute(function(a,l){var k={productGls:"#productGls",gcTypes:"#gcDeliveryTypes",device:"#device"},b=l.getElements(k);a.on("checkout:payment:challenge:log",function(f){var g={},h;for(h in k)k.hasOwnProperty(h)&&b[h]&&
b[h].val()&&(g[h]=b[h].val());f&&(g.paymentInstrumentId=f);Object.keys&&Object.keys(g).length&&a.ajax("/gp/buy/payselect/handlers/log-payment-challenge.html?ref_\x3dcheckout-payment-challenge",{method:"POST",params:g,timeout:1E3,cache:!1})})});"use strict";q.when("A","page-spinner-controller","page-main","page-transition-controller","page-conductor","client-side-metrics","button-blocker","ready").register("pay-auth",function(a,l,k,b,f,g,h){function d(){var a=p("#otp_id").val(),b=/^\d{6}$/;a&&b.test(a)?
h.hide("pay-auth-otp-checks"):(a=p("#otp_invalid_msg").val(),h.show("pay-auth-otp-checks",a))}function e(b,c){l.show();a.ajax("validate-otp.html",{method:"post",params:{otp_name:b,paystationRequestId:c},success:function(a){!a||"APPROVED"!==a.status&&"PENDING"!==a.status?(p("#otp_id").addClass("a-form-error"),p("#otpBadCode").removeClass("hidden"),l.hide()):(p("#isFormValidated").val("1"),u.submit())},error:function(a){l.hide()}})}function c(){p("#otp_id").removeClass("a-form-error");p("#otpBadCode").addClass("hidden")}
function m(){g.increaseCount(x.metricPrefix+x.resend,1,1);var b="1"===p("#isPaystationFlow").val(),c;b?(c="resend-otp.html?returnHtml\x3d0\x26isPaystationFlow\x3d1",l.show()):c="resend-otp.html?returnHtml\x3d0";a.ajax(c,{method:"get",success:function(a){b&&(a&&1===a.successful&&(p("#authSourceId").val(a.authSourceId),p("#paystationRequestId").val(a.paystationRequestId)),l.hide())},error:function(a){b&&l.hide()}})}var p=a.$,n,u,x={metricPrefix:"Payauth-",resend:"Resend"};a.on("checkout:reload:payauth",
function(){n=p("#resend_form");u=p("#otp_form");u.submit(function(a){var b=p(a.currentTarget);if("1"===b.find('input[id\x3d"isPaystationFlow"]').val()&&(c(),"1"!==b.find('input[id\x3d"isFormValidated"]').val()))return a=b.find('input[id\x3d"otp_id"]').val(),b=b.find('input[id\x3d"paystationRequestId"]').val(),e(a,b),!1});n.submit(function(a){"1"===p("#isPaystationFlow").val()&&c();m();return!1});d();p("#otp_id").unbind("keyup").bind("keyup",d)})});"use strict";q.when("A","ajax-utility","client-side-metrics",
"loading-spinner-controller","pay-common-lib","pay-common-util","page-conductor","page-transition-controller","quantity-service","weblab-helper").register("pay-gil",function(a,l,k,b,f,g,h,d,e,c){function m(a){J=a.popover;var b=t(J);z("#gil-estimates-popover-"+b+" .gil-popover-content").html("");z("#gil-estimates-popover-"+b+" .gil-popover-error").html("");a.popover.updatePosition(!0)}function p(a){J=a.popover;var c=t(J),d=z("#gil-estimates-popover-"+c);d.find("input[name\x3dgil-subtype]").val(c);
b.showSpinner(d,!1,J);a="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime();var e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(c);z.ajax({type:"POST",url:a,data:e,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return l.jsonify(a)},success:function(a,e,f){t(J)===c&&(k.increaseCount("Checkout:GIL:"+c+":IneligiblePopoverSuccess",1),e=J,b.hideSpinner(d),a&&a.errors&&0<a.errors.length?d.find(".gil-popover-error").show():a&&a.widgetHTML?
d.find(".gil-popover-content").html(decodeURIComponent(a.widgetHTML)):d.find(".gil-popover-error").show(),e.updatePosition(!0))},error:function(a){t(J)===c&&(k.increaseCount("Checkout:GIL:"+c+":IneligiblePopoverError",1),a=J,b.hideSpinner(d),d.find(".gil-popover-error").show(),a.updatePosition(!0))}})}function n(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")}function u(a){a.$event.preventDefault();var f=t(J),g=z("#gil-estimates-popover-"+f);b.showSpinner(g,
!1,J);var l=x(a.$currentTarget.parents("#gil-estimates-popover-"+f));b.showSpinner(g,!1,J);e.callBatch(l,{success:function(b,e,g){t(J)===f&&(k.increaseCount("Checkout:GIL:"+f+":SubmitIneligiblePopoverSuccess",1),n(a),d.show(),1==parseInt(z("input[name\x3d'gil-rendered-using-apx']").val(),10)&&c.isGILCreditCardEnabled()?(b=z(".pmts-select-payment-instrument-form"),e=J,"APX_PSP_TO_RCX_SPC"==(e.attrs?e.attrs("data").onSubmit:e.data.onSubmit)&&b&&0<b.length?h.continueClicked(null,b):k.increaseCount("Checkout:GIL:"+
f+"Popover:ErrorRedirectingToSPC",1)):r(f))},error:function(a){t(J)===f&&(k.increaseCount("Checkout:GIL:"+f+":SubmitIneligiblePopoverError",1),a=J,b.hideSpinner(g),g.find(".gil-popover-error").show(),a.updatePosition(!0))},isTrial:0})}function x(a){var b={};a.find(".gil-ineligible-items").children(".gil-ineligible-item").each(function(a,c){a=z(c).find('input[name^\x3d"ineligible-item"]').val();b[a]=0});return b}function q(a){a.$event.preventDefault();var b=z("#gil-ineligible-"+a.data.subtype).find(".gil-ineligible-items"),
c=b.data("index"),d=b.data("size"),c=(c+("next"===a.data.direction?1:-1)+d)%d,d=(c+1)%d;b.find(".gil-ineligible-item").addClass("aok-hidden").removeClass("a-span-last");a=b.find("#gil-ineligible-item-"+c);d=b.find("#gil-ineligible-item-"+d);a.removeClass("aok-hidden");d.addClass("a-span-last").removeClass("aok-hidden");b.data("index",c)}function r(b){g.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{handler:"new-gil-payment",subtype:b},{successHandler:function(c,d,e){k.increaseCount("Checkout:GIL:"+
b+":NewToExistingSuccess",1);h.ajaxUpdatePage(c,d,e);g.scrollTopTo(z("#existing-payment-methods [value\x3d"+b+"]"));if(h.isSPP())a.on("checkout:afterReload",function M(){z("#existing-gil input[value\x3d"+b+"]").trigger("click");a.off("checkout:afterReload",M)});else z("#existing-gil input[value\x3d"+b+"]").trigger("click")},errorHandler:function(a,c,d){k.increaseCount("Checkout:GIL:"+b+":NewToExistingError",1);h.ajaxUpdatePage(a,c,d)}})}function t(a){return a.attrs?a.attrs("data").subtype:a.data.subtype}
function v(){y&&(a.declarative("gil-close-popover",["click"],n),a.declarative("gil-submit-popover",["click"],u),a.declarative("gil-ineligible-pagination",["click"],q));z("#gil-cc-payment-type").length&&(a.off("a:popover:beforeShow:gil-estimates",m),a.off("a:popover:show:gil-estimates",p),a.on("a:popover:beforeShow:gil-estimates",m),a.on("a:popover:show:gil-estimates",p));z("#gil-payment-type").length&&(a.off("a:popover:beforeShow:gil-si-estimates",m),a.off("a:popover:show:gil-si-estimates",p),a.on("a:popover:beforeShow:gil-si-estimates",
m),a.on("a:popover:show:gil-si-estimates",p));y=!1}var z=a.$,y=!0,J;a.on("checkout:reload:payselect",v);a.on("checkout:reload:spp-payment",v);return{submitNewGilPayment:r,displayGILEstimatesMobile:function(a,b,c){var d="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime(),e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(a);g.makeAjaxCall(d,e,{successHandler:function(c,d,e){var f=l.jsonify(c);f&&!f.errors&&f.widgetHTML?k.increaseCount("Checkout:GIL:"+
a+":Mobile:IneligibleSubPageSuccess",1):k.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);b(c,d,e)},errorHandler:function(b){k.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);c(b)}})},actionCloseGilMobileSubpage:function(a){a.$event.preventDefault();z("#gil-estimates-subpage").remove();z(g.pages.main.pageId).show()},actionSubmitGilMobileSubpage:function(a,b,c){a.$event.preventDefault();z("#gil-ineligible-view");var d=x(a.$currentTarget.parents("#gil-ineligible-view"));
e.callBatch(d,{success:function(c,d,e){k.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageSuccess",1);b(c,d,e)},error:function(b){k.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageError",1);c(b)},isTrial:0})}}});"use strict";q.when("A","pay-common-util","page-detector").register("new-verified-debit-card",function(a,l,k){function b(){f=k.isMobile()?l.getElements(g):l.getElements(h);d=f.newVDC.find("#expirationInput");e=f.newVDC.find("#vdcCvvNumInput");
c=f.newVDC.find("#vdcYear");m=f.newVDC.find("#vdcMonth");p=new Date;n=p.getFullYear()+20;u=p.getMonth();0===u&&(u=12,n--)}var f={},g={newVDC:"#new-verified-debit-card"},h={newVDC:"#new-verified-debit-cards-table"},d,e,c,m,p,n,u;return{showExpiryDateAndCvv:function(){b();c.find("option:selected").removeAttr("selected");m.find("option:selected").removeAttr("selected");f.newVDC.find("#isSBIInternationalMaestroSelected").val("0");d.show();e.show()},hideExpiryDateAndCvv:function(){b();var a=m.val(u).find("option[value\x3d"+
u+"]"),g=c.val(n).find("option[value\x3d"+n+"]");a.attr("selected",!0);g.attr("selected",!0);f.newVDC.find("#isSBIInternationalMaestroSelected").val("1");d.hide();e.hide()}}});"use strict";q.when().register("recommendation-helper",function(){return{}});"use strict";q.when("A").register("apb-limit-messaging-helper",function(a){var l=a.$;return{renderAPBMessagingRemainingBalance:function(a,b,f,g){var h=l(".am-balance").html(),d=a.remainingBalance,e=a.purchaseTotal,c=a.isPurchaseTotalInSpan;0<b-f?d=
e:0>b-g&&(d=h);c?a.balanceApplied.html(d):a.balanceApplied.text(d)},displayAPBRedeemableLimitExhaustedMessaging:function(a){a.gcRadioContainer.addClass("hidden");a.gcCheckboxContainer.addClass("hidden");a.gcCheckbox.attr("disabled","disabled");a.gcRadio.attr("disabled","disabled");a.shortMsg.hide();a.longMsg.hide();a.amazonMoneyLimitBreachedMsg.removeClass("hidden");a.amazonMoneyLimitBreachedMsg.show()},renderAPBInsufficientMessaging:function(a,b,f){b==f?(a.shortMsg.show(),a.longMsg.hide()):(a.longMsg.show(),
a.shortMsg.hide())}}});"use strict";q.when("A").register("temporary-preference-indicator",function(a){return{}});"use strict";q.when("A","page-detector").register("alipay-detector",function(a,l){var k=a.$,b=function(){var a=k("input[name\x3d'isAlipayAppPayment']");0<a.length&&l.isMobileSpc&&a.val("1")},f=function(a){},g=function(){var a=k("input[name\x3d'isAlipayRedirect']");0<a.length&&l.isMobileSpc&&a.val("1")},h=function(a){};a.on("checkout:reload:spc",function(){k("input[name\x3d'isAlipayAppPayment']").length&&
q.when("safe-mash").execute(function(a){a=n.cordova.require("cordova/exec");a(b,f,"AlipayPlugin","isAlipayInstalled",[]);k("input[name\x3d'isAlipayRedirect']").length&&a(g,h,"AlipayPlugin","isAlipayFailReturnSupported",[])})})});"use strict";q.when("A","page-transition-controller","page-detector").execute(function(a,l,k){function b(){var a=f("#backButtonProtection");a.length&&"1"===a.val()&&(l.showPageTransition(),document.location.reload())}var f=a.$;q.register("back-button-protection",function(){return{markAsDirty:function(){f("#backButtonProtection").val(1)}}});
a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b)});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","delivery-preferences-csm-helper").register("delivery-preferences-controller",function(a,l,k,b,f,g,h,d,e){function c(){h.isTabletSpc()&&(v=t("#spc-orders .delivery-preferences-options"),K(),v.find("select").trigger("change"),u())}function m(){var a=v.find("input[name\x3dpreference]:checked").val(),
b=v.find("select[name\x3dSafePlaceLocation]");"NeighborDelivery"===a?(v.find("input[name\x3dneighbor-name]").removeAttr("disabled").removeClass("a-form-disabled"),v.find("input[name\x3dneighbor-house]").removeAttr("disabled").removeClass("a-form-disabled"),f.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),v.find(".safe-place-error").hide()):"SafePlaceDelivery"===a?(f.isSPP()?
q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"enabled"})}):b.removeAttr("disabled").closest(".a-button").removeClass("a-button-disabled"),v.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),v.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),v.find(".neighbor-name-error").hide(),v.find(".neighbor-house-error").hide()):(v.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),
v.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),f.isSPP()?q.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),v.find(".neighbor-name-error").hide(),v.find(".neighbor-house-error").hide(),v.find(".safe-place-error").hide());p(!0)}function p(a){var b=v.find("input[name\x3dpreference]:checked").val();v.find(".safe-place-error").hide();v.find(".neighbor-name-error").hide();
v.find(".neighbor-house-error").hide();v.find("input").removeClass("a-form-error");v.find("div.a-input-text-wrapper").removeClass("a-form-error");v.find("select").closest(".a-button").removeClass("a-button-error");0<t("div.spc-tablet").length?v.find(".set-delivery-preferences-button").removeClass("a-button-disabled"):v.find(".set-delivery-preferences-button").show();v.find(".save-disabled").hide();v.find(".current-blocker-content").text("");var c=!1;if("NeighborDelivery"===b){var d=v.find("input[name\x3dneighbor-name]");
d.data("defaultValueRemoved")&&d.val()||(v.find(".neighbor-name-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),v.find(".current-blocker-content").html(v.find(".neighbor-name-error-text").text()),c=!0);d=v.find("input[name\x3dneighbor-house]");d.data("defaultValueRemoved")&&d.val()||(v.find(".neighbor-house-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),v.find(".current-blocker-content").html(v.find(".neighbor-house-error-text").text()),
c=!0)}else"SafePlaceDelivery"===b&&(d=v.find("select[name\x3dSafePlaceLocation]"),d.val()||(v.find(".safe-place-error").show(),d.closest(".a-button").addClass("a-button-error"),v.find(".current-blocker-content").html(v.find(".safe-place-error-text").text()),c=!0));d=t("#disableSaveBtnWhenNoDeliveryPrefSelected").val();if(a&&c||"true"===d&&void 0===b)0<t("div.spc-tablet").length?v.find(".set-delivery-preferences-button").addClass("a-button-disabled"):v.find(".set-delivery-preferences-button").hide(),
v.find(".save-disabled").show();return!c}function n(a){a&&a.$event&&a.$event.preventDefault();a="hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26";var c="",g=v.find(".popover-deliv-prefs-content");g.data("obfuscatedEntityId")?c=g.data("obfuscatedEntityId"):v.data("obfuscatedEntityId")&&(c=v.data("obfuscatedEntityId"));a+="obfuscatedEntityId\x3d"+c+"\x26";c=v.find("input[name\x3dpreference]:checked").val();""!==c&&(a+="prefDelLocation\x3d"+c+"\x26","NeighborDelivery"===
c?(a+="neighborName\x3d"+encodeURIComponent(v.find("input[name\x3dneighbor-name]").val())+"\x26",a+="houseNo\x3d"+encodeURIComponent(v.find("input[name\x3dneighbor-house]").val())+"\x26"):"SafePlaceDelivery"===c&&(a+="safePlaceLocation\x3d"+v.find("select[name\x3dSafePlaceLocation]").val()+"\x26"),c=v.find("input[name\x3ddefaultPreference]:checked").val(),void 0!==c&&""!==c&&(a+="isDefaultPreference\x3d1"));0<t("div.spc-tablet").length?l.show():k.showSpinner(v.find(".popover-deliv-prefs-content"),
!1,z);e.recordCSMWithCurrentFieldValues("popover-submitted","preference","defaultPreference");t.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-delivery-preference.html",data:a,dataType:"text",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},success:function(a,c,e){y=!0;0<t("div.spc-tablet").length?l.hide():k.hideSpinner(v.find(".popover-deliv-prefs-content"));e.getResponseHeader("x-amz-checkout-page")?
(v.find(".a-button-close").trigger("click"),f.ajaxUpdatePage(a,c,e)):(a=b.jsonify(a),f.redirect(a));d.increaseCount("checkoutSpcDeliveryPref-save",1)},error:function(a,b,c){0<t("div.spc-tablet").length?l.hide():k.hideSpinner(v.find(".popover-deliv-prefs-content"));p(!0)}})}function u(){v.find("input[name\x3d'neighbor-name'], input[name\x3d'neighbor-house']").unbind("focus").bind("focus",function(){if(!t(this).data("defaultValueRemoved")){if(h.isMobileSpc()||h.isDesktopSpc())t(this).val(""),t(this).css("color",
"black");t(this).data("defaultValueRemoved",!0)}}).each(function(){(h.isMobileSpc()||h.isDesktopSpc())&&t(this).data("defaultValueRemoved")&&t(this).css("color","black")});v.find("input:radio[name\x3dpreference]").unbind("click").bind("click",m);v.find("input[name^\x3dneighbor]").unbind("keyup").bind("keyup",function(){p(!1)});0<t("div.spc-tablet").length?v.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",x):v.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",
function(){p(!1)})}function x(a){p(!0)&&n(a)}function K(a){var b=t("#spc-orders .delivery-preferences-options"),c,d="";a?(c=a.$currentTarget.find("input"),d=b.find("input[name\x3dpreference]:checked").val()):c=b.find("input[name\x3dpreference]:checked");b=c.val();if(d!==b){v.find(".expand-content").hide();var d=c,e=d.closest(".delivery-preferences-options");e.find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");e.find("input").attr("checked",
!1);d.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");d.attr("checked",!0);"NeighborDelivery"===b||"SafePlaceDelivery"===b?c.closest(".deliverypreference-option").siblings(".expand-content").show():a&&n(a)}}function r(a){(a=v.find("#delivery-preferences-set-default-checkbox"))&&1===a.length&&(a.prop("checked")?d.increaseCount("checkoutSpcDeliveryPref-setAsDefault",1):d.increaseCount("checkoutSpcDeliveryPref-setAsTemporary",1))}var t=a.$;if(!t("html").hasClass("a-ie6")){var v,
z,y;a.on("a:popover:beforeShow",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-delivprefs")&&(a.popover.$popover.find(".a-popover-inner").html(v.find(".current-blocker-content").text()),a.popover.updatePosition())});a.on("a:popover:show",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(d.increaseCount("checkoutSpcDeliveryPref-open",1),z=a.popover,v=z.$popover,y=!1,u(),e.recordCSMWithCurrentFieldValues("popover-displayed","preference",
"defaultPreference"),m(),v.find("select").trigger("change"))});a.on("a:popover:dismiss",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(y||d.increaseCount("checkoutSpcDeliveryPref-dismissed",1))});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(y||e.recordCSM("popover-dismissed"))});a.declarative("delivery-preferences-switch-tablet",["click"],function(a){K(a)});a.declarative("delivery-preferences-expander-toggle",
["click"],function(a){g.toggleExpanderContent(a)});a.declarative("set-delivery-preferences",["click","touchend"],function(a){a.$event.preventDefault();g.protectAgainstDoubleAction("set-delivery-preferences")||p(!0)&&n()});a.declarative("delivery-preferences-set-default-checkbox-triggered","change",r);a.on("checkout:reload:spc",c)}});"use strict";q.when("A","page-detector","time-left-formatter").register("fast-track-controller",function(a,l,k){function b(){for(var b in n)n[b]&&clearInterval(n[b]);
a.defer(f)}function f(){m.DAY=c("#fasttrack-day").html();m.DAYS=c("#fasttrack-days").html();m.HOUR=c("#fasttrack-hour").html();m.HOURS=c("#fasttrack-hours").html();m.AND=c("#fasttrack-and").html();m.MINUTE=c("#fasttrack-minute").html();m.MINUTES=c("#fasttrack-minutes").html();m.SECOND=c("#fasttrack-second").html();m.SECONDS=c("#fasttrack-seconds").html();(c("#isfresh").length&&c(".checkout.spc-mobile").length||c("#lazy-fresh-promise-delivery-message").length?c("#spc-form"):c("#spc-orders")).find(".fasttrack-span").each(function(){var b=
c(this),d=b.find("input[name\x3d'countdownId']").val();p[d]=parseInt(b.find("input[name\x3d'fasttrackExpiration']").val());u[d]=a.now()/1E3+p[d];g(b.find("input[name\x3d'countdownThreshold']").val(),b,b.find("input[name\x3d'showSimplifiedCountdown']").val(),d);b.show()})}function g(a,b,c,e){0>=p[e]?d(b,null):a&&0<a&&p[e]>a?b.find("span.fasttrackavailable").hide():(h(b,c),n[e]=setInterval(function(){h(b,c,e)},1E3))}function h(b,e,f){0<p[f]?(p[f]=Math.round(u[f]-a.now()/1E3),e=k.getTimeLeftFormatted(p[f],
1===e||"1"===e?!0:!1,m),c("html").hasClass("a-tablet")?b.find("span[data-field\x3d'fasttrackcountdown']").html("\x26nbsp;"+e):b.find("span[data-field\x3d'fasttrackcountdown']").html(e),b.find("span.fasttrackexpired").hide(),b.find("span.fasttrackcountdown").show(),b.find("span.fasttrackavailable").show()):d(b,f)}function d(a,b){b?(n[b]&&clearInterval(n[b]),a.find("span.fasttrackavailable").hide(),a.find("span.fasttrackexpired").show()):clearInterval(n[b])}function e(){b()}var c=a.$;if(!c("html").hasClass("a-ie6")){var m=
{},p={},n={},u={};a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b);return{spcLiteLazyLoadFastTrack:e}}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("gc-redeem-controller",function(a,l,k,b,f){function g(a){if(!q){a.preventDefault();p(a.currentTarget);var c;0<p("#spc-gcpromoinput").length&&(c=encodeURIComponent(p("#spc-gcpromoinput").val()));0<p("#gc-promo-input").length&&(c=encodeURIComponent(p("#gc-promo-input").val()));
var d=encodeURIComponent(p("#spc-usePromoOnly").val());if(c&&0!==c.length){var f=encodeURIComponent(p("input[name\x3dpurchaseTotal]").val());p("#gc-error").hide();p("#gc-promo-success").hide();p("#gc-success").hide();p("#gc-ineligible").hide();p("#promo-success").hide();b.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(p("#payment"))):l.show();var g=(new Date).getTime();a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_pay_page_gc_add";p(".checkout.spc.aui-templatized").length&&
(a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_spc_gc_add");c="purchaseTotal\x3d"+f+"\x26claimcode\x3d"+c+"\x26disablegc\x3d"+d+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+p("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+g;d=b.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});p.ajax({type:"POST",url:a,data:c,headers:d,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){q=!1},success:h,error:b.ajaxRedirect});q=!0}else e("addGiftCardOrPromo_NoCode")}}function h(a,f,g){var h=g.getResponseHeader("x-amz-checkout-page");if(h){if(b.ajaxUpdatePage(a,f,g),"spc"===h||"spclite"===h||"spp-revieworder"===h)(a=parseInt(p("#checkoutDisplayPage").data("delaySetTitle"),10)||parseInt(p("#gc-promo-delay").data("egcDelayUpdateRedemptionMessage"),10)||0)?setTimeout(function(){d(g)},a):d(g)}else{a=k.jsonify(a);if(!a)return b.redirect();if(a.error)return e(a.error);
if(a.errors)return e(a.errors);if(a.autohandlererror)return c(a.autohandlererror);b.redirect(a)}}function d(a){var b=a.getResponseHeader("x-updated-promo-type");a=a.getResponseHeader("x-updated-gc-applied-but-ineligible");b&&(a||p("#gc-promo-success").show(),0<p("div.spc-desktop").length?(p("#spc-gcpromoinput").removeClass("a-form-error"),p("#gc-promo-input").removeClass("a-form-error")):(p("#spc-gcpromoinput").closest(".a-input-text-wrapper").removeClass("a-form-error"),p("#gc-promo-input").closest(".a-input-text-wrapper").removeClass("a-form-error")),
"giftcard"===b?(m("applied"),a?(p("#gc-ineligible").show(),m("gcIneligible")):p("#gc-success").show()):p("#promo-success").show())}function e(a){l.hide();p("#gc-error p").hide();p("#gc-error").show();m("error");0<p("div.spc-desktop").length?(p("#spc-gcpromoinput").addClass("a-form-error"),p("#gc-promo-input").addClass("a-form-error")):(p("#spc-gcpromoinput").closest(".a-input-text-wrapper").addClass("a-form-error"),p("#gc-promo-input").closest(".a-input-text-wrapper").addClass("a-form-error"));p(0<
p("#gc-promo-input").length?"."+u[a]:"#"+a).show()}function c(a){if(a){var b=a.action,c="/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError");"fatal"===b?c+="\x26errorAction\x3dfatal":"redirect"===b&&(a.url?c=a.url:"cart"===a.page&&(c="/gp/cart/view.html"));n.location.href=c}else n.location.href="/gp/buy/payselect/handlers/error.html?errorType\x3dUnknown:pipelineJSError"}function m(b){var c=a.state("cxt-gc-redemption-method").method;
f.increaseCount("rcxGCRedeem:"+c+":"+b,1)}var p=a.$,q=!1;if(!p("html").hasClass("a-ie6")){a.state("cxt-gc-redemption-method",{method:"type"});var u={addGiftCardOrPromo_Unknown:"UNKNOWN",addGiftCardOrPromo_NoCode:"NO_CODE",addPromo_InvalidForPurchase:"PROMO_INVALID_FOR_PURCHASE",addPromo_BadCode:"PROMO_BAD_CODE",addPromo_ExpiredCode:"PROMO_EXPIRED_CODE",addPromo_InvalidForOrgUnit:"PROMO_INVALID_FOR_ORG_UNIT",addPromo_OfferNotYetBegun:"USED_BEFORE_START_DATE",addPromo_AlreadyRedeemed:"PROMO_ALREADY_REDEEMED",
addGiftCard_AlreadyRedeemedByAnotherAccount:"GC_ALREADY_REDEEMED_BY_ANOTHER_ACCOUNT",addGiftCard_AlreadyRedeemedByThisAccount:"GC_ALREADY_REDEEMED_BY_THIS_ACCOUNT",addGiftCard_BadCode:"GC_BAD_CODE",addGiftCard_ExpiredCode:"GC_EXPIRED_CODE",addGiftCard_Cancelled:"CANCELLED_CODE",addGiftCard_WrongOrgUnit:"GC_WRONG_ORG_UNIT",addGiftCard_ServiceDown:"GC_SERVICE_DOWN",addGiftCard_InvalidForAGS:"GC_INVALID_FOR_AGS",addGiftCard_PassedClaimByDate:"PASSED_CLAIM_BY_DATE",addGiftCard_OfferNotYetBegun:"GC_NOT_YET_BEGUN",
addGiftCard_ExceededMaxLimit:"GC_EXCEED_MAX_LIMIT",addGiftCard_Disabled:"GC_DISABLED",addGiftCard_OTP_Required:"GC_OTP_REQUIRED",addGiftCard_SEVIS_Decline:"GC_SEVIS_DECLINE",addGiftCard_OCRAH_Decline:"GC_OCRAH_DECLINE",addGiftCard_DEFAULT_Message:"GC_DEFAULT_MESSAGE"};a.declarative("gc-element",["click"],function(a){var b=a.data.click;b&&null!==b&&g(a.$event)});a.on("a:expander:redeem-gc-expander:toggle:expand",function(a){f.increaseCount("checkout:spp-payment:expand_addgc_coll",1)});p(document).delegate("#spc-gcpromoinput, #gc-promo-input",
"keypress",function(a){13===a.which&&g(a)});return{actionAddGiftPromotion:g,giftSystemErrorHandling:c}}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","gift-utility","weblab-helper").register("gift-popover-controller",function(a,l,k,b,f,g,h,d,e,c){function m(){var a=T;a.find("#select-recipient").empty();for(var b=0;b<ma.length;b++){var c=I("\x3coption/\x3e").attr({value:ma[b].value}).text(ma[b].text);
a.find("#select-recipient").append(c)}za&&(b=a.find('#select-recipient option[value\x3d"'+za+'"]').attr("selected","selected"),a.find("#select-recipient").closest("#popover-gift-connection-recipient").find(".a-placeholder").text(b.text()),ga())}function p(){a.defer(function(){I("#spc-orders").find(".gift-popover-link").each(function(){I(this).data("action")&&I(this).removeAttr("href").attr("tabindex",0)})});I(".larger-image-link").find("a").removeAttr("href")}function q(a){var b=T;b.find(".gift-error-box").hide();
b.find(".fake-label").each(function(){I(this).unbind("click").bind("click",function(){I(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".popover-gift-top .gift-item-title span").html(a.item.title);a&&a.item&&a.item.isAutoripEligible?b.find("#gift-autorip-unavailable-msg").show():b.find("#gift-autorip-unavailable-msg").hide();if(a&&a.obfuscatedEntityId){var c=b.find(".set-gift-options-button input");c.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,
giftData:a},u);g.bindActionEnterKeyOnButton(c)}ka?(ha=a&&a.item&&a.item.isAmazonFulfilled,va=!(a&&a.address&&0===a.address.shipToSelf),ha&&(a&&a.options&&a.options.canHaveMessage||a&&a.options&&a.options.canBeWrapped)?(r(!0),b.find(".mfn-hide-prices").hide(),b.find(".include-gift-receipt").show()):ha||(r(!0),b.find(".include-gift-receipt").hide(),b.find(".mfn-hide-prices").show(),b.find(".include-gift-message").show()),Aa=b.find(".include-gift-message").is(":visible"),J()):a&&a.options&&a.options.canHidePrices?
b.find(".hide-prices-checkbox").closest("div").show():b.find(".hide-prices-checkbox").closest("div").hide();a&&a.selected&&(c=R(b.find(".hide-prices-checkbox")),a.selected.hidePrices?c.attr("checked",!0):c.removeAttr("checked"));if(a&&a.item&&a.item.purchaseIsKindle){if(c=b.find(".kindle-registration-box"),c.show(),c.find(".register-kindle-customer-name").html(b.find(".gift-customer-name").html()),!ka){var c=R(b.find(".kindle-reg-radio-another-account")),d=R(b.find(".kindle-reg-radio-your-account"));
a.selected.hidePrices||a.selected.isWrapped?(d.removeAttr("checked"),c.attr("checked",!0)):(c.removeAttr("checked"),d.attr("checked","checked"));R(b.find(".hide-prices-checkbox")).trigger("change")}}else b.find(".kindle-registration-box").hide();if(a&&a.options&&a.options.canHaveMessage){a&&a.selected&&(c=a.selected.message,d=R(b.find(".include-gift-message-checkbox")),c&&c.length?(b.find("textarea[name\x3d'gift-message-text']").val(c),v(!0)):null===c&&(a.selected.isWrapped||a.selected.hasReceipt)?
(d.removeAttr("checked"),b.find(".textarea[name\x3d'gift-message-text']").val("")):(b.find("textarea[name\x3d'gift-message-text']").val(""),c="",ka?(c+=b.find(".sample-gift-msg-greeting").html(),a&&a.address&&a.address.firstName&&!va&&(c+=" "+a.address.firstName),c=c+",\n"+b.find(".sample-gift-msg").html(),c+="\n"):(c+=b.find(".sample-gift-msg").html(),c+="\n\n"),c+=b.find(".sample-gift-msg-from").text(),c=ka?c+e.getNameWithNoTitle(b.find(".gift-customer-name").html()):c+e.getFirstName(b.find(".gift-customer-name").html()),
b.find("textarea[name\x3d'gift-message-text']").val(c),!ka||va&&Aa||v(!0)));var f=I(".gift-message-warning").length,c=function(){ka&&v(!0);M(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);if(f){var b=T.find("textarea[name\x3d'gift-message-text']");e.toggleGiftMessageWarning(b,T)}};if(a&&a.options){var h=b.find("textarea[name\x3d'gift-message-text']");h.bind("keyup",c);h.bind("mouseup",c);M(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);
f&&e.toggleGiftMessageWarning(h,b);R(b.find(".include-gift-message-checkbox")).bind("change",function(){var c=I(this).is(":checked"),d=a.options.maxMessageChars,g=a.options.maxMessageLines,k=a.options.hasFixedGiftMsgLimit,l=T,m=l.find("textarea[name\x3d'gift-message-text']");c?ka&&y():(0<l.find(".validateInputCharactersOnBlur.a-form-error").size()&&(l.find(".validateInputCharactersOnBlur.a-form-error").removeClass("a-form-error"),0<l.find("#onblur-character-validation-error-gift-message-text").size()&&
l.find("#onblur-character-validation-error-gift-message-text").remove()),ka?J():(m.val(""),M(d,g,k)));f&&e.toggleGiftMessageWarning(h,b)})}}else b.find(".popover-gift-message-text").css("visibility","hidden"),b.find(".include-gift-message").css("visibility","hidden"),ka&&(b.find(".include-gift-message").hide(),b.find(".popover-gift-message").css("visibility","hidden")),b.find(".popover-gift-message-not-available").show();a&&a.options&&!a.options.canBeWrapped?(b.find(".wrap-option").hide(),b.find(".popover-gift-no-wrap-available").show(),
b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),R(b.find(".hide-prices-checkbox")).attr("disabled",!1)):a&&a.item&&a.item.isAmazonFulfilled?(b.find(".wrap-option").hide(),b.find(".popover-gift-fba-wrap").show(),b.find(".hide-prices-amazon-msg").show(),b.find(".hide-prices-merchant-msg").hide(),(c=a.options.wraps[0].imageurl)&&0<c.length&&(b.find(".large-preview").find("img").attr("src",c),b.find(".large-preview").show(),b.find(".fba-wrap-checkbox").show(),
d=b.find(".larger-image-link"),d.unbind("click").bind("click",{imageURL:c},Q),g.bindActionEnterKeyOnButton(d)),a.options.wraps[0].description&&b.find(".gift-wrap-title").show().html(a.options.wraps[0].description),"1"===I("#multipleAFNGiftWrapOption").val()?a.options&&a.options.wraps&&1<=a.options.wraps.length&&(c=b.find(".popover-gift-amazon-wrap"),x(b,c),da(a,"afn",c)):a.options&&a.options.wraps&&1===a.options.wraps.length?(b.find(".popover-gift-amazon-wrap").hide(),b.find(".popover-gift-merchant-wrap").hide(),
b.find(".fba-wrap-checkbox .gift-wrap-price").html(a.options.wraps[0].price),d=R(b.find(".amazon-gift-wrap")),d.val(a.options.wraps[0].id),c=R(b.find(".hide-prices-checkbox")),a.selected.isWrapped?(d.attr("checked",!0),a.item.purchaseIsKindle||(c.attr("checked",!0),c.attr("disabled",!0),b.find(".hide-prices-note").show())):(d.removeAttr("checked"),c.attr("disabled",!1),b.find(".hide-prices-note").hide())):a.options&&a.options.wraps&&1<a.options.wraps.length&&(c=b.find(".popover-gift-amazon-wrap"),
x(b,c),Z(a,"afn",c))):(b.find(".wrap-option").hide(),R(b.find(".hide-prices-checkbox")).removeAttr("disabled"),b.find(".hide-prices-amazon-msg").hide(),b.find(".hide-prices-note").hide(),b.find(".hide-prices-merchant-msg").show(),b.find(".large-preview").hide(),c=b.find(".popover-gift-merchant-wrap").show(),c.find(".mfn-wrap-copy").remove(),Z(a,"mfn",c));ka&&(P(),G(),D());if(0<I(".enable-gift-connections").length){b.find("#popover-gift-connection select.a-touch-select-input").each(function(){I(this).unbind("change").bind("change",
function(){var a=I(this),b=a.siblings("a.a-placeholder"),a=a.find(":selected").text();b.text(a);return!1})});b.find("#select-recipient").bind("change",function(a){N(a);return!1});b.find("#select-occasion").bind("change",function(a){U(a);return!1});b.find("#input-recipient-first-name").keyup(function(){ga()});b.find("#input-recipient-last-name").keyup(function(){ga()});b.find("#popover-gift-connection-recipient").unbind("click").bind("click",function(a){a=T;ja||a.find("#select-recipient-spinner").show()});
za=void 0;if(a.giftConnection){"0"===a.giftConnection.giftlistTypeId&&"0"===a.giftConnection.occasionId&&b.find("#include-gift-connection-checkbox").attr("checked",!1);a.giftConnection.firstName&&b.find("#input-recipient-first-name").val(a.giftConnection.firstName);a.giftConnection.lastName&&b.find("#input-recipient-last-name").val(a.giftConnection.lastName);if("1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)c=b.find('#select-recipient option[value\x3d"'+a.giftConnection.giftlistTypeId+
'"]').attr("selected","selected"),b.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(c.text()),b.find(".gift-connection-recipient-extra").show();if(a.giftConnection.giftlistId&&"0"!==a.giftConnection.giftlistId)za=a.giftConnection.giftlistId;else if("0"===a.giftConnection.giftlistTypeId||"1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)za=a.giftConnection.giftlistTypeId;a.giftConnection.occasionId&&(c=b.find('#select-occasion option[value\x3d"'+
a.giftConnection.occasionId+'"]').attr("selected","selected"),b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text()));a.giftConnection.occasionMonth&&(c=b.find('#select-occasion-month option[value\x3d"'+a.giftConnection.occasionMonth+'"]').attr("selected","selected"),b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text()));a.giftConnection.occasionDay&&(c=b.find('#select-occasion-day option[value\x3d"'+a.giftConnection.occasionDay+
'"]').attr("selected","selected"),b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text()));a.giftConnection.age&&(c=b.find('#select-occasion-age option[value\x3d"'+a.giftConnection.age+'"]').attr("selected","selected"),b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text()));if("1"===a.giftConnection.occasionId||"2"===a.giftConnection.occasionId)b.find(".gift-connection-occasion-extra").show(),"2"===a.giftConnection.giftlistTypeId&&
b.find("#select-occasion-age-row").show();a.giftConnection.hasReminder&&"0"===a.giftConnection.hasReminder&&b.find("#occasion-has-reminder-checkbox").attr("checked",!1)}(!a.giftConnection||"1"!==a.giftConnection.occasionId&&"2"!==a.giftConnection.occasionId&&"3"!==a.giftConnection.occasionId)&&ga();ma?(m(),b.find("#select-recipient").show(),b.find("#select-recipient-spinner").hide(),ja=!0):(ja=!1,la())}T.find(".content-container").css("visibility","visible");ta.updatePosition(!0);k.hideSpinner(b.find(".popover-content-main"))}
function u(a){var c=T,d="";if(!(0<c.find(".validateInputCharactersOnBlur.a-form-error").size())){a&&a.data&&a.data.obfuscatedentityid&&(d+="obfuscatedEntityId\x3d"+a.data.obfuscatedentityid+"\x26");ha&&(d+="isAFN\x3d1\x26");R(c.find(".include-gift-receipt-checkbox")).is(":checked")&&(d+="includeReceipt\x3d1\x26");R(c.find(".include-gift-message-checkbox")).is(":checked")?(d+="includeMessage\x3d1\x26message\x3d"+encodeURIComponent(c.find("textarea[name\x3d'gift-message-text']").val())+"\x26",d+="maxChars\x3d"+
a.data.giftData.options.maxMessageChars+"\x26",d+="maxLines\x3d"+a.data.giftData.options.maxMessageLines+"\x26"):d+="includeMessage\x3d0\x26";d=R(c.find(".hide-prices-checkbox")).is(":checked")?d+"hidePrices\x3d1\x26":d+"hidePrices\x3d0\x26";c.find(".kindle-registration-box").is(":visible")&&(d+="isKindlePurchase\x3d1\x26");var e;if(c.find(".popover-gift-fba-wrap").is(":visible"))if(c.find(".popover-gift-amazon-wrap").is(":visible")){if((e=c.find("input[name\x3d'afn-gift-wrap']:checked").eq(0).val())&&
e.length)for(d+="giftWrap\x3d"+e+"\x26",e=0;e<a.data.giftData.options.wraps.length;e++)if(c.find(".popover-gift-amazon-wrap").find(".afn-wrap-"+e).is(":checked")){d+="currencyAmount\x3d"+a.data.giftData.options.wraps[e].priceAmount+"\x26";d+="currencyUnit\x3d"+a.data.giftData.options.wraps[e].unit+"\x26";break}}else e=R(c.find(".amazon-gift-wrap")),e.is(":checked")&&(d+="giftWrap\x3d"+e.val()+"\x26",a.data.giftData.options&&(d+="currencyAmount\x3d"+a.data.giftData.options.wraps[0].priceAmount+"\x26",
d+="currencyUnit\x3d"+a.data.giftData.options.wraps[0].unit+"\x26"));else if(c.find(".popover-gift-merchant-wrap").is(":visible")&&(e=c.find("input[name\x3d'mfn-gift-wrap']:checked").eq(0).val())&&e.length)for(d+="giftWrap\x3d"+e+"\x26",e=0;e<a.data.giftData.options.wraps.length;e++)if(c.find(".popover-gift-merchant-wrap").find(".mfn-wrap-"+e).is(":checked")){d+="currencyAmount\x3d"+a.data.giftData.options.wraps[e].priceAmount+"\x26";d+="currencyUnit\x3d"+a.data.giftData.options.wraps[e].unit+"\x26";
break}if(0<I(".enable-gift-connections").length)if(c.find("#include-gift-connection-checkbox").is(":checked")){d+="includeGiftConnection\x3d1\x26";a=c.find("#select-recipient").val();d+="gcGiftlistTypeId\x3d"+a+"\x26";if("1"===a||"2"===a)d+="gcFirstName\x3d"+c.find("#input-recipient-first-name").val()+"\x26",d+="gcLastName\x3d"+c.find("#input-recipient-last-name").val()+"\x26";e=c.find("#select-occasion").val();d+="gcOccasionId\x3d"+e+"\x26";if("1"===e||"2"===e)d+="gcMonth\x3d"+c.find("#select-occasion-month").val()+
"\x26",d+="gcDay\x3d"+c.find("#select-occasion-day").val()+"\x26","1"===e&&"2"===a&&(d+="gcAge\x3d"+c.find("#select-occasion-age").val()+"\x26"),d+="gcHasReminder\x3d"+(c.find("#occasion-has-reminder-checkbox").is(":checked")?"1":"0")+"\x26"}else d+="includeGiftConnection\x3d0\x26";(a=I("input#executionId").val())&&(d+="executionId\x3d"+a+"\x26");a=(new Date).getTime();d+="isClientTimeBased\x3d"+I("input[name\x3d'useCtb']").val()+"\x26returnjson\x3d1\x26isDecoupleSPC\x3d1\x26hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
a;f.isSPP()&&(ta.hide(),a=I("#setOrderingPrefsCheckbox"),a.length&&a.is(":checked")&&(d+="\x26saveAsDefaultsSelected\x3d1"));l.show();a=f.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});I.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:d,dataType:"text",async:!0,cache:!1,headers:a,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,d,e){e.getResponseHeader("x-amz-checkout-page")?(f.isSPP()||c.find(".a-button-close").trigger("click"),
f.ajaxUpdatePage(a,d,e)):(a=b.jsonify(a),f.redirect(a))},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}}function x(a,b){a.find(".fba-wrap-checkbox").hide();a.find(".large-preview").hide();b.show();b.find(".afn-wrap-copy").remove()}function K(){var a=T,b=a.find(".popover-gift-amazon-wrap").is(":visible"),c=R(a.find(".amazon-gift-wrap")),d=R(a.find(".afn-wrap-none")),e=R(a.find(".hide-prices-checkbox"));if(c.is(":checked")||!d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!0),a.find(".hide-prices-note").show();
else if(c.not(":checked")||d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!1),a.find(".hide-prices-note").hide()}function r(a){var b=T,c=R(b.find(".include-gift-receipt-checkbox")),b=R(b.find(".mfn-hide-prices-checkbox"));a?(ha&&!c.is(":checked")&&c.attr("checked",!0).trigger("change"),ha||b.is(":checked")||b.attr("checked",!0).trigger("change")):(ha&&c.is(":checked")&&c.removeAttr("checked").trigger("change"),!ha&&b.is(":checked")&&b.removeAttr("checked").trigger("change"))}function t(a){var b=
T,c=R(b.find(".include-gift-receipt-checkbox")),b=R(b.find(".mfn-hide-prices-checkbox"));a?(r(!0),ha?c.attr("disabled","disabled"):b.attr("disabled","disabled")):ha?c.removeAttr("disabled"):b.removeAttr("disabled")}function v(a){var b=R(T.find(".include-gift-message-checkbox"));a?(b.is(":checked")||b.attr("checked",!0).trigger("change"),z(!1),y()):(b.is(":checked")&&b.removeAttr("checked").trigger("change"),J())}function z(a){var b=T,d=b.find(".no-message-warning"),e=b.find(".no-receipt-warning"),
f=b.find("textarea[name\x3d'gift-message-text']"),b=b.find(".message-remaining-text");a&&!e.is(":visible")?(c.showGiftTextAreaOnWarning()||f.addClass("gift-message-warning"),b.hide(),d.show()):(c.showGiftTextAreaOnWarning()||f.removeClass("gift-message-warning"),d.hide(),b.show())}function y(){var a=T,b=a.find("textarea[name\x3d'gift-message-text']"),a=a.find(".gift-message-label");b.removeClass("gift-message-inactive");a.removeClass("a-color-secondary")}function J(){var a=T,b=a.find("textarea[name\x3d'gift-message-text']"),
a=a.find(".gift-message-label");b.addClass("gift-message-inactive");a.addClass("a-color-secondary")}function D(){var b=T,c=R(b.find(".include-gift-message-checkbox")),d=b.find(".gift-msg-on-card"),e=b.find(".gift-msg-on-receipt"),f=a.trim(b.find(".gift-message-default-placeholder").text()),g=a.trim(b.find(".gift-message-with-wrap-placeholder").text()),h=b.find("textarea"),k=!1;b.find(".amazon-gift-wrap").each(function(){R(I(this)).is(":checked")&&(k=!0)});b.find(".afn-gift-wrap").each(function(){R(I(this)).is(":checked")&&
(k=!0)});b.find(".mfn-gift-wrap").each(function(){R(I(this)).is(":checked")&&(k=!0)});k?(e.hide(),d.show(),h.attr("placeholder",g),ha&&(v(!0),Aa&&c.attr("disabled","disabled"))):(d.hide(),ha&&e.show(),h.attr("placeholder",f),c.removeAttr("disabled"))}function F(){var a=T,b=R(a.find(".include-gift-message-checkbox")),a=a.find("textarea[name\x3d'gift-message-text']");!va&&ha&&(b.is(":checked")&&0<a.val().length?z(!1):z(!0))}function L(){var a=T,b=R(a.find(".include-gift-receipt-checkbox")),c=a.find(".no-receipt-warning"),
a=a.find(".no-message-warning");b.is(":checked")?(c.hide(),Aa||v(!0)):(a.hide(),c.show(),v(!1))}function P(a){a=T;var b=R(a.find(".include-gift-receipt-checkbox")),b=ha&&b.is(":checked"),c=R(a.find(".mfn-hide-prices-checkbox")),c=!ha&&c.is(":checked");b||c?(C(),a.find(".kindle-reg-msg-your-account").hide(),a.find(".kindle-reg-msg-another-account").show()):(W(),t(!1),a.find(".kindle-reg-msg-another-account").hide(),a.find(".kindle-reg-msg-your-account").show())}function G(a){a=T;var b=!1;R(a.find(".include-gift-message-checkbox")).is(":checked")&&
(b=!0);var c=!1;a.find(".amazon-gift-wrap").each(function(){R(I(this)).is(":checked")&&(c=!0)});a.find(".afn-gift-wrap").each(function(){R(I(this)).is(":checked")&&(c=!0)});a.find(".mfn-gift-wrap").each(function(){R(I(this)).is(":checked")&&(c=!0)});(b||c)&&r(!0);b&&Aa||c?t(!0):t(!1)}function M(a,b,c){var d=T;ia=a;ya=b;if(a=d.find("textarea[name\x3d'gift-message-text']")){b=c?a.val().length:n.unescape(encodeURIComponent(a.val())).length;ka&&!va&&ha&&(0<b?z(!1):z(!0));var e=a.val().split("\n").length;
c=ia-b;e=ya-e;!ka&&0<b&&d.find(".include-gift-message-checkbox").not(":checked")&&d.find(".include-gift-message-checkbox").attr("checked",!0);a=a.val().split("\n");for(var g in a)24<a[g].length&&(e=0===a[g].length%24?e-(Math.floor(a[g].length/24)-1):e-Math.floor(a[g].length/24));d.find(".popover-gift-center .remainder-count").hide();(-1>c?d.find(".popover-gift-center .remaining-char-over-multiple").show():0>c?d.find(".popover-gift-center .remaining-char-over-single").show():1===c?d.find(".popover-gift-center .remaining-char-single").show():
d.find(".popover-gift-center .remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(c));(-1>e?d.find(".popover-gift-center .remaining-line-over-multiple").show():0>e?d.find(".popover-gift-center .remaining-line-over-single").show():1===e?d.find(".popover-gift-center .remaining-line-single").show():d.find(".popover-gift-center .remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(e));if(0>c||0>e)f.isSPP()?(d.find(".set-gift-options-button").addClass("aok-hidden"),
d.find(".set-gift-options-button-disabled").removeClass("aok-hidden")):(d.find(".set-gift-options-button").hide(),d.find(".set-gift-options-button-disabled").show()),0>c?(d.find(".gift-char-limit-error").find(".char-limit-error").html(ia),d.find(".current-blocker-content").html(d.find(".gift-char-limit-error").html())):0>e&&(d.find(".gift-line-limit-error").find(".line-limit-error").html(ya),d.find(".current-blocker-content").html(d.find(".gift-line-limit-error").html()));-1<c&&-1<e&&(f.isSPP()?(d.find(".set-gift-options-button").removeClass("aok-hidden"),
d.find(".set-gift-options-button-disabled").addClass("aok-hidden")):(d.find(".set-gift-options-button").show(),d.find(".set-gift-options-button-disabled").hide()))}}function Q(a){a.stopPropagation();var b=T;b.find(".popover-content-main").fadeOut(100,function(){b.find(".popover-content-gift-wrap-preview .gift-wrap-preview-image").attr("src",a.data.imageURL);b.find(".popover-content-gift-wrap-preview").fadeIn(100)});var c=b.find(".popover-content-gift-wrap-preview .back-to-gift-options-button");c.unbind("click").bind("click",
V);g.bindActionEnterKeyOnButton(c);wa=!0}function V(a){wa=!1;var b=T;a?b.find(".popover-content-gift-wrap-preview").fadeOut(100,function(){b.find(".popover-content-main").fadeIn(100)}):setTimeout(function(){b.find(".popover-content-gift-wrap-preview").hide();b.find(".popover-content-main").show()},500)}function E(a){var b=T,c=!1;I(".amazon-gift-wrap").each(function(){R(I(this)).is(":checked")&&(c=!0)});I(".afn-gift-wrap").each(function(){R(I(this)).is(":checked")&&(c=!0)});I(".mfn-gift-wrap").each(function(){R(I(this)).is(":checked")&&
(c=!0)});if(c)C(),aa();else if(R(b.find(".hide-prices-checkbox")).is(":disabled"))Y();else if(a.is("input[type\x3dcheckbox]")&&(a.closest(".a-checkbox").hasClass("hide-prices-checkbox")||a.hasClass("hide-prices-checkbox")))a.is(":checked")?C():W();else if(f.isSPP())(b=a.closest(".a-radio"))&&a.is(":checked")&&(b.hasClass("kindle-reg-radio-your-account")?W():b.hasClass("kindle-reg-radio-another-account")&&C());else if(a.hasClass("kindle-reg-radio-another-account")||a.hasClass("kindle-reg-radio-your-account"))b.find(".kindle-reg-radio-your-account").is(":checked")?
W():C()}function C(){var a=T,b=R(a.find(".hide-prices-checkbox"));b.is(":checked")&&!f.isSPP()||b.attr("checked","checked");R(a.find(".kindle-reg-radio-your-account")).is(":checked")&&R(a.find(".kindle-reg-radio-another-account")).attr("checked",!0)}function W(){var a=T,b=R(a.find(".hide-prices-checkbox"));b.is(":checked")&&b.removeAttr("checked");R(a.find(".kindle-reg-radio-another-account")).is(":checked")&&R(a.find(".kindle-reg-radio-your-account")).attr("checked",!0)}function aa(){var a=T;R(a.find(".hide-prices-checkbox")).attr("disabled",
"true");R(a.find(".kindle-reg-radio-another-account")).attr("disabled",!0);R(a.find(".kindle-reg-radio-your-account")).attr("disabled",!0);a.find(".hide-prices-merchant-cant").is(":visible")||a.find(".hide-prices-note").show()}function Y(){var a=T;R(a.find(".hide-prices-checkbox")).removeAttr("disabled");R(a.find(".kindle-reg-radio-another-account")).removeAttr("disabled");R(a.find(".kindle-reg-radio-your-account")).removeAttr("disabled");a.find(".hide-prices-note").hide()}function X(a){var b=g.getPosition(a,
"#",2),c=g.getPosition(a,"#",3);return"60"===a.substring(b+1,c)}function da(b,c,d){var e=O(),f,g;e?(f=d.find('li[class\x3d"a-carousel-card gift-wrap noshi-wrap none-wrap"]'),g=d.find(".carousel-gift-wrap").find("ol")):(f=d.find("."+c+"-wrap-template"),g=d.find("ul.allGiftWrapList"));e&&a.trigger("checkout:gift:removeEmptyCarouselCards",g);var h=(d.data("lineitemid")||b.obfuscatedEntityId||"").replace(":","-");"afn"!==c||e||(g.find('li[class!\x3d"none-wrap gift-wrap noshi-wrap"]').remove(),I("#giftwrap-carousel-wrap-holder-"+
h).css("width",90*(b.options.wraps.length+1)),I("#giftwrap-carousel-wrap-pane-"+h).css("width",360));for(var k=T,l=k.find(".larger-image-link-carousel-template"),m=0;m<b.options.wraps.length;m++){var t=f.clone(!0).removeClass(c+"-wrap-template").addClass(c+"-wrap-copy"),p=l.clone(!0).removeClass("larger-image-link-carousel-template").addClass("larger-image-link-carousel-"+m),r=c,u=b,n=m,v=t,q=p,B=u.options.wraps[n].id;v.find("input").addClass(r+"-wrap-"+n).val(B);v.find("label").attr("for",r+"-wrap-"+
n);B=u.options.wraps[n].description;v.find("."+r+"-wrap-description").html(B);B=u.options.wraps[n].price;v.find("."+r+"-wrap-price").html(B);(u=u.options.wraps[n].imageurl)&&u.length?(v.find("."+r+"-image").attr("src",u).show(),r=v.find(".larger-image-link"),r.show(),r.unbind("click").bind("click",{imageURL:u},Q),q.unbind("click").bind("click",{imageURL:u},Q),q.find("a").unbind("click").bind("click",{imageURL:u},Q)):"mfn"!==r||O()||(v.find(".a-span3").hide(),v.find(".a-span9").addClass("a-span12").removeClass("a-span9"),
v.find(".a-color-price").removeClass("wrap-price"));if("afn"===c){n=b;q=m;v=h;r=g;u=k;B=n.options.wraps[q].id;t.data("giftwrap-id",B);t.data("wrap-no",q);if(n.selected.wrap===B){r.find("li.none-wrap").find("img").removeClass("selected-giftwrap-image");t.find("img").addClass("selected-giftwrap-image");var n=t.find("img").attr("src"),z=I("#giftwrap-option-preview-imagearea-image-"+v);z.find("img").attr("src",n);z.removeClass("aok-hidden");I("#giftwrap-option-preview-imagearea-default-"+v).addClass("aok-hidden");
E(t.find("input"));K();X(B)&&oa(v);p.removeClass("aok-hidden");p.addClass("selectedWrapLargeLink")}O()?(v=X(B)?"gift-wrap":"noshi-wrap",t.removeClass(v).removeClass("none-wrap"),r.append(t.show())):(v=X(B)?"\x3cli class\x3dnoshi-wrap\x3e":"\x3cli class\x3dgift-wrap\x3e",r.append(I(v).append(t.show())));t=u.find("#carousel-larger-image-div");t.find(".larger-image-link-carousel-"+q).length||t.append(p.show())}}d.find("."+c+"-wrap-checkbox").removeAttr("checked");b.selected&&b.selected.isWrapped?d.find("input[value\x3d'"+
b.selected.wrap+"']").attr("checked",!0):R(d.find("."+c+"-wrap-none")).attr("checked",!0);e&&a.trigger("checkout:gift:adjustCarouselInitial",b,d)}function O(){return f.isSPP()&&I("input[name\x3dsppGiftPopoverWithCarousel]").length}function Z(a,b,c){for(var d=c.find("."+b+"-wrap-template"),e=0;e<a.options.wraps.length;e++){var g=d.clone(!0).removeClass(b+"-wrap-template").addClass(b+"-wrap-copy"),h=a.options.wraps[e].id;g.find("input").addClass(b+"-wrap-"+e).val(h);g.find("label").attr("for",b+"-wrap-"+
e);h=a.options.wraps[e].description;g.find("."+b+"-wrap-description").html(h);h=a.options.wraps[e].price;g.find("."+b+"-wrap-price").html(h);if((h=a.options.wraps[e].imageurl)&&h.length){var k=g.find("."+b+"-image");f.isSPP()&&k.removeClass("hidden");k.attr("src",h).show();k=g.find(".larger-image-link");f.isSPP()&&k.removeClass("hidden");k.show();k.unbind("click").bind("click",{imageURL:h},Q)}else g.find(".a-span3").hide(),g.find(".a-span9").addClass("a-span12").removeClass("a-span9"),g.find(".a-color-price").removeClass("wrap-price");
f.isSPP()&&g.removeClass("hidden");g.insertAfter(d).show()}c.find("."+b+"-wrap-checkbox").removeAttr("checked");a.selected&&a.selected.isWrapped?c.find("input[value\x3d'"+a.selected.wrap+"']").attr("checked",!0):R(c.find("."+b+"-wrap-none")).attr("checked",!0)}function w(){T.find("#include-gift-connection-checkbox").attr("checked",!0)}function ca(){if(T.find(".include-gift-connection-checkbox").not(":checked")){var a=T;a.find(".gift-connection-recipient-extra").hide();var b;b=a.find('#select-recipient option[value\x3d"0"]').attr("selected",
"selected");a.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(b.text());a.find("#input-recipient-first-name").val("");a.find("#input-recipient-last-name").val("");ga()}}function ba(a){for(var b=T,c=0;c<ma.length;c++)if(a&&a===ma[c].value&&ma[c].bMonth&&ma[c].bDay){var d;d=b.find('#select-occasion-month option[value\x3d"'+ma[c].bMonth+'"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text());
d=b.find('#select-occasion-day option[value\x3d"'+ma[c].bDay+'"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text())}}function ga(){var a=T,b=a.find("#popover-gift-connection #select-recipient").find(":selected").val();if(""!==b&&"0"!==b&&("1"!==b&&"2"!==b||a.find("#input-recipient-first-name").val()||a.find("#input-recipient-last-name").val()))a.find("#select-occasion").prop("disabled",!1),a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:1});
else{b=T;b.find(".gift-connection-occasion-extra").hide();var c;c=b.find('#select-occasion option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-month option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-day option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text());
c=b.find('#select-occasion-age option[value\x3d"-1"]').attr("selected","selected");b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text());b.find("#occasion-has-reminder-checkbox").attr("checked",!0);a.find("#select-occasion").prop("disabled",!0);a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:.5})}}function fa(a,b){var c=T;"1"===a&&"2"===b?c.find("#select-occasion-age-row").show():c.find("#select-occasion-age-row").hide()}function N(a){a=
T;var b=a.find("#popover-gift-connection #select-recipient").find(":selected").val(),c=a.find("#popover-gift-connection #select-occasion").find(":selected").val();!b||"1"!==b&&"2"!==b?(a.find(".gift-connection-recipient-extra").hide(),"1"===c&&b&&ba(b)):a.find(".gift-connection-recipient-extra").show();fa(c,b);ga()}function U(a){a=T;var b=a.find("#popover-gift-connection #select-occasion").find(":selected").val(),c=a.find("#popover-gift-connection #select-recipient").find(":selected").val();!b||"1"!==
b&&"2"!==b?a.find(".gift-connection-occasion-extra").hide():("1"===b&&c&&"1"!==c&&"2"!==c&&ba(c),a.find(".gift-connection-occasion-extra").show());fa(b,c)}function la(a){var b=T,c="/gp/buy/pipeline/handlers/list-of-giftlists.html?escape\x3d0";ma&&(c+="\x26mappingOnly\x3d1");a&&(c+="\x26fromRegistryIds\x3d"+a);I.ajax({type:"POST",url:c,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(c){b.find("#select-recipient").hide();!ma&&c.options&&0<c.options.length&&(ma=c.options);a&&c.registryIdMapping&&
(za=c.registryIdMapping[a]);ma&&m();b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();ja=!0},error:function(){b.find("#select-recipient").show();b.find("#select-recipient-spinner").hide();ja=!0}})}function S(b,c){var d=O(),e=c.lineItemId;c=O()?c.currentTab:b.data("current-tab");var f=I("#popover-gift-options-wrapper-"+e).data("active-tab");c!==f&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),b.addClass("selected-giftwrap-tab"),b=I("#giftwrap-carousel-wrap-holder-"+
e),d||b.css("left",0),f=I("#giftwrap-carousel-wrap-holder-"+e+" li"),d?(a.trigger("checkout:gift:changeCarouselWrapOptions",b,c,e),a.trigger("checkout:gift:adaptCarouselSPCPanel",e,c)):"all"===c?f.show():(f.hide(),f.filter("."+{"gift-wrap":"gift-wrap",noshi:"noshi-wrap"}[c]).show()),I("#popover-gift-options-wrapper-"+e).data("active-tab",c),f.find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),f.filter(".none-wrap").find("img").addClass("selected-giftwrap-image"),I("#giftwrap-option-preview-imagearea-default-"+
e).removeClass("aok-hidden"),I("#giftwrap-option-preview-imagearea-image-"+e).addClass("aok-hidden"),d=I("#allGiftWrapList-"+e).find(".none-wrap").find("input"),c=I(".selectedWrapLargeLink"),d.prop("checked",!0),d.val("").change(),ua(e),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")))}function ea(a,b,c){c.$event.preventDefault();a=b.lineItemId;b=parseInt(I("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);0>b&&(b=b+90+"px",I("#giftwrap-carousel-wrap-holder-"+a).css("left",
b))}function ra(a,b,c){c.$event.preventDefault();a=b.lineItemId;var d=I("#allGiftWrapList-"+a);b=d.find("li").size();c=d.find("li.gift-wrap").size();var d=d.find("li.noshi-wrap").size(),e=I("#popover-gift-options-wrapper-"+a).data("active-tab"),f;"all"===e?f=b:"gift-wrap"===e?f=c:"noshi"===e&&(f=d);b=parseInt(I("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);b>-90*(f-4)&&(b=b-90+"px",I("#giftwrap-carousel-wrap-holder-"+a).css("left",b))}function pa(a,b){var c=b.lineItemId;I("#allGiftWrapList-"+
c).find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".afn-image").addClass("selected-giftwrap-image");b=a.parent();b.hasClass("noshi-wrap")&&!b.hasClass("none-wrap")?(oa(c),I("#afn-message-span-"+c).find("input").prop("checked",!1)):(ua(c),I("#afn-message-span-"+c).find("input").prop("checked",!0));var d=a.data("giftwrap-id"),e=a.find("input"),f=a.data("wrap-no");e.prop("checked",!0);e.val(d).change();d=I("#giftwrap-option-preview-imagearea-default-"+c);c=I("#giftwrap-option-preview-imagearea-image-"+
c);e=I(".selectedWrapLargeLink");f=I(".larger-image-link-carousel-"+f);b.hasClass("none-wrap")?(d.removeClass("aok-hidden"),c.addClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),c.find("img").attr("src",a),d.addClass("aok-hidden"),c.removeClass("aok-hidden"),e.length&&(e.addClass("aok-hidden"),e.removeClass("selectedWrapLargeLink")),f.length&&(f.addClass("selectedWrapLargeLink"),f.removeClass("aok-hidden")))}function sa(a,
b){var c=b.lineItemId;b=I("#giftwrap-option-preview-imagearea-default-"+c);c=I("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function qa(a,b){var c=b.lineItemId;a=I("#giftwrap-option-preview-imagearea-default-"+c);b=I("#giftwrap-option-preview-imagearea-image-"+c);I("#allGiftWrapList-"+c).find(".selected-giftwrap-image").parentsUntil("ul",
"li").hasClass("none-wrap")?(a.removeClass("aok-hidden"),b.addClass("aok-hidden")):(c=I("#allGiftWrapList-"+c).find(".selected-giftwrap-image").attr("src"),b.find("img").attr("src",c),a.addClass("aok-hidden"),b.removeClass("aok-hidden"))}function ua(a){var b=I("#afn-message-span-"+a+", #gift-message-"+a);I("#gift-message-noshi-warning-"+a).addClass("aok-hidden");b.removeClass("disable-message-area").addClass("enable-message-area");b.find("input").removeAttr("disabled");b.find("textarea").removeAttr("disabled")}
function oa(a){var b=I("#afn-message-span-"+a+", #gift-message-"+a);I("#gift-message-noshi-warning-"+a).removeClass("aok-hidden");b.removeClass("enable-message-area").addClass("disable-message-area");b.find("input").attr("disabled","disabled");b.find("textarea").attr("disabled","disabled")}var I=a.$;if(!I("html").hasClass("a-ie6")){var ia,ya,T,ta,wa=!1,ka=!1,va=!0,ha=!0,ma,ja=!1,za,Aa=!1;a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")&&(f.isSPP()&&
d.increaseCount("checkout:spp-revieworder:gift_pop_cancel_sec",1),wa&&V(),ka&&(a=T,a.find(".gift-msg-on-card").hide(),a.find(".popover-gift-warning").hide(),a.find(".message-remaining-text").show(),R(a.find(".amazon-gift-wrap")).removeAttr("checked"),v(!1),a.find('input[type\x3d"checkbox"]').removeAttr("disabled")))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")){T=a.popover.$popover;ta=a.popover;0<T.find(".include-gift-receipt-checkbox").length&&
(ka=!0);k.showSpinner(T.find(".popover-content-main"),!1,ta);T.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var c=ta.data;if(c)a+="\x26obfuscatedEntityId\x3d"+c;else throw{name:"MissingData",message:"lineItemId is undefined"};}catch(d){n.ueLogError&&n.ueLogError(d,{logLevel:"FATAL",attribution:"gift-popover",message:"[No lineItemId to open the gift-popover with]. "})}I.ajax({type:"POST",
url:"/gp/buy/pipeline/handlers/gift-select-content.html",data:a,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return b.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&f.redirect(a);null!==a?q(a,b,c):f.ajaxRedirect()},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-gift"))b=T,a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text()),
a.popover.updatePosition(!0);else if(a.popover&&a.popover.$popover){var b=a.popover.$popover;a=b.find(".validateInputCharactersOnBlur.a-form-error");0<a.size()&&a.removeClass("a-form-error");b=b.find("#onblur-character-validation-error-gift-message-text");0<b.size()&&b.remove()}});var Ba={enforceSelectorParity:E,enforceGiftReceiptParity:G,enforceHidePriceParity:P,disableHidePrice:K,toggleMessageBoxDisplay:D,toggleEmptyMsgWarning:F,toggleNoReceiptWarning:L,includeGiftConnection:w,clearGiftConnection:ca,
toggleGiftConnectionRecipientArea:N,toggleGiftConnectionOccasionArea:U,updateGiftOptionsTabSelection:S,updateCarouselOnLeftClick:ea,updateCarouselOnRightClick:ra,updateSelectedGiftWrap:pa,updatePreviewImageOnMouseEnter:sa,updatePreviewImageOnMouseLeave:qa},R=e.getInput;a.declarative("gift-popover-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(Ba[b[c]])Ba[b[c]](a.$target,a.data)});a.declarative("gift-popover-element","click mouseenter mouseleave",
function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(Ba[b[c]])Ba[b[c]](a.$currentTarget,a.data,a)});a.declarative("spc-update-gift-options-tab-selection","click",function(a){var b=a.$target.parents("li");b.attr("data",a.data);S(b,a.data)});a.on("checkout:reload:spc",p);a.on("checkout:reload:spp-revieworder",p)}});"use strict";q.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor",
"checkout-general-utils","page-detector","client-side-metrics").register("concealment-popover-controller",function(a,l,k,b,f,g,h,d){function e(){q("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");a.defer(function(){q("#spc-orders").find(".concealment-popover-link").each(function(){q(this).data("action")&&q(this).removeAttr("href").attr("tabindex",0)})})}function c(a){return a.is("input")?a:a.find("input")}function m(a){var b=u;b.find(".fake-label").each(function(){q(this).unbind("click").bind("click",
function(){q(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".concealment-item-title").html(a.item.title);if(a&&a.obfuscatedEntityId){var d=b.find(".set-concealment-options-button input");d.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,concealmentData:a,quantity:a.quantity},p);g.bindActionEnterKeyOnButton(d)}K=a&&a.item&&a.item.isAmazonFulfilled;a&&a.selected&&(d=c(b.find(".conceal-item-checkbox")),a.selected.concealItem?
d.attr("checked",!0):d.removeAttr("checked"));u.find(".content-container").css("visibility","visible");x.updatePosition(!0);k.hideSpinner(b.find(".popover-content-main"))}function p(a){var e=u,g="";a&&a.data&&a.data.obfuscatedentityid&&(g+="obfuscatedEntityId.0\x3d"+a.data.obfuscatedentityid+"\x26");a&&a.data&&a.data.quantity&&(g+="quantity.0\x3d"+a.data.quantity+"\x26");var h="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.saveConcealmentRefTag&&(h=a.data.concealmentData.saveConcealmentRefTag);
var k="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.cancelConcealmentRefTag&&(k=a.data.concealmentData.cancelConcealmentRefTag);(a=c(e.find(".conceal-item-checkbox")).is(":checked"))?(K&&(g+="isAFN.0\x3d1\x26"),g=g+"includeReceipt.0\x3d1\x26includeMessage.0\x3d1\x26"+("message.0\x3d"+encodeURIComponent(q("input[name\x3d'concealment-item-message']").val())+"\x26"),g=g+"hidePrices.0\x3d0\x26saveOnly\x3d1"+("ref\x3d"+h+"\x26")):g+="ref\x3d"+k+"\x26";var m=q("input#executionId").val();
m&&(g+="executionId\x3d"+m+"\x26");m="/gp/buy/gift/handlers/save-all.html/ref\x3d";a?(m+=h,d.increaseCount("CPEX.Checkout.Select.Concealment",1)):(m+=k,d.increaseCount("CPEX.Checkout.Cancel.Concealment",1));f.isSPP()&&(e.find(".a-button-close").trigger("click"),h=q("#setOrderingPrefsCheckbox"),h.length&&h.is(":checked")&&(g+="\x26saveAsDefaultsSelected\x3d1"));l.show();q.ajax({type:"POST",url:m,data:g,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},
contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,c,d){d.getResponseHeader("x-amz-checkout-page")?(f.isSPP()||e.find(".a-button-close").trigger("click"),f.ajaxUpdatePage(a,c,d)):(a=b.jsonify(a),f.redirect(a))},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}var q=a.$;if(!q("html").hasClass("a-ie6")){var u,x,K=!0;q(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){d.increaseCount("CPEX.Checkout.Concealment.Button.click",
1)});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")&&(f.isSPP()&&d.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),c(u.find(".conceal-item-checkbox")).removeAttr("checked"))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")){u=a.popover.$popover;x=a.popover;k.showSpinner(u.find(".popover-content-main"),!1,x);u.find(".content-container").css("visibility","hidden");
a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var c=x.data.lineItemEntityId,d=x.data.itemId;if(c)a+="\x26obfuscatedEntityId\x3d"+c;else if(d)a+="\x26lineItemEntityId\x3d"+d;else throw{name:"MissingData",message:"lineItemId is undefined"};var e=x.data.quantity;if(e)a+="\x26quantity\x3d"+e;else throw{name:"MissingData",message:"quantity is undefined"};}catch(g){n.ueLogError&&n.ueLogError(g,{logLevel:"FATAL",attribution:"concealment-popover",
message:"[Data missing to open the concealment-popover]. "})}c=x.data.ref;q.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/concealment-select-content.html/ref\x3d"+c,data:a+("\x26ref\x3d"+c),dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return b.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&f.redirect(a);null!==a?m(a,b,c):f.ajaxRedirect()},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",
function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-concealment")){var b=u;a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text());a.popover.updatePosition(!0)}});var r={};a.declarative("concealment-popover-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(r[b[c]])r[b[c]](a.$target,a.data)});a.declarative("concealment-popover-element","click mouseenter mouseleave",
function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(r[b[c]])r[b[c]](a.$currentTarget,a.data,a)});a.on("checkout:reload:spc",e);a.on("checkout:reload:spp-revieworder",e)}});"use strict";q.when("A","page-conductor","scroll-controller","page-detector","client-side-metrics","button-blocker").register("gold-box-controller",function(a,l,k,b,f,g){function h(){a.defer(e);a.defer(c)}var d=a.$;if(!d("html").hasClass("a-ie6")){var e=
function(){var a=d("#goldbox-countdown"),b=d("#spc-orders");b&&0!==b.length||(b=d("#spclite-items-block"));b=b.find("input[name\x3dgoldboxexpirelefttime]");if(0!==b.length){if(1<b.size()){var c=parseInt(b.attr("data-timeleftms"),10),e=b;d.each(b,function(){var a=d(this),b=parseInt(a.attr("data-timeleftms"),10);b<c&&(e=a,c=b)});b=e}var g=parseFloat(b.attr("data-pagestarttime")),h=parseFloat(b.attr("data-timeleftms")/1E3);if(!(isNaN(g)||isNaN(h)||0>=h)){var r=(new Date).getTime(),t=a.find("span[data-timefield\x3dminute]"),
v=a.find("span[data-timefield\x3dsecond]"),q=n.setInterval(function(){var b=(new Date).getTime();h-=(b-r)/1E3;r=b;if(0>h&&q)v.html("00"),n.clearInterval(q),q=null,l.isSPP()&&f.increaseCount("checkout:spp-revieworder:deal_expired",1),d("#gold-box-modal-launcher").trigger("click"),k.scrollToTop(),k.toggleScrollOff();else{var b=Math.floor(h/60%60),c=Math.floor(h%60),c=10>c?"0"+c:c;t.html(b);v.html(c);a.is(":visible")||a.show()}},1E3);l.isSPP()&&f.increaseCount("checkout:spp-revieworder:deal_countdown",
1)}}},c=function(){var a=d("#gold-box-button-blocker");1===a.length&&g.show("place-order-gold-box-blocker",a.attr("data-blocker-message"))};a.on("checkout:reload:spc",h);a.on("checkout:reload:spclite",h);a.on("checkout:reload:spp-revieworder",h)}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","currency-formatter","page-detector","client-side-metrics","pay-rewards-currency").register("inline-points-controller",function(a,l,k,b,f,g,h,d){function e(){r("#spc-points-input")&&
r("#spc-points-input").data("points-used")&&(r("#points-applied").show(),r("#inline-points-button").hide());r("#inline-points-register")&&r("#inline-points-register").removeAttr("href");r("#spc-loyalty-points-input")&&r("#spc-loyalty-points-input").val()&&(r("#loyalty-points-applied").show(),r("#loyalty-points-button").hide());r("#spc-points-input")&&r("#spc-points-input").hasClass("show-currency-input-widget-new")&&r("#spc-points-input").each(function(b,c){var e=a.$(c);b={$element:e,maxAmount:e.data("max-dollar-amount")};
c={$element:a.$("#inline-raw-points"),decimalPlaces:e.data("decimal-places"),ratio:e.data("conversion-ratio")};var f=e.data("country-code"),f=d.getCurrencyFormatByCountryCode(f);d.initializeInlineFormatting(b,c,f);r(document).delegate("#spc-points-input","keydown",function(a){if(e.data("points-used")!==e.val){a=r("#inline-points-button");var b=!1;a.is("span")&&(b=!0);var c=a.find("span.apply"),d=a.find("span.change");r("#points-applied").hide();e.data("points-used")?(c.hide(),d.show()):(c.show(),
d.hide());b?a.addClass("display-inline-block"):a.show()}})})}function c(a,c){a.preventDefault();if(m(c)){b.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(r("#payment"))):l.show();var d;a={"x-amz-checkout-page":"spc"};if(c)d=r("#loyalty-points-hidden-fields"),c="/gp/buy/spc/handlers/update-loyalty-points.html/ref\x3dox_spc_points_edit",d="\x26jpPointsPaymentInstrumentId\x3d"+encodeURIComponent(d.find("input[name\x3d'jpPointsPaymentInstrumentId']").val())+"\x26jpPointsCustomerRequestedAmount\x3d"+
r("#spc-loyalty-points-input").val()+"\x26jpPointsConversionRate\x3d"+d.find("input[name\x3d'jpPointsConversionRate']").val()+"\x26jpPointsBaseCurrencyCode\x3d"+d.find("input[name\x3d'jpPointsBaseCurrencyCode']").val()+"\x26jpPointsTargetCurrencyCode\x3d"+d.find("input[name\x3d'jpPointsTargetCurrencyCode']").val()+"\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+r("input[name\x3duseCtb]").val();else{a=b.setAjaxTransitionHeader(a);d=r("#inline-points-hidden-fields");var e=d.find("input[name\x3d'useGCBalance']").val();
c="/gp/buy/pipeline/handlers/update-reward-points.html/ref\x3d"+(b.isSPP()?"chk_pay_addswp_coll":"ox_pay_page_points_apply");d="paymentMethodId\x3d"+d.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+d.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+d.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+r("#spc-points-input").val()+"\x26rewardAccountRate\x3d"+d.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+
e+"\x26usePromoBalance\x3d"+e+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+r("input[name\x3duseCtb]").val()}r.ajax({type:"POST",url:c,data:d,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:a,success:function(a,c,d){d.getResponseHeader("x-amz-checkout-page")?b.ajaxUpdatePage(a,c,d):(a=k.jsonify(a),b.redirect(a))},error:function(a,c,d){b.ajaxRedirect(a,c,d)}})}}function m(a){var b=!1,c=
r("input[name\x3drewardAccountAmount]"),d=r("#inline-points-error-block");a||r("#spc-points-input")&&!r("#spc-points-input").hasClass("show-currency-input-widget-new")?(a&&(c=r("input[name\x3dloyaltyPointsValue]"),d=r("#loyalty-points-error")),d.hide(),d.find("p").hide(),n(c))?u(c,a)?q(c,a)||(d.find("p").filter(function(){return"badMax"===r(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badMin"===r(this).data("error")}).show().css("display","inline"),
b=!0):(d.find("p").filter(function(){return"badValue"===r(this).data("error")}).show().css("display","inline"),b=!0):a||u(c,a)||(d.find("p").filter(function(){return"badMin"===r(this).data("error")}).show().css("display","inline"),b=!0);if(b)return d.show(),c.addClass("a-form-error"),!1;c.removeClass("a-form-error");return!0}function p(a,b){var c=r(a.currentTarget),d=c.val();a=r("#inline-raw-points");b&&(a=r("#loyalty-points-applied-value"));var e=a.html();if(b)!/^\s*$/.test(d)&&!isNaN(d)&&0<d?a.html(d):
a.html(0);else if(!r("#spc-points-input").hasClass("show-currency-input-widget-new")){var g=c.data("min-dollar-amount");!/^\s*$/.test(d)&&!isNaN(d)&&0<d&&!isNaN(g)&&d>=g?(g=c.data("conversion-ratio"),c=c.data("decimal-places"),d=f.getNumberWithSeparators(d/g,c),a.html(d)):a.html(0)}(b||r("#points-applied").is(":visible"))&&e!==a.html()&&(a=r("#spc-loyalty-points-display"),e=r("#loyalty-points-applied"),d=r("#loyalty-points-button"),c=!1,b||(a=r("#inline-points-button"),a.is("span")&&(c=!0),e=a.find("span.apply"),
d=a.find("span.change"),r("#points-applied").hide()),e.hide(),d.show(),c?a.css("display","inline-block"):a.show())}function n(a){a=a.val();return/^\s*$/.test(a)||!isNaN(a)}function u(a,b){if(b)return!0;b=a.val();if(/^\s*$/.test(b))return!0;b=parseFloat(b);return isNaN(b)||!a.data("min-dollar-amount")?!0:0===b||b>=a.data("min-dollar-amount")}function q(a,b){var c=a.val();if(/^\s*$/.test(c))return!0;var c=parseFloat(c),d=a.data("max-dollar-amount");b&&(d=a.data("available-points"));return isNaN(c)||
!d?!0:c<=d}function K(a){switch(a.keyCode?a.keyCode:a.which){case 13:case 10:var b=r("#loyalty-points-button"),d=r("#spc-points-input");0<b.length&&b.is(":visible")?c(a,1):0<d.length&&c(a,0)}}var r=a.$;r("html").hasClass("a-ie6")||(r(document).delegate("#spc-loyalty-points-input","keypress",function(a){K(a)}),r("#spc-points-input")&&!r("#spc-points-input").hasClass("show-currency-input-widget-new")&&(r(document).delegate("#spc-points-input","keypress",function(a){K(a)}),r(document).delegate("#spc-points-input",
"keyup",function(a){p(a,0)})),r(document).delegate("#spc-loyalty-points-input","keyup",function(a){p(a,1)}),r(document).delegate("#inline-points-button","click",function(a){c(a,0)}),r(document).delegate("#loyalty-points-button","click",function(a){c(a,1)}),a.on("a:expander:apply-point-expander:toggle:expand",function(a){h.increaseCount("checkout:spp-payment:expand_addswp_coll",1)}),a.on("checkout:reload:spc",e),a.on("checkout:reload:spp-revieworder",e))});"use strict";q.when("A","client-side-metrics",
"ready").execute(function(a,l){var k=a.$;a.on("checkout:reload:spc",function(){var a=k("input[name\x3d'rewardsProgramId']").val(),f=k("input[name\x3d'swpWidgetCase']").val();a&&f&&l.increaseCount("Checkout::SPC::SWPWidgetCSM::"+a+"::"+f,1)})});"use strict";q.when("A").execute(function(a){return{}});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor").register("inline-fps-balance-controller",function(a,l,k,b){function f(a){a.preventDefault();g("#inline-fps-balance-checkbox").prop("disabled",
"disabled");b.isSPP()?(l.blockAllActions(),l.showTransitionInContainer(g("#payment"))):l.show();var d=g("#inline-fps-balance-hidden-fields"),e=0;g("#inline-fps-balance-checkbox").prop("checked")&&(e=1);a=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});var c="/gp/buy/pipeline/handlers/update-fps-balance.html/ref\x3d"+(b.isSPP()?"chk_pay_"+(e?"apply":"remmove")+"_fps_balance_coll":"ox_spc_page_fps_balance_apply"),d="fpsPaymentMethodId\x3d"+d.find("input[name\x3d'fpsPaymentMethodId']").val()+
"\x26useFlexiblePayments\x3d"+e+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+g("input[name\x3duseCtb]").val();g.ajax({type:"POST",url:c,data:d,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,c,d){d.getResponseHeader("x-amz-checkout-page")?b.ajaxUpdatePage(a,c,d):(a=k.jsonify(a),b.redirect(a))},error:function(a,c,d){b.ajaxRedirect(a,c,d)}})}var g=a.$;g("html").hasClass("a-ie6")||g(document).delegate("#inline-fps-balance-checkbox",
"click",function(a){f(a)})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","checkout-general-utils","error-feature-detection","page-detector","client-side-metrics","weblab-helper","a-modal").register("shipping-speed-selection-controller",function(a,l,k,b,f,g,h,d,e,c){function m(){da?C("fieldset div.a-radio").addClass("a-touch-radio").removeClass("a-radio"):a.defer(function(){var a=C("#spc-orders").find("div.ship-option");a.filter(".no-scheduled-delivery");w=
a.find('input[type\x3d"radio"]:checked');a.each(function(){C(this).find("input.radio-image").remove()});a.each(function(){var a=C(this).find("input.radio-standard");a.attr("checked")&&a.attr("checked",!0)})});p();e.isShippingOptionTrialCallsDisabled()||a.defer(y);g.markFeatureAvailable("shipping-speed-selection-controller");q()}function p(){var a=0<C("#trigger-case-call-to-resolve-cv").length||0<C(".force-resolve-invalid-ship-option").length;if(b.isSPP()&&a){var a=function(){var a=n.setInterval(function(){b.isAnimating()||
(l.show(),n.clearInterval(a))},50)},c=C("div.ship-option").filter(".call-set-to-resolve-cv").first().find("input[type\x3d'radio']");if(c&&c.length){var d=c.parents(".shipping-speeds").find("input.lineitemidinput[type\x3dhidden]").val();F(c,null,null,{transitionAction:a,refTag:"chk_revieworder_set_ship_option_no_default",extraData:{callingCASEResolveCV:1,lineItemIds:d}})}}}function q(){C("#buy-button-disabled-state").length&&u(function(a){x(a)})}function u(a){C("div.sd_widget_root").each(function(b,
c){a(c)})}function x(a){var b=setInterval(C.proxy(function(){if(C(this).hasClass("sd_widget_initialized")){var a=C(this),c=C(a).attr("id");c&&(a=K(a),a["ScheduledDeliveryEntity.startDeliveryDate"]&&F(null,c,a));n.clearInterval(b)}},a),1E3)}function K(a){var b={};r(a,function(a){var c=C(a).attr("key");a=C(a).val();b[c]=a||""});return b}function r(a,b){C(a).find("input[type\x3d'hidden']").each(function(a,c){b(c)})}function t(){aa||(aa=C("input[type\x3d'hidden'][name\x3d'scopeId']").val());return aa}
function v(a,c,d){var f=d.getResponseHeader("x-amz-checkout-page");if(f)return"spc"===f&&W||(Y=!1),(f=k.jsonify(a))&&f.success&&f.trialkey&&X[f.trialkey]?(a=X[f.trialkey],b.isSPP()&&"object"===typeof a&&(a=JSON.stringify(X[f.trialkey])),e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<C(".mobile-view").length?b.ajaxUpdatePage(a,c,d,{pushNewFrame:"false"}):b.ajaxUpdatePage(a,c,d),O&&(clearTimeout(O),O=null),X={},!0):e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<C(".mobile-view").length?b.ajaxUpdatePage(a,
c,d,{pushNewFrame:"false"}):b.ajaxUpdatePage(a,c,d);Y=!1;return b.redirect(a)}function z(a,b){if(a){var c=a.data(b);if(void 0!==c)return c;(a=a.closest(".radio-standard"))&&(c=a.data(b));return c}}function y(){X={};aa=null;O&&(clearTimeout(O),O=null);var a=C("#spc-orders").find("input[type\x3d'hidden'][name\x3d'shiptrialprefix']").val(),c=C("#spc-orders").find("div.shipment"),d=C("#setDeliveryPrefetchMultiGroups").val(),e=C("#setDeliveryPrefetchGroupLimit").val(),f=1;d&&(f=c.length,e&&e<c.length&&
(f=e));for(var g=e?18E4:6E4,h=0;h<f;h++){var l="returnpipedata\x3d0\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1",m=0,p=[],r=C("#shipTrialToCacheCount").val();c.each(function(a,c){c=C(c);var d="",e=c.find(".shipping-speed").find("input[type\x3d'radio']");a=a===h?e.filter(function(){return 1===z(C(this),"istrial")}):e.filter(function(){return C(this).is(":checked")});var f=c.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==f.length&&
(f=c.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));d+="\x26lineitemids"+m+"\x3d"+c.find("input[name\x3d'lineitemids"+m+"']").attr("value");d+=V(c,m);a.length&&a.each(function(){var a=C(this),c=L(a,f,m),d="ox_spc_set_trial_ship_option_no_data";b.isSPP()&&(d="chk_revieworder_set_trial_ship_option_no_data");if(1===z(a,"istrial")){var e=!1;z(a,"trialIndex")<r&&(e=!0,d="ox_spc_set_trial_ship_option",b.isSPP()&&(d="chk_revieworder_set_trial_ship_option"));a=t()+
":"+a.attr("name")+":"+a.attr("value");p.push({trialkey:a,speedparams:c,cacheResult:e,ref:d})}else l+=c});l+=d;m++});0<m&&(l+="\x26groupcount\x3d"+m);l+="\x26istrial\x3d1";0===l.indexOf("\x26")&&(l=l.substr(1));var u=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});C.each(p,function(b,c){b=l+c.speedparams+"\x26trialkey\x3d"+c.trialkey;c.cacheResult&&(b+="\x26returnFullHTML\x3d1");if(c.cacheResult||!a){var d=c.trialkey;c=C.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+
c.ref,data:b,dataType:"text",async:!0,cache:!1,headers:u,dataFilter:function(a){return k.jsonify(a)},success:function(a){delete Z[d];if(a&&a.trialkey){var b=a.trialkey.split(":")[0];!Y&&b===t()&&a.fullhtml&&(X[a.trialkey]=a.fullhtml,O||(O=setTimeout(function(){X={}},g)))}},error:function(){delete Z[d]}});Z[d]=c}})}}function J(a){a.closest("fieldset").find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");a.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive")}
function D(a){var b=a;C(".shipping-group").each(function(a,c){var d=!1;C(c).parents().each(function(a,b){return C(b).hasClass("shipment")?(d=!0,!1):!0});d||(b=b.add(c))});return b}function F(a,c,d,f){da&&J(a);f&&f.transitionAction?f.transitionAction():l.show();W=!1;Y=!0;for(var g in Z)Z.hasOwnProperty(g)&&(Z[g].abort(),delete Z[g]);g=C("#spc-orders").find("input[type\x3d'hidden'][name\x3d'shiptrialprefix']").val();var h;a||(a=C("#"+c).closest(".shipping-speed").find("input[type\x3d'radio']"));h=a.closest(".shipment").data("orderid");
a&&a.length&&a.hasClass("valid-btn")&&a.closest(".prime-calendar").hasClass("long-calendar")&&(h=a.closest(".prime-calendar").data("orderid"));var k="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";if(f&&f.extraData)for(var m in f.extraData)f.extraData.hasOwnProperty(m)&&(k+="\x26"+m+"\x3d"+f.extraData[m]);var p=C(".shipment"),r=0;m=p.length;p=D(p);k+="\x26groupsadded\x3d"+(p.length-m);p.each(function(b,e){e=C(e);b="";var f=e.has(".prime-calendar-container"),
g=e.find("input[name\x3d'currentshippingspeed']").attr("value"),l=e.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===p.length&&(k+="\x26oldoption\x3d"+g+"."+l);g=e.find("input[name\x3d'defaultshipsplitpreference."+r+"']").attr("value");l=e.find("input[name\x3d'usingprimeshipping."+r+"']").attr("value");g&&l&&(k+="\x26defaultshipsplitpreference."+r+"\x3d"+g,k+="\x26usingprimeshipping."+r+"\x3d"+l);g=e.find(".shipping-speed");g=a?g.find('input[type\x3d"radio"]:checked'):g.find("input[src*\x3dradio-on]");
f&&!g.length&&(g=e.find("input[name\x3d'hiddenSelection"+r+"']"));l=e.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==l.length&&(l=e.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));h===e.data("orderid")&&(z(a,"shippingofferingid")?g=a:l=a,1===p.length&&(b=f?b+("\x26option\x3d"+g.data("key")+"."+(l?l.attr("value"):"")):b+("\x26option\x3d"+g.attr("value")+"."+(l?l.attr("value"):""))));var m=e.find("input[name\x3d'lineitemids"+r+"']");
0<m.length&&(b+="\x26lineitemids"+r+"\x3d"+m.attr("value"));b+=V(e,r);if(g.length)if(b+=L(g,l,r,f),1===z(g,"isscheduleddelivery")){e=g.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]');if(c&&d&&(c===e.attr("id")||void 0===c))for(var u in d)d.hasOwnProperty(u)&&(b+="\x26"+u+"."+r+"\x3d"+d[u]);else b+="\x26"+e.children(":input").serialize();W=!0}else 1===z(g,"isscheduleddeliveryslot")&&z(g,"sddatastring")&&(b+="\x26ScheduledDeliveryEntity.data."+r+"\x3d"+encodeURIComponent(g.data("sddatastring")));
else b+="\x26isdigital"+r+"\x3d1";r++;k+=b});0<r&&(k+="\x26groupcount\x3d"+r);m="ox_spc_set_ship_option";if(b.isSPP()){m="chk_revieworder_set_ship_option";var u=C("#setOrderingPrefsCheckbox");u.length&&u.is(":checked")&&(k+="\x26saveAsDefaultsSelected\x3d1")}u=C("input[name\x3duseCtb]").val();k+="\x26isClientTimeBased\x3d"+u;1===z(a,"istrial")?(g=t()+":"+a.attr("name")+":"+a.attr("value"),k+="\x26trialkey\x3d"+g,X[g]&&(O&&clearTimeout(O),m="ox_spc_set_cached_ship_option",b.isSPP()&&(m="chk_revieworder_set_cached_ship_option"),
k=k.replace("returnFullHTML\x3d1","returnFullHTML\x3d0"),k+="\x26trialSuccess\x3d1")):"undefined"!==typeof g&&(g=g+":"+a.attr("name")+":"+a.attr("value"),k+="\x26trialkey\x3d"+g);f&&f.refTag&&(m=f.refTag);f&&f.removeGiftOption&&(k+="\x26giftOrderid\x3d"+a.closest(".shipment").data("orderid"));0===k.indexOf("\x26")&&(k=k.substr(1));f="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+m;g=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});e.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<
C(".mobile-view").length&&(g=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));C.ajax({type:"POST",url:f,data:k,dataType:"text",async:!0,cache:!1,headers:g,success:function(a,b,c){v(a,b,c)},error:function(a,c,d){Y=!1;b.ajaxRedirect(a,c,d)}})}function L(a,b,c,d,e){var f="";"undefined"!==typeof e&&(c+="-"+e);if(z(a,"rcxsspdecoupling"))return f={},f["shippingspeed"+c]=d?a.attr("key"):a.attr("value"),f["shippingofferingid"+c]=z(a,"shippingofferingid"),f["guaranteetype"+
c]=z(a,"guaranteetype"),f["issss"+c]=z(a,"issss"),f["forceshipsplitpreference"+c]=z(a,"forceshipsplitpreference"),d="shipWhenComplete",b&&(d=b.attr("value")),1===z(a,"isscheduleddelivery")&&(f["isscheduleddelivery"+c]="1",d="shipWhenComplete"),f["shippriority"+c]=d,f["preferredSSP"+c]=z(a,"shipsplitpriority"),f["currentSSP"+c]=b.attr("value"),f["isShipWheneverValid"+c]=z(a,"isshipwhenevervalid"),f["isShipWhenCompleteValid"+c]=z(a,"isshipwhencompletevalid"),f=C.param(f),"\x26"+f;f=d?f+("\x26shippingspeed"+
c+"\x3d"+a.data("key")):f+("\x26shippingspeed"+c+"\x3d"+a.attr("value"));f+="\x26shippingofferingid"+c+"\x3d"+z(a,"shippingofferingid");f+="\x26guaranteetype"+c+"\x3d"+z(a,"guaranteetype");f+="\x26issss"+c+"\x3d"+z(a,"issss");f+="\x26forceshipsplitpreference"+c+"\x3d"+z(a,"forceshipsplitpreference");d="shipWhenComplete";b&&(d=b.attr("value"));1===z(a,"isscheduleddelivery")&&(f+="\x26isscheduleddelivery"+c+"\x3d1",d="shipWhenComplete");return f+("\x26shippriority"+c+"\x3d"+d)}function P(a){var b=[a.closest(".shipment").data("orderid")];
M(a,b)}function G(a){var b=[];C("#spc-orders").find(".shipment").each(function(a,c){b.push(a)});e.isFTCMobileUpsellBannerMetricsEnabled()&&d.increaseCount("checkout:spc:mobile:same-day-upsell-banner:clicked",1);M(a,b)}function M(a,c){l.show();var d="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1",e="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+a.data("reftag");C("#spc-orders").find(".shipment").each(function(b,e){d+="\x26lineitemids"+
b+"\x3d"+C(e).find("input[type\x3d'hidden'][name\x3d'lineitemids"+b+"']").attr("value");d+=V(C(e),b);var f=C(e).find("input[type\x3d'hidden'][name^\x3d'shippriority']");if(e=-1===c.indexOf(b)?C(e).find("#selected-ship-option-"+b):a)d+="\x26shippingofferingid"+b+"\x3d"+e.data("shippingofferingid"),d+="\x26guaranteetype"+b+"\x3d"+e.data("guaranteetype"),d+="\x26issss"+b+"\x3d"+e.data("issss"),d+="\x26forceshipsplitpreference"+b+"\x3d"+e.data("forceshipsplitpreference"),d+="\x26shippriority"+b+"\x3d"+
e.data("targetshipoptionkey"),e.data("rcxsspdecoupling")&&(d+="\x26preferredSSP"+b+"\x3d"+e.data("shipsplitpriority"),d+="\x26currentSSP"+b+"\x3d"+f.attr("value"),d+="\x26isShipWheneverValid"+b+"\x3d"+e.data("isshipwhenevervalid"),d+="\x26isShipWhenCompleteValid"+b+"\x3d"+e.data("isshipwhencompletevalid"))});var f=C("#spc-orders").find("input[type\x3d'hidden'][name\x3d'groupcount']").val(),d=d+("\x26groupcount\x3d"+f),d=d+("\x26isClientTimeBased\x3d"+C("input[type\x3d'hidden'][name\x3d'useCtb']").attr("value")),
d=d+("\x26trialkey\x3d"+t()+":"+a.data("orderindex")+":"+a.data("targetshipoptionkey")),f=b.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});C.ajax({type:"POST",url:e,data:d,dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){v(a,b,c)},error:function(a,c,d){Y=!1;b.ajaxRedirect(a,c,d)}})}function Q(b,c,d,e){f.protectAgainstDoubleAction(c)||ba||(a.trigger(d,b),b=b.$currentTarget.find("a"),e&&e(b))}function V(a,b){var c=a.find("input[name\x3d'onOrAfterAppointment"+b+"']").val();
a=a.find("input[name\x3d'onOrAfterLineItemId"+b+"']").val();var d="";c&&a&&(d=d+("\x26onOrAfterAppointment"+b+"\x3d"+c)+("\x26onOrAfterLineItemId"+b+"\x3d"+a));return d}function E(){ca.closest("div.shipping-speed").find('input[type\x3d"radio"]').attr("checked",!0);"undefined"!==typeof c?c.get(C("#faster-than-same-day-spc-popover")).hide():a.$("div.a-popover button.a-button-close").trigger("click");F(ca,null,null,{removeGiftOption:!0})}var C=a.$;if(!C("html").hasClass("a-ie6")){var W=!1,aa,Y=!1,X=
{},da=C("html").hasClass("a-touch"),O,Z={},w,ca;n.spcpage.scheduledDeliverySetSOCallback=function(c,d){b.isSPP()&&a.objectIsEmpty(c)||(n.spcpage&&C("#spcpagecontent").is(":visible")?n.spcpage.actionSetShipOptions(null,d,c):F(null,d,c))};n.spcpage.scheduledDeliveryEnableSOCallback=function(){};C(document).delegate(".ship-option","click",function(a){var b=C(a.target);e.isSPCMobileDisplayMoreShipOptionsEnabled()&&C(a.target).closest(".ship-option").hasClass("mobile-view")&&a.preventDefault();var g=C(a.currentTarget);
d.resetMetrics();if(!(b.is('a[target\x3d"AmazonHelp"]')||b.is('a[target\x3d"PromoDetails"]')||e.isNoShipOptionSelectionChangeIndicatorEnabled()&&b.hasClass("no-ship-option-selection-change")||g.is("input")||b.hasClass("a-button")||b.closest("a-button").length||b.is("img")&&(b.closest("div").is(".prime-ship-speed")||b.closest(".prime-fake-radio").parent().is(".prime-ship-speed"))))if(b=g.find("div.prime-ship-speed"),0<b.length)b.find("a:first img").trigger("click");else if((b=g.find("input[type\x3d'image']").attr("src"))&&
b.match(/radio-off/)&&C(".ap_popover_sprited").hide(),g=g.find("input[type\x3d'radio']"),(b=g.closest("div.shipping-speeds").data("sospargs"))&&1===g.data("isscheduleddelivery")&&!g.is(":checked"))l.show(),g.attr("checked",!0),J(g),f.redirectWithJavascript("/gp/buy/shipoptionselect/handlers/display.html?"+b);else if(e.removesGiftOptionOnRush()&&0<g.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1==g.data("nosupportforgiftoption"))ca=g,ca.is(":checked")&&(ca.attr("checked",!1),w.attr("checked",
!0)),"undefined"!==typeof c?c.get(C("#faster-than-same-day-spc-popover")).show():setTimeout(function(){C("#faster-than-same-day-spc-popover").trigger("click")},10);else{g.hasClass("js-no-serverside-callback")&&(g.attr("checked",!0),J(g),g.closest(".a-section-expander-container").find(".a-link-section-expander").click());var b=C("#disableSubmitButtons").length,h=!1;e.isSPCMobileDisplayMoreShipOptionsEnabled()&&(a=C(a.currentTarget).closest(".ship-option"),a.hasClass("mobile-view")&&!a.hasClass("mobile-selected-option")&&
(h=!0));!b&&g.is(":checked")&&!h||1===g.data("isscheduleddelivery")||(g.attr("checked",!0),F(g))}});C(document).delegate(".ship-option input[type\x3d'radio']","change",function(a){if(!e.isSPCMobileDisplayMoreShipOptionsEnabled()||!C(a.target).closest(".ship-option").hasClass("mobile-view")){a=C(a.currentTarget);var b=a.closest("div.prime-ship-speed");e.removesGiftOptionOnRush()&&0<a.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1==a.data("nosupportforgiftoption")||(0<b.length?b.find('input[type\x3d"radio"]').attr("checked",
!1):1!==a.data("isscheduleddelivery")&&F(a))}});a.declarative("shipping-speed-expander-toggle",["click"],function(a){var b=a.$target.closest(".a-box"),c,d;b.hasClass("a-single")?(c=b.find(".expanded-header-content"),d=b.find(".collapsed-header-content"),d.hide(),c.hasClass("prime-title")&&c.find("div").attr("style",""),c.show()):(d=b.find(".collapsed-header-content"),c=b.find(".expanded-header-content"),b=b.siblings(".a-expander-content").find(".a-icon-touch-radio-active").siblings(".a-radio-label").html(),
d.html(b),c.hide(),d.show());f.toggleExpanderContent(a)});a.declarative("select-prime-slot",["click"],function(a){a=a.$currentTarget;C(".a-button-close").trigger("click");a.closest(".valid-slot").hasClass("selected-slot")||F(a)});var ba=!1;C(document).delegate(".mobile-upsell","touchmove",function(a){ba=!0});C(document).delegate(".mobile-upsell","touchstart",function(a){ba=!1});a.declarative("select-upsell-shipping-speed",["click","touchend"],function(a){Q(a,"select-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select",
P)});a.declarative("select-all-upsell-shipping-speed",["click","touchend"],function(a){Q(a,"select-all-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select-all",G)});a.declarative("faster-than-same-day-save",["click","submit"],E);a.on("checkout:reload:spc",m);a.on("checkout:reload:spp-revieworder",m)}});"use strict";q.when("A","page-detector","spc-page-state","client-side-metrics","page-conductor").register("order-summary-controller",function(a,l,k,b,f){function g(){q=c("#transactionalRadio");
u=c("#marketplaceRadio");c("#tfx-see-exchange-rates");p=c("#tfx-switch-currency-options");m||(b.increaseCount("removeauijs15"),c("#transactionalRadioImage").remove(),c("#marketplaceRadioImage").remove(),c("#acceptAccImage").remove());var a=c("#exchange-rate-link"),d=c("#switch-currency-link");if(0!==u.length){var e=p.find('input[name\x3d"switchCurrency"]'),f=e.not(":checked"),e=k.prop("currencyType")||e.filter(":checked").val();f.val()===e?f.parent().trigger("click"):h(e);m||(b.increaseCount("removeauijs16"),
a.find("i.a-icon-collapse").remove(),d.find("i.a-icon-collapse").remove())}}function h(d){c(".tfx-currency").each(function(){c(this).text(c(this).data(d))});k.prop("currencyType",d);var e=c("#subtotals-marketplace-table"),g=c("#subtotals-transactional-table"),h=c("#subtotals-marketplace-spp-bottom"),p=c("#subtotals-transactional-spp-bottom"),n=c("#vatRetailSubtotals-transactional-table"),y=c("#vatGlobalSubtotals-transactional-table"),J=c("#vatMerchantSubtotals-transactional-table"),D=c("#vatRetailSubtotals-marketplace-table"),
F=c("#vatGlobalSubtotals-marketplace-table"),L=c("#vatMerchantSubtotals-marketplace-table"),P=c(".place-your-order-button"),G=f.isSPP()?c(".place-order-button-text"):c(".place-your-order-button + span");f.isSPP()||setTimeout(function(){var a=Math.max(e.outerHeight(),g.outerHeight());0<a&&(e.height(a),g.height(a))},500);if(!m){b.increaseCount("removeauijs17");var M=u.siblings("i"),Q=q.siblings("i");if(M.hasClass("a-icon-touch-radio-inactive")||M.hasClass("a-icon-touch-radio-active"))"marketplace"===
d?(M.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),Q.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive")):(Q.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),M.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"))}"marketplace"===d?(c("#fxGoodNews-transactional").hide(),c("#fxGoodNews-marketplace").show(),g.hide(),e.show(),p.hide(),h.show(),n.hide(),y.hide(),J.hide(),D.show(),
F.show(),L.show(),P.val(c("#placeYourOrderTextMarketplace").val()),m&&G.text(c("#placeYourOrderTextMarketplace").val()),c("#currencyChanged").attr("value","true"),c("#fxCurrencyChoice").attr("value","marketplace"),c("#tfx-total-header").addClass("aok-hidden"),c("#mkt-total-header").removeClass("aok-hidden")):(c("#fxGoodNews-transactional").show(),c("#fxGoodNews-marketplace").hide(),e.hide(),g.show(),h.hide(),p.show(),D.hide(),F.hide(),L.hide(),n.show(),y.show(),J.show(),P.val(c("#placeYourOrderTextTransactional").val()),
m&&G.text(c("#placeYourOrderTextTransactional").val()),c("#currencyChanged").attr("value","false"),c("#fxCurrencyChoice").attr("value","transactional"),c("#mkt-total-header").addClass("aok-hidden"),c("#tfx-total-header").removeClass("aok-hidden"));a.trigger("checkout:spc:ordersummary:sizeChanged");l.isMobileSpc()&&(h=c("#vatBreakdownNote"),0<h.size()&&(p=h.attr("href"),p=0<p.lastIndexOf(".html?")?p+("\x26currencyType\x3d"+d):p+("?currencyType\x3d"+d),h.attr("href",p)))}function d(a){var d=c("#tfx-footer"),
f=c("#tfx-header");if(!m){b.increaseCount("removeauijs18");var g=c("#fxApplicabilityDecision").siblings("i"),k=c("#fxApplicabilityAdoption").siblings("i");if(k.hasClass("a-icon-touch-checkbox-inactive")||k.hasClass("a-icon-touch-checkbox-active"))k.removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),g.removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active")}"accept"===a?(e()?(c("#fx-terms-and-conditions").show(),c("#fxCardCurrencySubcondition").hide()):
(c("#fx-enable").show(),c("#fx-disable").hide()),c("#fxApplicabilityDecision").prop("checked",!0),f.show(),h("transactional"),d.show(),c("#marketplaceRadio").prop("checked",!1),c("#transactionalRadio").prop("checked",!0),c("#fxApplicabilityChoice").attr("value","accept")):(e()?(c("#fx-terms-and-conditions").hide(),c("#fxCardCurrencySubcondition").show()):(c("#fx-enable").hide(),c("#fx-disable").show()),c("#fxApplicabilityAdoption").prop("checked",!1),f.hide(),h("marketplace"),d.hide(),c("#transactionalRadio").prop("checked",
!1),c("#marketplaceRadio").prop("checked",!0),c("#fxApplicabilityChoice").attr("value","decline"))}function e(){return f.isSPP()&&c("input[name\x3disNewTFXExperienceEnabled]").length}var c=a.$;if(!c("html").hasClass("a-ie6")){var m=n.P&&n.P.AUI_BUILD_DATE,p,q,u;c(document).delegate("#checkoutCurrencyTransactional","click",function(){h("transactional")});c(document).delegate("#checkoutCurrencyMarketplace","click",function(){h("marketplace")});c(document).delegate("#fxApplicabilityDecisionCheckbox",
"click",function(){d("decline")});c(document).delegate("#fxApplicabilityAdoptionCheckbox","click",function(){var a=e()&&!c("#fxApplicabilityAdoption").is(":checked");d(a?"decline":"accept")});a.on("a:expander:tfx-options-expander:toggle:expand",function(a){b.increaseCount("checkout:spp-ordersummary:expand_tfx_options",1)});a.on("a:expander:tfx-see-rate-expander:toggle:expand",function(a){b.increaseCount("checkout:spp-ordersummary:expand_tfx_see_rate",1)});return{changeCurrency:h,initOrderSummary:g}}});
"use strict";q.when("A","ready").register("spc-page-state",function(a){var l={};return{prop:function(a,b){if(a&&"string"===typeof a)return 1<arguments.length&&(l[a]=b),l[a]}}});"use strict";q.when("A","ready").execute(function(a){function l(){0<k("#spcCachedPromiseData").length&&(b=(new Date).getTime(),k(".place-your-order-button").click(function(){var a=(new Date).getTime()-b;k("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'spcWaitingTime' value\x3d'"+a+"' /\x3e")}))}var k=a.$,b=0;a.on("checkout:reload:spc",
l);a.on("checkout:reload:spclite",l);a.on("checkout:reload:spp-revieworder",l)});"use strict";q.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor","checkout-general-utils","ready").register("changeCustomerDetailsPopover",function(a,l,k,b,f,g){function h(){return 0<c("#onblur-character-validation-error-changeNameInput").size()}function d(){m&&m.find("button[data-action\x3da-popover-close]").trigger("click")}function e(){var a=c("#saveButton");if(a.length){var b=
c("#changeNameInput"),d=c("#changePostNumberInput"),e=c("#changePhoneInput"),f=1,g=1,k=1;b.length&&!b.val()&&(f=0);d.length&&!d.val()&&(g=0);e.length&&!e.val()&&(k=0);f&&g&&k&&!h()?(a.removeClass("a-button-disabled"),a.removeAttr("disabled")):(a.addClass("a-button-disabled"),a.attr("disabled","true"))}}var c=a.$,m;a.declarative("clickedsave","click submit",function(a){if(!h()){var b=c("#changeNameInput").val(),e=c("#changePhoneInput").val(),g=c("#changePostNumberInput").val(),k=c("#changeAccountNameCheckBox").is(":checked")?
1:0,m=c("#changePostNumberCheckBox").is(":checked")?1:0,b="custName\x3d"+encodeURIComponent(b)+"\x26changeAccountName\x3d"+encodeURIComponent(k);e&&(b=b+"\x26custPhoneNumber\x3d"+encodeURIComponent(e));g&&(b=b+"\x26dhlPostNumber\x3d"+encodeURIComponent(g),m&&(b=b+"\x26changeDhlPostNumberInEmbu\x3d"+encodeURIComponent(m)));e=a.data.changeDetailUrl;f.isSPP()&&(e=a.$target.data("changedetailurl"),c("#cancelReminderPopover").click());f.isSPP()||(b+="\x26usePipelineDispatch\x3d1");l.show();e&&c.ajax({type:"POST",
data:b,url:e,dataType:"html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:f.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,b,c){d();l.hide();f.ajaxUpdatePage(a,b,c)},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.declarative("clickedsave","mouseenter mousemove touchstart",function(a){e()});a.declarative("changeNameKeyIn changePostNumberKeyIn changePhoneNumberKeyIn","keydown keyup change keypress mouseenter mouseleave mousemove",
function(a){e()});a.declarative("clickedcancel","click submit",function(a){d()});a.on("a:popover:beforeShow:changeDetailPopover",function(a){h()&&c("#onblur-character-validation-error-changeNameInput").remove()});a.on("a:popover:show:changeDetailPopover",function(a){if(!f.isSPP()){var b=c(n).width(),d=c(n).height(),b=parseInt(.6*b,10),d=parseInt(.7*d,10);m=a.popover.$popover;var g=a.popover;m.css("position","absolute");m.css("top","50px");m.css("height",d+"px");m.css("width",b+"px");g.updatePosition()}b=
f.isSPP()?a.popover.originalnamevalue:a.popover.$trigger.data("original-name-value");d=f.isSPP()?a.popover.originalcellphonevalue:a.popover.$trigger.data("original-cellphone-value");a=f.isSPP()?a.popover.originalpostnumbervalue:a.popover.$trigger.data("original-postnumber-value");var g=c("#changeNameInput"),h=c("#changePhoneInput"),k=c("#changePostNumberInput");g.val(b);h.val(d);k.val(a);e()})});"use strict";q.when("A","page-transition-controller","ajax-utility","page-conductor","page-detector","checkout-general-utils").register("prime-decline-controller",
function(a,l,k,b,f,g){function h(){e("input[name\x3d'changeCardNoEndDatePrime']").attr("data-action","prime-decline-element")}function d(a,d,e){if(e.getResponseHeader("x-amz-checkout-page"))b.ajaxUpdatePage(a,d,e);else{a=k.jsonify(a);if(!a)return b.redirect();a.error?l.hide():a.errors?l.hide():a.autohandlererror?(d=(a=a.autohandlererror)?a.action:null,e=a&&a.type?a.type:d&&d.code?d.code:"string"===typeof a?a:"Unknown:pipelineJSError",n.location.href="fatal"===d?"/gp/buy/payselect/handlers/error.html?errorAction\x3dfatal\x26errorType\x3d"+
encodeURIComponent(e):"redirect"===d?a.url:"/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(e)):b.redirect(a)}}var e=a.$;e("html").hasClass("a-ie6")||(a.declarative("prime-decline-element",["click","touchend"],function(a){g.protectAgainstDoubleAction("prime-decline-element")||(a.$event.preventDefault(),l.show(),a=(new Date).getTime(),a="changeCardNoEndDatePrime\x3d1\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26fromAnywhere\x3d"+e("input[name\x3dfromAnywhere]").val()+
"\x26cachebuster\x3d"+a,e.ajax({type:"POST",url:"/gp/buy/spc/handlers/stuff-handler.html/ref\x3dox_spc_prime_renew_nodate",data:a,headers:{"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:d,error:b.ajaxRedirect}))}),a.on("checkout:reload:spc",h),a.on("checkout:reload:spp-revieworder",h))});"use strict";q.when("A","loading-spinner-controller","page-conductor").register("prime-popover-controller",
function(a,l,k){function b(){g={};a.defer(function(){0!==f("#spc-orders").find(".prime-popover-link").length&&(f("#spc-orders").find(".prime-popover-link").each(function(){var a=f(this);if(a.data("action")){a.removeAttr("href").attr("tabindex",0);var b=a.data("aCheckoutModalPopover");var e=b.name,c="";b.width&&b.height&&(c="width:"+b.width+"px;height:"+b.height+"px;");0<f("#spc-orders").find("#"+e+"-popover").length||(b=f(['\x3cdiv id\x3d"a-popover-'+e+'" class\x3d"a-popover-preload" style\x3d"display:none;"\x3e',
'\x3cdiv id\x3d"'+e+'-popover" class\x3d"checkout" style\x3d"'+c+'"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join("")),f("#spc-orders").append(b));a=a.data("aCheckoutModalPopover").name;g[a]||(b=f(".prime-popover-content").html())&&0<b.length&&(g[a]=b,f("#"+a+"-popover").html(b))}}),f("#spc-orders").find(".a-box").each(function(){var a=f(this),b=a.find(".prime-ad-banner-content .prime-popover-link");1<b.length&&(b=b.first());a.find("a.primeAdLauncher").each(function(){var a=f(this);a.wrap('\x3cspan class\x3d"a-declarative" data-action\x3d"prime-event" data-prime-event\x3d\'{"metric":"lm3"}\'\x3e\x3c/span\x3e');
a.replaceWith(b.clone().text(a.text()).addClass("a-size-mini"))})}))})}var f=a.$;if(!f("html").hasClass("a-ie6")){var g={};a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("prime")&&(a=a.popover.name,!g[a])){var b=f("input#primePopopverFallbackContent").val()||"";g[a]=b;f("#"+a+"-popover").html(b)}});a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b)}});"use strict";q.when("A","page-transition-controller","back-button-protection","page-conductor",
"continue-wrapper-selector","weblab-helper").register("place-order-controller",function(a,l,k,b,f,g){function h(){if(!b.isAnimating()){var c=e("#spc-form");if("0"===e("#showPageTransition").attr("content")){if(0<e("#enableAlternatePYOBlocker").length){var d;d=f.SELECTOR?e(f.SELECTOR):c.find(".a-button.continue-button");if("disabled"===d.find("input").attr("disabled"))return;d.find("input").attr("disabled","disabled");d.addClass("a-button-disabled");setTimeout(function(){d.removeClass("a-button-disabled");
d.find("input").removeAttr("disabled")},4E4)}}else l.showPageTransition();var h=e("#currencyChanged");0<h.length&&"true"===h.val()&&(h='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+e("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',e("#spc-form-inputs").append(h));if(g.isMfaPSD2DeviceDescriptionCollectionEnabled())for(var h=[{name:"javaEnabled",value:n&&n.navigator&&n.navigator.javaEnabled()},{name:"language",value:n&&n.navigator&&n.navigator.language},
{name:"screenColorDepth",value:n&&n.screen&&n.screen.colorDepth},{name:"screenHeight",value:n&&n.screen&&n.screen.height},{name:"screenWidth",value:n&&n.screen&&n.screen.width},{name:"timeZone",value:(new Date).getTimezoneOffset()}],q=0;q<h.length;q++)if(void 0!==h[q].name&&void 0!==h[q].value){var u='\x3cinput type\x3d"hidden" name\x3d"'+h[q].name+'" value\x3d"'+h[q].value+'" /\x3e';e("#spc-form-inputs").append(u)}c.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");
(h=a.state("firetv-aws-attributes"))&&h.queryParams&&(q=c.attr("action"),q+=0<=q.indexOf("?")?"\x26":"?",q+=e.param(h.queryParams),c.attr("action",q));b.isSPP()&&c.append(e("#subtotalsSection").find("input").hide());k.markAsDirty();c.submit()}}function d(a){a.preventDefault();h(a.target)}var e=a.$;if(!e("html").hasClass("a-ie6"))return a.declarative("a-checkout-place-order",["click"],function(a){h(a.target)}),e(document).delegate("span.place-order-button-link","click",d),{placeOrderClick:h,placeOrderClickDelegate:d,
PLACE_ORDER_BUTTON_LINK_SELECTOR:"span.place-order-button-link"}});"use strict";q.register("continue-wrapper-selector",function(){return{SELECTOR:null}});"use strict";q.when("A","page-conductor","a-tooltip","button-blocker","client-side-metrics","weblab-helper").register("verification-checkbox-controller",function(a,l,k,b,f,g){function h(a){a.blocking?b.show("place-order-imb-checks",a.message):(b.hide("place-order-imb-checks"),c("#hasTVNavigation").length&&q.when("a-tv").execute(function(a){a.select(".continue-button")}))}
function d(){var b,d={blocking:!1,message:""};if(B)b=c("#spc-imb").find(".verification-checkbox input:not(:checked)"),0<b.length&&(d={blocking:!0,message:b.first().closest(".verification-checkbox").attr("data-blocker-message")});else{f.increaseCount("removeauijs23");if(!c("#spc-imb").find(".verification-checkbox").length)return;b=l.isSPP()?c("#spc-imb").find(".verification-checkbox input:not(:checked)"):c("#spc-imb").find(".verification-checkbox:not(:checked)");0<b.length&&(d={blocking:!0,message:l.isSPP()?
b.first().closest(".spp-panel").hasClass("aok-hidden")?b.first().closest(".verification-checkbox").data("non-review-panel-blocker-msg"):b.first().closest(".verification-checkbox").data("blocker-message"):b.first().attr("data-blocker-message")})}a.trigger("checkbox:primaryActionBlocker:blockingStateChanged",d)}function e(){var a=c("#wineNoticeCheckbox");a&&a.length&&(m?(a.attr("checked",""),p&&(a=a.siblings(".a-icon-touch-checkbox-inactive"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-inactive"),
a.addClass("a-icon-touch-checkbox-active"))):(a.removeAttr("checked",""),p&&(a=a.siblings(".a-icon-touch-checkbox-active"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-active"),a.addClass("a-icon-touch-checkbox-inactive"))));d();g.isAddSpcPyoCFMarkerEnabled()&&f.setmarker("cf");f.markWithinAnalysisScope("cf");a=n.P&&n.P.AUI_BUILD_DATE?'.verification-checkbox input[type\x3d"checkbox"]':"input.verification-checkbox";c("#spc-imb").find(a).unbind("change.verification-checkbox").bind("change.verification-checkbox",
d)}var c=a.$,m,p=c("html").hasClass("a-touch"),B=!l.isSPP()&&n.P&&n.P.AUI_BUILD_DATE;if(!c("html").hasClass("a-ie6"))return a.on("checkbox:primaryActionBlocker:blockingStateChanged",function(a){if(B){var b=c(".continue-button"),d=c(".continue-button-blocker"),e=c(".place-order-blocker-message.custom-blocker-message"),f;(f=a.blocking)||(f=c("input[name\x3disINExpressCheckoutCC]"),f=!(f&&f.length&&1===parseInt(f.val(),10)));f&&(a.blocking?(e.text(a.message),b.addClass("aok-hidden"),d.removeClass("aok-hidden")):
(e.empty(),b.removeClass("aok-hidden"),d.addClass("aok-hidden"),(a=k.get(d))&&a.isActive()&&a.hide()))}else h(a)}),a.declarative("change-wine-notice-checkbox",["change"],function(a){m=a.$target.is(":checked")?1:0}),a.on("checkout:reload:spc",e),a.on("checkout:reload:spclite",e),a.on("checkout:reload:spp-revieworder",e),a.on("checkout:reload:spp-collapsed",e),{verifyCheckboxes:d}});"use strict";q.when("A","page-transition-controller","scroll-controller","ajax-utility","page-conductor","quantity-service",
"checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("quantity-update-controller",function(a,l,k,b,f,g,h,d,e,c,m,p){function B(){aa=W=!1;a.defer(function(){var a=G("#spc-orders");a.find("a.quantity-change-button-static").remove();"1"!==G("#spc-form-inputs").find("input[name\x3d'isQuantityInvariant']").val()&&a.find("div.quantity-value-static").remove()});G(".lineitem").each(function(a,b){a=G(b);a.find(".no-js-quantity").remove();
b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))});var b=G("#pantry-mov-popover-content"),c=G("#pantry-mov-popover-placeholder");!b.length&&c.length&&(b=c.attr("data-device"),G.ajax({type:"GET",url:"/gp/pantry/checkout/mov/get-pantry-mov-popover-contents.html",data:"device\x3d"+b,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
success:function(a,b,d){~a.indexOf("pantry-mov-popover-content")?c.append(a):m.increaseCount("checkout:pantry:pantry_mov_popover_contents:bad-content",1)},error:function(a,b,c){m.increaseCount("checkout:pantry:pantry_mov_popover_contents:"+c,1)}}))}function u(a,b){a=G('.update-quantity-error[data-itemid\x3d"'+a+'"]');a.find(".error-message").hide();a.find('.error-message[data-error-type\x3d"'+b+'"]').show();a.find("i").show();a.find(".a-span12").show();a.show();b=a.closest(".item-details-right-column");
b.find(".spc-quantity-dropdown-button").addClass("a-button-error");b.find(".spc-quantity-input").addClass("a-form-error");b=a.parents("div.update-quantity-error");a=b.siblings(".item-details");0<a.length&&(a.find(".a-input-text-wrapper").addClass("a-form-error"),a.removeClass("a-spacing-large"),a.find(".a-touch-select").addClass("a-input-text a-form-error"));b.show()}function x(a,d,g){var h=g.getResponseHeader("x-amz-checkout-new-cart-quantity");e.updateCartByMash(h);if(g.getResponseHeader("x-amz-checkout-page"))f.ajaxUpdatePage(a,
d,g,{pushNewFrame:"false"}),a=g.getResponseHeader("x-amz-checkout-updated-itemid"),g=g.getResponseHeader("x-amz-checkout-quantity-error"),a&&g&&u(a,g);else if(a=b.jsonify(a))if(a&&a.errors&&a.errors.pantry&&a.errors.pantry.mov)r(a.errors.pantry.showAddonInfo);else{if(a&&a.errors&&a.errors.addon&&(f.isSPP()&&m.increaseCount("checkout:spp-revieworder:addon_warn_pri",1),g=a.errors.addon.type,d=a.errors.addon.asins,K(),G(".item-list").hide(),d.forEach(function(a){G('[data-asin\x3d"'+a+'"]').show()}),
g=G("#addon-warning-"+g+"-launcher"),g.length)){G("input[name\x3duseLiveAUI]").length?c.get(g).attrs({$trigger:Y}).show():X&&G("div.checkout.spc-mobile.aui-templatized").length?g.click():(m.increaseCount("removeauijs19"),a=G.Event("keyup",{triggerPositioningElement:Y,manualTrigger:!0}),g.trigger(a),0<G("div.spc-mobile").length&&(k.scrollToTop(),k.toggleScrollOff()));l.hide();return}return f.redirect(a)}else f.redirect()}function K(){G("#a-popover-addon-warning-normal .select-address-title").hide();
0<M?(G("#a-popover-addon-warning-normal .reduce-title").show(),G("#a-popover-addon-warning-normal .delete-title").hide()):(G("#a-popover-addon-warning-normal .delete-title").show(),G("#a-popover-addon-warning-normal .reduce-title").hide())}function r(a){var b=G("#pantry-mov-popover-launcher"),c=G(".pantry-mov-reduce-prompt"),d=G(".pantry-mov-delete-prompt"),e=G("#pantry-mov-addon-info-container");b.length?(P()||m.increaseCount("checkout:pantry:pantry_mov_popover:non_spc",1),e.length&&e.empty(),a&&
G("#addon-warning-normal-popover-content").length&&(K(),e.length||(e=G("\x3cdiv/\x3e",{id:"pantry-mov-addon-info-container"})),e.append('\x3chr class\x3d"a-divider-normal"\x3e').append(G("#addon-warning-normal-popover-content").html()).appendTo("#pantry-mov-popover-content")),0<M?(c.show(),d.hide()):(d.hide(),c.show()),b.length&&(b.click(),l.hide())):(m.increaseCount("checkout:pantry:pantry_mov_popover_contents:no-launcher",1),f.redirect())}function t(a,b){l.show();var c={isClientTimeBased:G('input[name\x3d"useCtb"]').val(),
fromAnywhere:G("input[name\x3dfromAnywhere]").val(),success:x};if(b)for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);f.isSPP()?(c.ref="chk_ship_chg_qty_pri",b=G("#setOrderingPrefsCheckbox"),b.length&&b.is(":checked")&&(c.saveAsDefaultsSelected=1)):G(".spc-mobile.aui-templatized").length&&(c.ref="ox_spc_change_quantity");b=G("#addon-indicator")&&"true"===G("#addon-indicator").attr("data-has-addon-items");d=G("#pantry-mov-indicator")&&"true"===G("#pantry-mov-indicator").attr("data-has-pantry-items");
a||!b&&!d||(c.istrial=1);g.call(V,M,c);E?E.data("currentQuantity",M):C&&C.data("currentQuantity",M)}function v(){l.hide();n.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function z(){var a=Q;M=Q;E&&q.when("a-dropdown").execute(function(b){E&&(b.getSelect(E).setValue(a.toString()),E.data("currentQuantity",M))});k.toggleScrollOn();if(C){C.val(a);C.data("currentQuantity",M);var b=C.closest(".quantity-block");b.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden");
b.find(".quantity-display").removeClass("hidden");b.find(".quantity-display-block-tablet").removeClass("hidden");b.find(".dynamic-quantity-update").hasClass("stay-visible")||b.find(".dynamic-quantity-update").addClass("hidden").children().addClass("hidden")}}function y(a,b){var c=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");V=c.data("entityId");M=0;E=null;Q=c.data("currentQuantity");Y=G("a.quantity-delete-button[data-entity-id\x3d'"+V+"']");Y.length||(Y=a.$currentTarget);C=
c.closest(".dynamic-quantity-update").find(".quantity-input");C.length||(C=null);c.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):(t(!1,b),h.hideById(c.closest(".a-popover").data("aPopoverId")))}function J(a){if(!e.protectAgainstDoubleAction("order-summary-update-quantity",200)){m.resetMetrics();var b=a.$currentTarget,c=b.closest(".lineitem"),d=b.find("select"),d=d.length?d:b;V=c.data("entityId");var f=G('.update-quantity-error[data-itemid\x3d"'+
V+'"]');C=E=null;d.is("select")?(E=b.find("select"),M=d.val()):(C=c.find(".quantity-input"),M=C.val());Q!==M&&(Y=d.is("select")?E.parent():C,""===M?L(c):"Delete"===M||0===parseInt(M,10)?(a.$event.preventDefault(),e.protectAgainstDoubleAction("delete-item")||D(a)):e.validateNumber(M,0,999)?(f.hide(),c.blur(),c.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):t(!1)):u(V,"changeQuantity_quantityNotInRange"))}}function D(a,b){var c=a.$currentTarget.closest(".lineitem");
V=c.data("entityId");M=0;c.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):(t(!1,b),h.hideById(c.closest(".a-popover").data("aPopoverId")))}function F(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),d=a.$currentTarget.find("input").data("currentQuantity");Q=d;-1===parseInt(c,10)||""===c?("change"===a.type&&
L(a.$currentTarget.closest(".lineitem")),b.hide()):parseInt(c,10)!==d?b.show():b.hide()}function L(a){a.find(".quantity-input").val(Q)}function P(){return f.isSPP()?G("#revieworder").hasClass("expanded")?!0:!1:0<G("div.spc").length?!0:!1}var G=a.$;if(!G("html").hasClass("a-ie6")){var M,Q,V,E,C,W=!1,aa=!1,Y,X=n.P&&n.P.AUI_BUILD_DATE;a.declarative("change-quantity",["click","touchend"],function(a){if(!e.protectAgainstDoubleAction("lock-update-quantity",200)){a=a.$currentTarget;var b=!0;a.addClass("hidden");
a=a.closest(".quantity-block");a.find(".change-quantity").addClass("hidden");a.find(".quantity-display").addClass("hidden");a.find(".quantity-display-block-tablet").addClass("hidden");a.find(".dynamic-quantity-update").removeClass("hidden").find(".hidden").each(function(){var a=G(this);a.removeClass("hidden");a.is("input")&&(a.focus(),a.select(),a.unbind("keydown.update-quantity-spc").bind("keydown.update-quantity-spc",function(a){13===a.which&&a.preventDefault()}),a.unbind("keyup.update-quantity-spc").bind("keyup.update-quantity-spc",
function(a){13!==a.which||b||G(a.target).closest(".dynamic-quantity-update").find(".update-quantity-button").trigger("click")}))});setTimeout(function(){b=!1},500)}});a.declarative("order-summary-get-quantity",["click","touchend"],function(a){e.protectAgainstDoubleAction("order-summary-get-quantity",200)||a.$currentTarget.find("select").length&&(Q=a.$currentTarget.find("select").val())});a.declarative("order-summary-update-quantity",["change"],J);a.declarative("order-summary-update-quantity-text-field",
["click","touchend"],J);a.declarative("order-summary-handle-text-input",["keydown"],function(a){13===a.$event.which?(a.$event.preventDefault(),J(a)):e.limitInputToNumbers(a)});a.declarative("order-summary-show-update-button",["change","keyup"],F);a.declarative("trigger-update-quantity-button",["keydown"],function(a){13===a.$event.which&&(a.$event.preventDefault(),a.$currentTarget.closest(".quantity-block").find(".update-quantity-button").trigger("click"))});a.declarative("toggle-update-quantity-button",
["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-block").find(".update-quantity-button"),c=a.$currentTarget.find("input"),d=c.val(),e=c.data("currentQuantity");""===d?("change"===a.type&&c.val(e),b.hide()):parseInt(d,10)!==e?b.show():b.hide()});a.declarative("update-quantity",["click","touchend"],function(a){m.resetMetrics();var b=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");a=b.closest(".quantity-block");var c=b.closest(".dynamic-quantity-update"),
d=c.find(".quantity-input");c.length||(d=a.find(".quantity-input"));if(e.protectAgainstDoubleAction("lock-update-quantity",200))d.focus();else{var f=d.val();V=b.data("entityId");var g=G('.update-quantity-error[data-itemid\x3d"'+V+'"]');e.validateNumber(f,0,999)?(g.hide(),c.find(".a-form-error").removeClass("a-form-error"),d.removeClass("a-form-error"),f=parseInt(f,10),C=d,Q=C.data("currentQuantity"),Q=parseInt(Q,10),f===Q?(a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),
a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),c.addClass("hidden").children().addClass("hidden")):(M=f,Y=b,b.blur(),b.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+b.data("bundleGroupId")).trigger("click")},100):t(!1))):u(V,"changeQuantity_quantityNotInRange")}});G(document).delegate(".spc-quantity-dropdown","change",function(a){E=G(a.currentTarget);m.resetMetrics();X?(a=E.next(),V=a.data("entityId"),Q=a.data("currentQuantity")):
(m.increaseCount("removeauijs21"),V=E.data("entityId"),Q=E.data("currentQuantity"));var b=E.find(":selected");M=parseInt(b.val(),10);Q!==M&&(a=G("#toggleDropdownQuantityTrigger"),a.length&&M===parseInt(a.val(),10)?(a=E.closest(".quantity-block"),a.find(".spc-quantity-dropdown-button").hide(),a.find(".quantity-input").show()):(Y=E.parent(),E.blur(),b&&b.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+b.data("bundleGroupId")).trigger("click")},100):t(!1)))});a.declarative("dont-delete-item",
["click","touchend"],function(a){a.$event.preventDefault();e.protectAgainstDoubleAction("dont-delete-item")||h.hideById(a.$currentTarget.closest(".a-popover").data("aPopoverId"))});a.declarative("delete-item",["click","touchend"],function(a){a.$event.preventDefault();e.protectAgainstDoubleAction("delete-item")||y(a)});a.declarative("delete-prime-membership-item-confirm",["click","touchend"],function(a){a.$event.preventDefault();if(!e.protectAgainstDoubleAction("delete-prime-membership-item-confirm")){var b=
{additionalData:{deletePrimeMembership:1,primeMembershipASIN:(a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a")).data("asin")}};y(a,b)}});a.declarative("bundle-delete",["click","touchend"],function(){e.protectAgainstDoubleAction("bundle-delete")||t(!1)});a.declarative("bundle-delete-action",["click","touchend"],function(a){e.protectAgainstDoubleAction("bundle-delete-action")||(q.when("a-popover-base").execute(function(b){b.get(a.data.popoverName).hide()}),t(!1))});a.declarative("egc-delete",
function(a){V=a.entityId;M=0;t(!0)});a.declarative("bundle-dont-delete",["click","touchend"],function(){e.protectAgainstDoubleAction("bundle-dont-delete")||(M=Q,E&&q.when("a-dropdown").execute(function(a){a.setValue(E.attr("id"),Q.toString());E.data("currentQuantity",M)}))});a.declarative("pantry-return-to-cart-btn",["click","touchend"],function(){e.protectAgainstDoubleAction("pantry-return-to-cart-btn")||P()&&v()});a.declarative("pantry-delete-items-btn",["click","touchend"],function(){!e.protectAgainstDoubleAction("pantry-delete-items-btn")&&
P()&&(aa=!0,G(".a-button-close").trigger("click"),t(!0))});a.declarative("pantry-cancel-delete-btn",["click","touchend"],function(){e.protectAgainstDoubleAction("pantry-cancel-delete-btn")||P()&&z()});a.on("a:popover:hide:pantry-mov-popover",function(){P()&&(aa||z())});a.declarative("addon-return-to-cart",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-return-to-cart")||P()&&v()});a.declarative("addon-delete-items",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-delete-items")||
(P()&&(W=!0,G(".a-button-close").trigger("click"),t(!0)),f.isSPP()&&m.increaseCount("checkout:spp-revieworder:addon_delete_pri",1))});a.declarative("addon-dont-delete",["click","touchend"],function(){e.protectAgainstDoubleAction("addon-dont-delete")||(P()&&z(),f.isSPP()&&m.increaseCount("checkout:spp-revieworder:addon_keep_pri",1))});a.on("a:popover:hide:addon-warning-normal",function(){0<G("div.spc-mobile").length?v():P()&&(W||z())});a.on("a:popover:hide:addon-warning-special",function(){P()&&(W||
z())});a.on("checkout:reload:spc",B);a.on("checkout:reload:spp-revieworder",B)}});q.when("A","ready").execute(function(a){a.on("a:popover:beforeShow",function(a){if(a.popover.$trigger.hasClass("quantity-dropdown-button")){var k=a.popover.$popover,b=k.closest("div.a-dropdown");b.length&&(a.popover.$iframe.css("max-height","260px"),k.css("max-height","260px"),k=b.find("div.a-popover-inner"),k.css({"max-height":"260px"}),a.popover.updatePosition(),k.css({"overflow-y":"scroll"}))}})});"use strict";q.when("A",
"page-transition-controller","page-conductor","ajax-utility").register("tax-exemption-controller",function(a,l,k,b){function f(a,e,c){return c.getResponseHeader("x-amz-checkout-page")?k.ajaxUpdatePage(a,e,c,{pushNewFrame:"false"}):(a=b.jsonify(a))?k.redirect(a):k.redirect()}function g(a,b){var c=b.$target.data("entityId");if(c){l.show();var g={isClientTimeBased:h('input[name\x3d"useCtb"]').val(),fromAnywhere:h("input[name\x3dfromAnywhere]").val()},g=g||{};b={returnFullHTML:1,cachebuster:(new Date).getTime(),
isClientTimeBased:0,hasWorkingJavascript:1};h.extend(b,g);b.entityId=c;b.optOut=a;a=k.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});h.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/tax-exemption-optout.html",data:h.param(b),dataType:"text",async:!0,cache:!1,headers:a,success:f,error:k.ajaxRedirect})}else n.ueLogError&&n.ueLogError({name:"MissingData",message:"lineItemId is undefined, when trying to opt out from tax exemption",logLevel:"FATAL"})}var h=a.$;h("html").hasClass("a-ie6")||(a.declarative("tax-exemption-opt-out",
["click","touchend"],function(a){g(!0,a)}),a.declarative("tax-exemption-opt-in",["click","touchend"],function(a){g(!1,a)}))});"use strict";q.when("A").execute(function(a){return{}});"use strict";q.when("A","page-transition-controller","page-conductor").register("sns-subscription-controller",function(a,l,k){function b(){var b=h(document);b.delegate(".sns-option","click",function(a){a=h(this);g(a.closest(".sns-upsell"),a)});b.delegate(".sns-option-mobile","click",function(a){var b=h(this);a.target.name&&
"snsSetCreateSubscription"===a.target.name&&g(b.closest(".sns-upsell-mobile"),b)});b.delegate(".sns-option-tablet","click",function(a){a=h(this);g(a.closest(".sns-upsell-tablet"),a)});b.delegate(".sns-upsell-nextdelivery","change",function(){f(h(this))});a.declarative("sns-upsell-nextdelivery-dropdown","change",function(a){f(h(a.$target))});b.delegate(".sns-upsell-learn-more","click",function(a){var b=h(this);a=b.width();var d=b.height(),f=b.position(),b=b.find(".sns-upsell-popover-learn-more");b.removeClass("aok-hidden");
var g=b.width();b.height();b.css({top:f.top+d,left:f.left-(g-a)/2,position:"absolute"})});b.delegate(".sns-upsell-learn-more-close","click",function(a){(a=h(this))&&a.closest(".sns-upsell-popover-learn-more")&&a.closest(".sns-upsell-popover-learn-more").addClass("aok-hidden");return!1})}function f(a){var b=a.closest(".sns-upsell,.sns-upsell-mobile,.sns-upsell-tablet");if(a.length&&b.length){var c=b.data("index"),f=b.find("span.sns-change-delivery-txt");f&&f.text(a.find("option:selected").data("date"));
f=a.find("option:selected").data("epoch");a=a.find("option:selected").val();b.find("input[type\x3d'hidden'][name\x3d'sns_nextDelivery"+c+"']").val(f);b.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+c+"']").val(a)}}function g(a,b){l.show();var c=a.data("index"),f=(new Date).getTime(),g=a.find("input[type\x3d'hidden'][name\x3d'sns_lineItemIdentifier"+c+"']").attr("value"),n=a.find("input[type\x3d'hidden'][name\x3d'sns_merchantId"+c+"']").attr("value"),q=a.find("input[type\x3d'hidden'][name\x3d'sns_asin"+
c+"']").attr("value");a=a.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+c+"']").attr("value");b=b.prop("checked")||b.find("[type\x3dcheckbox]").is(":checked");f={returnpipedata:0,returnFullHTML:1,cachebuster:f,hasWorkingJavascript:1};f.lineItemIdentifier=g;f.isONMLSelected=b?1:0;f.merchantId=n;f.asin=q;f.frequency=a;g=k.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});h.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-sns-options.html",data:h.param(f),dataType:"text",async:!0,cache:!1,
headers:g,success:function(a,b,c){return k.ajaxUpdatePage(a,b,c)},error:function(a,b,c){k.ajaxRedirect(a,b,c)}})}var h=a.$;h("html").hasClass("a-ie6")||b()});"use strict";q.when("A","page-detector","page-detector-current-page","page-conductor","page-transition-controller","ajax-utility","place-order-controller","client-side-metrics").execute(function(a,l,k,b,f,g,h,d){function e(a){"function"===typeof n.ues&&(n.ues("t0",a,new Date),n.ues("ctb",a,"1"));"function"===typeof n.uet&&n.uet("tc",a,{wb:1})}
function c(a,b){"function"===typeof n.ues&&n.ues("id",a,b)}function m(a,b){"function"===typeof n.uet&&n.uet(a,b,{wb:1})}function p(a){"function"===typeof n.uex&&n.uex("ld",a,{wb:1})}function q(a){n.ueLogError&&n.ueLogError({message:a},{logLevel:"WARN",attribution:"ajax-typ"})}function u(){var a=L("span#typ-load").attr("data-typ-args");n.location.href="https://"+n.location.hostname+"/gp/buy/thankyou/handlers/display.html?"+a}function x(){if(aa){var a=L("#typ-desktop-frame").contents(),b=aa;if(b.deliveryestimates)for(var c in b.deliveryestimates)if(b.deliveryestimates.hasOwnProperty(c)){var d=
a.find("span#"+c);d&&d.replaceWith(b.deliveryestimates[c])}b.autorip&&(a=a.find("#thank-you-rogue"))&&a.replaceWith(b.autorip)}}function K(){m("cf","ajax-typ:place-your-order");x();var a=L("#typ-desktop-frame").contents(),b="ThankYouCart",e=a.find("span#typ-rewrite-url");history&&history.pushState&&e&&0<e.length&&(history.pushState({},"",e.attr("data-url")),b=e.attr("data-view"));a=a.find("title").text();L("#checkoutDisplayPage").hide();L("#typ-desktop").show();document.title=a;f.hide();b=L("span#typ-load").attr("data-typ-args")+
"\x26viewId\x3d"+b;m("be","ajax-typ:place-your-order");d.setmarker&&(a=d.getscope(),X&&(b+="\x26requestID\x3d"+da,d.setscope("ajax-typ")),d.setmarker("cf"),X&&d.setscope(a));L.ajax({type:"POST",url:"/gp/buy/thankyou/handlers/log-data.html",data:b,dataType:"text",async:!0,cache:!1,complete:function(a,b){b=L("#typ-desktop-frame")[0].contentWindow;"function"===typeof b.updateCart&&b.updateCart();a.getResponseHeader("x-amz-checkout-requestid")&&(a=a.getResponseHeader("x-amz-checkout-requestid"),d.sendue&&
(b=d.getscope(),d.setscope("ajax-typ"),d.setrid(a),d.sendue("ld"),d.setscope(b)),c("ajax-typ:place-your-order",a),p("ajax-typ:place-your-order"))}});X||(d.sendUEPageLoadStats(),p("ajax-typ:place-your-order"))}function r(a,c,d){a&&a.conductoraction&&a.conductoraction.url?b.redirect(a):(m("af","ajax-typ:place-your-order"),aa=a,Q?K():G?V=1:(q("No TYP data available after place-order, redirecting to static TYP"),u()))}function t(){if(!w)if(Z&&clearTimeout(Z),3===O.readyState){var a;try{a=g.jsonify(O.responseText)}catch(c){a=
null}null!==a?(w=1,r(a)):Z=setTimeout(t,50)}else 4===O.readyState&&(w=1,200===O.status?(a=g.jsonify(O.responseText),null!==a?r(a):(q("No results from place-order, calling ajaxRedirect"),b.ajaxRedirect())):(q("Error calling place-order, calling ajaxRedirect"),b.ajaxRedirect()))}function v(){M=1;C&&clearTimeout(C);W&&clearTimeout(W);var a=L("#currencyChanged");0<a.length&&"true"===a.val()&&(a='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+L("#tfx-switch-currency-options").find("input:radio:checked").val()+
'" /\x3e',L("#spc-form-inputs").append(a));L("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a=(new Date).getTime()-ca;L("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'waitingTime' value\x3d'"+a+"' /\x3e");L("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'returnjson' value\x3d'1' /\x3e");ba&&L("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'isAsyncTYPEnabled' value\x3d'1' /\x3e");var a=L("#spc-form").serialize(),c=L("#typ-desktop-frame").contents().find("input#cached-promise-data");
0<c.length&&(a+="\x26cachedPromiseData\x3d"+c.val());if(Y){if(n.XMLHttpRequest)O=new XMLHttpRequest;else if(n.ActiveXObject)try{O=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(d){O=null}if(!O){q("Can't get XMLHttpRequest for data stream, calling standard placeOrderController");M=1;h.placeOrderClick();return}O.open("POST","/gp/buy/spc/handlers/place-your-decoupled-order.html",!0);O.setRequestHeader("Content-type","application/x-www-form-urlencoded");O.setRequestHeader("Content-length",a.length);O.setRequestHeader("Connection",
"close");O.onreadystatechange=t;O.overrideMimeType("text/plain");O.send(a)}else L.ajax({type:"POST",url:"/gp/buy/spc/handlers/place-your-decoupled-order.html",data:a,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return g.jsonify(a)},success:function(a,c,d){null!==a?r(a,c,d):(q("No results from place-order, calling ajaxRedirect"),b.ajaxRedirect())},error:function(a,c,d){q("Error calling place-order, calling ajaxRedirect");b.ajaxRedirect(a,c,d)}});"function"===typeof n.uet&&n.uet("bb","ajax-typ:place-your-order",
{wb:1})}function z(){Q=G=E=0;L("div#typ-desktop").empty()}function y(a,b,f){E||(E=1,clearTimeout(W),G=0,Q=1,P++,(a=L("#typ-desktop-frame").contents().find("span#typ-rewrite-url"))&&0<a.length&&(a=a.attr("data-requestid"),e("ajax-typ:place-your-order"),X?da=a:(d.setAsyncRequestId(a),c("ajax-typ:place-your-order",a))),V?K():!M&&5>P&&(C=setTimeout(function(){z();J()},12E4)))}function J(){if(!(M||G||5<=P)){G=1;var a=L("span#typ-load").attr("data-typ-args");W=setTimeout(function(){z();V&&(q("Timed out waiting for TYP fetch after place-order, redirecting to static TYP"),
u())},45E3);L("\x3ciframe /\x3e",{name:"typ-desktop-frame",id:"typ-desktop-frame",width:"100%",height:"100%",frameborder:"0",src:"/gp/buy/thankyou/handlers/display.html?"+a}).appendTo("div#typ-desktop").load(y)}}function D(){y()}function F(){l.isSpc()&&0<L("span#typ-load").length&&(ca=(new Date).getTime(),P=0,L("div#typ-desktop").length?z():L("body").append('\x3cdiv id\x3d"typ-desktop" style\x3d"position:absolute;left:0;right:0;bottom:0;top:0;display:none;"\x3e\x3c/div\x3e'),Y=L("span#typ-load").attr("data-early-json-flush")&&
!L("html").hasClass("a-lt-ie10"),ba=0<L("span#async-typ-enabled").length,X=L("span#typ-load").attr("data-use-cds-stub"),L(document).undelegate("span.place-order-button-link","click"),L(document).delegate("span.place-order-button-link","click",function(a){a.preventDefault();X?(a=d.getscope(),d.setscope("ajax-typ"),d.setctb(),d.resetue(),d.setmarker("tc"),d.setscope(a)):(d.resetMetrics(),d.setmarker("tc"));G||Q?(f.show(),v()):(M=1,h.placeOrderClick())}),J())}var L=a.$;if(!L("html").hasClass("a-ie6")){var P=
0,G=0,M=0,Q=0,V=0,E=0,C,W,aa,Y=0,X=0,da,O,Z,w=0,ca=0,ba=0;a.on("ajax-typ-cf",D);a.on("checkout:reload:spc",F);a.on("checkout:reload:spp-revieworder",F);a.on("checkout:reload:spclite",F)}});"use strict";q.when("A","client-side-metrics").register("trialSignPrefetchCommon",function(a,l){function k(){b()&&(m().val(0),l.increaseCount("TrialSign:js:activated"),f(),void 0!==q&&c(),q=a.interval(e,5E4),x=0)}function b(){return 0!==m().length&&0!==p("input[name\x3d'purchaseID']").length}function f(){void 0!==
n&&n.abort();n=a.ajax("/gp/buy/spc/handlers/trigger-trial-sign.html",{method:"post",params:{purchaseId:p("input[name\x3d'purchaseID']").val()},success:g,error:h,abort:d})}function g(a,b,c){m().val(a.signPurchaseTrialId);n=void 0;l.increaseCount("TrialSign:js:success")}function h(a,b,d){c();n=void 0;l.increaseCount("TrialSign:js:failed")}function d(){c();n=void 0;l.increaseCount("TrialSign:js:aborted")}function e(){x++;10<x?c():(l.increaseCount("TrialSign:js:retry"),l.increaseCount("TrialSign:js:retry:"+
x),f())}function c(){void 0!==q&&(clearInterval(q),q=void 0)}function m(){return p("input[name\x3d'trialSignId']")}var p=a.$,n,q,x=0;a.on("checkout:reload:spc",k);a.on("checkout:reload:spclite",k);a.on("checkout:billing-address-update",k);return{makeTrialSignCall:f,trialSignCallSucceeded:g,isTrialSignActivated:b}});"use strict";q.when("A","client-side-metrics","ajax-utility","button-blocker","button-blocker-popover","spclite-items-viewer","fast-track-controller").register("get-final-results-update",
function(a,l,k,b,f,g,h){function d(){for(var b=function(){a.trigger("checkout:spc:ordersummary:sizeChanged")},c=0;20>c;++c)setTimeout(b,100*c)}function e(a,b){setTimeout(function(){var c=g.prepare(a);c&&u("#spclite-items-operation").show();u("#spclite-items-header-dynamic").fadeIn(b?0:300,function(){c&&u("#spclite-items-operation").find(".spclite-items-view-switch").each(function(){var a=u(this).attr("view-name");a&&u(this).find("a").click(function(){l.increaseCount("SPCLite:ClientSide:SwitchViewClick:"+
a,1);g.switchToView(a);u("#spclite-items-operation").fadeOut(b?0:300);d()})})})},b?0:800)}function c(b,c,d){if(b&&u.isArray(b))for(var e=!1,f=0;f<b.length;f++){var g=b[f];if(g.identifier&&g.content){var h=u("#"+c+"-"+g.identifier);h&&0!==h.length?a.slideDown(h.html(g.content),d?0:500,"ease-out",function(){}):(l.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Item:"+c,1),e||(l.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Page:"+c,1),e=!0))}}}function m(b,f){if(b.presentCVs&&0<b.presentCVs.countOfCVs)p();
else{b.orderSummaryHTML&&(a.fadeOut(u("#order-summary-footer"),f?0:250,"ease-out"),a.fadeOut(u("#spc-order-summary"),f?0:250,"ease-out",function(){u("#spc-order-summary").replaceWith(b.orderSummaryHTML).hide();b.additionalOrderSummaryHTML&&u("#order-summary-footer").html(b.additionalOrderSummaryHTML);a.fadeIn(u("#spc-order-summary"),f?0:400,"ease-out");a.fadeIn(u("#order-summary-footer"),f?0:400,"ease-out")}));b.freshDeliveryMessageHTML&&(u("#lazy-fresh-promise-delivery-message").html(b.freshDeliveryMessageHTML),
a.slideDown(u("#lazy-fresh-promise-delivery-message"),f?0:500,"ease-out"),h.spcLiteLazyLoadFastTrack());c(b.itemToPrimeMembershipDelivery,"lazy-membership-delivery",f);c(b.itemToGiftContentMapping,"lazy-gift-options",f);c(b.itemToShipOfferingMapping,"lazy-ship-method",f);c(b.itemToPromise,"lazy-promise",f);b.freshDeliverySlotInformationHTML&&(u("#lazy-fresh-delivery-slot-information").html(b.freshDeliverySlotInformationHTML),a.slideDown(u("#lazy-fresh-delivery-slot-information"),f?0:250,"ease-out"));
b.freshDeliveryInstructionsHTML&&(u("#lazy-fresh-delivery-instructions").html(b.freshDeliveryInstructionsHTML),a.slideDown(u("#lazy-fresh-delivery-instructions"),f?0:250,"ease-out"));if(b.itemToPromoMapping&&u.isArray(b.itemToPromoMapping))for(var g=u("#items-block"),k=0;k<b.itemToPromoMapping.length;k++){var l=b.itemToPromoMapping[k];"lightningdeal"===l.type?g.find(".lazy-lightning-promo-details-"+l.identifier).removeClass("aok-hidden"):"promotion"===l.type&&g.find(".lazy-promo-details-"+l.identifier).removeClass("aok-hidden")}b.freeShippingId&&
u("#"+b.freeShippingId).removeClass("aok-hidden");u("input#isOrderSummaryReady").val(1);e(b.itemGroupData,f);d()}}function p(){var c=u("#spclite-block-order-place-message").html()||"";b.show("disabled-order-place",c);b.lock();f.create({name:"disabled-order-place",content:c});f.lock();var d=b.getButtonBlocker().data("a-popover-id");a.on("checkout:beforeReload",function(){f.unlock();b.unlock();f.destroy();u("#a-popover-"+d).remove()})}function q(a){if(a&&a.data){var b;try{b=n.atob(a.data)}catch(c){return l.increaseCount("SPCLite:FinalResult:Base64Decode:Failure",
1),null}if((b=k.jsonify(b))&&!u.isEmptyObject(b))return b}return null}var u=a.$,x,K=function(a,b){function c(){if(f&&0!==f.length){for(var a="",b=0;b<d%3+1;b++)a+=".";f.html(a);d++}}var d=0,e,f;this.start=function(){b&&b.useTextAnimate&&(d=0,f=a.find(".spclite-loading-text .spclite-processing-indicator"),e=setInterval(c,800))};this.stop=function(){e&&(clearInterval(e),f&&0<f.length&&f.html(""),d=0);a.find(".spclite-loading-spinner").hide();b&&b.showTextAlways||a.find(".spclite-loading-text").hide()}};
a.on("checkout:reload:spclite",function(){if("1"===u('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")){var a=q(n.__spcliteFinalResultsData);if(a){m(a,!0);return}}else if(n.__spcliteFinalResultsData){m(n.__spcliteFinalResultsData,!0);return}var a="",b=u("input#executionId").val();b&&(a+="executionId\x3d"+b);return u.ajax({type:"GET",url:"/gp/buy/spclite/handlers/get-final-results.html/ref\x3dox_spclite_get_final_results",data:a,dataType:"text",async:!0,beforeSend:function(a){x=
new K(u("#spclite-order-summary-loading-indicator"),{showTextAlways:!0});x.start();n.uet&&n.uet("bb","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},success:function(a,b,c){a=k.jsonify(a);"1"===u('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")?(a=q(a))?m(a,!1):p():a&&!u.isEmptyObject(a)?m(a,!1):p()},error:function(a,b,c){p()},complete:function(a){x.stop();n.uex&&n.uex("ld","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},cache:!1})});a.on("checkout:beforeLoadPage",function(){n.__spcliteFinalResultsData=
void 0})});"use strict";q.when("A","client-side-metrics").register("spclite-items-viewer",function(a,l){function k(){var a=f("#spclite-items-block").find(".spclite-item-detail");a&&0<a.length&&(h={},a.each(function(a){a=f(this).attr("entity-id");h[a]=f("\x3cp\x3e\x3c/p\x3e").append(f(this).clone().removeClass("a-span-last")).html()}))}function b(a,b){if(!b||0===b.length)return null;a=f('\x3cdiv class\x3d"a-row spclite-item-view" view-type\x3d"order-by-delivery"\x3e\x3c/div\x3e');var c=b;b=[];for(var g=
[],k=0;k<c.length;k++){var l=c[k];if("normal"!==l.type)g.push(l);else{for(var n=0;n<b.length;)if(l.data.destinationAddressId!==b[n].data.destinationAddressId)n++;else break;for(;n<b.length;)if(l.data.destinationAddressId===b[n].data.destinationAddressId&&l.data.promise.starttime.dayepoch>b[n].data.promise.starttime.dayepoch)n++;else break;b.splice(n,0,l)}}for(c=0;c<g.length;c++)switch(l=g[c],l.type){case "primemembership":b.unshift(l);break;case "vas":case "digital":case "no-promise":case "exception":b.push(l);
break;default:b.push(l)}for(g=0;g<b.length;g++){l=b[g];if(c=l.content)k='\x3cdiv class\x3d"row spclite-item-group-title"\x3e',c.destination&&(k+='\x3cdiv class\x3d"row destination"\x3e'+c.destination+"\x3c/div\x3e"),c.promise&&(k+='\x3cdiv class\x3d"row promise"\x3e'+c.promise+"\x3c/div\x3e"),k+="\x3c/div\x3e",a.append(k);a:if(c=l.items,h&&c&&0!==c.length){k="";for(n=0;n<c.length;n++){0===n%2&&(k+='\x3cdiv class\x3d"a-row"\x3e');var q=c[n].identifier;if(!h[q]){c=null;break a}q=f(h[q]);1===n%2&&q.addClass("a-span-last");
k+=f("\x3cp\x3e\x3c/p\x3e").append(q).html();1===n%2&&(k+="\x3c/div\x3e")}1===c.length%2&&(k+='\x3cdiv class\x3d"a-column a-span6 a-span-last"\x3e\x3c/div\x3e\x3c/div\x3e');c=k}else c=null;if(c)c=f(c),("no-promise"===l.type||"normal"===l.type&&l.data&&l.data.promise&&"scheduled"!==l.data.promise.type)&&c.find(".spclite-promise").hide(),a.append(c);else return null;g<b.length-1&&a.append("\x3chr\x3e")}return a}var f=a.$,g,h;return{prepare:function(a){try{var e;a:{k();if(h){var c=b("order-by-delivery",
a);if(c){g={"order-by-delivery":c};e=!0;break a}}e=!1}return e}catch(f){l.increaseCount("SPCLite:ClientSide:Exception:SwitchViewPrepare",1)}return!1},switchToView:function(a,e){var c;g&&g[a]?c=g[a]:(l.increaseCount("SPCLite:ClientSide:SwitchViewNoPrepared:"+a,1),"order-by-delivery"===a&&(c=b(a,e)));if(c){var h=f("#spclite-items-block");h.find(".spclite-item-view").fadeOut(300,function(){h.empty();h.append(c.clone().hide());h.find(".spclite-item-view").fadeIn(500)})}}}});"use strict";q.when("A","loading-spinner-controller").register("cpf-controller",
function(a,l){function k(a){var b,h,d;if(/^\d{11}$/.test(a)||/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(a)){a=a.replace(/[^\w\s]|_/g,"");if(/(\d)\1{10}/.test(a))return!1;b=a.substring(0,9);h=a.substring(9);d=0;for(var e=10;1<e;e--)d+=b.charAt(10-e)*e;if((2>d%11?0:11-d%11)!==h.charAt(0))return!1;b=a.substring(0,10);d=0;for(a=11;1<a;a--)d+=b.charAt(11-a)*a;return(2>d%11?0:11-d%11)!==h.charAt(1)?!1:!0}return!1}var b=a.$;a.on("checkout:reload:spp-taxid",function(){b("#useThresholdTaxIdService").length||b("#taxidForm").submit(function(){var a=
b("#taxidregistration-imb");if(!k(b("#taxid-field").val()))return l.hideSpinner(b("#spinner-anchor"),!0),a.show(),!1;a.hide();return!0})})});"use strict";q.when("A","page-conductor","ready").register("taxid-threshold-controller",function(a,l){function k(){var a=b();l.isSPP()?a?(f("#taxid-continue-disabled").hide(),f("#taxid-continue-enabled").show()):(f("#taxid-continue-enabled").hide(),f("#taxid-continue-disabled").show()):a?f("span.#continue").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):
f("span.#continue").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}function b(){var a=!0,b=f("#taxIdForm");b.length&&b.find('input[type\x3d"text"]').each(function(){var b=f(this);if(!b.val()||7>b.val().length)b.parents(".taxid-form").find('input[type\x3d"checkbox"]').attr("checked")||(a=!1)});return a}var f=a.$;a.on("checkout:reload:spp-taxid",function(){if(f("#useThresholdTaxIdService").length){var a=f("#taxIdForm");a.length&&(a.find('input[type\x3d"text"]').keyup(k),
a.find('input[type\x3d"checkbox"]').change(k));k()}})});"use strict";q.when("A","page-conductor","loading-spinner-controller","taxaddress-page-config","ready").register("taxaddress-controller",function(a,l,k,b){function f(){var a=d(c.taxidInputIdSelector).val();if(0===a.length)return!0;var b=d(c.taxlegalnameInputIdSelector).val();return e.test(a)&&0!==b.trim().length?(a=d(c.taxaddressInputNameSelector).val())&&0<a.length:!1}function g(){var a=f();if(l.isSPP()){var b=d("#taxid-continue-enabled"),e=
d("#taxid-continue-disabled");a?(e.hide(),b.show()):(b.hide(),e.show());0<d(c.taxidInputIdSelector).val().length?(b.find("span.a-button-text").text(c.saveContinueLabel),e.find("span.a-button-text").text(c.saveContinueLabel)):(b.find("span.a-button-text").text(c.continueLabel),e.find("span.a-button-text").text(c.continueLabel))}}function h(){var a=d(c.taxidInputIdSelector).val();if(m||0===a.length)m=!1;else{var b=0<d(c.newTaxaddressInputIdSelector).val().length;m||!b&&!f()||d.ajax({type:"POST",url:c.sifEncryptionUrl,
dataType:"json",data:{taxid:a},success:function(a,b,e){d(c.taxidInputIdSelector).val(a.sifEncryptedPayload);m=!0;d(c.taxaddressFormIdSelector).submit()},error:function(a,b,c){console.log("Error [tramway][away] failed calling sifcontinue.html :"+b)}});return!1}}var d=a.$,e=/^\d{11}$/,c=b.getConfig(),m=!1;a.on("checkout:reload:spp-taxaddress",function(){d(c.taxidInputIdSelector).keyup(g);d(c.taxlegalnameInputIdSelector).keyup(g);d('input:radio[name\x3d"'+c.taxaddressInputName+'"]').each(function(){d(this).change(g)});
d(c.taxaddressFormIdSelector).submit(h);g()});return{getNewTaxAddressPopoverURL:function(){return c.newTaxAddressPopoverURL},submitTaxAddressFormWithNewAddressId:function(a){d(c.newTaxaddressInputIdSelector).val(a);k.showSpinner(d(c.taxAddressPanelSelector),!1);d(c.taxaddressFormIdSelector).submit()}}});q.when("A","address-popovers","taxaddress-controller","ready").register("taxaddress-addresspopover-helper",function(a,l,k){l.actionRegisterTaxAddressController(k)});"use strict";q.when("A","page-spinner-controller",
"ajax-utility","page-conductor","client-side-metrics").execute(function(a,l,k,b,f){function g(){function e(a){if(!g)if(a.preventDefault(),a=encodeURIComponent(h("#spc-deliverytipinput").val()),h("#tip-error").addClass("aok-hidden"),h("#tip-promo-success").addClass("aok-hidden"),h("#tip-success").addClass("aok-hidden"),h("#tip-ineligible").addClass("aok-hidden"),h("#tip-success").addClass("aok-hidden"),a&&0!==a.length)if(0>a)f("invalidDeliveryTip_NoAmount");else if(/^[0-9]*(\.[0-9]{1,2})?$/.test(a)){l.show();
k=h("#spc-deliverytipnoticecheckbox").attr("checked")?1:0;var d=(new Date).getTime();a="tipamount\x3d"+a+"\x26isDefaultTip\x3d"+k+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+h("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+d;d=b.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});h.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-tip.html/ref\x3dox_tip_page_delivery_tip_add",data:a,
headers:d,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){g=!1;l.hide()},success:c,error:b.ajaxRedirect});g=!1}else f("invalidDeliveryTip_NoAmount");else f("addDeliveryTip_NoAmount")}function c(a,b,c){l.hide()}function f(a){l.hide();h("#tip-error").removeClass("aok-hidden");0<h("div.spc-desktop").length?h("#spc-deliverytipinput").addClass("a-form-error"):h("#spc-deliverytipinput").closest(".a-input-text-wrapper").addClass("a-form-error");h("#"+
a).removeClass("aok-hidden")}var g=!1,k=0;d&&(a.declarative("tip-element",["click"],function(a){var b=a.data.click;b&&null!==b&&e(a.$event)}),d=!1)}var h=a.$;if(!h("html").hasClass("a-ie6")){var d=!0;a.on("checkout:reload:spc",g);a.on("checkout:reload:spclite",g)}});"use strict";q.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("checkout-feedback-controller",function(a,l,k,b){function f(){if(!h||"function"!==typeof h)return"";var a=h(),b="";if(a)for(var c in a)if("number"===
typeof a[c]||"string"===typeof a[c]||"boolean"===typeof a[c])b+="\x26__pagedata_"+c+"\x3d"+a[c];return b}var g=a.$,h;a.declarative("checkout-submit-feedback",["click","touchend"],function(a){if(!l.protectAgainstDoubleAction("checkout-submit-feedback",200)&&(a=g("#checkout-feedback-form"),a.length)){b.showSpinner(a,!1);var e=a.serialize(),e=e+f();g.ajax({type:"POST",url:a.attr("action"),data:e,dataType:"text",error:k.ajaxRedirect,success:function(a,b,d){b=d.getResponseHeader("checkout-feedback-submitted");
g(".a-button-close").trigger("click");null!==b&&void 0!==b&&g("#checkout-feedback-banner").append(a)}})}});return{registerPageDataCollecter:function(a){a&&"function"===typeof a&&(h=a)}}});"use strict";q.when("A","page-spinner-controller","scroll-controller","ajax-utility","page-conductor","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics").execute(function(a,l,k,b,f,g,h,d,e,c){function m(){function c(a){a=a.$currentTarget.closest(".delivery-instructions-block");
a.find(".edit-delivery-instructions-link").addClass("aok-hidden");a.find(".delivery-instructions-display").addClass("aok-hidden");var b=a.find(".dynamic-delivery-instructions-update").find(".delivery-instructions-input").attr("maxlength");a.find(".dynamic-delivery-instructions-update").removeClass("aok-hidden");p("#deliveryInstructions").focus();p("#deliveryInstructions").select();p("#deliveryInstructions").keydown(function(a){10===a.which&&a.preventDefault()});p("#deliveryInstructions").keyup(function(){p("#delivery-instructions-left-text").hasClass("aok-hidden")&&
p("#delivery-instructions-left-text").removeClass("aok-hidden");var a=b-p(this).val().length;0>a&&(a=0);p("#delivery-instructions-left").text(a)});setTimeout(function(){},500)}function d(a){l.show();a=a.$currentTarget;var b=p("#deliveryInstructions").val(),c=a.closest(".delivery-instructions-block"),g=a.closest(".dynamic-delivery-instructions-update");c.find(".edit-delivery-instructions-link").removeClass("aok-hidden");c.find(".delivery-instructions-display").removeClass("aok-hidden");g.addClass("aok-hidden");
c=(new Date).getTime();b="deliveryInstructions\x3d"+encodeURIComponent(b)+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+p("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+c;c=f.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});p.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-instructions.html/ref\x3dox_instructions_page_delivery_instructions_update",data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){l.hide()},success:e,error:f.ajaxRedirect});a.blur()}function e(a,c,d){(a=b.jsonify(a))&&!p.isEmptyObject(a)&&p("#deliveryInstructionsDisplay").html(a.deliveryInstructions);l.hide()}n&&(a.declarative("edit-delivery-instructions",["click"],c),a.declarative("update-delivery-instructions",["click"],d),n=!1)}var p=a.$;if(!p("html").hasClass("a-ie6")){var n=!0;a.on("checkout:reload:spc",m);a.on("checkout:reload:spclite",m)}});"use strict";q.when("A","page-conductor").register("installments-service",
function(a,l){var k=a.$;return{call:function(a,f,g){k.ajax({type:"POST",url:"/gp/buy/installments/handlers/set-item-installments.html/ref\x3dox_spc_inst_toggle",data:{itemId:a,programId:f},dataType:"text",async:!0,cache:!1,headers:l.setAjaxTransitionHeader(),success:g.success||null,error:g.error||null})}}});"use strict";q.when("A","page-transition-controller","page-conductor","page-detector","button-blocker","installments-service").register("installments-controller",function(a,l,k,b,f,g){function h(){a.defer(e)}
function d(a,b,c){l.hide();k.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"})}function e(){var a=c("#installments-button-blocker");1===a.length&&(a=a.data("blocker-message"),f.show("place-order-installments-blocker",a))}var c=a.$;a.declarative("installments-sync-state",["change"],function(a){var b=a.data.itemId;a=a.$target.is(":checked")?a.data.programId:"";var c={success:d,error:k.ajaxRedirect};l.show();g.call(b,a,c)});a.on("checkout:reload:spp-revieworder",h);a.on("checkout:reload:spc",h)});"use strict";
q.when("A","page-conductor","checkout-modal-popover","page-transition-controller","ajax-utility","page-detector","payments-portal-common","ready").register("spc-payments-portal",function(a,l,k,b,f,g,h){function d(b,c){c={refTag:c,callbackBeforePageUpdate:function(){a.$("div.a-popover button.a-button-close").trigger("click")}};l.isSPP()&&(c.keepCachedPagesData=1);l.loadPage("spc",b,null,c)}function e(a,d,e){l.isSPP()?(b.blockAllActions(),b.showTransitionInContainer(c("#payment"))):b.show();a="/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+
a;var f=l.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});c.ajax({type:"POST",url:a,data:d,headers:f,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?l.ajaxUpdatePage(a,b,c):e(a)},error:l.ajaxRedirect})}var c=a.$;return{prepareDelegatedPopovers:function(b){function d(a,b){a=c(a);a.data("aCheckoutModalPopover",b);k.createModal({$declarativeParent:a},
b)}a.on("pmts:retail:billing-address-popover",function(a){d(".pmts-change-address-link",{header:b.billingAddressPopoverHeader,footer:"",name:"billing-address",allowScrollOnPage:!0})});a.on("pmts:retail:rewards-registration",function(a){d(".pmts-shop-with-points-learn-more-link",{header:b.rewardsRegistrationPopoverHeader,footer:"",name:"rewards-registration",allowScrollOnPage:!0})})},handleClaimCodeSubmittedEvent:function(a,b){var d={returnjson:"1",returnFullHTML:"1",hasWorkingJavascript:"1",fromAnywhere:c("input[name\x3dfromAnywhere]").val(),
cachebuster:(new Date).getTime(),nextAction:"pipeline-dispatch",embedOnlyData:"1"};a=c.param(a)+"\x26"+c.param(d);e("ox_pay_page_gc_add",a,function(a){h.claimCodePageUpdater(b,a)})},handleChangeBillingAddressRequestedEvent:function(){g.isDesktopSpc()?l.isSPP()?c("#pmts-change-billing-address-popover").trigger("click"):a.trigger("pmts:retail:billing-address-popover"):(b.show(),l.isPipeliningOn()&&d("billingaddressselect","ox_spc_change_ship_addr"))},handleChangePaymentInstrumentRequestedEvent:function(){b.show();
l.isPipeliningOn()&&d("payselect","ox_spc_change_payment")},handleRewardsAccountLearnMoreRequestedEvent:function(){a.trigger("pmts:retail:rewards-registration")},handlePointsAccountSubmittedEvent:function(a){var b={hasWorkingJavascript:"1",isClientTimeBased:c("input[name\x3duseCtb]").val(),nextAction:"dispatch"};a=c.param(a)+"\x26"+c.param(b);e("ox_spc_points_edit",a,function(a){a=f.jsonify(a);l.redirect(a)})}}});"use strict";q.when("ajax-utility","gc-redeem-controller","page-transition-controller",
"ready").register("payments-portal-common",function(a,l,k){return{claimCodePageUpdater:function(b,f){f=a.jsonify(f);null!==f?f.widgetJsonData?(b.update(f.widgetJsonData),k.hide()):f.autohandlererror&&l.giftSystemErrorHandling(f.autohandlererror):k.hide()}}});"use strict";q.when("A","page-detector-current-page","a-button","a-meter").register("checkout-throttle-error",function(a,l,k,b){var f=a.$;a.on("checkout:reload:throttle",function(){if(f("#checkout-throttle-meter").length){var a=1E3*f('input[name\x3d"waiting-time"]').val()/
100;k("#checkout-throttle-return-to-cart").disable();var h=b("#checkout-throttle-meter"),d=0,e=setInterval(function(){h.percent(d);if(100>d)d+=1;else{clearInterval(e);var a=k("#checkout-throttle-return-to-cart");a.text(f("#checkout-throttle-primary-button-active-text").text());a.enable()}},a)}})});"use strict";q.when("A","weblab-helper").register("nav-bar-helper",function(a,l){function k(){try{q.register("navCF")}catch(a){if(-1===a.message.toLowerCase().indexOf("already registered"))throw a;}}if(l.isNavCFWeblabOn())a.on("checkout:reload",
k)});q.when("A").execute(function(a){a.declarative("remaining-customizations-action","click",function(a){a.$currentTarget.parent().find(".remaining_customization_info").removeClass("aok-hidden");a.$currentTarget.hide();a.$event.preventDefault()})});"use strict";q.when("A","checkout-federation-utilities","client-side-metrics").register("checkout-federation-wrapper",function(a,l,k){function b(a){for(var b=[],d=f;d<a.length;d++)b.push(a[d]);return b}var f=2;return{wrap:function(a,f){try{return a.apply(null,
b(arguments))}catch(m){var d=f,e=m,c;c=d;c=l.getExternalDependecies()[c];c=void 0!==c&&null!==c?c.cti:"Undefined";k.logError(e,"["+d+"] Javascript error thrown while executing wrapper",c,"FATAL");n.console&&n.console.error&&n.console.error(e,d,c)}}}});"use strict";q.when("A","jQuery","checkout-federation-utilities").register("checkout-federation-injector",function(a,l,k){function b(a){a=a.assetsModule;if(f[a]?0:0<l('script[type\x3d"checkout-asset-trigger"][data-checkout-asset-trigger\x3d"'+a+'"]').length)f[a]=
!0,q.register("trigger"+a,function(){})}var f={};a.on("checkout:reload",function(){var a=k.getExternalDependecies(),f;for(f in a)a.hasOwnProperty(f)&&b(a[f])})});"use strict";q.when("A","client-side-metrics").register("checkout-federation-utilities",function(a,l){return{getExternalDependecies:function(){var k=a.state("triggerExternalDependencies");Object&&Object.keys&&l.increaseCount("Checkout:ExternalDependencies:count:"+(k?Object.keys(k).length:"undefined"));return void 0===k||null===k?{}:k}}})});
/* ******** */
(function(m){var k=window.AmazonUIPageJS||window.P,Z=k._namespace||k.attributeErrors,a=Z?Z("CheckoutMultiPagePipeline",""):k;a.guardFatal?a.guardFatal(m)(a,window):a.execute(function(){m(a,window)})})(function(m,k,Z){m.when("A","a-tooltip").register("button-blocker-mpp",function(a,b){var e=a.$;a.declarative("a-tooltip-button-blocker",["mouseenter","click","touchstart"],function(a){a=a.$target;if(0<a.length){var c=b.get(a),f=e(".place-order-blocker-message.custom-blocker-message");if(f.is(":empty")){var g=
e("#gold-box-button-blocker");1===g.length&&f.text(g.attr("data-blocker-message"))}f.is(":empty")&&e("div.locale-cn").length&&(f=e(".place-order-blocker-message.china-invoice-message"));c?c.updateContent(f.text()):c=b.create(a,{content:f.text()});c.isActive()||c.show()}})});m.when("A","a-popover-base","a-popover-util","button-blocker").register("button-blocker-popover",function(a,b,e,d){function c(a,c){if(c.name)b.show({$trigger:a?a.$target:d.getButtonBlocker(),skin:w,alone:!1,update:n,hide:k,content:c.content,
name:c.name,position:c.position||"triggerVertical"});else if(c=b.show({$trigger:a.$target,skin:w,alone:!1,update:n,hide:k,content:a.$currentTarget.data("blockerText"),position:c.position||"triggerVertical"}))c.update(a.$currentTarget.data("blockerText")),c.updatePosition()}function f(c){var g=c?c.$target:d.getButtonBlocker();g&&a.delay(function(){c&&e.eventOccursWithin(c,g)||b.hide(g)},250)}var g=a.$,w=function(a){return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e','\x3cdiv class\x3d"a-popover-inner"\x3e'+
a+"\x3c/div\x3e",'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")},u=!1,n=function(a){u||g(".a-popover-inner",this.$popover).html(a)},k=function(){u||a.fadeOut(this.$popover,250)},z={mouseenter:c,mouseleave:f},r={click:c};a.declarative("a-button-blocker",["mouseenter","mouseleave","click"],function(c){try{c.$event.preventDefault()}catch(b){if(!g("html").hasClass("a-lt-ie9"))throw b;}if(!u){var e=(a.capabilities.touch?r:
z)[c.type];e&&e(c,c.data)}});return{create:function(a){a&&a.name&&a.content&&c(null,a)},destroy:function(a){f(null)},lock:function(){u=!0},unlock:function(){u=!1}}});"use strict";m.when("jQuery").register("form-icon-controller",function(a){function b(a){a.is(":checked")?a.closest("label").find("i").removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"):a.closest("label").find("i").removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive");
a.is(":disabled")?a.closest("label").addClass("a-touch-selector-disabled"):a.closest("label").removeClass("a-touch-selector-disabled")}function e(a){a.is(":checked")?a.closest("label").find("i").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"):a.closest("label").find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");a.is(":disabled")?a.closest("label").addClass("a-touch-selector-disabled"):a.closest("label").removeClass("a-touch-selector-disabled")}
function d(){a("label.a-touch-checkbox-control input").each(function(c){b(a(this))});a("label.a-touch-radio-control input").each(function(c){e(a(this))})}function c(){a("label.a-touch-checkbox-control input").unbind("change.form-icon-controller").bind("change.form-icon-controller",function(c){b(a(this))});a("label.a-touch-radio-control input").unbind("change.form-icon-controller").bind("change.form-icon-controller",function(c){e(a(this))});a("label.a-touch-radio-control").unbind("click.form-icon-controller").bind("click.form-icon-controller",
function(c){c=a("input",this);if(!c.is(":disabled")){var b=a("i.a-icon",this),e=a('i[data-a-input-name\x3d"'+c.attr("name")+'"]'),d=a('input[name\x3d"'+c.attr("name")+'"]');d.removeAttr("checked");c.attr("checked","checked");e.addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");b.addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");d.trigger("change");c.trigger("change")}});a("label.a-touch-checkbox-control").unbind("click.form-icon-controller").bind("click.form-icon-controller",
function(c){c=a("input",this);if(!c.is(":disabled")){var b=a("i.a-icon",this);c.is(":checked")?c.removeAttr("checked"):c.attr("checked","checked");b.toggleClass("a-icon-touch-checkbox-active").toggleClass("a-icon-touch-checkbox-inactive");c.trigger("change")}})}function f(){a("html").hasClass("a-touch")&&(d(),c(),a("label.a-touch-radio-control input").trigger("change"))}m.when("A").execute(function(a){a.on("checkout:reload",f)});return{initializeIconControllers:d,bindIconControllers:c}});"use strict";
m.when("A","checkout-general-utils").register("inline-expander",function(a,b){function e(a){var b=a.parent().find(".a-expander-inner");b.length||(b=d("#"+a.data("expanderContent")));a.data("isShown")&&"false"!==a.data("isShown")?(b.slideUp("fast"),a.data("isShown","false")):(b.slideDown("fast"),a.data("isShown","true"),b=d("#"+a.data("expanderAnchor")),b.length&&d("html, body").animate({scrollTop:b.offset().top},"fast"));a=a.find("i");(a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand"))&&
a.toggleClass("a-icon-collapse").toggleClass("a-icon-expand")}var d=a.$;a.declarative("a-inline-expander",["click","touchend"],{allowLinkDefault:!0},function(a){a.$event.preventDefault();b.protectAgainstDoubleAction("a-inline-expander",400)||e(d(a.$event.currentTarget))});return{toggleExpander:e}});"use strict";m.when("jQuery").register("checkout-pagination",function(a){function b(a,c,b,d,f){var k=c.find("li.checkout-page-selector.a-selected").removeClass("a-selected");a.find("js-hide").hide().removeClass("js-hide");
e(k,a,c,b,f,d);d.height(d.height())}function e(a,b,e,n,k,z){if(!a.hasClass("a-selected")){var r=parseInt(a.text(),0)-1,B=parseInt(a.siblings(".a-selected").text(),0)-1,q=e.find(".checkout-page-previous"),v=e.find(".checkout-page-next");b.stop(!0,!0).clearQueue();0===r?c(q):d(q);r===k-1?c(v):d(v);e.find(".checkout-page-selector").removeClass("a-selected");a.addClass("a-selected");a=function(){return b.slice(r*n,r*n+n).fadeIn("fast")};isNaN(B)?a().stop(!0,!0):b.slice(B*n,B*n+n).fadeOut("fast",a);0<
r&&f(z)}}function d(a){a.hasClass("a-disabled")&&(a.removeClass("a-disabled"),a.wrapInner('\x3ca href\x3d"javascript:void(false)"/\x3e'))}function c(a){a.hasClass("a-disabled")||(a.addClass("a-disabled"),a.html(a.children("a").html()))}function f(c){var b=0;c.children().filter(":visible").each(function(){b+=a(this).outerHeight(1)});b>c.height()&&c.height(b)}return{initializePagination:function(c){c.unbind("checkoutpagination.initializePagination").bind("checkoutpagination.initializePagination",function(){var c=
a(this),d=c.find(".checkout-pagination-content"),g=d.children().addClass("checkout-pagination-item"),f=c.find("div.a-pagination"),k=parseInt(f.data("checkoutPaginationItemsperpage"),0)||5;if(0!==k&&0!==f.length){var r=Math.ceil(g.length/k);1===r?f.hide():(b(g,f,k,d,r),c.delegate("li.checkout-page-selector","click",function(c){c.preventDefault();e(a(this),g,f,k,r,d)}),c.delegate("li.checkout-page-previous","click",function(c){c.preventDefault();if(a(this).hasClass("a-disabled"))return!1;e(f.find(".a-selected").prev(),
g,f,k,r,d)}),c.delegate("li.checkout-page-next","click",function(c){c.preventDefault();if(a(this).hasClass("a-disabled"))return!1;e(f.find(".a-selected").next(),g,f,k,r,d)}),d.delegate(".checkout-pagination-item","activate.checkout-pagination",function(){var c=a(this),c=g.index(c);f.find("li:contains("+(Math.floor(c/k)+1)+")").click()}))}}).trigger("checkoutpagination.initializePagination")}}});"use strict";m.register("latency-logger",function(){var a=[],b=[];return{start:function(e){var d=(new Date).getTime();
a.push(d);b.push(e)},stop:function(){var e=(new Date).getTime(),d=a.pop();if(k.log_latency&&k.console&&k.console.log){var c=b.pop();console.log(c+": "+(e-d)+" ms")}}}});"use strict";m.when("page-conductor","ajax-utility","jQuery","page-detector").register("page-conductor-mpp",function(a,b,e,d){a.initFunc(function(a){e("body").html(a)},function(a){var b=e("#checkoutDisplayPage");b.length&&(b.html(a),d.isMobile()&&(e(document).scrollTop(b.offset().top),a=e("h1"),a.attr("tabindex","0").css("outline",
"none"),a.focus()))})});"use strict";m.when("A","loading-spinner-controller","page-conductor").register("long-calendar-popover-controller",function(a,b,e){var d=a.$,c={},f,g,w=0;a.on("a:popover:show:prime-long-calendar",function(a){f=a=a.popover.$trigger.data("orderid");d(".prime-long-calendar-popover").each(function(a){d(this).parent().hasClass("a-popover-inner")&&(g=d(this))});b.showSpinner(g,!1);var n;if(d("#spc-another-day-link").length)n="spc",w=0;else if(n="sosp",w=1,c[f]){d(".prime-long-calendar-popover").html(c[f]);
return}var k;"spc"===n?k=d("input[name\x3dlineitemids"+a+"]").attr("value"):"sosp"===n&&(k=d("input[name\x3dlineItemEntityIds_"+a+"]").attr("value"));d.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+k+"\x26orderid\x3d"+a+"\x26fromPage\x3d"+n,dataType:"html",async:!0,cache:!1,headers:{"x-amz-checkout-page":n},success:function(a){d(a).find("#recs-server-error").length?d(".a-button-close").trigger("click"):d(".prime-long-calendar-popover").html(a)},
error:e.ajaxRedirect})});a.on("a:popover:hide:prime-long-calendar",function(a){w&&(c[f]=g.html())})});"use strict";m.when("A","a-popover-base").execute(function(a,b){function e(a){var d=$(".ags-popover-content").closest(".a-popover-wrapper");d.find(".a-popover-inner").unbind();var g=a.$declarativeParent;if(b.get(g)){var w=setTimeout(function(){b.hide(g)},250);d.find(".a-popover-inner").bind("mouseenter",function(a){clearTimeout(w);a.stopPropagation()});d.find(".a-popover-inner").bind("mouseleave",
function(b){e(a);b.stopPropagation()})}}var d;a.on("a:popover:beforeShow:ags-badge-popover",function(){var a=$(".ags-popover-content").closest(".a-popover-wrapper"),b=a.find(".a-popover-header");1===b.length&&(d=b.find(".a-button-close").clone(),b.remove());a.find(".a-popover-inner").prepend(d)});a.declarative("a-popover","mouseenter",function(a){"ags-badge-popover"===a.data.name&&a.$currentTarget.trigger("click")});a.declarative("a-popover","mouseleave",function(a){"ags-badge-popover"===a.data.name&&
e(a)})});"use strict";m.when("A","ready").register("checkout-buttom-sheet-controller",function(a){a=a.$;var b=a("#a-page");return{disablePageScrolling:function(){b.css({position:"fixed",top:"-"+k.scrollY+"px"})},enablePageScrolling:function(){var a=Math.abs(b.position().top);b.css({position:"",top:""});k.scrollTo(0,a)}}});m.when("A","ready").register("autopopulate-fields-clear",function(){});"use strict";m.when("A","page-detector").execute(function(a,b){function e(){b.isSpc()&&d("iframe#typ-assets-spc-iframe").attr("src",
"/gp/checkoutprefetch/typ-assets.html")}var d=a.$;a.on("checkout:reload:spc",function(){setTimeout(e,1E3)})});"use strict";m.when("A","page-detector","page-detector").execute(function(a,b,e){function d(){0<f(".prime-calendar-container").length&&f(".prime-calendar-container").contents().each(function(a,c){8===c.nodeType&&f(c).replaceWith(c.nodeValue)});u=w=-1;var a=f("html");a.hasClass("a-ie6")&&(a.removeClass("a-js").addClass("a-no-js"),f(".a-declarative").removeClass("a-declarative"));setTimeout(c,
1E3)}function c(){if(e.isSpc())if(e.isSpcLite()){n=f("#left-grid");m=f("#right-grid");u=f("#second-buy-button").height();m.css("min-height",0);n.css("min-height",0);var a=n.height(),c=f("#order-summary-box").height(),b=c+u;if(b<a){m.css("min-height",a);n.css("min-height",a);var c=f(document).height(),d=f(k).height()+200;c>d&&b<a?f("#second-buy-button").show():f("#second-buy-button").hide()}else a<b&&n.css("min-height",c),f("#second-buy-button").hide()}else-1===w&&(n=f("#left-grid"),m=f("#right-grid"),
w=n.height(),u=f("#second-buy-button").height()),c=f("#order-summary-box").height(),b=c+u,b<w?(m.css("min-height",w),n.css("min-height",w),c=f(document).height(),d=f(k).height()+200,c>d&&b<w?f("#second-buy-button").show():f("#second-buy-button").hide()):(w<b&&n.css("min-height",c),f("#second-buy-button").hide())}var f=a.$,g,w,u,n,m;a.on("resize",function(){g&&k.clearTimeout&&k.clearTimeout(g);g=setTimeout(function(){c();g=null},100)});a.on("checkout:spc:ordersummary:sizeChanged",c);a.on("checkout:reload:spc",
d);a.on("checkout:reload:spclite",d)});m.when("error-feature-detection").execute(function(a){a.registerFeature("shipping-speed-selection-controller",1)});"use strict";m.when("A","checkout-general-utils","page-transition-controller","page-detector","page-conductor","cache-page-data-controller").execute(function(a,b,e,d,c,f){function g(b,e,d,g,f){a.trigger("checkout:beforeLoadPage");c.ajaxUpdatePage(n[b+":"+e+":"+d+":"+g+":"+f].data,n[b+":"+e+":"+d+":"+g+":"+f].status,n[b+":"+e+":"+d+":"+g+":"+f].response,
{refTag:g,anchor:d})}function w(a){if(k)k=!1;else if(b.protectAgainstDoubleAction("pipeline-link"))a.preventDefault(),a.stopImmediatePropagation();else{var d=u(a.currentTarget),w=d.data("pipelineLinkFromPage"),q=d.data("pipelineLinkToPage"),v=d.data("pipelineLinkAnchor"),l=d.data("pipelineLinkRef"),d=d.data("pipelineLinkArgs");q&&(a.preventDefault(),a.stopImmediatePropagation(),c.isSPP()&&f.setCachedPageData(w,q),"object"!==typeof n[w+":"+q+":"+v+":"+l+":"+d]||!n[w+":"+q+":"+v+":"+l+":"+d].pending&&
"undefined"===typeof n[w+":"+q+":"+v+":"+l+":"+d].data?(e.show(),a={refTag:l,anchor:v},c.isSPP()&&(a.keepCachedPagesData=1),c.loadPage(w,q,d,a)):n[w+":"+q+":"+v+":"+l+":"+d].pending?(e.show(),n[w+":"+q+":"+v+":"+l+":"+d].dispatch=1):g(w,q,v,l,d))}}var u=a.$,n={},k=!1;a.on("checkout:reload:spc",function(){u("a.pipeline-link.static-link-prefetch").each(function(a,b){a=u(b);a.bind("touchmove",function(){k=!0});a.bind("click keypress touchend",w);var d=a.data("pipelineLinkFromPage"),e=a.data("pipelineLinkToPage"),
f=a.data("pipelineLinkAnchor"),l=a.data("pipelineLinkRef"),p=a.data("pipelineLinkArgs");if(e){n[d+":"+e+":"+f+":"+l+":"+p]={};n[d+":"+e+":"+f+":"+l+":"+p].pending=1;n[d+":"+e+":"+f+":"+l+":"+p].dispatch=0;var A={refTag:l,anchor:f,resultscallback:function(a,b,w){n[d+":"+e+":"+f+":"+l+":"+p].pending=0;a?(n[d+":"+e+":"+f+":"+l+":"+p].data=a,n[d+":"+e+":"+f+":"+l+":"+p].response=w,n[d+":"+e+":"+f+":"+l+":"+p].status=b,n[d+":"+e+":"+f+":"+l+":"+p].dispatch&&g(d,e,f,l,p)):n[d+":"+e+":"+f+":"+l+":"+p].dispatch&&
(A.resultscallback=void 0,c.loadPage(d,e,p,A))}};a="isAsync\x3d1\x26isClientTimeBased\x3d1";p&&(a+="\x26"+p);c.loadPage(d,e,a,A)}})})});"use strict";m.when("A","ready").execute(function(a){var b=a.$,e,d,c;a.on("checkout:beforeReload",function(){void 0!==c&&(d.css("margin-bottom",c+"px"),c=void 0)});a.on("checkout:reload:spc",function(){e=b("#pyo-button-pinned");d=b("body");if(1===e.length&&"fixed"===e.css("position")&&void 0===c){var a=d.css("margin-bottom");c=parseInt(a,10);d.css("margin-bottom",
c+e.height()+"px")}})});"use strict";m.when("A","loading-spinner-controller","page-transition-controller","page-conductor","ajax-utility","checkout-general-utils","page-detector","client-side-metrics","deliver-to").register("inline-address-popover-controller",function(a,b,e,d,c,f,g,w,u){function n(){F="T1"===h("#fixPopupModalInfiniteSpinner").val();a.defer(function(){h("#spc-top").find(".change-address-popover-link").each(function(){var a=h(this);a.data("action")&&-1<a.data("action").indexOf("a-checkout-modal-popover")&&
a.attr("tabindex",0)})});var c=h(".a-popover-modal");c.find("#shipping-address-popover").remove();c.find("#billing-address-popover").remove();a.defer(function(){m();z()})}function m(){h("#desktop-shipping-address-div .screenreader-address-span").text(" "+h("#desktop-shipping-address-div .displayAddressAddressLine1").text())}function z(){h("#billing-address .duplicate-address").is(":visible")?h("#billing-address .screenreader-address-span").text(" "+h("#desktop-shipping-address-div .displayAddressAddressLine1").text()):
h("#billing-address .screenreader-address-span").text(" "+h("#billing-address .displayAddressAddressLine1").text())}function r(b,f,g){function G(b){b.isSameAsShipping?(h("#billing-address .single-address").hide(),h("#billing-address .duplicate-address").show()):b.addressHTML&&(h("#billing-address .duplicate-address").hide(),h("#billing-address .single-address").html(b.addressHTML).show());z();a.trigger("checkout:billing-address-update")}function l(a){var b=h("#left-grid");a.isSameAsShipping?b.find(".pmts-billing-address-details").html(b.find(".billing-duplicate-address").html()):
a.addressHTML&&b.find(".pmts-billing-address-details").html(a.addressHTML)}function p(a){return"shouldRefreshSPCOnChange"in a&&1===a.shouldRefreshSPCOnChange}if(g.getResponseHeader("x-amz-checkout-page")){var r=g.getResponseHeader("x-amz-checkout-fatal-error");if(null!==r&&void 0!==r){k.location=r;return}h(".a-button-close").trigger("click");return d.ajaxUpdatePage(b,f,g)}if((b=c.jsonify(b))&&(b.isSameAddress||b.isSameAsShipping||b.addressHTML)&&(0===h("#billing-address").size()?l(b):G(b),!p(b))){e.hide();
h(".a-button-close").trigger("click");b.requestid&&(w.setAsyncRequestId(b.requestid),w.sendUEPageLoadStats());return}d.redirect(b);b&&b.conductoraction?h(".a-button-close").trigger("click"):p(b)||(e.hide(),h(".a-button-close").trigger("click"))}function B(a,c){c=c.toLowerCase();if(F){if("none"===h("#"+c+"-address-popover").closest(".a-popover").css("display")){G.push(c+"-Address: Not populating popup modal is hidden");return}}else{if(!E){G.push(c+"-Address: Not populating content already loaded");
return}E=!1}var d=h("#"+c+"-address-popover .select-address-main"),e="/gp/buy/pipeline/handlers/update-"+c+"-address.html",g=!1;"true"===a.isCampus&&(g=d.closest(".select-address-main"),g.find(".popover-pagination").remove(),g="true"===a.hideAddAddress||!1);N(a.addresses,d,2,3,e,c,"pageConductor.ajaxRedirect",g);a=d.find(".select-address-page").filter(function(){return"template"!==h(this).data("addresspage")}).length;1<a&&(a=A(0,a,p),g=d.closest(".select-address-main"),g.find(".popover-pagination").remove(),
a.appendTo(g).show());!1===D.modifiedForCampus&&d.closest(".address-popover").find(".address-popover-sidebar").css("visibility","visible").hide().fadeIn(300);b.hideSpinner(d);G.push(c+"-Address: Hiding spinner");V(h("#"+c+"-address-popover"));d.find(".select-address-page").filter(function(){return 0===h(this).data("addresspage")}).fadeIn(300)}function q(a){G.push("Billing-Address: AJAX Call returned with data: "+c.jsonify(a));B(a,"Billing")}function v(a){G.push("Shipping-Address: AJAX Call returned with data: "+
c.jsonify(a));B(a,"Shipping");var b=h("#shipping-address-popover .select-address-main"),d=h("#popover-store-pickup-search-spc");a.showPickupSearch?(d.show(),a.useTwoZipStoreSearch?(d.find(".secondary-pickup-input").show(),d.find("input[name\x3d'searchCriterion']").val("storeTwoZips"),d.find(".popover-pickup-input input").removeClass("single-input").addClass("two-inputs")):d.find(".secondary-pickup-input input").val("")):d.hide();a.canShipToMultiple?h("#spc-popover-ship-to-multiple-link").show():h("#spc-popover-ship-to-multiple-link").hide();
d.find(".popover-pickup-input input").focus(function(){h(this).hasClass("pickup-search-field")&&h(this).removeClass("a-color-secondary").val("")});a=b.find(".add-address-button");a.hasClass("pipeline-link")||(a.bind("click",{usecase:"addaddress",reftag:"ox_spc_shipaddr_addnewbox_popover"},l),b=h("#spc-popover-add-new-address-link a"),b.bind("click",{usecase:"addaddress",reftag:"ox_spc_shipaddr_addnewlink_popover"},l),d=h("#spc-popover-edit-address-link a"),d.bind("click",{usecase:"editaddress",reftag:"ox_spc_shipaddr_editlink_popover"},
l),f.bindActionEnterKeyOnButton(a),f.bindActionEnterKeyOnButton(b),f.bindActionEnterKeyOnButton(d));a=h("#spc-popover-ship-to-multiple-link a");a.hasClass("pipeline-link")||(a.bind("click",{usecase:"shiptomultiple",reftag:"ox_spc_shipaddr_multilink_popover"},l),f.bindActionEnterKeyOnButton(a))}function l(a){var b;if(a&&a.data&&a.data.usecase){b=a.data.usecase;a=a.data.reftag?a.data.reftag:"shipaddr_popover_link";var c=null,d="";"addaddress"===b?(c="/gp/buy/addressselect/handlers/display.html",d="#new-address"):
"editaddress"===b?c="/gp/buy/addressselect/handlers/display.html":"shiptomultiple"===b&&(c=f.addQueryStringParameter("/gp/ordering/checkout/item/select.html","useCase","multiAddress"));c&&(e.show(),c=f.addQueryStringParameter(c,"ref",a),c=f.addQueryStringParameter(c,"hasWorkingJavascript","1"),k.location.href=c+d)}}function p(a){if(a&&a.target){var b=h(a.target),c=parseInt(b.closest("li").data("goto"),10),d=h(a.target).closest(".select-address-main"),e=d.find(".select-address-page").filter(function(){return"template"!==
h(this).data("addresspage")}).length;d.find(".select-address-page:visible").fadeOut(300,function(){var a=A(c,e,p);d.find(".popover-pagination").remove();a.appendTo(d).show();d.find("div").filter(function(){return h(this).data("addresspage")===c}).fadeIn(300)})}}function A(a,b,c){var d=h("div[data-pagination\x3d'template']").clone().attr("data-pagination","copy"),e=d.find(".pagination-next-disabled"),g=a-1;0>g&&(g=0);var G=g+2;G>=b&&(G=b-1,g=G-2,0>g&&(g=0));3>g&&(g=1);4>b-G&&(G=b-2);e.before(h("\x3cli\x3e").addClass("pagination-link").data("goto",
0).html("\x3ca\x3e1\x3c/a\x3e").attr("tabindex",0));for(2<g&&e.before(h("\x3cli\x3e").addClass("a-disabled").html("..."));g<=G;g++)e.before(h("\x3cli\x3e").addClass("pagination-link").data("goto",g).html("\x3ca\x3e"+(g+1)+"\x3c/a\x3e").attr("tabindex",0));3<b-G&&e.before(h("\x3cli\x3e").addClass("a-disabled").html("..."));e.before(h("\x3cli\x3e").addClass("pagination-link").data("goto",b-1).html("\x3ca\x3e"+b+"\x3c/a\x3e").attr("tabindex",0));0<a&&(d.find(".pagination-previous-disabled").hide(),d.find(".pagination-previous-enabled").addClass("pagination-link").data("goto",
a-1).attr("tabindex",0).show());a<b-1&&(e.hide(),d.find(".pagination-next-enabled").addClass("pagination-link").data("goto",a+1).attr("tabindex",0).show());d.find("li.pagination-link").filter(function(){return h(this).data("goto")===a}).removeClass("pagination-link").addClass("a-selected");b=d.find(".pagination-link");b.bind("click",c);f.bindActionEnterKeyOnButton(b);return d}function K(){return"template"===h(this).data("addresspage")}function Q(){return"template"===h(this).data("addressrow")}function L(){return"template"===
h(this).data("newaddressslot")}function R(){return"template"===h(this).data("addressslot")}function M(){return"template"===h(this).data("addressgroup")}function S(a,b,c){var d=h("#shipping-address-popover .address-book").filter(M).clone().data("addressgroup","copy").show();d.find("h4").html(b);d.find(".popover-address-book-container").html(a.contents());c&&d.find(".popover-address-book-container").removeClass("a-padding-base");return a.empty().prepend(d)}function N(a,b,c,d,g,G,w,l){b.find(".select-address-page").filter(function(){return"template"!==
h(this).data("addresspage")}).remove();for(var p=0,r=0,X=0,n=0,q,E=!1,k=function(){h(this).height()>n&&(n=h(this).height())},B=0;p<=a.length;B++){for(var A=b.find(".select-address-page").filter(K).clone().data("addresspage",B),v=0;v<c&&p<=a.length;v++){var D=A.find(".select-address-row").filter(Q).clone().data("addressrow","copy").show();p<a.length&&a[p].addressBook&&(q=a[p].addressBook);for(var m=0;m<d&&p<=a.length;m++){var F;if(p===a.length)F=D.find(".select-address-slot").filter(L).clone().data("newaddressslot",
"copy").show(),q&&F.find(".add-address-button").width(170),!0===l&&F.hide();else{if(q&&a[p].addressBook!==q)continue;F=D.find(".select-address-slot").filter(R).clone().data("addressslot","copy").show();F.find(".select-address-slot-content").append(a[p].html);u.enhanceWithDeliverTo(F);F.unbind("deliverTo-slotSelected").bind("deliverTo-slotSelected",function(){h(this).find(".select-address-button a").click()});a[p].isInvoiceAddress&&F.append(F.find(".invoice-address-note").clone().show());var U={seturl:g,
setargs:a[p].setArgs+"\x26index\x3d"+p,callerType:G,errorhandler:w,popoverdiv:b.closest(".address-popover")},z;z=a[p].isSelected?F.find(".use-current-address-button"):F.find(".use-different-address-button");a[p].isSuggestedPUP?function(a){z.unbind("click").bind("click",function(){e.show()}).show().find("a").attr("href",a)}(a[p].insertUrl):z.unbind("click").bind("click",U,H).show();f.bindActionEnterKeyOnButton(z)}m===d-1&&F.addClass("a-span-last");D.append(F);p++}v===c-1&&D.addClass("a-spacing-base");
q&&(p<a.length&&a[p].addressBook!==q||v===c-1&&!E?D=S(D,q,!1):E=!0);A.find("div:first").append(D)}r++;E&&(A=S(A,q,!0),E=!1);b.append(A);A.show();b.height()>parseInt(b.css("min-height"),10)&&b.css("min-height",b.height());A.height()>X&&b.find(".select-address-page").css("min-height",A.height());A.find(".select-address-slot-content").each(k);X=A.height();A.hide()}b.find(".select-address-slot-content").height(n);h(".screenreader-address-span").each(function(){var a=h(this);a.text(" "+a.closest(".select-address-slot").find("li.displayAddressAddressLine1").text())})}
function H(a){var b,g,f;a&&a.data&&a.data.seturl&&a.data.setargs&&a.data.callerType&&a.data.errorhandler&&(b=a.data.seturl,g=a.data.setargs,f=a.data.callerType);e.show();var G=h("input[name\x3duseCtb]").val();g=g+"\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+G+"\x26responsive\x3d1";a=h("input#deliver-to-input").add(h(a.currentTarget).closest(".select-address-slot").find("input.deliverToNewInput"));a.length&&(g+="\x26deliverTo\x3d"+a.val());a={"x-amz-checkout-page":"spc"};
h("#passAjaxRequestHeader").length&&(a["x-amz-checkout-transition"]="ajax");T({type:"POST",url:b,data:g,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded;charset\x3dutf-8",headers:a,success:function(a,b,g){"shipping"===f?g.getResponseHeader("x-amz-checkout-page")?(h(".a-button-close").trigger("click"),d.ajaxUpdatePage(a,b,g)):(a=c.jsonify(a))&&a.isSameAddress?(e.hide(),h(".a-button-close").trigger("click"),a.requestid&&(w.setAsyncRequestId(a.requestid),w.sendUEPageLoadStats())):
(m(),d.redirect(a)):"billing"===f&&r(a,b,g)},error:function(a,b,c){d.ajaxRedirect(a,b,c)}})}function O(){D.initialized&&setTimeout(function(){var a=h("#shipping-address-popover .select-address-main");a.css("minHeight",D.shippingAddressPopoverMinHeight).find(".select-address-page").css("minHeight",D.selectAddressPageMinHeight);a.closest(".address-popover").find(".address-popover-sidebar").show()},300);D.modifiedForCampus=!1}function T(a){if(F){P&&P.abort();var b=a.success;a.success=function(a,c,d){P=
null;b&&"function"===typeof b&&(console.log("Success"),b(a,c,d))};var c=a.error;a.error=function(a,b,d){P=null;console.log("Error");"abort"!==b&&c&&"function"===typeof c&&c(a,b,d)}}P=h.ajax(a)}function y(a,b){if(a){b=b||0;G=["Starting spinner monitor"];var c=a.attr("id");I(c);U(c,function(){I(c);var d="none"!==h(".a-popover-modal").css("display"),e=0<a.children(".loading-spinner").length;d&&e&&(d=1E4+b,d="Popover Modal ("+a.attr("id")+") is still waiting after "+d/1E3+" secs. Current status is: "+
G,f.logError(d))},1E4)}}function V(a){a&&(a=a.attr("id"),I(a))}function I(a){X[a]&&(clearTimeout(X[a]),delete X[a])}function U(a,b,c){b=setTimeout(b,c);X[a]=b}var h=a.$;if(!h("html").hasClass("a-ie6")){var E=!1;if(!h("html").hasClass("a-touch")){var D={initialized:!1,modifiedForCampus:!1,shippingAddressPopoverMinHeight:0,selectAddressPageMinHeight:0},F=!1;a.declarative("search-locker",["click","touchend"],function(){if(!f.protectAgainstDoubleAction("search-locker")){var a=h("input[name\x3d'searchLockerFormAction']").val();
if(a){e.show();var b='\x3cform name\x3d"searchLockerForm" action\x3d"'+a+'" method\x3d"POST"\x3e';h("#popover-store-pickup-search-spc input").each(function(){b+='\x3cinput name\x3d"'+h(this).attr("name")+'" value\x3d"'+h(this).val()+'" type\x3d"hidden" /\x3e'});b+='\x3cinput name\x3d"hasWorkingJavascript" value\x3d"1" type\x3d"hidden" /\x3e';b+="\x3c/form\x3e";a=h(b);h("body").append(a);a.submit()}}});a.on("a:popover:hide:billing-address",function(){E=!1});a.on("a:popover:hide:shipping-address",function(){E=
!1;D.modifiedForCampus&&O()});a.on("a:popover:beforeShow:shipping-address",function(a){if((a=a&&a.popover?a.popover.data:void 0)&&!0===a.returnCampusAddressesOnly){a=h("#shipping-address-popover .select-address-main");var b=a.closest(".select-address-main");a.closest(".address-popover").css("minWidth",b.width()).find(".address-popover-sidebar").hide();D.modifiedForCampus=!0;!1===D.initialized&&(D.shippingAddressPopoverMinHeight=a.css("minHeight"),D.selectAddressPageMinHeight=a.closest(".address-popover").find(".select-address-page").css("minHeight"),
D.initialized=!0);a.css("minHeight","").find(".select-address-page").css("minHeight","")}else D.modifiedForCampus=!1});a.on("a:popover:show:shipping-address",function(a){E=!0;b.showSpinner(h("#shipping-address-popover"),!1);y(h("#shipping-address-popover"));G.push("Shipping-Address: Executing AJAX request");T({type:"POST",url:"/gp/buy/pipeline/handlers/shipping-address-select-content.html",dataType:"text",dataFilter:function(a){return c.jsonify(a)},data:a&&a.popover?a.popover.data:void 0,async:!0,
cache:!1,headers:{"x-amz-checkout-page":"spc"},success:v,error:d.ajaxRedirect})});a.on("a:popover:show:billing-address",function(a){E=!0;b.showSpinner(h("#billing-address-popover"),!1);y(h("#billing-address-popover"));G.push("Billing-Address: Executing AJAX request");T({type:"POST",url:"/gp/buy/pipeline/handlers/billing-address-select-content.html",dataType:"text",dataFilter:function(a){return c.jsonify(a)},async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},success:q,error:d.ajaxRedirect})});
a.on("checkout:reload:spc",n);var P,G=[],X={}}}});"use strict";m.when("A").register("thirdparty-redirect-popover-controller",function(a){function b(){k.history&&k.history.pushState?f(document).delegate("span.place-your-order-button-span","click",function(a){a.preventDefault()}):(f("span.place-your-order-button-span").removeClass("a-declarative"),f("input.place-your-order-button").parents("span.a-button-primary").addClass("place-order-button-link"))}function e(a){var b=f(a);0<b.filter("#thirdpartyform-headless").length?
(f("#spc-desktop").append('\x3cdiv id\x3d"thirdparty-redirecting-hidden-form" style\x3d"display:none"\x3e\x3c/div\x3e'),f("#thirdparty-redirecting-hidden-form").append(b),f("#thirdpartyform-headless").submit()):(k.history.pushState({state:"pushed-thirdparty-submit"},null,f("#spc-form").attr("action")),b=document.open(),b.write(a),b.close(),k.onpopstate=function(a){null===a.state&&k.location.reload()})}function d(a){f("#spc-form").submit()}function c(a){g&&g.abort();var b=a.success;a.success=function(a,
c,d){g=null;b&&"function"===typeof b&&b(a,c,d)};var c=a.error;a.error=function(a,b,d){g=null;"abort"!==b&&c&&"function"===typeof c&&c(a,b,d)};g=f.ajax(a)}var f=a.$;a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b);a.on("a:popover:show:thirdparty-redirecting",function(a){a=f("#spc-form");a.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a.append("\x3cinput type\x3d'hidden' name\x3d'headlessForm' value\x3d'1' /\x3e");c({type:"POST",url:a.attr("action"),
data:a.serialize(),async:!0,cache:!1,success:e,error:d})});var g});"use strict";m.when("A","order-summary-controller","inline-expander","client-side-metrics").register("order-summary-controller-mpp",function(a,b,e,d){var c=a.$,f=k.P&&k.P.AUI_BUILD_DATE;a.on("checkout:reload:spc",function(){b.initOrderSummary();var a=c("#exchange-rate-link"),w=c("#switch-currency-link");if(!f){d.increaseCount("removeauijs67");if(c("html").hasClass("a-touch"))w.unbind("click").bind("click",function(a){e.toggleExpander(c(a.currentTarget))}),
a.unbind("click").bind("click",function(a){e.toggleExpander(c(a.currentTarget))});else{var u=c("#spc-order-summary");u.find(".regulatory-fee-link").removeAttr("href").attr("tabindex",0);u.find(".vat-breakdown-link").removeAttr("href").attr("tabindex",0)}e.toggleExpander(w);e.toggleExpander(a)}})});"use strict";m.when("A","page-transition-controller","page-conductor").register("pallet-delivery-controller",function(a,b,e){function d(a,c,d){if(d.getResponseHeader("x-amz-checkout-pallet-warning"))b.hide(),
f(".pallet-delivery-update").hide(),f(".pallet-delivery-display").show(),f(".pallet-delivery-warning-display").show();else{if(d.getResponseHeader("x-amz-checkout-page"))return e.ajaxUpdatePage(a,c,d);e.redirect(a)}}function c(a,c,d){d.getResponseHeader("x-amz-checkout-pallet-warning")?(b.hide(),f(".pallet-delivery-disclaimer-mobile").hide(),f(".pallet-delivery-warning-mobile").show()):e.redirect(a)}var f=a.$;f("html").hasClass("a-ie6")||(a.declarative("pallet-delivery-update","click",function(a){a=
a.$currentTarget.closest(".pallet-delivery-block");var b=a.find("input[type\x3d'radio']:checked").val();a.data("selection",b);a.find(".pallet-delivery-display").hide();a.find(".pallet-delivery-update").show()}),a.declarative("pallet-delivery-select","click",function(a){var b=a.$currentTarget;a=a.$target;var c=b.find("input[type\x3d'radio']"),b=b.closest(".pallet-delivery-block"),d=b.data("selection")!==c.val();d||(b.find(".pallet-delivery-update").hide(),b.find(".pallet-delivery-display").show());
a.is(c)||(c.attr("checked",!0),d&&c.change())}),a.declarative("pallet-delivery-select","change",function(a){var c=a.$currentTarget.find("input[type\x3d'radio']");a=a.data.addressId;c=c.attr("value");b.show();c="cachebuster\x3d"+(new Date).getTime()+"hasWorkingJavascript\x3d1\x26addressId\x3d"+a+"\x26palletDelivery\x3d"+c;a=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});f.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-pallet-delivery.html/ref\x3dox_spc_set_pallet_delivery",data:c,dataType:"text",
async:!0,cache:!1,headers:a,success:d,error:e.ajaxRedirect})}),a.declarative("show-pallet-delivery-disclaimer-mobile","click",function(a){f(".pallet-delivery-disclaimer-mobile").show();f(".pallet-delivery-warning-mobile").hide()}),a.declarative("hide-pallet-delivery-disclaimer-mobile","click",function(a){f(".pallet-delivery-disclaimer-mobile").hide();f(".pallet-delivery-warning-mobile").hide()}),a.declarative("set-pallet-delivery-preference-mobile","click",function(a){a=a.data.addressId;var d=f('input[name\x3d"pallet-delivery-option"]:checked').val();
b.show();a="cachebuster\x3d"+(new Date).getTime()+"hasWorkingJavascript\x3d1\x26addressId\x3d"+a+"\x26palletDelivery\x3d"+d;d=e.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});f.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-pallet-delivery.html/ref\x3dox_spc_m_set_pallet_delivery",data:a,dataType:"text",async:!0,cache:!1,headers:d,success:c,error:e.ajaxRedirect})}))});"use strict";m.when("A","page-detector").register("time-preferences-controller",function(a,b){function e(a){a=f(a.target).closest("a");
var b=a.next(".time-preferences-options-list");b.is(":hidden")?(a.find(".time-pref-title").hide(),a.find(".time-pref-title-expanded").show(),b.slideDown("fast")):(a.find(".time-pref-title-expanded").hide(),a.find(".time-pref-title").show(),b.slideUp("fast"))}function d(a){var b=f(a.target);a=b.closest(".time-preferences-options-list").prev(".time-preferences-link").find(".time-pref-title-details");g&&(a=b.closest(".a-expander-container").find(".time-pref-title-details"));b=b.closest(".time-preferences-option").find(".time-preference-label").text();
a.text(b)}function c(){if(0!==f("div.locale-cn").length&&f("html").hasClass("a-touch")){var a=f("#spc-orders");a.find(".time-preferences-option").unbind("click").bind("click",d);a.find(".time-preferences-link").unbind("click").bind("click",e)}}var f=a.$;if(!f("html").hasClass("a-ie6")){var g=k.P&&k.P.AUI_BUILD_DATE;a.on("checkout:reload",c)}});"use strict";m.when("A","page-detector").register("imb-controller",function(a,b){function e(){a.defer(function(){var a=d("#spc-imb").find(".imb-message-link");
0<a.length&&a.find("i.js-hide").remove()})}var d=a.$;if(!d("html").hasClass("a-ie6"))a.on("checkout:reload:spc",e)});"use strict";m.when("A","fast-track-controller","page-detector").register("carrier-details-controller",function(a,b,e){function d(){a.defer(function(){f("#spc-reservation-countdown").length&&c()})}function c(){var a=f("#spc-reservation-countdown");if(a.length){var c=a.data("secondsLeft"),d=function(c,e){c--;if(0>=c)e.find(".cn-wireless-notice-js").hide(),e.find(".cn-wireless-expired-message").show();
else{var f=b.getFastTrackCountdown(c,a);e.find("span[data-field\x3d'countdown']").html(f);e.find(".cn-wireless-notice-js").show();e.find(".cn-wireless-expired-message").hide();setTimeout(function(){d(c,e)},1E3)}};d(c,a)}}var f=a.$;f("html").hasClass("a-ie6")||(a.on("a:popover:beforeShow:simcard",function(a){a.popover.$popover.find(".popover-content").html(f("#carrier-sim-card-details").html());a.popover.updatePosition()}),a.on("checkout:reload:spc",d))});"use strict";m.when("A","checkout-buttom-sheet-controller",
"client-side-metrics").execute(function(a,b,e){a.on("a:sheet:beforeShow:assuranceWidget",function(a){e.increaseCount("Checkout:assuranceWidget:WidgetClicked");b.disablePageScrolling()});a.on("a:sheet:afterShow:assuranceWidget",function(a){e.increaseCount("Checkout:assuranceWidget:BottomSheetShown")});a.on("a:sheet:afterHide:assuranceWidget",function(a){b.enablePageScrolling();e.increaseCount("Checkout:assuranceWidget:BottomSheetClosed")})});"use strict";m.when("A","page-transition-controller","checkout-general-utils",
"address-utilities","client-side-metrics","deliver-to").register("as-controller",function(a,b,e,d,c,f){function g(a){a=a.find("input[type\x3d'checkbox']");0<h(".checkout-as-mobile").length?w(a):0<h(".checkout-as-tablet").length&&u(a)}function w(a){var b=k.P&&k.P.AUI_BUILD_DATE,d=a.closest(".address-book-entry").find(".ship-to-this-link-area"),e=d.find(".a-button"),f=d.find("a");0>=a.length||a.is(":checked")?(e.removeClass("a-button-disabled"),b?(a=d.find(".ship-to-this-link-value"),f.attr("href",
a.text())):(c.increaseCount("removeauijs24"),f.attr("href",f.data("select-locker-url")))):(e.addClass("a-button-disabled"),f.removeAttr("href"))}function u(a){var b=h("#ship-to-this-link-area"),c=b.find(".a-button"),b=b.find("input[type\x3d'submit']");0>=a.length||a.is(":checked")?(c.removeClass("a-button-disabled"),b.prop("disabled",!1)):(c.addClass("a-button-disabled"),b.attr("disabled",!0))}function n(a){a.find("div.enter-address-form form").find("input.a-form-error, select.a-form-error").filter(function(){return 0===
h(this).parents().filter(".enhanced-input").length}).closest(".a-input-text-wrapper").addClass("a-form-error")}function C(a){a=a.find("div.enter-address-form form");a.find(".enhanced-input .enterAddressFormInputError").addClass("a-form-error");a.find(".enhanced-input input.a-form-error, .enhanced-input select.a-form-error, .enhanced-input label.a-form-error").each(function(){h(this).parents(".a-input-text-wrapper").last().addClass("a-form-error")})}function z(a){var b=a.siblings("div.a-input-text-wrapper").andSelf();
b.siblings().unwrap();a.removeClass("a-input-text-wrapper");for(var c=h(),b=b.first();b.length;b=b.parent().nextAll("div.a-input-text-wrapper:first"))if(b.hasClass("a-input-text-wrapper")){var d=b.nextUntil(":not(.a-input-text-wrapper)").andSelf();d.wrapAll("\x3cdiv class\x3d'a-input-text-group'\x3e\x3c/div\x3e");1===d.length&&(c=c.add(b))}c.unwrap();a=a.closest("form");a.find(".a-input-text-group").siblings("div").andSelf().addClass("a-spacing-base");a.find(".a-touch-select").addClass("a-spacing-mini")}
function r(a){a.find("#identity-add-new-address select.#enterAddressCountryCode").closest(".a-input-text-wrapper").each(function(){var a=h(this),b=h(this).closest("form").find("#address-country-container");a.appendTo(b).removeClass("a-input-text-wrapper").addClass("a-spacing-medium")});a=a.find("#identity-add-new-address .a-input-text-wrapper:has(.a-touch-select), #identity-add-new-address .a-input-text-wrapper:has(.javascript-unwrap-row)").not(":has(.enhanced-input)");z(a)}function B(a){var b=a.find(".store-results-list"),
c=b.siblings(":not(script)");h(k).unbind("resize.store-results").bind("resize.store-results",function(){q(b,c)});q(b,c)}function q(a,b){var c=h(k).height();b.each(function(){c-=h(this).outerHeight()});a.height(c)}function v(a){a.undelegate("div.address-book-entry","click.resultToMapBinding").delegate("div.address-book-entry","click.resultToMapBinding",function(){var a=h(this);a.hasClass("address-book-entry")||(a=a.closest("div.address-book-entry"));0!==a.length&&(a=a.index("div.address-book-entry"),
k.Map&&k.Map.selectPin&&k.Map.selectPin(a))});a.find("label.a-touch-radio a.a-button").unbind("click.checkout-as").bind("click.checkout-as",function(a){b.show();a.stopPropagation()})}function l(a){k.Map&&k.Map.registerPinClickCallback&&k.Map.registerPinClickCallback(function(b){var c=a.find("div.store-results-list");b=c.find("div.address-book-entry:eq("+b+")");b.find(".a-control-row").trigger("activate.checkout-pagination").trigger("click",["preventAddressSelectionChangedTrigger"]);b=b.position().top;
var d=c.scrollTop();c.animate({scrollTop:d+b+"px"})})}function p(a){k.mapBubbleButtonClicked=function(c){c=h(c).data("storeid");c=a.find("div.store-results-list").find("div.address-book-entry:eq("+c+")").find(".a-button").attr("href");b.show();e.redirectWithJavascript(c)}}function A(a){a.find("form.controlEnterKeyFormSubmission").find("input[type\x3d'text']").unbind("keypress.controlEnterKeyFormSubmission").bind("keypress.controlEnterKeyFormSubmission",function(a){if(a.which&&13===a.which||a.keyCode&&
13===a.keyCode){if(a=h(this).closest("form").find("button[type\x3d'submit'], input[type\x3d'submit']"),a.length)return a.click(),!1}else return!0})}function K(a){a.find("form.controlEnterAddressForm").find("input[type\x3d'text']").unbind("keypress.controlEnterAddressForm").bind("keypress.controlEnterAddressForm",function(a){return(a.which&&13===a.which||a.keyCode&&13===a.keyCode)&&0<h(this).closest("div").next().length?(e.moveToNextInput(h(this).closest("div")),!1):!0})}function Q(a){m.when("checkout-pagination").execute(function(b){b.initializePagination(a.find("div.checkout-pagination-container"));
a.find(".a-icon-touch-radio-active").closest(".checkout-pagination-item").trigger("activate.checkout-pagination")})}function L(){var a=h("div.checkout-as-tablet");a.length&&(a.hasClass("checkout-as-store-search-results")&&(M(a),B(a),v(a),l(a),p(a),a.find("div.store-opening-hours br").replaceWith(",\x26nbsp;")),Q(a),r(a),a.find("div.address-options div.address-feature div.a-expander-content[aria-expanded\x3dfalse]").css({display:"none"}),n(a),C(a),S(a),A(a),d.countrySpecificLabelOptimizationCheck(a),
m.when("tablet-address-select-controller").execute(function(){a.find("div.address-book-entry").find(".a-icon-touch-radio-active").closest("label.a-declarative").trigger("click")}))}function R(a){a.find("input[type\x3d'hidden']").each(function(){h(this).appendTo(h(this).closest("form"))})}function M(a){a.undelegate("click.as").delegate(".addr-display","click.as",function(b,c){b=h(this).closest(".a-box");0===b.length&&(b=h(this).closest(".address-book-entry"));if(!b.hasClass("active-box")){var d=a.find(".active-box");
d.removeClass("active-box").addClass("inactive-box");d.find("i").removeClass("a-icon-touch-radio-active");d.find("i:not('.locker-restriction-reminder')").addClass("a-icon-touch-radio-inactive");b.removeClass("inactive-box").addClass("active-box");"preventAddressSelectionChangedTrigger"!==c&&b.trigger("address-selection-changed");a.hasClass("checkout-as-store-search-results")&&g(b)}});var b=a.find(".address-book-entry:has(input[type\x3dradio]:checked)");b.trigger("click");a.hasClass("checkout-as-store-search-results")&&
g(b)}function S(a){m.when("a-form-controls").execute(function(){a.find("select.a-touch-select-input").each(function(){var a=h(this);""!==a.val()&&"--"!==a.val()&&a.change()})})}function N(a){var b=h("input#deliver-to-input").val();if(0<b.length){var c=h(a.currentTarget).attr("href");h(a.currentTarget).attr("href",c+"\x26deliverTo\x3d"+encodeURIComponent(b))}}function H(){var a=h("div.checkout-as-mobile");a.length&&(k.P&&k.P.AUI_BUILD_DATE?(R(a),r(a),d.countrySpecificLabelOptimizationCheck(a),C(a),
y(a),a.hasClass("checkout-as-store-search-results")&&(a=h(".address-book-entry:has(input[type\x3dradio]:checked)"),0<a.length&&g(a))):(c.increaseCount("removeauijs25"),R(a),n(a),C(a),M(a),r(a),S(a),d.countrySpecificLabelOptimizationCheck(a),K(a),y(a),A(a)))}function O(){var a=h("div.checkout-as-desktop");a.length&&d.countrySpecificPopoverOptimizationCheck(a)}function T(a){c.increaseCount("checkout:access-point:"+a,1)}function y(b){E=b.find("div[id$\x3d'-country']");F=b.find("div[id$\x3d'-pickup-type']");
E.length&&F.length&&V(E,F);a.declarative("country-filter-pickup-point","change",function(a){E.length&&F.length&&V(E,F)})}function V(a,b){D=a.find("select[name\x3dcountry]");P=b.find("select[name\x3dpickupType]");if(D.length&&P.length){var c=D.find("option:selected");a=P.find("option[value!\x3d'All']");c=P.find("option."+c.attr("data-pickuptypeclass"));c.length?(a.hide(),c.show(),P.prop("disabled",!1),P.val("All").change(),b.show()):b.length&&P.length&&(P.prop("disabled","disabled"),b.hide())}}function I(){L();
H();O();h("div.checkout-as input[placeholder]").each(function(){var a=h(this).attr("placeholder"),a=h("\x3cdiv /\x3e").html(a).text().replace(":","");h(this).attr("placeholder",a)});h("div.checkout-as #newShippingAddressFormFromIdentity span.field-description, #locker-find span.field-description").each(function(){var a=h(this),b=a.closest("div.one-new-address-form-field, label").find("input, select, textarea");!(0<a.find("a[href]").length||0===b.length)&&"placeholder"in b[0]&&(b.attr("placeholder",
a.text()),a.remove())});h("html.checkout-as-mobile div.displayAddressDiv ul.displayAddressUL, div.checkout-as-tablet div.displayAddressDiv ul.displayAddressUL").bind("touchend",function(a){});(function(){var a=h("div.checkout-as #searchLockerByLocationButton");a.unbind("enable").bind("enable",function(){h(this).removeClass("a-button-disabled").removeAttr("disabled")}).unbind("disable").bind("disable",function(){h(this).addClass("a-button-disabled").attr("disabled",!0)});if(navigator&&navigator.geolocation&&
navigator.geolocation.getCurrentPosition){a.text();a.data("labelActive");a.data("labelSuccess");a.find(".a-button-text");var c=a.data("submit-url");a.click(function(d){d.preventDefault();var e=h("\x3cdiv id\x3d'turbo-checkout-bottom-sheet' class\x3d'aok-hidden'\x3e\x3c/div\x3e");a.append(e);var f=h("div.checkout-as #clientSideLockerFindErrorIMB").hide().removeClass("hidden").find(".hidden").removeClass("hidden").hide().end();navigator.geolocation.getCurrentPosition(function(d){e.remove();var f=a.closest("form"),
g=c?c:f.attr("action");f.attr("action",g);f.append(h("\x3cinput type\x3d'hidden' /\x3e").attr("name","latitude").attr("value",d.coords.latitude));f.append(h("\x3cinput type\x3d'hidden' /\x3e").attr("name","longitude").attr("value",d.coords.longitude));f.append(h("\x3cinput type\x3d'hidden' /\x3e").attr("name","isGeolocalisationButtonClicked").attr("value",1));b.showPageTransition();f.submit()},function(b){e.remove();a.closest("div.checkout-as-mobile, div.checkout-as-tablet").length?alert(f.find("p.e"+
b.code).text()):f.show().find("p.e"+b.code).show()},{maximumAge:12E4,timeout:1E4})})}else a.hide()})();(function(){h("div.checkout-as-mobile form#locker-find").submit(function(a){a=h(this).find("#locker-find-search-field");var c=h(this).find("#locker-find-inline-alert"),d=h("div.checkout-as-mobile #locker-find-error-imb");a.closest("form");var e=h(this).find("input[name\x3d'latitude']").attr("value"),f=h(this).find("input[name\x3d'longitude']").attr("value"),g=0<a.val().trim().length;c.removeClass("aok-hidden").addClass("aok-hidden");
a.parent().removeClass("a-form-error");if(e&&f)return!0;if(g)return b.showPageTransition(),!0;d&&d.remove();a.parent().removeClass("a-form-error").addClass("a-form-error");c.removeClass("aok-hidden");return!1})})();(function(){h.support.ajax&&h("div.checkout-as a.a-button-text[href], div.checkout-as a.a-button[href], div.checkout-as a.js-add-working-javascript[href]").each(function(){0<h(this).attr("href").indexOf("?")&&h(this).attr("href",h(this).attr("href")+"\x26hasWorkingJavascript\x3d1")})})();
(function(){h("div.checkout-as .enter-address-form").not(".hidden").find("div.a-alert-error").addClass("js-originally-shown-imb");h("div.checkout-as a.js-switch-form").click(function(a){a.preventDefault();a=h(this).closest(".enter-address-form");d.toggleAddressForm(a,a.siblings(".enter-address-form"))})})();(function(){m.when("A").execute(function(a){a.declarative("switch-store-results-display",["click"],function(a){if(a.data&&a.data.showDiv){var b=h(a.data.showDiv);0!==b.length&&(a.$declarativeParent.addClass("a-button-selected").siblings(".a-button-selected").removeClass("a-button-selected"),
b.show(),b.siblings("div").hide())}})})})();(function(){m.when("jQuery").execute(function(a){0!==a(".js-scroll-lock").length&&a(k).unbind("scroll.as").bind("scroll.as",function(){a(".js-scroll-lock").each(function(){var b=a(this),c=b.position().top,c=a(k).scrollTop()-c+10;0>=c||b.outerHeight()>a(k).height()?b.css({marginTop:"auto"}):b.css({marginTop:c})})})})})();(function(){h(".checkout-as div#deliver-to").length&&h("div#deliver-to").length?h(".ship-to-this-address").each(function(){h(this).find("a.a-button-text").unbind("click.deliver-to").bind("click.deliver-to",
N)}):h(".address-book-entry").each(function(){var a=h(this);f.enhanceWithDeliverTo(a);var b=a.find("div.ship-to-this-address a"),c=function(){var c=a.find("input");return c.length&&c.val()?e.addQueryStringParameter(b.attr("href"),"deliverTo",c.val()):b.attr("href")};a.unbind("deliverTo-slotSelected").bind("deliverTo-slotSelected",function(){b.click();document.location.href=c()});b.unbind("click.deliver-to").bind("click.deliver-to",function(){b.attr("href",c())})})})();h("li[data-a-tab-name\x3dpickupTab]").length&&
T("pickupTab:visible");if(0<h(".imb-autoscroll").length){var c=h(".imb-autoscroll:first").closest(".on-imb-scroll-here");c.length&&h("html, body").animate({scrollTop:c.offset().top},1E3)}h("#legacy-non-converged-locker-find").delegate("input[type\x3dtext], select","click change",function(a){h(this).closest("tr").find("input[type\x3dradio]").attr("checked",!0)});h("html").hasClass("a-lt-ie8")&&h("div.checkout-as-desktop input[type\x3d'text']").addClass("a-input-text");a.defer(function(){h(".screenreader-address-span").each(function(){var a=
h(this);a.text(" "+a.closest(".address-book-entry").find("li.displayAddressAddressLine1").text())})})}function U(b,d,e){a.$("#"+b).addClass("aok-hidden");a.$("#"+d).removeClass("aok-hidden");c.increaseCount("APCX:Checkout:AddressBook:unavailableLocationsIngress:"+e)}var h=a.$,E,D,F,P;a.declarative("select-address",["click"],function(a){a=h(".address-content input[type\x3dradio]:checked");a.length&&(a=a.data("addressSelect"))&&(b.showPageTransition(),e.redirectWithJavascript(a))});a.declarative("tap-to-field",
["click"],function(a){h(k).scrollTop(a.$declarativeParent.offset().top)});m.register("tablet-address-select-controller",function(){a.declarative("tablet-store-select-button",["click"],function(a){if(a=a.$currentTarget.closest("div.store-results-list").find("input[name\x3d'selectedStore']:checked").closest("label").data("selectThisStoreUrl"))b.show(),e.redirectWithJavascript(a)});a.declarative("tablet-checkout-cancel-address",["click"],function(a){a.$currentTarget.closest(".a-expander-container").find("a.a-expander-header").click();
h(document).scrollTop(0)});a.declarative("tablet-address-select",["click"],function(a){function b(a){a.addClass("a-button-disabled");a.find("input").attr("disabled",!0)}function c(a){a.removeClass("a-button-disabled");a.find("input").removeAttr("disabled")}var d=h("div.checkout-as-tablet"),e=d.find(".address-select-button"),d=d.find(".address-edit-button");a.data&&a.data.disableSelect?b(e):c(e);a.data&&a.data.disableEdit?b(d):c(d)})});a.declarative("edit-address",["click"],function(a){a=h(".address-content input[type\x3dradio]:checked");
a.length&&(a=a.data("addressEdit"))&&(b.showPageTransition(),e.redirectWithJavascript(a))});a.declarative("suggestion-edit-address",["click"],function(a){a=h("div.checkout-as-tablet #address-suggestion-form");if(a.length){var c=a.find("input[type\x3dradio]:checked");if(c.length){var c=c.val(),d=a.find("input#operationField");d.length&&(d.val(c),d.attr("name","edit_"+c),b.show(),a.submit())}}});a.declarative("refine-locker-search-results",["click"],function(a){var b=a.$currentTarget.closest("form");
b.find("#latitude").val(a.data.latitude);b.find("#longitude").val(a.data.longitude)});a.declarative("mobile-refine-locker-search-results",["click"],function(a){var c=a.$currentTarget,d=c.closest("form");d.find("#latitude").val(a.data.latitude);d.find("#longitude").val(a.data.longitude);c.find("input[type\x3dradio]").prop("checked",!0);b.show();d.submit()});a.declarative("mobile-store-results-back-button",["click"],function(a){b.show();k.history&&k.history.length&&0<k.history.length?(k.history.go(-1),
a.$event.preventDefault()):e.redirectWithJavascript(a.data.url)});a.declarative("suggestion-select-address",["click"],function(a){a=h("div.checkout-as-tablet #address-suggestion-form");if(a.length){var c=a.find("input[type\x3dradio]:checked");if(c.length){var c=c.val().replace(/^addr_/,""),d=a.find("input#operationField");d.length&&(d.val(c),d.attr("name","useSelectedAddress"),b.show(),a.submit())}}});a.declarative("tablet-checkout-delete-address",["click"],function(a){k.confirm(h("#addressConfirmDeletion").text())&&
(a=a.$currentTarget,b.showPageTransition(),e.redirectWithJavascript(a.attr("href")))});a.declarative("mobile-confirm-locker-restriction",["click"],function(a){w(a.$currentTarget.find("input[type\x3d'checkbox']"))});a.declarative("tablet-confirm-locker-restriction",["click"],function(a){u(a.$currentTarget.find("input[type\x3d'checkbox']"))});a.declarative("mobile-select-address",["change"],function(a){a=a.$currentTarget.closest("div.address-book-entry");if(!a.hasClass("active-box")){if(h("li[data-a-tab-name\x3ddeliverTab]").length&&
h("li[data-a-tab-name\x3dpickupTab]").length){var b=a.closest(".address-book");b&&b.find("div.address-book-entry.active-box").removeClass("active-box").addClass("inactive-box")}else h("div.address-book-entry.active-box").removeClass("active-box").addClass("inactive-box");a.removeClass("inactive-box").addClass("active-box");0<h("div.checkout-as-mobile").length&&g(a)}});a.declarative("pickup-tab-selected",["click"],function(a){T("pickupTab:clicked")});a.on("checkout:reload:shipaddressselect",I);a.on("checkout:reload:billingaddressselect",
I);a.on("checkout:reload:editaddress",I);a.on("checkout:reload:newaddress",I);a.on("a:expander:greyOutExpander:toggle:collapse",function(){U("ineligibleStoresExpandedHeading","ineligibleStoresCollapsedHeading","collapsed")});a.on("a:expander:greyOutExpander:toggle:expand",function(){U("ineligibleStoresCollapsedHeading","ineligibleStoresExpandedHeading","expanded")})});m.when("A").register("as-faf-controller",function(a){function b(){e("#faf-error-message").hide();e("#faf-content").hide();e("#faf-loading-image").show();
e.ajax({type:"GET",url:"/gp/gifting/add-friends-and-family.html?filter\x3d1",dataType:"html",cache:!1,timeout:1E4,success:function(a){e("#faf-loading-image").hide();e("#faf-content").show();e("#faf-content").html(a)},error:function(a){e("#faf-loading-image").hide();e("#faf-error-message").show()}})}var e=a.$;a.on("a:popover:show:add-friends-and-family",function(a){b()});a.on("checkout:reload:shipaddressselect",function(){e("div.checkout-as-desktop").delegate("#faf_retry","click",function(){b()})})});
m.when("A","page-transition-controller","page-conductor","checkout-general-utils").execute(function(a,b,e,d){var c=a.$;a.declarative("checkout-delete-address",["click"],function(a){a.$event.preventDefault();var g=0,w;a.data&&void 0!==a.data.targetAddress&&(g=1,w=a.data.targetAddress);var u=a.$declarativeParent.find("a[href]:first").attr("href");!u&&g&&(u=a.$declarativeParent.attr("href"));if(c("div.checkout-as-mobile").length&&!k.confirm(c("#addressConfirmDeletion").text()))return!1;b.show();c.ajax({dataType:"json",
url:u,success:function(n,k,m){var r;r=g?c("#"+w):a.$declarativeParent.closest(".address-book-entry");var B=r.parent();if(B.closest("div.checkout-as-mobile").length){if(r.removeClass("address-book-entry").addClass("deleted-address-book-entry"),n=r.find(".displayAddressDiv").text(),r.find(".a-box-inner").empty(),n=c("\x3cdiv class\x3d'a-box a-alert-inline a-alert-inline-success'\x3e\x3c/div\x3e").append("\x3cdiv class\x3d'a-box-inner'\x3e\x3ci class\x3d'a-icon a-icon-alert' /\x3e\x3cp class\x3d'deleted-address-alert-content'\x3e"+
n+"\x3cbr/\x3e"+c("#addressWasDeletedSuccess").text()+"\x3c/p\x3e\x3c/div\x3e"),r.find(".a-box-inner").append(n),n=r.prev(".address-book-entry.a-box"),0===n.length&&(n=r.next(".address-book-entry.a-box")),0===n.length&&!(0<c(".checkout.checkout-as .address-book-entry").length)){b.hidePageTransition();d.redirectWithJavascript(u);return}}else if(c("div.checkout-as-desktop").length){r.detach();var q=B.find("div.address-book-entry");q.length||e.ajaxUpdatePage(n,k,m);q.removeClass("address-book-new-row").filter(":nth-child(3n+1)").addClass("address-book-new-row");
c("div.checkout-as-desktop").trigger("checkout-as-recalculate-address-height")}r.is(".a-box.active-box")&&B.find(".address-book-entry.a-box.inactive-box:first").addClass("active-box").removeClass("inactive-box").find("input[type\x3d'radio']").attr("checked",!0).change().siblings("i.a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");g&&c(".a-button-close").trigger("click");b.hide()},error:function(){b.hidePageTransition();d.redirectWithJavascript(u)}})})});
m.when("A","a-expander","ready").register("as-tablet-controller",function(a){var b=a.$;a.on("checkout:reload:shipaddressselect",function(){if(b("div.checkout-as-tablet").length&&k.location.hash){var a=b(k.location.hash+".a-expander-header");"none"===a.siblings("div.a-expander-content").css("display")&&setTimeout(function(){a.trigger("click")},500)}})});m.when("A","safe-mash","page-detector").register("as-locker-mobile-controller",function(a,b,e){var d=a.$;a.on("checkout:reload:shipaddressselect",
function(){e.isMobileAddressSelect()&&a.defer(function(){if(!b||!b.showDeliveryDestinationPicker){var a=d("div.checkout-as-mobile").find("a.checkout-add-locker"),e=a.attr("href");e&&"#"!==e||a.hide()}})})});m.when("A","page-transition-controller","safe-mash","page-detector","checkout-general-utils","mash").register("as-mash-controller",function(a,b,e,d,c){var f=a.$;e.showDeliveryDestinationPicker&&f("div.checkout-as-mobile").find("a.checkout-add-locker").show();a.declarative("invoke-mash-store-picker",
["click"],function(a){if(e.showDeliveryDestinationPicker){var w;k.app&&k.app.willReappear&&(w=k.app.willReappear,delete k.app.willReappear);d.isTabletAddressSelect()&&a.$currentTarget.closest("div.a-expander-container").find("div.a-expander-content").remove();e.showDeliveryDestinationPicker({successCallback:function(a){var d="/gp/buy/storeaddress/handlers/select.html",d=c.addQueryStringParameter(d,"addressID",a.addressId),d=c.addQueryStringParameter(d,"requestToken",f("div.checkout-as").data("requestToken")),
d=c.addQueryStringParameter(d,"purchaseId",f("div.checkout-as").data("purchaseId"));b.show();k.setTimeout(function(){k.app&&w&&(k.app.willReappear=w);c.redirectWithJavascript(d)},650)},failCallback:function(a){k.app&&w&&(k.app.willReappear=w)}})}else 1<(a.$currentTarget.attr("href")||"").length&&c.redirectWithJavascript(a.$currentTarget.attr("href"))})});m.when("A","a-checkbox").execute(function(a,b){a.declarative("filter-available-locations",["click"],function(b){var d=a.$;b=b.$target.is(":checked");
clientMetrics.increaseCount("APCX:CheckoutMPP:filterAvailableLocations");b?d(".ineligible-store").hide():d(".ineligible-store").show()})});m.when("A","a-checkbox","ready").execute(function(a,b){var e=a.$,d=b("[id\x3d'filterLocationsMpp']");e('[id\x3d"filterLocationsMpp"]').change(function(){d.isChecked()?e(".ineligible-store").hide():e(".ineligible-store").show();var a=d.isChecked()?!1:!0;"undefined"!==typeof k.Map&&e(".ineligible-store").each(function(){var b=e(this).attr("data-store-display-number");
b&&(b=parseInt(b,10)-1,k.Map.togglePinVisibility(b,a))})})});m.when("A").execute("searchLevelAlert",function(a){var b=a.$;b(k);var e=b("#searchLevelMessage"),d=function(){0>e.height()-b(k).scrollTop()?e.removeClass("search-level-message-back-to-top").addClass("search-level-message"):e.removeClass("search-level-message").addClass("search-level-message-back-to-top")};b("#searchLevelMessage").length&&a.on.scroll(d)});m.when("A","page-transition-controller","checkout-general-utils","page-detector").execute(function(a,
b,e,d){function c(){if(d.isMobileAddressSelect()){var a=k.location.href,c=f(".active-box");if("undefined"!==typeof c)var u=c.data("store-id"),n=c.data("address-id"),m=c.data("search-latitude"),c=c.data("search-longitude"),a=e.addQueryStringParameter(decodeURIComponent(a),"selectedStoreId",u),a=e.addQueryStringParameter(decodeURIComponent(a),"optedStoreAddressId",n),a=e.addQueryStringParameter(decodeURIComponent(a),"latitude",m),a=e.addQueryStringParameter(decodeURIComponent(a),"longitude",c);a&&(b.showPageTransition(),
e.redirectWithJavascript(decodeURIComponent(a)))}}var f=a.$;a.on("toggle-preference-success",function(){c()});a.on("toggle-preference-failure",function(){c()});a.on("do-nothing-success",function(){c()})});m.when("A","checkout-general-utils","page-detector").execute(function(a,b,e){a.on("checkout:reload:shipaddressselect",function(){if(e.isMobile()){var b=a.$,b=b(".active-box");"undefined"!==typeof b&&1==b.data("redirect-from-accessibility")&&(b=b.offset().top,k.scrollTo(0,b))}})});m.when("A","ready").register("delivery-preference-widget-focus",
function(a){var b=a.$;a.on("checkout:reload:editaddress",function(a){b("#deliveryPreferenceScrollEnabled").length&&b("#deliveryPreferenceScrollEnabled").offset()&&b("html, body").animate({scrollTop:b("#deliveryPreferenceScrollEnabled").offset().top},"fast")})});"use strict";m.when("A","ready").register("address-autopopulate-fields-clear",function(){});"use strict";m.when("A","page-transition-controller").register("accesspoint-search-controller",function(a,b){var e=a.$;a.declarative("search-accesspoint-for-location",
["click"],function(a){navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition&&navigator.geolocation.getCurrentPosition(function(b){var f=a.data.url,g=e("#accesspoint-search-form");g.attr("action",f);g.append(e("\x3cinput type\x3d'hidden'/\x3e").attr("name","latitude").attr("value",b.coords.latitude));g.append(e("\x3cinput type\x3d'hidden'/\x3e").attr("name","longitude").attr("value",b.coords.longitude));g.submit()},function(a){a=e("#geolocation-error-strings").find(".e"+a.code).text();
alert(a)})});a.on("checkout:reload:accesspoint",function(){e("#legacy-non-converged-locker-find").delegate(".storesearchinput input,.storesearchinput select","click",function(a){e(this).closest(".storesearchinput").siblings().find("input[type\x3dradio]").click()})})});"use strict";m.when("A","checkout-general-utils","ready").register("delivery-preference-controller",function(a,b){function e(){return g("form.checkout-page-form").serialize()}function d(a){g(a).addClass("aok-hidden")}function c(){var a=
e();a!==m&&5>=n&&(a&&(a+="\x26"),g.ajax({type:"POST",url:"/gp/buy/deliverypreference/handlers/save.html",data:a+"returnjson\x3d1\x26isTrial\x3d1",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"deliverypreference"},complete:function(){}}),n++)}function f(){n=0;m=e();g("form.checkout-page-form").find("input[type\x3d'checkbox'],input[type\x3d'radio'],input[type\x3d'text'],select").unbind("change").change(c);u&&g("form.checkout-page-form").data("checkoutFormReady",!0).change()}var g=
a.$,k=g("input#isPipelinedPage"),u=0<k.length&&"1"===k.val(),n,m;a.declarative("select-delivery-preference-radio-button",["click","touchend"],function(a){b.protectAgainstDoubleAction("select-delivery-preference-radio-button")||a.$currentTarget.closest(".delivery-preference-option").find("input[type\x3d'radio']").trigger("click")});a.declarative("wini-radio-clicked","click",function(a){a=a.$target.context.value;"NeighborDelivery"===a?(d(".wini-safePlaceInput"),g(".wini-neighborInput").removeClass("aok-hidden")):
"SafePlaceDelivery"===a?(d(".wini-neighborInput"),g(".wini-safePlaceInput").removeClass("aok-hidden")):"NoSpecialDelivery"===a&&(d(".wini-neighborInput"),d(".wini-safePlaceInput"))});if(u)a.on("checkout:reload:deliverypreference",f)});"use strict";m.when("A").register("deliver-to",function(a){var b=a.$;return{enhanceWithDeliverTo:function(a){var d=b("#deliverToNew");if(d.length)var c=a.find(".displayAddressFullName"),f=c.text(),g=d.find(".deliverToNewChangeRecipientTemplate").clone().appendTo(c).click(function(){g.remove();
var b=d.find("input").clone().val(f);c.empty().append(b);b.focus()[0].setSelectionRange(0,f.length);b.keydown(function(c){13===c.which&&(b.blur(),a.trigger("deliverTo-slotSelected"))});return!1})}}});"use strict";m.when("A","weekend-availability-expander-helper").register("weekend-availability-expander-desktop",function(a,b){function e(a,b){return{isSaturdayChecked:d("#"+a).prop("checked"),isSundayChecked:d("#"+b).prop("checked")}}var d=a.$,c=!0,f=!0,g={"sat-sun-expander-header":{saturdayId:"sat-sun-availability-checkbox-sat",
sundayId:"sat-sun-availability-checkbox-sun"},"sat-sun-expander-header-domestic":{saturdayId:"sat-sun-availability-checkbox-sat-domestic",sundayId:"sat-sun-availability-checkbox-sun-domestic"}};return{init:function(){b.isBusinessDefaultWeekendDeliveryViewActive()&&(f=c=!1);a.declarative("sat-sun-availability-checkbox-change","change",function(a){a=e(a.data.satCheckboxId,a.data.sunCheckboxId);b.updateAllWeekendAvailabilityStates(a);var c=d("input[name\x3d'BusinessHours']").attr("value"),c=b.stateToCheckboxes(c);
d(".weekend-checkbox-sat").prop("checked",c.isSaturdayChecked);d(".weekend-checkbox-sun").prop("checked",c.isSundayChecked);b.updateAllTitles(a);b.updateAllOptOutMessages(a)});var k="expander"===d("input[name\x3d'weekendDeliveryDisplayType']").attr("value"),u=d("input[name\x3dshipToThisAddress]");u.length&&k&&u.closest("form").submit(function(a){b.logExpanderState("mpp","create",f,c)});u=d("input[name\x3dfromAddressEditToContinue]");u.length&&k&&u.closest("form").submit(function(a){b.logExpanderState("mpp",
"edit",f,c)});a.declarative("a-expander-toggle","click",function(a){a=a.$currentTarget;var d=a.attr("id");a.hasClass("sat-sun-expander-class")&&void 0!==g[d]&&(a=e(g[d].saturdayId,g[d].sundayId),b.updateAllWeekendAvailabilityStates(a),b.updateAllTitles(a),c=!c,f=!1)})}}});"use strict";m.when("A","delivery-preferences-csm-helper","checkout-general-utils","page-detector-current-page").register("mpp-delivery-preferences-controller",function(a,b,e,d){a.declarative("delivery-preferences-submit-button",
["click","touchend"],function(a){"deliverypreference"===d.getCurrentPage()&&(e.protectAgainstDoubleAction("delivery-preferences-submit-button",400)||b.recordCSMWithCurrentFieldValues("page-submitted","prefDelLocation","isDefaultPreference"))});a.on("checkout:reload:spc",function(){b.recordCSMForEligiblePages()});a.on("checkout:reload:deliverypreference",function(){b.recordCSMWithCurrentFieldValues("page-displayed","prefDelLocation","isDefaultPreference")})});"use strict";m.when("A","delivery-preferences-csm-helper",
"page-detector","page-detector-current-page","client-side-metrics").register("what-if-im-not-in-delivery-preferences",function(a,b,e,d,c){function f(){if(l)a.capabilities.history?k.history.back():m.when(v?"a-secondary-view":"a-popover-base").execute(function(a){a.get("what-if-im-not-in-form-popover").hide()});else{var b=q("#what-if-im-not-in-form-container").closest(".a-popover-wrapper");b.length&&b.find(".a-button-close").click()}}function g(){q('select[name\x3d"enterAddressCountryCode"]').val()!==
q("input[name\x3dcountryOrg]").val()?(q(".what-if-im-not-in-delivery-preferences-summary").hide(),z()):(q(".what-if-im-not-in-delivery-preferences-summary").show(),C())}function w(a,b){v?m.when("a-dropdown").execute(function(c){c.setValue(a.attr("id"),b)}):(c.increaseCount("removeauijs26"),a.find("option").removeAttr("selected"),a.find('option[value\x3d"'+b+'"]').attr("selected","selected"),a.siblings(".a-placeholder").text(a.find("option:selected").text()))}function u(a,b){v?m.when("a-checkbox").execute(function(c){c=
c("#"+a.attr("id"));b?c.check():c.uncheck()}):(c.increaseCount("removeauijs27"),b?a.attr("checked","checked"):a.removeAttr("checked"),a.siblings("i").removeClass("a-icon-touch-checkbox-"+(b?"inactive":"active")).addClass("a-icon-touch-checkbox-"+(b?"active":"inactive")))}function n(){var a=l&&"newaddress"===d.getCurrentPage(),c=!l&&!e.isTablet()&&"shipaddressselect"===d.getCurrentPage();(a||c)&&b.recordCSMForEligiblePages("address-form:")}function C(){var a=q("#what-if-im-not-in-form-container"),
b=q(".what-if-im-not-in-delivery-preferences-summary").closest("form"),c=a.find("input[name\x3dprefDelLocation]:checked").val();b.find('input[name\x3d"prefDelLocation"]').val(c);"NeighborDelivery"===c?(b.find('input[name\x3d"neighborName"]').val(a.find("input[name\x3dneighborName]").val()),b.find('input[name\x3d"houseNo"]').val(a.find("input[name\x3dhouseNo]").val())):"SafePlaceDelivery"===c&&b.find('input[name\x3d"safePlaceLocation"]').val(a.find("select[name\x3dsafePlaceLocation]").val());b.find('input[name\x3d"isDefaultPreference"]').val(a.find("input[name\x3disDefaultPreference]").is(":checked")?
"1":"0")}function z(){var a=q(".what-if-im-not-in-delivery-preferences-summary").closest("form");a.find('input[name\x3d"prefDelLocation"]').removeAttr("value");a.find('input[name\x3d"neighborName"]').removeAttr("value");a.find('input[name\x3d"houseNo"]').removeAttr("value");a.find('input[name\x3d"safePlaceLocation"]').removeAttr("value");a.find('input[name\x3d"isDefaultPreference"]').removeAttr("value")}function r(){n();q(".what-if-im-not-in-delivery-preferences-summary").length&&(g(),q('select[name\x3d"enterAddressCountryCode"]').change(function(){g()}))}
function B(a){a.$event.preventDefault();b.recordCSMWithCurrentFieldValues("embedded-in-address-form-submitted","prefDelLocation","isDefaultPreference");var d=q("#what-if-im-not-in-form-container"),e=d.find("input[name\x3dprefDelLocation]:checked").val();a=q("#what-if-im-not-in-form-container");a.find("input").removeClass("a-form-error");a.find("div.a-input-text-wrapper").removeClass("a-form-error");v?a.find("select").siblings(".a-button").removeClass("a-button-error"):(c.increaseCount("removeauijs28"),
a.find("select").closest(".a-button").removeClass("a-button-error"));a=!1;"NeighborDelivery"===e?(e=d.find("input[name\x3dneighborName]"),e.val()||(e.addClass("a-form-error"),e.closest(".a-input-text-wrapper").addClass("a-form-error"),a=!0),d=d.find("input[name\x3dhouseNo]"),d.val()||(d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),a=!0)):"SafePlaceDelivery"===e&&(d=d.find("select[name\x3dsafePlaceLocation]"),d.val()||(v?d.siblings(".a-button").addClass("a-button-error"):
(c.increaseCount("removeauijs29"),d.closest(".a-button").addClass("a-button-error")),a=!0));if(!a){z();C();d=q("#what-if-im-not-in-form-container");a=q(".what-if-im-not-in-delivery-preferences-summary").closest("form");var e=d.find("input[name\x3dprefDelLocation]:checked").val(),g,l;"NeighborDelivery"===e?(g=a.find("input[name\x3dneighborDeliveryLabel]").val(),l=d.find("input[name\x3dneighborName]").val(),d=d.find("input[name\x3dhouseNo]").val(),l=l+", "+d):"SafePlaceDelivery"===e?(g=a.find("input[name\x3dsafePlaceDeliveryLabel]").val(),
l=d.find("select[name\x3dsafePlaceLocation] option:selected").text()):"NoSpecialDelivery"===e&&(g=a.find("input[name\x3dnoSpecialDeliveryLabel]").val());g+=l?": "+l:"";q("#delivery-preference-label").text(g);g=q("#delivery-preference-link");g.length&&g.text(a.find("input[name\x3dchangeYourPreferenceLabel]").val());f()}}var q=a.$,v=k.P&&k.P.AUI_BUILD_DATE,l=e.isMobile();a.declarative("embedded-what-if-im-not-in-form","submit",B);a.declarative("what-if-im-not-in-mpp-popover","click",B);a.on("a:popover:show:what-if-im-not-in-form-popover",
function(){var a=q("#what-if-im-not-in-form-container"),c=q(".what-if-im-not-in-delivery-preferences-summary").closest("form"),d=c.find('input[name\x3d"prefDelLocation"]').val()||"";a.find("input[name\x3dprefDelLocation][value\x3d"+d+"]").click();a.find('input[name\x3d"neighborName"]').val(c.find("input[name\x3dneighborName]").val());a.find('input[name\x3d"houseNo"]').val(c.find("input[name\x3dhouseNo]").val());var d=a.find('select[name\x3d"safePlaceLocation"]'),e=c.find("input[name\x3dsafePlaceLocation]").val();
w(d,e);a=a.find('input[name\x3d"isDefaultPreference"]');u(a,"0"!==c.find("input[name\x3disDefaultPreference]").val());b.recordCSMWithCurrentFieldValues("embedded-in-address-form-displayed","prefDelLocation","isDefaultPreference")});a.on("checkout:reload:shipaddressselect",r);a.on("checkout:reload:newaddress",r)});"use strict";m.when("A","weekend-availability-expander-helper","a-secondary-view","client-side-metrics","a-checkbox").register("weekend-availability-secondary-view-mobile",function(a,b,e,
d,c){function f(){m=!0;var a=n("input[name\x3d'BusinessHours']").attr("value"),a=b.stateToCheckboxes(a);c("#weekend-availability-sat-checkbox").check(a.isSaturdayChecked);c("#weekend-availability-sun-checkbox").check(a.isSundayChecked);c("#weekend-availability-sat-checkbox-domestic").check(a.isSaturdayChecked);c("#weekend-availability-sun-checkbox-domestic").check(a.isSundayChecked);n(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0)}function g(a,b){return{isSaturdayChecked:c("#"+
a).isChecked(),isSundayChecked:c("#"+b).isChecked()}}function k(){return m&&z?"save":m?"back":"noView"}function u(a,b,c){var e=n("#hasUserDefinedValue").length?"userDefined":"notUserDefined";d.increaseCount("checkout:delivery-preferences:"+a+":secondaryView:"+b+":"+c+":"+e)}var n=a.$,m=!1,z=!1;return{init:function(){a.declarative("sat-sun-availability-checkbox-change","change",function(a){b.updateAllOptOutMessages(g(a.data.saturdayCheckboxId,a.data.sundayCheckboxId))});var c="secondaryView"===n("input[name\x3d'weekendDeliveryDisplayType']").attr("value"),
d=n("input[name\x3dshipToThisAddress]");d.length&&c&&d.closest("form").submit(function(a){u("mpp","create",k())});d=n("input[name\x3dfromAddressEditToContinue]");d.length&&c&&d.closest("form").submit(function(a){u("mpp","edit",k())});a.declarative("weekend-availability-secondary-view-save","click",function(a){var c=a.data;a=e.get(c.popoverName);null!==a&&void 0!==a&&(c=g(c.saturdayCheckboxId,c.sundayCheckboxId),b.updateAllWeekendAvailabilityStates(c),b.updateAllTitles(c),a.hide(),z=!0)});a.on("a:popover:beforeShow:weekend-availability-secondary-view",
f);a.on("a:popover:beforeShow:weekend-availability-secondary-view-domestic",f)}}});"use strict";m.when("A","page-detector").register("weekend-availability-loader",function(a,b){function e(){b.isMobile()?m.when("weekend-availability-secondary-view-mobile").execute(function(a){a.init()}):m.when("weekend-availability-expander-desktop").execute(function(a){a.init()})}a.on("checkout:reload:shipaddressselect",e);a.on("checkout:reload:editaddress",e);a.on("checkout:reload:newaddress",e)});"use strict";m.when("A",
"jQuery","gift-form-base-controller").register("gift-form-controller",function(a,b,e){a.on("checkout:gift:adaptCarousel",function(a){a=b("#giftwrap-carousel-wrap-holder-"+a);parseInt(a.css("left"),10);a.css("left",0)});a.on("checkout:gift:changeCarouselWrapOptions",function(a,c,e){"all"===c?b("#giftwrap-carousel-wrap-holder-"+e+" li").show():"GW"===c?(b("#giftwrap-carousel-wrap-holder-"+e+" li",b(a)).hide(),b(".gift-wrap",b(a)).show()):"noshi"===c&&(b("#giftwrap-carousel-wrap-holder-"+e+" li",b(a)).hide(),
b(".noshi-wrap",b(a)).show())});e.extendFunctions({updateCarouselOnLeftClick:function(a,c,e){e.$event.preventDefault();a=c.itemId;c=parseInt(b("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);0>c&&(c=c+90+"px",b("#giftwrap-carousel-wrap-holder-"+a).css("left",c))},updateCarouselOnRightClick:function(a,c,e){var g;e.$event.preventDefault();a=c.itemId;g=b("#giftwrap-carousel-wrap-pane-"+a);c=parseInt(b("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);e=g.find("ul li").size();var k=g.find("ul li.gift-wrap").size();
g=g.find("ul li.noshi-wrap").size();var u=b("#afn-gift-options-wrapper-"+a).data("active-tab"),n;"all"===u?n=e:"GW"===u?n=k:"noshi"===u&&(n=g);c>-90*(n-4)&&(c=c-90+"px",b("#giftwrap-carousel-wrap-holder-"+a).css("left",c))}})});m.when("A","jQuery","client-side-metrics","ready").execute(function(a,b,e){function d(a,c,d){a=0;var e="",f=!1;b("#includeReceiptCheckbox-"+d)&&b("#includeReceiptCheckbox-"+d).is(":checked")&&(f=!0);b('input[name\x3d"wrap.'+d+'"]:checked')&&(a=b('input[name\x3d"wrap.'+d+'"]:checked').val());
b("#includeMessageCheckbox-"+d)&&b("#includeMessageCheckbox-"+d).is(":checked")&&(e=b("#message-area-"+d).val(),10<e.length&&(e=e.substring(0,10)+"..."));(!a||1>a.length)&&b("#wrapRadio-"+d+"-noWrap").attr("checked","checked").trigger("change");a&&!(1>a.length)||e&&!(1>e.length)||f?(c.find(".no-gift-options-button-text").hide(),c.find(".selected-gift-options-button-text").show(),c.find(".gift-wrap-button-text").hide(),a&&0<a.length&&c.find(".gift-wrap-button-text-"+a.replace(/#/g,"\\#")).show(),e&&
0<e.length?(c.find(".gift-message-button-text").show(),c.find(".gift-message-preview").html(e)):c.find(".gift-message-button-text").hide(),f?c.find(".gift-receipt-button-text").show():c.find(".gift-receipt-button-text").hide()):(c.find(".selected-gift-options-button-text").hide(),c.find(".no-gift-options-button-text").show())}function c(a){a.find(".selected-gift-options-button-text").hide();a.find(".no-gift-options-button-text").show()}function f(a){a.is(":checked")||(r?a.closest("label").click():
(e.increaseCount("removeauijs32"),a.attr("checked",!0).trigger("change")))}function g(a){var b=a.find("div.expando-content"),c=1===a.data("select-gift-receipt");a=1===a.data("select-gift-message");(c||a)&&u(b,c,a)}function w(a){return a.is("input")?a:a.find("input")}function u(a,b,c){var d;d=0<a.find(".includeReceiptCheckbox").length?w(a.find(".includeReceiptCheckbox")):w(a.find(".mfnHidePriceCheckbox"));a=w(a.find(".includeMessageCheckbox"));(b||c)&&f(d);c&&f(a)}function n(){m.when("A","a-carousel-framework").execute(function(a,
b){b.initializeAll()})}function C(){r?m.when("A").execute(function(a){a.off("a:expander:gift-options-expander:toggle:collapse");a.on("a:expander:gift-options-expander:toggle:collapse",function(a){a=a.expander.$expander;var b=a.closest("div.expando-box"),c=b.find("div.expando-content"),b=b.data("itemNumber");d(c,a,b)});a.on("a:sheet:afterShow",function(a){n()});a.on("a:sheet:beforeHide",function(a){a=a.sheet.$container.find(":radio:checked");var c=a.attr("name"),d=a.parents(".wrap"),e=d.find(".wrap-text").text(),
d=d.find("img").attr("src"),c=b('.gift-sheet-radio :radio[name\x3d"'+c+'"]'),f=c.parents(".gift-options-wrapper");c.val(a.val()).prop("checked",!0);f.find(".wrap-text").text(e);f.find(".wrap-img").attr("src",d)});a.off("a:expander:gift-options-expander:toggle:expand");a.on("a:expander:gift-options-expander:toggle:expand",function(a){c(a.expander.$expander);n();var b=a.expander.$expander.closest("div.expando-box");a=b.find("div.expando-content");var d=1===b.data("select-gift-receipt"),b=1===b.data("select-gift-message");
(d||b)&&u(a,d,b)})}):(e.increaseCount("removeauijs33"),b("a.expando-link").unbind("click").bind("click",function(a){var e=b(this),f=e.closest("div.expando-box"),g=f.attr("data-item-number"),r=f.find("div.expando-content");r.is(":visible")?r.slideUp("fast",function(){d(r,e,g);e.find("i").removeClass("a-icon-section-expand").addClass("a-icon-section-collapse")}):(c(e),r.slideDown("fast",function(){e.find("i").removeClass("a-icon-section-collapse").addClass("a-icon-section-expand");var a=1===f.data("select-gift-receipt"),
b=1===f.data("select-gift-message");(a||b)&&u(r,a,b)}))}));var f=b("a.expando-link");if(0<f.length){if(f=f.eq(0),f.click(),r){var k=b("div.expando-box").eq(0);c(f);a.delay(function(){g(k)},100)}}else a.delay(function(){b("div.expando-box").each(function(){g(b(this))})},100)}var z=b("input#isPipelinedPage"),z=0<z.length&&"1"===z.val(),r=k.P&&k.P.AUI_BUILD_DATE;if(z)a.on("checkout:reload:giftselect",C);else C()});"use strict";m.when("A","pay-common-util").register("page-slide",function(a,b){function e(a,
e,g){if(!e)return a;0<a.length&&a.remove();a=d(e).hide();e=b.getCurrentPage();0===e.length?b.elements.pageContainer.append(a):g?a.insertBefore(e):a.insertAfter(e);return a}var d=a.$;return{slideHide:function(a,d){var g=b.getCurrentPage();a=e(a,d,!1);g.hide();a.show()},slideShow:function(a,d){var g=b.getCurrentPage();a=e(a,d,!0);g.hide();a.show()}}});m.when("A","ajax-utility","pay-common-util","page-conductor","page-slide","page-transition-controller","pay-validator","pay-credit-card","a-dropdown",
"client-side-metrics","pay-gil","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper","new-verified-debit-card","recommendation-helper","safe-apx-helper","apb-limit-messaging-helper").register("page-main",function(a,b,e,d,c,f,g,w,u,n,C,z,r,B,q,v,l,p){function A(a,b){if(null!==a){if(J)return String(a.data(b));n.increaseCount("removeauijs35");return a.attr(b)}}function K(){x.newVDC.find(".vdc-other-fields").show();var a=x.newVDC.find("#cardErrors_VDC").hide();a.find("li.error-message").not(".hidden").length&&
a.show()}function Q(a){var b=t(a.currentTarget).val(),c=x.newVDC.find(".bank-name").hide(),d=x.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=x.newVDC.find("option:selected").data("isdisabled"),f=!1,g="1"===t("#save_citi_card").val()&&"CIT"===b,h="1"===x.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;x.newVDC.find(".vdc-other-fields").hide();x.newVDC.find("#cardErrors_VDC").hide();"OtherBanks"===b||g||h?(K(),t.isEmptyObject(q)||q.showExpiryDateAndCvv()):"SMP"!==b||t.isEmptyObject(q)?
""!==b&&(a=t(a.currentTarget).find("option:selected").text(),e?d.show().find(".suppress-bank-name-text").html(a):c.show().find(".bank-name-text").html(a),f=!0):(K(),q.hideExpiryDateAndCvv());Y(f)}function L(a){t(".upi-action").hide();a=t(a.currentTarget).val();t("#"+a).show();Y(M(l))}function R(a){Y(N())}function M(a){if(t("#upi-input")){var b=t("#upiActionSelect").val();if("upi-registration"===b)return N();if("upi-acceptance"===b)return S(a)}else return S(a);return!1}function S(a){return(a=a.get("ValidatePaymentMethod"))?
a.shouldEnableContinueButton():!0}function N(){var a=t("#upiRegistration_bankSelect").val();if(a&&0<a.length)return!0}function H(a,b){if(!t.isEmptyObject(r)&&a)return a(b)}function O(b){var c=Array.prototype.slice.call(arguments);c.shift();m.now("upi-helper").execute("safe-upi-wrapper",function(d){d&&!a.objectIsEmpty(d)&&"function"===typeof d[b]&&d[b].apply(null,c)})}function T(a){H(r.removeEMIMenuSelectionAttributes);x.newEMI.find(".emi-group").hide();a="CreditCard"===t(a.currentTarget).find("option:selected").val()?
x.newEMI.find(".new-emi-card-fields").hide():H(r.getEMIMenuSelectedCardSection);a=H(r.toggleEMITenureSelectBehaviour,a);Y(a)}function y(a){(t(a.currentTarget).hasClass("sv-select-value")?t(a.currentTarget).val():t(a.currentTarget).find("option:selected").val())?Y(!0):Y(!1)}function V(){var a=g.create();a.validatePayment(ma());a.hasErrors()||d.makePrefetch(x.paymentsForm)}function I(b){var c=t(b.currentTarget);b=J?c.find("i"):c.children("i");if(J&&c.find("#addCreditCardNumber").is(":visible")){var d=
t("#auiTemplatingPaypageSelectionFix");0<d.length&&"T1"===d.val()&&c.find("#addCreditCardNumber").focus()}"1"===c.attr("ischecked")||b.eq(0).hasClass("a-icon-touch-radio-active")||(ga(!0),x.continueErrors.hide(),x.paymentRows.attr("ischecked",0),x.paymentRows.attr("isclicked",0),c.attr("ischecked",1),pa(c),b=la(c),Y(b),m.when("rewards-section-mobile").execute(function(b){a.trigger("rewards-section-mobile:select-payment-row",c)}),fa(c),Ea(c),Fa(c),Ga(c),"1"===t("#suppressionMessageFixEnabledStatus").val()&&
Ha(c),Ia(c),Ja(),Aa(c),Ca(),ia(),U(c,"#existing-gil-description"),U(c,"#existing-gil-alert"),U(c,"#existing-gil-si-rcl-description"),U(c,"#existing-gil-si-rcl-alert"),V(),E(c),z.toggleGCForMCB(c,x),h(c),t.isEmptyObject(v)||v.toggleCustomerNudgingMessage(c))}function U(a,b){var c=t(b);if(c&&0!==c.length){var d=0;0<a.find(b).length&&(d=1);d&&!c.is(":visible")?c.removeClass("aok-hidden"):!d&&c.is(":visible")&&c.addClass("aok-hidden")}}function h(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');
var b=t("input[type\x3d'hidden'][name\x3d'paySelectLocale']");b.length&&"IN"===b.val()&&a.length&&m.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-Mobile",1)})}function E(a){if(t("#isGlobalCODEligible").val()){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=t("#new-gc-promo");a.length?b.hide():b.show()}}function D(a){a.$event.preventDefault();var b=a.$target;J?b.closest("#card-expiration").hide():(n.increaseCount("removeauijs36"),b.parent().hide());
b.parents("div.a-box-inner").find("#"+a.data.targetId).show();a=J?".a-touch-radio":"label.a-touch-radio";J?b.parents(a).find("label").trigger("click"):(n.increaseCount("removeauijs37"),b.parents(a).trigger("click"))}function F(a){a=a.$target;J?a.parent().parent().hide():(n.increaseCount("removeauijs38"),a.parent().hide());t("#reward-err-detail").show()}function P(a){a.$target.parent().hide();t(".financial-offer-err-detail").show()}function G(a){a.$event.preventDefault();e.makeAjaxCall(a.data.href,
{},{successHandler:function(a,b,d){a&&(b=e.getPageId(d))&&c.slideShow(t(b),a)}})}function X(a){a.$event.preventDefault();e.makeAjaxCall(a.data.href,{},{successHandler:function(a,b,d){a&&(b=e.getPageId(d))&&c.slideShow(t(b),a)}})}function wa(a){var b=t("input#isPipelinedPage"),b=0<b.length&&"1"===b.val(),c=e.prop("activeGoElement");if(c)for(var d=["gcPromo","newVCC","newVDC"],h=0;h<d.length;h++){var l=x[d[h]];if(l&&l.length&&l.find(c).length)return l.find('input[type\x3d"button"]').trigger("click"),
a.$event.preventDefault(),!1}c=W();d=[xa,ya];for(h=0;h<d.length;h++)if((0,d[h])(a.data.url,c))return a.$event.preventDefault(),b&&a.$event.stopImmediatePropagation(),!1;c=g.create();d=ma();!t.isEmptyObject(r)&&H(r.isEMIPaymentInstrument,d)&&(d=H(r.getEMIMenuSelectedCardSection));c.validatePayment(d);c.apxValidatePayment(d,x.paymentsForm);if((c=c.getHighestErrorId())&&c.identifier)return a.$event.preventDefault(),b&&a.$event.stopImmediatePropagation(),"continue_GilCCContinueErrorIneligibleItems"===
c.identifier?C.displayGILEstimatesMobile("StandaloneCreditCardInstallment",da,ea):"continue_GilContinueErrorIneligibleItems"===c.identifier?C.displayGILEstimatesMobile("StandaloneInstallment",da,ea):"continue_GilRCLContinueErrorIneligibleItems"===c.identifier?C.displayGILEstimatesMobile("StandaloneReusableCreditLineInstallment",da,ea):x.continueErrors.show().find("#"+c.identifier).show(),!1;x.continueErrors.hide().find(".error-message").hide();f.showPageTransition()}function da(a,d,f){var g=b.jsonify(a);
g&&!g.errors&&g.widgetHTML?(a=t(e.pages["gil-estimates"].pageId),c.slideShow(a,g.widgetHTML),k.scrollTo(0,0)):ea(a,d,f)}function ea(a,b,c){t("#continue_GilCCContinueErrorIneligibleItems").show()}function ka(a){a=t(a.currentTarget);1===a.data("isclicked")?a.data("isclicked",0):a.data("isclicked",1);ia()}function ia(){var a=t("#pm_promo"),b=t("#pm_gc_radio"),c=t("#pm_gc_checkbox"),d="1"===t("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val();if(!b.length&&!c.length)return!1;var e=
t("input[name\x3dgcBalanceRaw]").val();t("input[name\x3damBalanceRaw]").length&&(e=t("input[name\x3damBalanceRaw]").val());var f=t("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),g=t("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),h=t("input[name\x3damAvailableBalanceRaw]").val(),r=t("input[name\x3dremainingBalanceRaw]").val(),l=t("input[name\x3dpurchaseTotalRaw]").val(),E,k,q=t(".purchase-total").length;q?(k=t(".purchase-total").html(),E=t(".remaining-balance").html()):(k=t("input[name\x3dpurchaseTotal]").val(),
E=t("input[name\x3dremainingBalance]").val());var n=t(".balance-applied");q?n.html(k):n.text(k);a=a.closest(".a-control-row");"1"===a.attr("isclicked")||1===a.data("isclicked")?0<r&&(q?n.html(E):n.text(E)):r=l;var a=b.closest(".a-control-row"),u=c.closest(".a-control-row"),m=t(".long"),w=t(".amazon-money-limit-breached"),D=t(".short");f&&p.renderAPBMessagingRemainingBalance({purchaseTotal:k,remainingBalance:E,balanceApplied:n,isPurchaseTotalInSpan:q},e,l,h);"1"===f&&"1"===g?p.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:a,
gcCheckboxContainer:u,gcCheckbox:c,gcRadio:b,shortMsg:D,longMsg:m,amazonMoneyLimitBreachedMsg:w}):0<=e-l?("disabled"===b.attr("disabled")&&b.removeAttr("disabled"),a.removeClass("hidden"),u.addClass("hidden"),c.attr("disabled","disabled"),0==e-l?(m.hide(),D.show()):(m.show(),D.hide())):0<e-r?0>=r?(u.removeClass("hidden"),u.find("i").addClass("a-button-disabled checkbox-disabled"),c.attr("disabled","disabled"),a.addClass("hidden"),b.attr("disabled","disabled"),D.show(),m.hide()):("disabled"===b.attr("disabled")&&
b.removeAttr("disabled"),a.removeClass("hidden"),u.addClass("hidden"),c.attr("disabled","disabled"),m.show(),D.hide()):("disabled"===c.attr("disabled")&&c.removeAttr("disabled"),u.removeClass("hidden"),u.find("i").removeClass("a-button-disabled checkbox-disabled"),a.addClass("hidden"),b.attr("disabled","disabled"),"1"===f?p.renderAPBInsufficientMessaging({shortMsg:D,longMsg:m},e,h):(D.show(),m.hide()));d&&(b.attr("disabled","disabled"),c.attr("disabled","disabled"))}function Z(a){a=a.$target||t(a.currentTarget);
aa(a)}function aa(b,c){var d=b.find("input[type\x3d'checkbox']")||b.find("input[type\x3d'radio']"),e;e=d.is("input[type\x3d'checkbox']")?"checkbox":"radio";if(d.length){var f=d.siblings("i"),g=x.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),h=x.paymentRows.filter(".a-touch-radio[data-paymentmethodtype\x3d'creditCard']");b=h.siblings(".installments-select.a-row");var l=h.siblings(".installments-message"),E=h.siblings(".card-offers"),h=h.filter("[data-isinstallmentsonlycard\x3d1]"),
k=x.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),q=J?k.parents(".a-control-row"):k.parent(),n=x.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),D=!n.parent().find('input[type\x3d"hidden"][name\x3d"isEMIMenuDisabled"]').val(),p=x.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]'),w=p.closest(".payment-row"),F=x.paymentRows.find("#pm_upi_web_collect"),Q=x.paymentRows.filter(".upi-saved-handle");c||f.hasClass("a-icon-touch-"+
e+"-inactive")?(g.attr("disabled",!0).prop("disabled",!0),D&&H(r.disableEMIMenu,n),B.showInstantBankDiscountAmazonPaySelected(),O("disableUPIFromSelectionOnPSP",F,Q),g.is(":checked")&&(g.attr("checked",!1),g.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),g.siblings("i").addClass("a-icon-radio-inactive").removeClass("a-icon-radio-active"),fa(g)),c=J?g.parents(".a-control-row"):g.parent(),c.addClass("a-color-secondary js-gc-disabled"),k.attr("disabled",
!0).prop("disabled",!0),k.is(":checked")&&(k.attr("checked",!1),k.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),k.siblings("i").addClass("a-icon-radio-inactive").removeClass("a-icon-radio-active"),fa(k)),q.addClass("a-color-secondary js-gc-disabled"),q.siblings(".selected-section-more-payment-method").hide(),(c=b.find("select"))&&c.each(function(){var a=this.id.replace(/\./g,"\\.");u.setValue(a,"");a=t(this).find("option").eq(0).text();t(this).siblings(".a-input-dropdown").text(a)}),
b.find(".installments-enabled-text").hide(),l.find(".installments-enabled-text").hide(),E.find(".installments-enabled-text").hide(),b.find(".installments-disabled-text").show(),l.find(".installments-disabled-text").show(),E.find(".installments-disabled-text").show(),h.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),m.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",p)})):(g.attr("disabled",!1).prop("disabled",!1),D&&(H(r.enableEMIMenu,
n),n.is(":checked")&&(H(r.addEMIMenuSelectionAttributes),t("#selectedSectionEmiPaymentMethod").show())),B.showInstantBankDiscountAmazonPayDeselected(),f.removeClass("a-icon-touch-"+e+"-inactive").addClass("a-icon-touch-"+e+"-active"),c=J?g.parents(".a-control-row"):g.parent(),c.removeClass("a-color-secondary js-gc-disabled"),b.find(".installments-disabled-text").hide(),l.find(".installments-disabled-text").hide(),E.find(".installments-disabled-text").hide(),b.find(".installments-enabled-text").show(),
l.find(".installments-enabled-text").show(),E.find(".installments-enabled-text").show(),h.find("input[name\x3dpaymentMethod]").removeAttr("disabled"),q.parent().find(".payment-invalid").length||(k.attr("disabled",!1).prop("disabled",!1),q.siblings(".selected-section-more-payment-method").show()),q.removeClass("a-color-secondary js-gc-disabled"),w.find(".payment-invalid").length||m.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",p)}),O("enableUPIForSelectionOnPSP",F,Q),
d.is(":checked")&&(k.attr("disabled",!0).prop("disabled",!0),k.is(":checked")&&k.attr("checked",!1),k.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),k.siblings("i").addClass("a-icon-radio-inactive").removeClass("a-icon-radio-active"),q.siblings(".selected-section-more-payment-method").hide(),D&&(H(r.disableEMIMenu,n),n.is(":checked")&&(t("#selectedSectionEmiPaymentMethod").hide(),H(r.removeEMIMenuSelectionAttributes))),B.showInstantBankDiscountAmazonPaySelected(),
O("disableUPIFromSelectionOnPSP",F,Q),m.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",p)})))}}function xa(a,b){if("true"!==A(b,"isaddresschallenge"))return!1;a=b.parent();if(w.runConfirmCardValidator(a,a.find("#confirmCardErrors")))return e.scrollTopTo(a.find("#addCreditCardNumber")),!0;a=e.getInputValues(a);w.confirmCreditCard(a,Ba,a.confirmCardUrl);return!0}function ya(a,b){b=e.getInputValues(b.parent());if("undefined"===typeof b.newMonth||!b.newMonth||!b.newYear||
"undefined"===typeof b.newYear||parseInt(b.expmonth,10)===parseInt(b.newMonth,10)&&parseInt(b.expyear,10)===parseInt(b.newYear,10))return!1;b.handler="update-credit-card";b.ccId0=b.paymentmethodid;b.issueNumber0=b.issuer;b.month0=b.newMonth;b.year0=b.newYear;e.makeAjaxCall(a,b,{},{useSif:!0});return!0}function za(){var a=t("#new-cc-inbox label");if(a&&0!==a.length){var b;J?b=x.paymentRows.filter(".a-touch-radio[data-paymentmethodtype\x3d'creditCard']"):(n.increaseCount("removeauijs43"),b=x.paymentRows.filter("label[paymentmethodtype\x3d'creditCard']"));
if(b=!(0<b.length))b=x.continueBtn.parents(".a-button").hasClass("a-button-disabled")?!0:!1;b&&(e.scrollTopTo(a),a.trigger("click"))}}function Aa(a){var b=t("#form-add-credit-card");if(b&&0!==b.length){var c=0;0<a.find('input[value\x3d"addingNewCCInBox"]').length&&(c=1);c&&!b.is(":visible")?b.slideDown():b.is(":visible")&&b.slideUp()}}function la(a){var b=g.create();a&&a.length||b.addError("continue_BlankSlate");a&&"function"===typeof a.parent&&b.validatePCICVVBlock(a.parent());b.apxValidatePayment(a,
x.paymentsForm);if(b.hasErrors())return!1;if("pmEmiPaymentOptions"===a.find('input[type\x3d"radio"]').attr("id"))return H(r.getEMIMenuSelectedCardSection).find(".emi-menu-tenures-dropdown").find("option:selected").val()?!0:!1;b=a.find('input[name\x3d"paymentMethod"]').val();if("cashOnDeliveryCash"===b&&a.parent().find(".phonenumberNotVerified").length)return!1;if("StandaloneCreditCardInstallment"===b||"StandaloneInstallment"===b||"StandaloneReusableCreditLineInstallment"===b)return b=a.find('input[name\x3d"gilShowContinueBlocker"]').val(),
a=a.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val(),"1"!==b&&"1"!==a;if("addingNewCCInBox"===b||"addingNewCUPDCInBox"===b)return!1;if("upi"===b)return M(l);if("verifiedDebitCard"!==b&&"verifiedCreditCard"!==b)return!0;if("verifiedCreditCard"===b)return!1;a=x.newVDC.find("#vdcBanksSelect").val();return""!==a&&"OtherBanks"!==a}function Ba(c){var d=b.jsonify(c);d.imbWidgetHTML&&t("#imb-wrapper").html(e.decodeJSonResponse(d.imbWidgetHTML));c=W();var f=A(c,"paymentmethodid");!d.cardWidgetHTML||
d.newpaymentmethodid!==f&&d.optionalnewpaymentmethodid!==f||(c.closest(".a-box").replaceWith(e.decodeJSonResponse(d.cardWidgetHTML)),null!=d.rewardsAccountsWidgetHTML&&m.when("rewards-section-mobile").execute(function(b){a.trigger("rewards-section-mobile:refresh-rewards-section",e.decodeJSonResponse(d.rewardsAccountsWidgetHTML))}),ja(),c=W(),"true"!==A(c,"isaddresschallenge")&&(w.setCardPasswordInputStatus(c,d.newpaymentmethodid,"cvv","#existingCvvNum"),w.setCardPasswordInputStatus(c,d.newpaymentmethodid,
"pincode","#existingPincodeNum"),x.continueBtn.closest(".a-row").show()))}function W(){var a=x.paymentRows.filter("[ischecked\x3d1]");if(a.length)return n.increaseCount("removeauijs41"),a;if(J)return x.paymentRows.filter("[data-ischecked\x3d1]");n.increaseCount("removeauijs42");return x.paymentRows.children("i").filter(".a-icon-touch-radio-active").parent()}function ma(){var a=[];a.push(W());x.jppoints&&x.jppoints.length&&x.jppoints.find("#redeemPoints").is(":checked")&&a.push(x.jppoints);return a}
function Ca(){for(var a=x.paymentRows.parent(),b=["#reward-err-link",".financial-offer-err-link"],c=0;c<b.length;c++)t(b[c],a).show();for(var b=["#reward-err-detail",".financial-offer-err-detail"],d=0;d<b.length;d++)t(b[c],a).hide()}function Da(){for(var a=[".financial-offer-err-detail"],b=0;b<a.length;b++){var c=t(a[b]);c.data("isHidden")||c.show()}}function na(a){a.stopPropagation();a.preventDefault()}function oa(a,b){ha[b]&&(ha[b](),ha[b]=null);var c=a.find(b);c.length&&(c=c[0],c.addEventListener("click",
na),ha[b]=function(){c.removeEventListener("click",na)})}function pa(a){t(".pci-blocking-cvv").length&&(x.paymentRows.each(function(){var a=t(this).parent().find(".pci-blocking-cvv");a.length&&a.hide()}),a&&(a=a.parent().find(".pci-blocking-cvv"),a.length&&a.show()))}function fa(a){var b=".card-cvv-field .card-pcard-field #invoice-address .loc-order-number #net-banking-list #selected-section-more-payment-method #selectedSectionEmiPaymentMethod .new-card-fields .installments-link #rewards-balance-link .financial-offer-link .financial-offer-err-detail .review-continue-text #form-add-cupdc-inbox .otpBlock #ovdWidgetSection".split(" ");
t("#upi-input").length?b.push("#upi-input"):b.push("#upi-acceptance-input");ba||b.push("#domestic-card-list","#third-party-list","#installment-payment-warning");var c=t("#cash-back-ineligible-for-cod-message");c&&c.length&&b.push("#cash-back-ineligible-for-cod-message");for(var c=x.paymentRows.parent(),d=a.parent(),e=0;e<b.length;e++){var f=b[e];"#selectedSectionEmiPaymentMethod"===f&&H(r.removeEMIMenuSelectionAttributes);t(f,c).hide();var g=d.find(f);g.data("isHidden")||(g.show(),".card-cvv-field"===
f&&(oa(d,"#existingCvvNum"),oa(d,"#existingPincodeNum")))}"pmEmiPaymentOptions"===a.find('input[type\x3d"radio"]').attr("id")&&H(r.addEMIMenuSelectionAttributes);a=["#reward-points",".financial-offer"];for(b=0;b<a.length;b++)e=a[b],t(e,c).show(),t(e,d).hide()}function Ea(b){var c=x.paymentRows.parent();c.find("#card-expiration,.payment-info").show();c.find("#addr-challenge,#addr-challenge-msg,.addr-challenge-card-scan,.addr-challenge-confirm,#expire-date-fields").hide();x.continueBtn.closest(".a-row").show();
"true"===A(b,"isaddresschallenge")&&(c=b.parent(),c.find("#card-expiration,.payment-info").hide(),c.find("#addr-challenge,#addr-challenge-msg,.addr-challenge-card-scan,.addr-challenge-confirm,#expire-date-fields").show(),x.continueBtn.closest(".a-row").hide(),b=b.attr("paymentmethodid")?b.attr("paymentmethodid"):b.attr("data-paymentmethodid"),a.trigger("checkout:payment:challenge:log",b))}function Fa(a){x.paymentRows.parent().find(".verified-fail-msg").hide();"true"===A(a,"isverifiedfail")&&a.parent().find(".verified-fail-msg").show()}
function Ga(a){x.paymentRows.parent().find(".cup-expired-msg").hide();"true"!==A(a,"iscupcardexpired")&&"true"!==A(a,"iscupcardexpiringsoon")||a.parent().find(".cup-expired-msg").show()}function Ha(a){x.paymentRows.parent().find("#savedCardSuppressed").hide();a.parent().find("#savedCardSuppressed").show()}function Ia(a){var b=x.paymentRows.parent();b.find(".installments-select").hide();b.find(".installments-message").show();a=a.parent();a.find(".installments-select").show();a.find(".installments-message").hide()}
function Ja(){var a=t("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}function qa(){var a;J?a=t("#select-payments-view input[type\x3d'radio'][name\x3d'paymentMethod']:checked").closest(".a-touch-radio"):(n.increaseCount("removeauijs44"),a=t("#select-payments-view input[type\x3d'radio'][name\x3d'paymentMethod'][checked\x3d'checked']").closest("label.a-touch-radio"));
a=la(a);Y(a)}function Y(a){var b=x.continueBtn.parents(".a-button");a?(x.continueBtn.removeAttr("disabled"),b.removeClass("a-button-disabled")):(x.continueBtn.attr("disabled",!0),b.addClass("a-button-disabled"))}function Ka(b){var c=b.$target.closest("a");b=c.closest("div.extender-section");c=c.find("i");c.hasClass("a-icon-extender-expand")?(b.find(".collapsed").hide(),a.slideDown(b.find(".expanded"),200),c.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(b.find(".collapsed").show(),
a.slideUp(b.find(".expanded"),200),c.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"));e.scrollTopTo(ca().find(".reg-expander-anchor"))}function ca(){return W().closest(".payment-box")}function La(){ga()}function ga(a){var b=ca();b.find("div.flag-register-rewards").is(":visible")?(b.find(".flag-register-rewards").addClass("aok-hidden"),b.find(".card-unreg-rewards").removeClass("aok-hidden"),b.find(".a-box-inner:first").removeClass("no-padding-bottom")):a||(b.find(".card-unreg-rewards").addClass("aok-hidden"),
b.find(".flag-register-rewards").removeClass("aok-hidden"),b.find(".a-box-inner:first").addClass("no-padding-bottom"));a||e.scrollTopTo(b)}function Ma(a){a.$event.preventDefault();var c=J?".a-touch-radio":"label.a-touch-radio",d=a.$currentTarget.closest(".payment-box"),c=d.find(c);0!==c.length&&(c.find('input[type\x3d"radio"]').click(),"1"===d.find("div.flag-register-rewards").data("cached")?ga():(d=a.$target.attr("href"),f.show(),e.makeAjaxCall(d,a.data,{successHandler:function(a){f.hide();var c=
b.jsonify(a);a=e.decodeJSonResponse(c.widgetHTML);ca().find("div.flag-register-rewards").html(a).data("cached","1").find(".error-message").each(function(){var a=t(this),b=a.data("errorid");a.html(c.displaydata[b])});ga()}})))}function ra(a){a=x.showAmexWarning_mobile;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function Na(a){f.show();var c=ca(),d=c.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),g=c.find(".card-unreg-rewards").data(),h=c.find(".flag-register-rewards"),
h=e.getInputValues(h);h.programid=g.programid;h.paymentinstrumentid=g.paymentinstrumentid;h.CARD_EXPIRATION_DATE=g.expiredate;h.CARD_HOLDER_NAME=g.holdername;h.returnRefreshedPage=a.data.returnRefreshedPage;h.rewardsdateofbirthmonth&&h.rewardsdateofbirthday&&(h.DATE_OF_BIRTH=h.rewardsdateofbirthmonth+h.rewardsdateofbirthday);e.makeAjaxCall(a.data.url,h,{successHandler:function(a,g,h){f.hide();a&&(a=b.jsonify(a),g=ca().find(".register-error"),a.error?g.show().find(".error-message").hide().filter("#"+
a.error).show():(g.hide(),x.pageContainer.html(a.refreshedPage),ja(),a=J?".a-touch-radio":"label.a-touch-radio",c=x.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+d+'"]').closest(a),c.trigger("click")),e.scrollTopTo(c))}})}function ja(b){if(e.isMobileCX()){e.refreshElements(x,sa);ba=parseInt(t("input[type\x3d'hidden'][name\x3d'showWidgetInSeparateGroup']").val(),10);ba=isNaN(ba)?0:ba;ta&&(a.declarative("show-expire-date-fields",["click"],D),a.declarative("show-reward-err-detail",
["click"],F),a.declarative("show-financial-offer-err-detail",["click"],P),a.declarative("submit-payment-form",["submit"],wa),a.declarative("show-reward-points",["click"],G),a.declarative("show-financial-offer",["click"],X),a.declarative("show-rewards-reg-mobile",["click"],Ma),a.declarative("register-card-rewards-mobile",["click"],Na),a.declarative("cancel-register-card-rewards-mobile",["click"],La),a.declarative("extender-toggle-mobile",["click"],Ka),ta=!1);O("initiateUpiDeviceCheck");x.existingPincodeNum.unbind("click",
ra).bind("click",ra);J?(x.paymentsForm.undelegate(".a-touch-radio","click").delegate(".a-touch-radio:has(input[name\x3dpaymentMethod]:enabled)","click",I),x.paymentsForm.undelegate(".promoLabel","click").delegate(".promoLabel:has(input[name\x3dusePromoBalance]:enabled)","click",ka),b=function(a){a.target.focus()},t("input#existingPincodeNum").bind("click",b),t("input#existingCvvNum").bind("click",b),t("input#existingCvvNum").bind("click",b),t("input#addCreditCardNumber").bind("click",b),t("input#addCreditCardPincode").bind("click",
b),t("input#addCreditCardVerificationNumber").bind("click",b),t(".payment-select").bind("touchstart",function(a){t(this).find("i").removeClass("a-icon-touch-radio-inactive")})):(n.increaseCount("removeauijs46"),x.paymentsForm.undelegate("label.a-touch-radio","click").delegate("label.a-touch-radio:has(input[name\x3dpaymentMethod]:enabled)","click",I),x.paymentsForm.undelegate("label.promoLabel","click").delegate("label.promoLabel:has(input[name\x3dusePromoBalance]:enabled)","click",ka));t("#domestic-card-dropdown").unbind("change").bind("change",
function(){t("#label-domestic-card").trigger("click")});t("#third-party-dropdown").unbind("change").bind("change",function(){t("#label-third-party").trigger("click")});t("#vdcBanksSelect").unbind("change",Q).bind("change",Q);t("#upiActionSelect").unbind("change",L).bind("change",L);t("#upiRegistration_bankSelect").unbind("change",R).bind("change",R);t("#emiPaymentMethodsSelectList").unbind("change",T).bind("change",T);t(".sv-select-option").unbind("click",ua).bind("click",ua);t(".emi-menu-tenures-dropdown").unbind("change",
y).bind("change",y);t("#net-banking-list").unbind("change",va).bind("change",va);if(0<t("input[name\x3d'needDisableCODandEMIforGC']").length){b=t("#existing-gift-card-promo");if(b.length){b.bind("click",Z);x.paymentsForm.delegate(".js-gc-disabled","click",function(){return!1});var c=J?b.find("#pm_300"):b.children("#pm_300");c.is("input[type\x3d'checkbox']:checked")&&aa(b,!0);b.data("gc-initially-checked")&&aa(b,!0)}var d=t(".existing-gift-card-balance");d.length&&(d.bind("click",Z),x.paymentsForm.delegate(".js-gc-disabled",
"click",function(){return!1}),c=J?d.find("#pm_gc_checkbox"):d.children("#pm_gc_checkbox"),c.is(":checked")&&aa(d,!0),d.data("gc-initially-checked")&&aa(b,!0))}m.when("rewards-section-mobile").execute(function(b){a.trigger("rewards-section-mobile:init",x.paymentsForm,g)});m.when("installments-payselect-mobile").execute(function(){a.trigger("installments-payselect-mobile:init",x.paymentsForm,g)});m.when("apx-payselect-helper").execute(function(){var a=l.get("payselect");a&&a.initEvents(x.paymentsForm,
qa)});pa(W());qa();za();fa(W());Da();ia();b=W();E(b);t.isEmptyObject(v)||v.toggleCustomerNudgingMessage(b);z.determineIsMCBEnabled(x);z.toggleGCForMCB(b,x);t("form.checkout-page-form").data("checkoutFormReady",!0).change()}}function va(a){a=t(a.currentTarget).find("option:selected");var b=a.data("isdisabled"),c=t("#net-banking-list");b?(c.find("#disable-bank-content-mob").show(),c.find("#selected-bank-mob").text(a.text()).show()):c.find("#disable-bank-content-mob").hide()}function ua(a){a=t(a.currentTarget);
var b=a.data(),c=t(document.getElementById(b.id)),d=t(document.getElementById("popover-"+b.id));c.find(".sv-select-value").val(b.value).trigger("change");d.find(".sv-select-option").removeClass("a-active");a.addClass("a-active");b=c.find(".a-button-text");a=a.find(".sv-select-option-primary-text").html();b.html(a)}var t=a.$,x={},ta=!0,J=k.P&&k.P.AUI_BUILD_DATE,sa={jppoints:"#jppoints",continueBtn:"#select-payments-view #continueButton",continueErrors:"#continue-errors",gcPromo:"#new-gc-promo",newVCC:"#new-verified-credit-card",
newVDC:"#new-verified-debit-card",newEMI:"#newEmiCard",paymentRows:"#select-payments-view label.a-touch-radio",paymentsForm:"#select-payments-view form",pageContainer:"#page-container",existingBalance:"#pm_300",showAmexWarning_mobile:"#showAmexWarning_mobile",existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning"};J&&(sa.paymentRows='#select-payments-view .a-touch-radio:not([data-a-input-name\x3d"rewardsAccount"])');var ba,ha={};return{init:ja,setContinueButtonStatus:Y,getSelectedPaymentRow:W,
getGilEstimatesMobileSuccess:da}});m.when("A","pay-common-util","pay-rewards-currency").register("page-rewards",function(a,b,e){function d(a){a=m(a.currentTarget);var b=n?a.closest("div").data():a.data(),c=a.val()/b.ratio;isNaN(c)||(c=0>c||a.val()<b.min?0:g(c,b.decimalplaces),C.customRewardPoints.html(c))}function c(a){a=m(a.currentTarget);var b=a.data(),c=a.val(),d=parseFloat(C.rewardForm.find("#rewardsmax").val());isNaN(c)||0>c?(C.customRewardPoints.html(0),a.val(0)):c>d&&(b=g(d/b.ratio,b.decimalplaces),
C.customRewardPoints.html(b),a.val(d))}function f(a){a=m(a.currentTarget);"1"!==a.attr("ischecked")&&(C.rewardRows.attr("ischecked",0),a.attr("ischecked",1),"rewardscustom"===a.find("[type\x3dradio]").val()?(C.customReward.show(),C.customRewardText.addClass("a-text-bold")):(C.customReward.hide(),C.customRewardText.removeClass("a-text-bold")))}function g(a,b){isNaN(b)||(a=Number(a).toFixed(b));a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:g(a.substring(0,b-3),0)+
","+a.substring(b-3)}var m=a.$,u=!0,n=k.P&&k.P.AUI_BUILD_DATE,C={},z={customReward:"#select-payment-rewards-view #custom-reward",customRewardPoints:"#select-payment-rewards-view #custom-reward-points",customRewardText:"#select-payment-rewards-view #custom-reward-text",rewardForm:"#select-payment-rewards-view form",rewardRows:"#select-payment-rewards-view label.a-touch-radio"};n&&(z.rewardRows="#select-payment-rewards-view .a-touch-radio");return{init:function(){if(b.isMobileCX()){b.refreshElements(C,
z);u&&(u=!1);var a=C.rewardForm.find("input[name\x3drewardsCustom]"),g=!1,k;a.hasClass("show-currency-input-widget-new")?(g=!0,k=m(a)):a.parent().hasClass("show-currency-input-widget-new")&&(g=!0,k=m(a.parent()));if(g){var v=parseFloat(k.data("max")),l=k.data("decimalplaces"),p=k.data("ratio"),A=k.data("country-code");a.each(function(b,c){c=C.rewardForm.find("#custom-reward-points");m(a);b={$element:m(a),maxAmount:v};c={$element:m(c),decimalPlaces:l,ratio:p};var d=e.getCurrencyFormatByCountryCode(A);
e.initializeInlineFormatting(b,c,d)})}else a.unbind("keyup").bind("keyup",d).unbind("blur").bind("blur",c);g=n?".a-touch-radio":"label.a-touch-radio";C.rewardForm.undelegate(g,"click").delegate(g,"click",f)}}}});m.when("A","pay-common-util").register("page-financial-offer",function(a,b){function e(a){a.$event.preventDefault();a=a.$target;var c=b.getInputValues(a),d=a.find(":checked").val();c.selectedFinancialOfferId=d;c.recommendedPaymentMethodId=c.paymentMethodId;b.makeAjaxCall(a.attr("action"),
c)}var d=!0,c={},f={financialOfferForm:"#select-payment-financial-offer-view form",financialOfferRows:"#select-payment-financial-offer-view label.a-touch-radio"};k.P&&k.P.AUI_BUILD_DATE&&(f.financialOfferRows="#select-payment-financial-offer-view .a-touch-radio");return{init:function(){b.isMobileCX()&&(b.refreshElements(c,f),d&&(a.declarative("apply-financial-offer",["submit"],e),d=!1))}}});m.when("A","pay-common-util","ready").execute(function(a,b){function e(){b.isMobileCX()&&(b.init(),b.elements.pageContainer.undelegate(".expando-link",
"click").delegate(".expando-link","click",function(a){var b=d(this);a=b.closest("div.expando-section").find("div.expando-content");a.is(":visible")?a.slideUp("fast",function(){b.find("i").removeClass("a-icon-collapse").addClass("a-icon-expand");b.find("div.expando-toggle-text-show").show();b.find("div.expando-toggle-text-hide").hide()}):a.slideDown("fast",function(){b.find("i").removeClass("a-icon-expand").addClass("a-icon-collapse");b.find("div.expando-toggle-text-show").hide();b.find("div.expando-toggle-text-hide").show()})}))}
var d=a.$,c=d("input#isPipelinedPage");if(0<c.length&&"1"===c.val())a.on("checkout:reload:payselect",e);else e()});m.when("A","pay-common-util","page-slide","pay-validator","ajax-utility","page-transition-controller","pay-credit-card","page-main","pay-common-lib","safe-mash","client-side-metrics","payselect-enhancements","emi-helper","ready").register("mobile-new-payments",function(a,b,e,d,c,f,g,m,u,n,C,z,r){function B(a){"undefined"!==typeof k.ue&&"undefined"!==typeof k.ue.count&&k.ue.count("PayPage-ClientSide-AddCupClick-Mobile",
1);var c=a.data.url,d={},e;for(e in a.data)"url"!==e&&(d[e]=a.data[e]);"object"===typeof n?"function"===typeof n.showEmbeddedBrowser&&n.showEmbeddedBrowser({targetURL:c,method:"POST",postParameters:d,successCallback:function(){}}):b.submitFormRequest(c,d,{target:"_blank"})}function q(a){"undefined"!==typeof k.ue&&"undefined"!==typeof k.ue.count&&k.ue.count("PayPage-ClientSide-AddCupAckClick-Mobile",1);f.show();k.location.reload()}function v(a,c){var d=a.data.type;g.isWaitingForType(d)?(a.$event.preventDefault(),
f.show(),setTimeout(function(){v(a)},50)):(y("#card-scanner-success-messages").addClass("aok-hidden"),N(d)?a.$event.preventDefault():y("#cupSecurityCode").is(":visible")&&y("#cupMobileNumber").is(":visible")?p(a,c):c?b.makeAjaxCall(a.data.url,c,{successHandler:R},{useSif:!0}):M(a,{useSif:!0}))}function l(a){a.$event.preventDefault();var c=b.getInputValues(y("#new-cc-inbox #form-add-credit-card"));c.handler=c.handler_addNewCC;v(a,c)}function p(a,d){if(!d){d={};for(var e=V?a.$declarativeParent.find("form").serializeArray():
a.$declarativeParent.serializeArray(),f=0;f<e.length;f++)d[e[f].name]=e[f].value}a.$event.preventDefault();b.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",d,null,{useSif:!0,success:function(a,b,d){a=c.jsonify(a);A(a,b,d)}})}function A(a){var d={},e={success:function(a,d,e){a=c.jsonify(a);a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3;"PENDING"===a.cardStatus&&1<a.checkStatusCount?(--a.checkStatusCount,
A(a)):b.submitFormRequest("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId})}};d.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(d.checkStatusCount=a.checkStatusCount);setTimeout(function(){b.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",d,null,e)},2500)}function K(a){g.handleCreditCardType(a,S)}function Q(a){a.$event.preventDefault();var c=a.data.type;if(!N(c)){var d=I[c],f=y(d.fieldId),d=d.suffix,h=b.getInputValues(f),f=
h["addCreditCardVerificationNumber"+d],k=h["addCreditCardPincode"+d],l=h["isCardSavedFromEMIMenu"+d],c={addCreditCardNumber:h["addCreditCardNumber"+d],addCreditCardVerificationNumber:f,addCreditCardPincode:k,handler:h["handler"+d],month:h["month"+d],name:h["name"+d],newPaymentType:c,recommendedPaymentMethodId:h.paymentMethod,year:h["year"+d],cctype:h["cctype"+d],isCardSavedFromEMIMenu:l,isSBIInternationalMaestroSelected:h["isSBIInternationalMaestroSelected"+d]},m=a.$target.hasClass("addCardAndContinueButton");
b.prop("cvv-newcard",f);b.prop("pincode-newcard",k);b.makeAjaxCall(a.data.url,c,{successHandler:function(a){if(a){var c=y(b.pages.main.pageId);e.slideShow(c,a);"1"===y("#hideCVVInEMIMenuStatus").val()&&"1"===l&&(a=r.getEMIMenuSelectedCardSection,a=!y.isEmptyObject(r)&&a?a(void 0):void 0,c=r.setAndHideCVVInEMIMenu,!y.isEmptyObject(r)&&c&&c(a));a=V?y("#select-payments-view .a-touch-radio"):y("#select-payments-view label.a-touch-radio");g.setNewCardCVVInputStatus(a)}},completeHandler:function(a,b){m&&
(C.increaseCount("checkout:payselect:addcardandcontinue:continueactionactivated",1),y("#select-payments-view #continueButton").trigger("submit"));y.isEmptyObject(z)||z.triggerAjaxLoadEvent()}},{useSif:!0,isAddCardAndContinueEnabled:m})}}function L(a,b){b=y("#form-add-direct-debit");var c=b.find("input[name\x3daddBankAccountRoutingNumber]"),e=b.find("input[name\x3daddBankAccountNumber]"),f=b.find("input[name\x3ddebitAccountName]"),h=d.create();h.validateDirectDebitRoutingNum(c,c);h.validateDirectDebitAccountNum(e,
e);h.validateDirectDebitAccountName(f,f);h.displayErrors(b.find("#direct-debit-errors"),b);h.hasErrors()?a.$event.preventDefault():M(a)}function R(c,d,f){c&&(d=b.getPageId(f))&&(e.slideShow(y(d),c),a.trigger("checkout:reload:payselect"),(c=0<y(".activateScrollToError").length)&&0<y("#check-errors").length?y(k).scrollTop(y("#check-errors").offset().top):c&&0<y("#direct-debit-errors").length?y(k).scrollTop(y("#direct-debit-errors").offset().top):c&&0<y("#new-invoice-errors").length?y(k).scrollTop(y("#new-invoice-errors").offset().top):
"#select-payments-view"===d&&u.scrollTopTo(m.getSelectedPaymentRow()))}function M(a,c){b.handleForm(a,R,c)}function S(a,b){if(a){"1"===a.isDebitCard?y("#cardWarnings").show().removeClass("hidden"):y("#cardWarnings").hide().addClass("hidden");b=y(I[b].fieldId);g.setDateSelectorStatus(a,b);if("1"===a.hasErrors){var c=d.create();c.validateGetCreditCardTypeResult(a);if(c.hasErrors()){c.displayErrors(b.find("#cardErrors"),b);return}}c=b.find(".cup-card-field");if(0!==c.length){var e=a.specificFields;e&&
1===e.securityCode&&1===e.mobileNumber?c.show():c.hide()}if(a&&(c=a.specificFields,e=b.find(".pincode-field"),0!==e.length)){var f=b.find(".cvv-field");0!==f.length&&(b=b.find("#cardType"),0!==b.length&&(b.val(a.issuer+a.brand),c&&1===c.pincode?(f.hide(),e.show()):c&&0===c.pincode&&0===c.securityCode?(e.hide(),f.hide()):(e.hide(),f.show())))}}}function N(a){if(!(a in I))return!0;var b=I[a],c=y(b.fieldId),b=b.suffix,e="1"===c.find("#isSBIMaestroAsSavedCardEnabled").val()&&"1"===c.find('input[name\x3d"isSBIInternationalMaestroSelected'+
b+'"]').val(),f=c.find('input[name\x3d"addCreditCardVerificationNumber'+b+'"]'),h=c.find('select[name\x3d"month'+b+'"]'),g=c.find('input[name\x3d"name'+b+'"]');a=c.find('input[name\x3d"addCreditCardNumber'+("brdc"===a?"":b)+'"]');var l=c.find('input[name\x3d"addCreditCardMobileNumber'+b+'"]'),m=c.find('select[name\x3d"year'+b+'"]'),n=c.find('input[name\x3d"addCreditCardPincode'+b+'"]'),r=d.create();f&&f.length&&f.is(":visible")&&(r.isAMEXCreditCard(a)?r.validateCreditCardCVV2(f,f,"A"):r.validateCreditCardCVV2(f,
f));l&&l.length&&l.is(":visible")&&r.validateCreditCardMobile(l,l);h.is(":disabled")||m.is(":disabled")||r.validateCreditCardDate(h,h.closest(".card-date").find(".a-button"),m,m.closest(".card-date").find(".a-button"));r.validateCreditCardName(g,g);r.validateCreditCardNumber(a,a);e&&r.validateSBIMaestroCardNumberLength(a,a);n&&n.length&&n.is(":visible")&&r.validateCreditCardPincode(n,n);r.displayErrors(c.find("#cardErrors"+b),c);0<y(".activateScrollToError").length&&0<y("#cardErrors").length&&y(k).scrollTop(y("#cardErrors").offset().top);
return r.hasErrors()}function H(){if(b.isMobileCX()&&U){a.declarative("new-payment-methods",["click"],function(a){a.$event.preventDefault();b.makeAjaxCall(a.data.href,{},{successHandler:function(a){if(a){var c=b.pages["new-payment-methods"].pageId;e.slideShow(y(c),a);b.scrollTopTo(y(c));a=y("#pageHeading");a.attr("tabindex","0").css("outline","none");a.focus()}}})});a.declarative("new-cc",["submit"],v);a.declarative("new-cc-inbox",["click"],l);T()?a.declarative("new-dd",["submit"],L):a.declarative("new-dd",
["submit"],M);a.declarative("new-invoice",["submit"],M);a.declarative("new-brdc",["submit"],v);a.declarative("new-verified-card",["click"],Q);a.declarative("check-card-type",["change"],K);a.declarative("redirect-cup",["click","touchend"],B);a.declarative("cup-popover-close",["click"],q);a.declarative("new-ba",["submit"],function(a){var b=a.$target;if(b.find("#check-account-number").val()!==b.find("#check-account-number-confirm").val())return b.find("#check-errors").show(),b.find("#addBankAccount_AccountNumberMismatch").show(),
b.find("[error\x3daddBankAccount_AccountNumberMismatch]").addClass("a-form-error"),a.$event.preventDefault(),!1;M(a)});var c;a.declarative("check-terms-show",["click"],function(b){c=y(document).scrollTop();a.$("#check-terms-content").show();y(document).scrollTop(0)});a.declarative("check-terms-close",["click"],function(b){y(document).scrollTop(c);a.$("#check-terms-content").hide()});a.declarative("new-gc-promo",["click"],O);a.declarative("invoice-policy",["click"],function(a){a=a.$declarativeParent;
a.find("i.a-icon-touch-link").hide();a.find("span.policy-preview").hide();a.find("span.policy-full").show()});U=!1}}function O(a){var c=b.getInputValues(y("#new-gc-promo"));a.data.handler&&(c.handler=a.data.handler);b.makeAjaxCall(a.data.url,c,{successHandler:function(a,c,d){a&&(c=b.getPageId(d))&&e.slideShow(y(c),a)},completeHandler:function(a,b){y.isEmptyObject(z)||z.triggerAjaxLoadEvent()}});a.$event.preventDefault()}function T(){var a=y("#useDDNewErrorMessage");return a.length&&"1"===a.val()}
var y=a.$,V=k.P&&k.P.AUI_BUILD_DATE,I={cc:{fieldId:"#form-add-credit-card",suffix:""},vcc:{fieldId:"#new-verified-credit-card",suffix:"_VCC"},emi:{fieldId:"#newEmiCard",suffix:"_VCC"},vdc:{fieldId:"#new-verified-debit-card",suffix:"_VDC"},brdc:{fieldId:"#form-add-br-debit-card",suffix:"_BRDC"}},U=!0,h=y("input#isPipelinedPage");if(0<h.length&&"1"===h.val())a.on("checkout:reload:payselect",H);else H()});m.when("A","pay-common-util","ajax-utility","page-transition-controller","page-main","safe-mash",
"client-side-metrics","pay-gil","page-conductor","weblab-helper","ready").register("mobile-gil-estimates",function(a,b,e,d,c,f,g,k,m,n){function C(a){k.actionCloseGilMobileSubpage(a);b.scrollTopTo(c.getSelectedPaymentRow());return!1}function z(a){d.show();k.actionSubmitGilMobileSubpage(a,r,B);return!1}function r(a,d,e){c.getSelectedPaymentRow().find('input[name\x3d"showIneligibleItemSubpage"]').val("");1==parseInt(v("input[name\x3d'gil-rendered-using-apx']").val(),10)&&n.isGILCreditCardEnabled()?
(a=v(".pmts-select-payment-instrument-form"))&&0<a.length?m.continueClicked(null,a):g.increaseCount("Checkout:GIL:IneligibleSubpage:ErrorRedirectingToSPC",1):v(b.pages.main.pageId).find("#continueButton").trigger("click")}function B(a){v("#gil-estimates-subpage").find(".gil-estimates-error").show()}function q(){b.isMobileCX()&&(a.declarative("gil-close-subpage",["click"],C),a.declarative("gil-submit-subpage",["click"],z))}var v=a.$;e=v("input#isPipelinedPage");if(0<e.length&&"1"===e.val())a.on("checkout:reload:payselect",
q);else q()});m.when("A","page-main","ready").execute(function(a,b){var e=a.$,e=e("input#isPipelinedPage");if(0<e.length&&"1"===e.val())a.on("checkout:reload:payselect",b.init);else b.init()});m.when("A","page-rewards","ready").execute(function(a,b){var e=a.$,e=e("input#isPipelinedPage");if(0<e.length&&"1"===e.val())a.on("checkout:reload:payselect",b.init);else b.init()});m.when("A","page-financial-offer","ready").execute(function(a,b){var e=a.$,e=e("input#isPipelinedPage");if(0<e.length&&"1"===e.val())a.on("checkout:reload:payselect",
b.init);else b.init()});m.when("A","page-main","pay-common-util","client-side-metrics","mobile-carrier-billing-util","weblab-helper").register("jppoints-mobile",function(a,b,e,d,c,f){function g(){l.gcCheckbox.is(":checked")||(l.redeemableAmount.text(l.redeemableAmountWithoutGC.val()),l.redeemableValue.text(l.redeemableValueWithoutGC.val()));l.gcRadio&&l.gcRadio.is(":checked")&&w();(v?l.redeemPoints.parents(".a-control-row"):l.redeemPoints.parent("label")).bind("click",C);var a=v?".a-control-row":
"label";l.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]').closest(a).bind("click",z);l.jpPointsCustomAmount.bind("keyup",B);l.jpPointsCustomAmount.bind("click",function(){l.useCustomPoints.attr("checked",!0);l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");u()||b.setContinueButtonStatus(!1)});(v?l.gcCheckbox.parents(".a-control-row"):
l.gcCheckbox.parent("label")).bind("click",r);l.paymentRows.bind("click",function(){var a=q(this).find('input[type\x3d"radio"]');a&&a.length&&(0<a.filter("[value^\x3davailablebalance]").size()?w():!f.isMCBMultiTenderWeblabEnabled()&&0<a.filter("[value^\x3dMCB]").size()?(w(),c.showMCBWarningMessageForPoints(l)):(l.redeemPoints.attr("disabled",!1),l.jppoints.find('input[type\x3d"radio"]').attr("disabled",!1),l.jppoints.find('input[type\x3d"checkbox"]').attr("disabled",!1),l.useCustomPoints.attr("disabled",
!1),l.jpPointsCustomAmount.attr("disabled",!1),l.jppoints.find("#canApplyPoints").show(),l.jppoints.find("#cannotApplyPoints").hide(),c.hideMCBWarningMessageForPoints(l)))})}function w(){l.redeemPoints.attr("checked",!1).attr("disabled",!0);l.redeemPoints.siblings("i").addClass("a-icon-touch-checkbox-inactive").removeClass("a-icon-touch-checkbox-active");l.jppoints.find('input[type\x3d"radio"]').attr("checked",!1).attr("disabled",!0);l.jppoints.find('input[type\x3d"checkbox"]').attr("checked",!1).attr("disabled",
!0);l.jppoints.find("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");l.useCustomPoints.attr("disabled",!0);l.jpPointsCustomAmount.val("");l.jpPointsCustomAmount.attr("disabled",!0);l.jppoints.find("#canApplyPoints").hide();l.hiddenSection.hide();l.jppoints.find("#cannotApplyPoints").show()}function u(){if(v)return 0<l.paymentRows.filter("[data-ischecked\x3d1]").length;d.increaseCount("removeauijs48");return 0<l.paymentRows.filter("[ischecked\x3d1]").length}function n(){var a=
q('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.attr("checked",!1);a.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");a.closest("label").attr("ischecked",0)}function C(c){q(c.target);l.redeemPoints.siblings("i").toggleClass("a-icon-touch-checkbox-active").toggleClass("a-icon-touch-checkbox-inactive");l.redeemPoints.attr("checked",!l.redeemPoints.attr("checked"));if(l.redeemPoints.is(":checked")){l.hiddenSection.show();l.useMaxPoints.attr("checked",
!0);l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");c=parseInt(l.redeemableAmount.text(),10);var d=parseInt(l.jpPointsConversionRate.val(),10),e=parseInt(l.purchaseTotalRaw.val(),10);l.gcCheckbox.is(":checked")&&(e-=parseInt(l.jpPointsCustomerGCValue.val(),10));d*c>=e?(n(),b.setContinueButtonStatus(!0)):u()||b.setContinueButtonStatus(!1)}else l.hiddenSection.hide(),l.useMaxPoints.attr("checked",!1),l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),
l.useCustomPoints.attr("checked",!1),l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),l.jpPointsCustomAmount.val(""),u()||b.setContinueButtonStatus(!1);m.when("installments-payselect-mobile").execute(function(b){a.trigger("installments-payselect-mobile:toggleJPPointsInstallmentEligibility",l.jppoints)});return!1}function z(c){var d=q(c.target);if(d.find("#jpPointsMax").length||d.siblings("#jpPointsMax").length){l.useMaxPoints.attr("checked",
!0);l.jpPointsError.hide();l.jpPointsCustomAmount.val("");l.jpPointsCustomAmount.removeClass("a-form-error");l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");var d=parseInt(l.redeemableAmount.text(),10),e=parseInt(l.jpPointsConversionRate.val(),10),d=d*e,e=parseInt(l.purchaseTotalRaw.val(),10);l.gcCheckbox.is(":checked")&&(e-=
parseInt(l.jpPointsCustomerGCValue.val(),10));d>=e?(n(),b.setContinueButtonStatus(!0)):u()||b.setContinueButtonStatus(!1)}else l.useCustomPoints.attr("checked",!0),l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive"),l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),l.jpPointsCustomAmount.focus(),u()||b.setContinueButtonStatus(!1);m.when("installments-payselect-mobile").execute(function(b){a.trigger("installments-payselect-mobile:toggleJPPointsInstallmentEligibility",
q(c.currentTarget))});return!1}function r(){var a=l.gcCheckbox;if(!a.length&&(a=q('input[type\x3d"radio"][value\x3d"availableBalance"]'),!a.length))return;var b;a.is(":checked")?(a=parseInt(l.redeemableAmountWithoutGC.val(),10),b=l.redeemableValueWithoutGC.val()):(a=parseInt(l.redeemableAmountWithGC.val(),10),b=l.redeemableValueWithGC.val());l.redeemableAmount.text(a);l.redeemableValue.text(b);B()}function B(){var c=parseInt(l.jpPointsCustomAmount.val(),10);if(!c||0>c)l.jpPointsCustomAmount.val(""),
l.jpPointsCustomAmount.removeClass("a-form-error"),l.jpPointsError.hide();else if(l.jpPointsCustomAmount.val(c),parseInt(l.redeemableAmount.text(),10)<c)l.jpPointsError.show(),l.jpPointsCustomAmount.addClass("a-form-error");else{l.jpPointsError.hide();l.jpPointsCustomAmount.removeClass("a-form-error");var d=parseInt(l.purchaseTotalRaw.val(),10),e=parseInt(l.jpPointsConversionRate.val(),10),e=c*e;if(l.gcCheckbox.is(":checked"))var f=parseInt(l.jpPointsCustomerGCValue.val(),10),e=e+f;e>=d?(n(),b.setContinueButtonStatus(!0)):
u()||b.setContinueButtonStatus(!1);m.when("installments-payselect-mobile").execute(function(b){a.trigger("installments-payselect-mobile:actionToggleJPPointsSection",c)})}}var q=a.$,v=k.P&&k.P.AUI_BUILD_DATE,l={},p={jppoints:"#jppoints",paymentRows:"#select-payments-view label.a-touch-radio",gcCheckbox:'input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]',gcRadio:'input[type\x3d"radio"][value\x3d"availablebalance"]',hiddenSection:"#hiddenSection",jpPointsConversionRate:'input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]',
jpPointsCustomAmount:'input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]',jpPointsCustomerGCValue:'input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]',jpPointsError:"#jpPointsError",purchaseTotalRaw:'input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]',redeemableAmount:"#redeemableAmount",redeemableAmountWithGC:'input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]',redeemableAmountWithoutGC:'input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]',redeemPoints:"#redeemPoints",
redeemableValue:"#redeemableValue",redeemableValueWithGC:'input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]',redeemableValueWithoutGC:'input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]',useCustomPoints:"#jpPointsCustom",useMaxPoints:"#jpPointsMax",mcbPointsWarning:"#mcbPointsWarning"};v&&(p.paymentRows="#select-payments-view .a-touch-radio");a.on("checkout:reload:payselect",function(){e.isMobileCX()&&(e.refreshElements(l,p),l.jppoints&&l.jppoints.length&&g())})});m.when("A","pay-common-util").execute(function(a,
b){function e(){d('.a-radio[data-isaddresschallenge\x3d"true"]').unbind("click").bind("click",function(){var a=d(this),b=a.find('input[type\x3d"radio"]').is(":checked"),e="1"===a.attr("isfocused");a.attr("isfocused",b?1:0);e&&b&&a.find("#addCreditCardNumber").focus()})}var d=a.$;a.on("checkout:reload:payselect",function(){var a;if(a=k.P&&k.P.AUI_BUILD_DATE){a=parseFloat;var f;f=navigator.userAgent.toLowerCase();f=f.match(/android\/([0-9\.]*)/);a=4.4===a(f?f[1]:0)}a&&(a=d("#useFocusFixForTextBoxWithinRadio"),
a=a.length&&"1"===a.val());a&&b.isMobileCX()&&e()})});"use strict";m.when("A","ready").register("purchase-order-number-trial",function(a){function b(){}function e(){}var d=a.$;a.on("checkout:reload:payselect",function(){var a=d(".checkout-page-form");a&&0!==a.length&&parseInt(a.attr("data-trial-po-number"),10)&&d('#existing-loc-accounts input[type\x3d"text"]').each(function(a){var c=d(this);c.unbind("change").bind("change",function(){var a=c.val();if(a&&0!==a.length){var f;if(c.attr("name")){var k=
c.attr("name").split(".");k&&2===k.length&&(f=k[1])}f&&0!==f.length&&d.ajax({type:"POST",url:"/gp/buy/payselect/handlers/set-po-number-trial.html",data:{purchaseOrderNumber:a,paymentMethodId:f},dataType:"text",async:!0,success:b,error:e,cache:!1})}})})})});"use strict";m.when("A","safe-mash","a-dropdown","client-side-metrics","ready").execute(function(a,b,e,d){function c(){setTimeout(function(){g("#stop-mash-reappear").remove()},100)}function f(a,f){a.append('\x3cdiv id\x3d"stop-mash-reappear" /\x3e');
g("#ccScannerUsed").val(1);var C=[1],z="undefined"!==typeof k.ue&&"undefined"!==typeof k.ue.count;z&&!b.showCardScanner?k.ue.count("ccScannerFailureMashFtNotFound",1):b.showCardScanner({cardTypes:C,successCallback:function(b){if(b&&b.cardData){b=b.cardData;var B;g.isArray(b.number)&&b.number.length&&(B=b.number[0].value);if(B){z&&k.ue.count("ccScannerSuccess",1);a.find("#card-scanner-feature").addClass("aok-hidden");a.find("#addCreditCardNumber").val(B);B=null;if(g.isArray(b.expirationMonth)&&g.isArray(b.expirationYear)&&
b.expirationMonth.length&&b.expirationYear.length){var q=parseInt(b.expirationYear[0].value,10);100>q&&(q+=2E3);q>=(new Date).getFullYear()&&(B={month:""+parseInt(b.expirationMonth[0].value,10),year:""+q})}if(B){z&&k.ue.count("ccScannerSuccessWithMonth",1);var v=a.find("#ccMonth");b=a.find("#ccYear");if(0>=v.length||0>=b.length){c();f&&a.find("#confirm-card").trigger("click");return}m?(e.getSelect(v).val(B.month),e.getSelect(b).val(B.year)):(d.increaseCount("removeauijs34"),v.val(B.month),q=v.siblings("a.a-placeholder"),
v=v.find("option[value\x3d"+B.month+"]").text(),q.html(v),b.val(B.year),q=b.siblings("a.a-placeholder"),b=b.find("option[value\x3d"+B.year+"]").text(),q.html(b))}b=!1;q=a.find("#card-scanner-success-messages");g("#ccName").val()||(q.find("#cc-scan-missing-name").removeClass("aok-hidden"),b=!0);B||(q.find("#cc-scan-missing-exp-date").removeClass("aok-hidden"),b=!0);b&&q.removeClass("aok-hidden")}else z&&(k.ue.count("ccScannerFailure",1),k.ue.count("ccScannerFailureNoNum",1));c();f&&a.find("#confirm-card").trigger("click")}else c()},
failCallback:function(a){z&&(k.ue.count("ccScannerFailure",1),k.ue.count("ccScannerFailureError",1));c()}})}var g=a.$,m=k.P&&k.P.AUI_BUILD_DATE;a.declarative("card-scanner",["click"],function(a){a.$event.preventDefault();a=a.$currentTarget.parents("#add-new-cc, #new-cc, #new-cc-inbox");f(a,!1)});a.declarative("card-scanner-addr-challenge",["click"],function(a){a.$event.preventDefault();a=a.$currentTarget.parents(".payment-box, .payment-row");f(a,!0)})});"use strict";m.when("page-detector","A","ready").register("third-party-account-alternative",
function(a,b){var e=b.$;b.declarative("a-third-party-payment-select",["click"],function(a){var b=null;a.data&&a.data.value?b=a.data.value:(a=a.$target.closest(".payment-alternate"),a.length&&(b=a.data("value")));b&&e("#third-party-select").val(b)});b.on("checkout:reload:payselect",function(){if(a.isMobile()){var b=e(".payment-alternate");b.length&&(b=b.find("input[type\x3d'radio']:checked"),b.length&&b.click())}else if(b=e("#third-party-account").find(".payment-alternate"),0!==b.length){var c=e("#pm-third-party-account");
c.length&&c.is(":checked")&&(c=e("#third-party-select").val(),b=b.filter("[data-value\x3d"+c+"]"),b.length&&(b.addClass("payment-selected"),b.find("input").prop("checked",!0)))}})});"use strict";m.when("A","ready").register("credit-card-autopopulated-fields-clear",function(){});"use strict";m.when("A","ready").register("credit-card-number-format-spacing",function(){});"use strict";m.when("A","ready").register("payselect-enhancements",function(){});"use strict";m.when("A","page-transition-controller",
"scroll-controller","checkout-modal-popover","page-conductor","checkout-general-utils","safe-mash").register("itemselect-controller",function(a,b,e,d,c,f,g){function m(a){C(a.data);a.$event.preventDefault();a=a.$target.closest(A?"button[type\x3dbutton]":"input[type\x3dbutton]");var b={};b[a.attr("name")]=a.val();u(b)}function u(a){b.show();var d=p("form#changeQuantityFormId"),e=d.serialize(),e=e+("\x26"+p.param(a));p.ajax({type:"POST",url:d.attr("action"),data:e,dataType:"text",headers:{"x-amz-checkout-page":"itemselect"},
error:c.ajaxRedirect,success:n})}function n(a,d,e){var g=e.getResponseHeader("x-amz-checkout-new-cart-quantity");f.updateCartByMash(g);g=e.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==g&&void 0!==g?(b.hide(),k.location=g):c.ajaxUpdatePage(a,d,e,{pushNewFrame:"false"})}function C(a){""!==a&&p("form#changeQuantityFormId").attr("action",a)}function z(){b.hide();k.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function r(){e.toggleScrollOn();p("div.stma-line-item-hidden-fields input[name^\x3dpreviousQuantity]").each(function(){var a=
p(this);if(a.attr("name")&&17<a.attr("name").length){var b=a.attr("name").substring(17);p('div.stma-line-item-details input[name\x3d"quantity.'+b+'"]').val(a.val())}})}function B(a){function b(a){var c=p("#stma-address-selector"),d=a.data("itemCount"),e=a.data("addressSelectorName"),f=p("#address-item-id-"+d).val();a=a.data("ineligibleAddresses");p("#address-selector-selector").val(e);p("#address-selector-id").val(f);p("#address-selector-num").val(d);c.find(".addressLine").removeClass("a-active");
c.find("."+f).addClass("a-active");p("#stma-page-container").hide();p("#stma-page-header").hide();A&&p("#stma-page-footer").hide();c.show();q(a)}K||(K={value:!1},"1"===p("#rmMultiaddress2ndBackApp").val()&&(K.value=g&&g.navigate&&p("#checkoutDisplayPage").data("useMashNavigateForTransitions")));K.value?g.navigate({url:null,transitionEffect:"slide",successCallback:function(){b(a);k.history.pushState({multipleAddressPageMarker:!0},"");k.history.pushState(null,"");var c=k.onpopstate;k.onpopstate=function(a){a.state.multipleAddressPageMarker&&
(l(),k.onpopstate=c,k.history.back())}},failCallback:function(a){}}):b(a)}function q(a){p(".addressLine").prop("disabled",!1);p(".addressLine").show();p(a.split(" ")).each(function(){p("#"+this).prop("disabled",!0).hide()});var b=p("#filterMessage");a?b.show():b.hide()}function v(a){var b="#"+p("#address-selector-selector").val();if(p(b).hasClass("pantry-item")&&(b=p(".pantry-item"),!(2>b.length))){var c=a.data("addressid"),d=a.data("addresskey"),e=a.data("addresshtml");b.each(function(){var a=p(this);
if(a.val()===d)return!0;var b,f=a.parents("a[data-item-count]")[0];f&&(b=p(f).attr("data-item-count"));b&&(a.val(d),p("#address-item-id-"+b).val(c),p("#address-item-display-"+b).text(e))})}}function l(){p("#stma-page-header").show();p("#stma-page-container").show();A&&p("#stma-page-footer").show();p("#stma-address-selector").hide()}var p=a.$,A=k.P&&k.P.AUI_BUILD_DATE,K=null;a.on("checkout:reload:itemselect",function(){p("form#changeQuantityFormId").attr("action",p("form#changeQuantityFormId").attr("action")+
"\x26action\x3dcontinue");a.defer(function(){p("html").hasClass("a-touch")&&p("a[target\x3d'AmazonHelp']").removeAttr("onclick")});0<p("div.checkout-stma-tablet").length&&p(".quantity-field").unbind("keypress.stma-qty-field").bind("keypress.stma-qty-field",function(c){13===c.which&&(c.preventDefault(),b.show(),a.trigger("a:declarative:ship-to-multiple-continue:click"),p("form#changeQuantityFormId").submit())});var c=p("#addon-indicator");if(c.data("hasAddonItems")){var d=c.data("addonWarningType"),
d=p("#addon-warning-"+d+"-launcher");d.length&&(c.data("showAddressTitle")?(p("#a-popover-addon-warning-normal .select-address-title").show(),p("#a-popover-addon-warning-normal .delete-title").hide(),p("#a-popover-addon-warning-normal .reduce-title").hide()):(p("#a-popover-addon-warning-normal .delete-title").show(),p("#a-popover-addon-warning-normal .reduce-title").hide(),p("#a-popover-addon-warning-normal .select-address-title").hide()),d.trigger("click"),e.scrollToTop(),e.toggleScrollOff())}});
(function(){a.declarative("stma-delete-item",["click"],function(a){m(a)});a.declarative("ship-to-multiple-delete",["click"],function(a){0<p("div.checkout-stma").length&&(p(".quantity-delete-button[data-entity-id\x3d'"+a.$currentTarget.data("entityId")+"']"),k.confirm(p("#addressConfirmDeletion").val())?m(a):a.$event.preventDefault())});a.declarative("ship-to-multiple-continue",["click"],function(a){C(a.data)});a.declarative("stma-items",["click"],function(a){a=a.$currentTarget;var b=p("#stma-address-selector"),
c=a.data("addressid"),d=a.data("addresskey");b.find(".addressLine").removeClass("a-active");b.find("."+c).addClass("a-active");b="#"+p("#address-selector-selector").val();p(b).val(d);d=p("#address-selector-num").val();p("#address-item-id-"+d).val(c);c="#address-item-display-"+d;a=a.data("addresshtml");p(c).text(a);K.value?g.goBack():l()});a.declarative("stma-address-select",["click"],function(a){B(a.$currentTarget)});a.declarative("stma-back",["click"],function(a){a.$event.preventDefault();l()});
a.declarative("addon-return-to-cart",["click"],function(a){0<p("div.checkout-stma-mobile").length&&z()});a.declarative("addon-delete-items",["click","touchend"],function(a){0<p("div.checkout-stma").length&&(a.$event.preventDefault(),e.toggleScrollOn(),a=p("input#updateLinkAction").val(),C(a),u({"deleteAddon.x":1,"deleteAddon.y":1}))});a.declarative("addon-dont-delete",["click","touchend"],function(a){0<p("div.checkout-stma").length&&r()});a.declarative("stma-items",["click"],function(a){v(a.$currentTarget)});
a.on("a:popover:hide:addon-warning-normal",function(a){0<p("div.checkout-stma-mobile").length?z():0<p("div.checkout-stma-tablet").length&&r()});a.on("a:popover:hide:addon-warning-special",function(a){0<p("div.checkout-stma").length&&r()})})()});"use strict";m.when("A","checkout-general-utils").register("checkout-confirm-action",function(a,b){var e;a.declarative("a-checkout-confirm-action",["click","touchend"],function(d){if(!b.protectAgainstDoubleAction("checkout-confirm-action")){var c=a.$("#rcx-confirm-"+
d.data.confirmAction).find("#rcx-modal-trigger"),e=c.data("a-checkout-modal-popover");e.data=d.data;c.data("a-checkout-modal-popover",e);setTimeout(function(){c.trigger("click")},30)}});a.declarative("a-popover-confirm",["click","touchend"],function(d){b.protectAgainstDoubleAction("popover-confirm")||(d=d.data,e&&e.data&&d&&a.trigger("a:declarative:"+d,e.data),e&&e.$popover.find("button[data-action]\x3da-popover-close").trigger("click"))});a.on("a:popover:show:checkout-confirm",function(b){e=b.popover;
b=e.$popover.find(".a-popover-inner");var c=a.$("#rcx-confirm-"+e.data.confirmAction).find("#rcx-confirm-template").html();b.html(c);e.updatePosition()});a.on("a:popover:hide:checkout-confirm",function(){e=null})});"use strict";m.when("A").register("pip-controller",function(a){var b=a.$;a.on("checkout:reload:pip",function(){b(".checkout.checkout-pip").length||b("head .aui-page-asset").attr("disabled",!0);b("head .old-pipeline-asset").attr("disabled",!0);0<b("#disablePIPPrefetch").length?(b(".prime-checkout-continue-link").removeClass("checkout-continue-link"),
b(".prime-checkout-continue-form").removeClass("checkout-page-form")):(b(".prime-checkout-continue-link").addClass("checkout-continue-link"),b(".prime-checkout-continue-form").addClass("checkout-page-form"))})});"use strict";m.when("A","page-detector").register("locker-promo-controller",function(a,b){function e(){var a=c("#locker-search-link"),b=a.attr("href");a.attr("href",b+"\x26hasWorkingJavascript\x3d1");c("#locker-promo-checkbox-link").addClass("has-js")}function d(){c("#locker-promo-checkbox-link").addClass("has-js");
if(c("#locker-promo").hasClass("trigger-interstitial")){var a=c("#locker-high-vis-promo-title");setTimeout(function(){a.trigger("click")},50)}}var c=a.$;c("html").hasClass("a-ie6")||(a.on("checkout:reload:spc",e),a.on("checkout:reload:shipoptionselect",d))});"use strict";m.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor","checkout-general-utils").register("store-search-popover-controller",function(a,b,e,d,c,f){function g(){if(0<S&&"undefined"!==
typeof k.Map)try{k.Map.getMapAndIcons(),Q=!0}catch(a){--S,setTimeout(g,500)}S=20}function m(){y=0;v.find("button.a-button-close").trigger("click")}function u(a){var b=q("#locker-promo");b.hasClass("trigger-interstitial")&&(b.removeClass("trigger-interstitial"),B(T),0<q("#lockerInterstitialHeader").length&&q("#lockerInterstitialHeader").hide(),q.ajax({type:"POST",url:"/gp/azbox/interstitial/handlers/interstitial-opt-out.html/ref\x3d"+a,dataType:"html",cache:!1,headers:{"x-amz-checkout-page":"sosp"}}))}
function n(a){a.filter("style").each(function(){var a=this.text||this.textContent||this.innerHTML||"";if(null!==a){var b=document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a));v.find("#storeResultContent").append(b)}})}function C(a){a.filter("script").each(function(){if(this.src)0<this.src.indexOf("mapcontrol")&&(K=this.src);else{var a=this.text||this.textContent||this.innerHTML||"";if(null!==a){var b=document.createElement("script");
b.type="text/javascript";b.text=a;v.find("#storeResultContent").append(b)}}})}function z(a,b){a.find("div#wrapper").css("width","100%");a.find("div#ft").hide();d.hideSpinner(L);L.show();L.html(a.find("div#wrapper"));L.css({"overflow-y":"scroll"});v.css("position","absolute");v.css("top","50px");q("#storeResultContent").css("height",N+"px");n(a);C(a);null!==K&&!1===Q?q.ajax({url:K,async:!1,success:g,dataType:"script",error:function(a,b,d){c.ajaxRedirect(a,b,d)}}):g();e.scrollToTop();e.toggleScrollOff()}
function r(a){L=l.$popover.find("#storeResultContent");d.showSpinner(L);q.ajax({type:"POST",url:a,dataType:"html",data:{defaultStoreUpsellSelectedAddressId:I},async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a,b,e){null!==a?(b=q(a),0<b.find("div.errorblock").length?(d.hideSpinner(L),L.show(),L.html(b.find("div.errorblock").parent())):0<b.find("input[name\x3drefineSearch]").length?(A=b.find("form[name\x3dlocationForm]"),null!==A&&(A.find("input").attr("id","storeSearchRefineButton"),
A.parent().find("h1").css("color","black")),z(b,a)):0<b.find("div#wrapper").length?(b.find("#wrapper").find("tr:first").children("td")[0].style.width="49%",b.find("#wrapper").find("tr:first").children("td")[1].style.width="2%",b.find("#wrapper").find("tr:first").children("td")[2].style.width="49%",b.find("#sl_map").css("width","100%"),b.find("#whatsThisPopoverLink").removeAttr("href"),b.find("#whatsThisPopoverLink").addClass("a-declarative"),b.find("#whatsThisPopoverLink").css("a-declarative"),b.find("#whatsThisLink").addClass("a-declarative"),
b.find("#whatsThisLink").attr("data-action","a-tooltip"),e='{"position":"triggerBottom","content":"'+M+'"}',b.find("#whatsThisLink").attr("data-a-tooltip",e),b.find("#whatsThisLink").css("max-width","100px"),b.find("input[name\x3dshipToThisAddress]").attr("src",R),b.find("input[name\x3dshipToThisAddress], span.default-store-upsell-selected-address").parent().css("text-align","center"),b.find("input[name\x3dshipToThisAddress], span.default-store-upsell-selected-address").parent().css("vertical-align",
"middle"),p=b.find("table.storesearchtable").parent(),p.find("label").css("display","inline"),b.find("table.storesearchtable").parent().append(O),b.find("table.storesearchtable").parent().find("div#lockerPromoPopover").show(),z(b,a)):k.location.reload()):c.ajaxRedirect()},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function B(a){v.find("div.a-popover-header h4").text(a)}var q=a.$;if(!q("html").hasClass("a-ie6")){var v,l,p,A,K=null,Q=!1,L,R,M,S=20,N,H,O,T,y,V,I;a.on("a:popover:hide",function(a){a.popover&&
a.popover.name&&a.popover.name.indexOf("store-search-popover")});q(document).delegate("#storeResultContent input.storesearchprimaryinput","click",function(a){a.preventDefault();q(this).parent().parent().find("input[type\x3dradio]").attr("checked","checked")});q(document).delegate("#storeResultContent input[name\x3dshipToThisAddress]","click",function(a){a.preventDefault();a=q(this).parents().find("form")[0].action;a+="?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26shipToThisAddress\x3dContinue";
var c=q(this).parent().parent().find("input:hidden"),d,e;for(e=0;e<c.length;e++){d=c[e].name;var g=c[e].value;if(y&&V&&"storeUpsellAddressId"===d&&g){d=f.addQueryStringParameter(V,"storeUpsellSelectedAddressId",g);break}d=a=a+"\x26"+d+"\x3d"+g}m();b.show();f.redirectWithJavascript(d)});q(document).delegate("#storeResultContent input[name\x3dshowDetailedMap]","click",function(a){a=a.$target[0].id.replace("pinpointImage_idx_","");"undefined"!==typeof k.Map&&k.Map.selectPin(a-1)});q(document).delegate("#storeResultContent input[name\x3dsearchStoreByName]",
"click",function(a){a.preventDefault();A=v.find("form");a=A[0].action;a+="?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26searchStoreByName\x3dContinue";var b=A.find("input:hidden"),c;for(c=0;c<b.length;c++)a=a+"\x26"+b[c].name+"\x3d"+b[c].value;r(a)});q(document).delegate("#storeResultContent #storeSearchRefineButton","click",function(a){a.preventDefault();A=v.find("form[name\x3dlocationForm]");a=A[0].action;a+="?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26";var b=A.find("input:hidden"),
c;for(c=0;c<b.length;c++)a=a+"\x26"+b[c].name+"\x3d"+b[c].value;r(a)});q(document).delegate("#storeResultContent div.storesearchaction input","click",function(a){a.preventDefault();p=v.find("#new-store").parent().find("form");var b=p.find("input:checked")[0].value;a=p[0].action;var c=p.find("input:checked")[0].name,d=v.find("#"+b)[0].name,e=v.find("#"+b)[0].value;a=a+"?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26"+c+"\x3d"+b+"\x26"+d+"\x3d"+e;for(b=0;b<p.find("select").length;b++)c=p.find("select")[b].name,
d=p.find("option:checked")[b].value,a=a+"\x26"+c+"\x3d"+d;c=p.find("input:hidden");for(b=0;b<c.length;b++)a=a+"\x26"+c[b].name+"\x3d"+c[b].value;r(a)});q(document).delegate("div#promoFooter button","click",function(a){u("sosp_locker_tp_optout_nt");m()});q(document).delegate("div.a-popover-header button.a-button-close","click",function(a){u("sosp_locker_tp_optout_cb")});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("store-search-popover")){var b=q(k).width(),
c=q(k).height(),b=parseInt(.88*b,10);N=parseInt(.62*c,10);var d=a.popover.$trigger.data("locker-search-url");v=a.popover.$popover;l=a.popover;T=v.find("div.a-popover-header h4").text();q("#locker-promo").hasClass("trigger-interstitial")&&(B(a.popover.$trigger.data("header-interstitial")),0<q("#lockerInterstitialHeader").length&&q("#lockerInterstitialHeader").show(),d=a.popover.$trigger.data("locker-search-url-interstitial"),N=parseInt(.45*c,10));q("#storeResultContent").css("height",N+"px");q("#storeResultContent").css("width",
b+"px");v.css("position","absolute");v.css("top","50px");l.updatePosition(!0);H=v.find("div#lockerPromo");O=H.clone(!0);O.attr("id","lockerPromoPopover");v.find("#storeResultContent").empty();R=a.popover.$trigger.data("locker-search-button");a.popover.$trigger.data("locker-search-disabled-button");M=a.popover.$trigger.data("restricted-locker-disclaimer-text");y=0;r(d)}});a.on("a:popover:show:store-upsell-ship-options",function(a){var b=q(k).width(),c=q(k).height(),b=parseInt(.88*b,10);N=parseInt(.62*
c,10);c=a.popover.$trigger.data("store-search-url");v=a.popover.$popover;l=a.popover;q("#storeResultContent").css("height",N+"px");q("#storeResultContent").css("width",b+"px");v.css("position","absolute");v.css("top","50px");l.updatePosition(!0);H=v.find("div#store-upsell-pickup-instructions");O=H.clone(!0);O.attr("id","lockerPromoPopover");v.find("#storeResultContent").empty();R=a.popover.$trigger.data("store-search-button-url");M=a.popover.$trigger.data("restricted-store-disclaimer-text");y=1;V=
a.popover.$trigger.data("store-select-pickup-url");I=a.popover.$trigger.data("default-store-upsell-selected-address-id");r(c)});a.on("a:popover:hide:store-upsell-ship-options",function(a){y=0})}});"use strict";m.when("A","page-detector-current-page","first-load-dependencies-base","client-side-metrics","weblab-helper").register("first-load-dependencies",function(a,b,e,d,c){var f=a.$,g=["shared-kitchensink","page-transition-controller","page-conductor","page-conductor-mpp","checkout-federation-injector"];
k.P&&k.P.AUI_BUILD_DATE||(d.increaseCount("removeauijs62"),g.concat(["checkout-modal-popover","form-icon-controller"]));d={accesspoint:["accesspoint-search-controller"],deliverypreference:["delivery-preference-controller"],shipaddressselect:"as-controller as-faf-controller as-tablet-controller as-locker-mobile-controller address-book-controller address-utilities what-if-im-not-in-delivery-preferences weekend-availability-loader".split(" "),billingaddressselect:["as-controller","as-tablet-controller",
"address-book-controller"],editaddress:["as-controller","as-tablet-controller","weekend-availability-loader"],giftselect:["gift-form-controller","gift-form-del-opt-controller"],itemselect:["itemselect-controller","itemselect-quantity-controller","address-popovers","itemselect-address-controller","address-popovers"],newaddress:["what-if-im-not-in-delivery-preferences","weekend-availability-loader"],payselect:"pay-common-lib pay-common-util pay-gil pay-validator pay-credit-card existing-payments jppoints page-slide page-main page-rewards mobile-new-payments mobile-gil-estimates jppoints-mobile purchase-order-number-trial otp-for-cod mobile-carrier-billing-util emi-helper instant-bank-discount-helper".split(" "),
payauth:["pay-auth"],pip:["pip-controller"],shipoptionselect:["shipoptionselect-controller","deliv-prefs-sosp","scheduled-delivery-readiness-checker"],spc:"delivery-preferences-controller gc-redeem-controller gift-popover-controller inline-address-popover-controller thirdparty-redirect-popover-controller inline-fps-balance-controller inline-points-controller order-summary-controller-mpp place-order-controller prime-decline-controller quantity-update-controller shipping-speed-selection-controller time-preferences-controller verification-checkbox-controller installments-controller pay-validator page-conductor toggle-pyo-button toggle-pyo-button-common".split(" "),
spclite:["verification-checkbox-controller","get-final-results-update"],throttle:["checkout-throttle-error"]};c.isSospCalendarFixEnabled()&&d.shipoptionselect.push("load");b=b.getCurrentPage();var m=f.merge(g,d[b]||[]);c=c.getFixFederatedAssetsInjectionTimingIssueTreatment();f=function(){e.allDependenciesCheck(m)};if(/T1|T2/.test(c))a.on({T1:"afterReady",T2:"ready"}[c],f);else f()});"use strict";m.when("A","ready").execute(function(a){function b(){e()?g("span.#button_verify").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):
g("span.#button_verify").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled","disabled")}function e(){var a=!0;g('input[type\x3d"text"]:visible').each(function(){var b=g(this);a=b.val()?"documentNumber"===b.attr("name")&&10!==b.val().length||"birthdate"===b.attr("name")&&7!==b.val().length||"expiry"===b.attr("name")&&7!==b.val().length?!1:!0:!1;if(!a)return!1});return a}function d(){g('input[type\x3d"radio"][name\x3d"idType"]').change(function(){g(".container").removeClass("newGermanId oldGermanId passportId").addClass(this.value);
g('input[type\x3d"text"]:visible').each(function(){g(this).val("")});b()})}function c(){a.on("a:dropdown:selected:idType",function(a){g(".container").removeClass("newGermanId oldGermanId passportId").addClass(a.value);g('input[type\x3d"text"]:visible').each(function(){g(this).val("")});b()})}function f(){g("form").submit(function(a){g("#documentNumber").attr("name","");g("#expiry").attr("name","");return!0})}var g=a.$;a.on("checkout:reload",function(){if(0<g(".checkout-ageEntry").length){var a=0<
g(".checkout-ageEntry-mobile").length;g(".checkout-age-verification-inputs").removeClass("nojs").addClass("js");a?(a=g("#idSelector option:selected").attr("value"),-1<["newGermanId","oldGermanId","passportId"].indexOf(a)?g(".container").removeClass("newGermanId oldGermanId passportId").addClass(a):g(".container").removeClass("newGermanId oldGermanId passportId").addClass("newGermanId")):(a=g('input[type\x3d"radio"]:checked').val(),g(".container").removeClass("newGermanId oldGermanId passportId").addClass(a));
b();-1<g(location).attr("href").indexOf("age-verification")&&k.history.replaceState({page:"ageDisplay"},"","/gp/buy/age-verification/handlers/display.html");g('input[type\x3d"text"]').keyup(b);d();c();f()}})});"use strict";m.when("A","ready").execute(function(a){var b=a.$;b(document).ready(function(){b("#changeCORForm").find("#learnMorePopoverLinkPhoneNumber").remove()});b("#changeCORForm").submit(function(){var e={};b(this).find("input").each(function(a,b){e[b.name]=b.value});b(this).find("select").each(function(a,
b){e[b.name]=b.options[b.selectedIndex].value||b.options[b.selectedIndex].innerHTML});a.ajax("/gp/buy/dsv/handlers/change-country-setting.html",{method:"post",params:e,success:function(a){a.success?b("#continueCheckout").submit():"FormErrors"===a.error?b("#dsvAddressForm").html(a.newForm):"DependencyFailure"===a.error?b("#continueCheckout").submit():b("#showWereSorryPage").submit()},error:function(a){b("#continueCheckout").submit()}});return!1})});"use strict";m.when("A","client-side-metrics").execute(function(a,
b){var e=a.$;a.declarative("imb-enter-cvv","click",function(a){b.increaseCount("checkout:spc:desktop:expresscheckout:imbclicked");(a=a.data)&&a.focusTarget&&(a=e("#"+a.focusTarget))&&a.length&&a.focus()})});"use strict";m.when("A","place-order-controller","button-blocker","ready").register("toggle-pyo-button",function(a,b,e){var d=a.$;return{disable:function(){var a=d("form#spc-form");a&&a.length&&(a=a.find(".continue-button-blocker"))&&a.length&&(a=a.find("input").data("blockerText"),e.show("place-order-cvv-error",
a))},enable:function(){var a=d("form#spc-form");a&&a.length&&e.hide("place-order-cvv-error")}}});"use strict";m.when("A","pay-validator","toggle-pyo-button","page-conductor").register("toggle-pyo-button-common",function(a,b,e,d){function c(a){return n("\x3cinput\x3e").attr({type:"hidden",name:"returnjson",id:"returnjsonel",value:a})}function f(a){if(!z&&"1"!==k()){var b=c((new Date).getTime());b.appendTo(a);d.submitFormAjax(a,function(a){z=!1;try{var b=JSON.parse(a);if(b&&b.isOK){var c=b.responseTimestamp;
c>C&&(C=c,g(b.isOK))}}catch(d){}},function(){z=!1;g(0)},void 0,{action:"/gp/buy/spc/handlers/set-payment.html"});z=!0;b.remove()}}function g(a){var b=n("input[name\x3dINExpressCheckoutSetPayment]");b&&b.length&&b.val(a)}function k(){var a=n("input[name\x3dINExpressCheckoutSetPayment]");if(a&&a.length)return a.val()}function m(a,b,c){function d(a){var k=n("#spc-form"),m=n(a.currentTarget),r=parseInt(m.attr("maxlength"),10),u=r,m=m.val(),w=!1;m&&r&&!isNaN(r)&&(b===c.isValidCardCVV?w=b(m,r):b===c.isValidCardPincode&&
(6===r&&(u=5),w=b(m,u,r)));w?(e.enable(),f(k)):(e.disable(),g(0));k&&k.length&&13===a.keyCode&&k.submit()}a.keyup(d);a.change(d)}var n=a.$,C=0,z=!1;a.on("checkout:reload:spc",function(){var a=n("#spc-form");if(a&&a.length&&(a=n("input[name\x3disINExpressCheckoutCC]"))&&a.length&&1===parseInt(a.val(),10)){var a=b.create(),c=a.isValidCardCVV,d=n("#existingCvvNum"),d=d&&d.length?d:n("input[name\x3daddCreditCardVerificationNumber]");d&&0!==d.length||(d=(d=n("#addCreditCardPincode"))&&d.length?d:n("input[name\x3daddCreditCardPincode]"),
c=a.isValidCardPincode);a=d&&0!==d.length?{inputEl:d,inputValidator:c,validator:a}:void 0;if(a){m(a.inputEl,a.inputValidator,a.validator);e.disable();return}}e.enable()})});"use strict";m.when("A","mash","client-side-metrics","ready").register("gc-scan-to-claim",function(a,b,e){function d(){setTimeout(function(){k("#stop-mash-reappear").remove()},100)}function c(a){d();e.increaseCount("gcScannerOnRCXFailureError",1);a.code===b.cardScanError.CANNOT_OPEN_CAMERA?e.increaseCount("gcScannerOnRCXFailureError:cannotOpenCamera",
1):a.code===b.cardScanError.INVALID_CARD_TYPE?e.increaseCount("gcScannerOnRCXFailureError:invalidCardType",1):a.code===b.cardScanError.NO_SUPPORTED_CARD_TYPES&&e.increaseCount("gcScannerOnRCXFailureError:unsupportedCardType",1)}function f(b){b?(b=b.cardData)?(b=b.number)?(14>b.length&&e.increaseCount("gcScannerOnRCXMashError:invalidClaimCodeLength",1),b=14>b.length?b:b.replace(/^(.{4})(.{6})(.+)?$/,"$1-$2-$3"),(k("#spc-gcpromoinput").length?k("#spc-gcpromoinput"):k("#gcpromoinput")).val(b),e.increaseCount("gcScannerOnRCXSuccess:showClaimCode",
1),a.state.replace("cxt-gc-redemption-method",{method:"scan"}),(k("#apply-gc-button").length?k("#apply-gc-button"):k("#button-add-gcpromo")).trigger("click"),a.trigger("gc:scan:rcx:success")):(e.increaseCount("gcScannerOnRCXMashError:noClaimCode",1),d()):(e.increaseCount("gcScannerOnRCXMashError:noCardData",1),d()):(e.increaseCount("gcScannerOnRCXMashError:noCardInfo",1),d())}function g(a){a.$event.preventDefault();k("#apply-gc-button-container").append('\x3cdiv id\x3d"stop-mash-reappear" /\x3e');
e.increaseCount("gcScannerOnRCXSuccess:clickOnScanButton",1);b.showCardScanner({cardTypes:[2],successCallback:f,failCallback:c})}var k=a.$;a.declarative("gc-scan","click",g);a.declarative("gc-scan-input-box","keyup change",function(a){a=k("#spc-gcpromoinput").length?k("#spc-gcpromoinput"):k("#gcpromoinput");var b=k("#apply-gc-button-container");0<k.trim(a.val()).length?b.removeClass("hidden"):b.hasClass("hidden")||b.addClass("hidden")});return 0>=k("div#gc-promo-delay").length?{showScanner:a.constants.NOOP}:
{showScanner:g}})});
/* ******** */
